const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-rjhLG1eB.js","assets/index-D57cUaFw.js","assets/mdxeditor-Cxvfqdhz.js","assets/apexcharts-BnXoAgVT.js","assets/index-DdbShWyY.js","assets/index-nOtcpH01.js","assets/index-uAn85tBp.js","assets/index-D4Wp6AEg.js","assets/index-CWmy4eKR.js","assets/index-CfyObm-o.js","assets/index-yU9Yh-H5.js","assets/index-BdmKeUBW.js","assets/index-DQ-8l3PE.js","assets/index-JH4Gotpn.js","assets/index-FrdabaJ1.js","assets/index-BgBG5lba.js","assets/index-BlSIl150.js","assets/index-BGm_t98o.js"])))=>i.map(i=>d[i]);
import{r as v,j as m,c as be,R as $,_ as hn,k as C$,b as x$,i as k$,a as mx,u as S$,d as Gn,g as dm,e as E$,f as T$,h as _$,l as x_,m as A$,n as I$,o as gn,p as ZD,q as M$,s as is,t as Pl,v as bo,w as Ly,x as R$,y as k_,z as Ed,A as eN}from"./mdxeditor-Cxvfqdhz.js";import{a as P$,g as D$}from"./apexcharts-BnXoAgVT.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();var Uu={},S_;function N$(){if(S_)return Uu;S_=1,Object.defineProperty(Uu,"__esModule",{value:!0}),Uu.parse=i,Uu.serialize=c;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,o=Object.prototype.toString,s=(()=>{const h=function(){};return h.prototype=Object.create(null),h})();function i(h,f){const p=new s,y=h.length;if(y<2)return p;const b=(f==null?void 0:f.decode)||u;let w=0;do{const k=h.indexOf("=",w);if(k===-1)break;const x=h.indexOf(";",w),A=x===-1?y:x;if(k>A){w=h.lastIndexOf(";",k-1)+1;continue}const I=a(h,w,k),M=l(h,k,I),T=h.slice(I,M);if(p[T]===void 0){let S=a(h,k+1,A),_=l(h,A,S);const R=b(h.slice(S,_));p[T]=R}w=A+1}while(w<y);return p}function a(h,f,p){do{const y=h.charCodeAt(f);if(y!==32&&y!==9)return f}while(++f<p);return p}function l(h,f,p){for(;f>p;){const y=h.charCodeAt(--f);if(y!==32&&y!==9)return f+1}return p}function c(h,f,p){const y=(p==null?void 0:p.encode)||encodeURIComponent;if(!t.test(h))throw new TypeError(`argument name is invalid: ${h}`);const b=y(f);if(!e.test(b))throw new TypeError(`argument val is invalid: ${f}`);let w=h+"="+b;if(!p)return w;if(p.maxAge!==void 0){if(!Number.isInteger(p.maxAge))throw new TypeError(`option maxAge is invalid: ${p.maxAge}`);w+="; Max-Age="+p.maxAge}if(p.domain){if(!n.test(p.domain))throw new TypeError(`option domain is invalid: ${p.domain}`);w+="; Domain="+p.domain}if(p.path){if(!r.test(p.path))throw new TypeError(`option path is invalid: ${p.path}`);w+="; Path="+p.path}if(p.expires){if(!d(p.expires)||!Number.isFinite(p.expires.valueOf()))throw new TypeError(`option expires is invalid: ${p.expires}`);w+="; Expires="+p.expires.toUTCString()}if(p.httpOnly&&(w+="; HttpOnly"),p.secure&&(w+="; Secure"),p.partitioned&&(w+="; Partitioned"),p.priority)switch(typeof p.priority=="string"?p.priority.toLowerCase():void 0){case"low":w+="; Priority=Low";break;case"medium":w+="; Priority=Medium";break;case"high":w+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${p.priority}`)}if(p.sameSite)switch(typeof p.sameSite=="string"?p.sameSite.toLowerCase():p.sameSite){case!0:case"strict":w+="; SameSite=Strict";break;case"lax":w+="; SameSite=Lax";break;case"none":w+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${p.sameSite}`)}return w}function u(h){if(h.indexOf("%")===-1)return h;try{return decodeURIComponent(h)}catch{return h}}function d(h){return o.call(h)==="[object Date]"}return Uu}N$();var E_="popstate";function O$(t={}){function e(r,o){let{pathname:s,search:i,hash:a}=r.location;return F1("",{pathname:s,search:i,hash:a},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:oh(o)}return V$(e,n,null,t)}function Ct(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function vo(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function L$(){return Math.random().toString(36).substring(2,10)}function T_(t,e){return{usr:t.state,key:t.key,idx:e}}function F1(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?nu(e):e,state:n,key:e&&e.key||r||L$()}}function oh({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function nu(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function V$(t,e,n,r={}){let{window:o=document.defaultView,v5Compat:s=!1}=r,i=o.history,a="POP",l=null,c=u();c==null&&(c=0,i.replaceState({...i.state,idx:c},""));function u(){return(i.state||{idx:null}).idx}function d(){a="POP";let b=u(),w=b==null?null:b-c;c=b,l&&l({action:a,location:y.location,delta:w})}function h(b,w){a="PUSH";let k=F1(y.location,b,w);c=u()+1;let x=T_(k,c),A=y.createHref(k);try{i.pushState(x,"",A)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;o.location.assign(A)}s&&l&&l({action:a,location:y.location,delta:1})}function f(b,w){a="REPLACE";let k=F1(y.location,b,w);c=u();let x=T_(k,c),A=y.createHref(k);i.replaceState(x,"",A),s&&l&&l({action:a,location:y.location,delta:0})}function p(b){return j$(b)}let y={get action(){return a},get location(){return t(o,i)},listen(b){if(l)throw new Error("A history only accepts one active listener");return o.addEventListener(E_,d),l=b,()=>{o.removeEventListener(E_,d),l=null}},createHref(b){return e(o,b)},createURL:p,encodeLocation(b){let w=p(b);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:h,replace:f,go(b){return i.go(b)}};return y}function j$(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ct(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:oh(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function tN(t,e,n="/"){return B$(t,e,n,!1)}function B$(t,e,n,r){let o=typeof e=="string"?nu(e):e,s=Fs(o.pathname||"/",n);if(s==null)return null;let i=nN(t);$$(i);let a=null;for(let l=0;a==null&&l<i.length;++l){let c=J$(s);a=Y$(i[l],c,r)}return a}function nN(t,e=[],n=[],r=""){let o=(s,i,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:i,route:s};l.relativePath.startsWith("/")&&(Ct(l.relativePath.startsWith(r),`Absolute route path "${l.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(r.length));let c=Ns([r,l.relativePath]),u=n.concat(l);s.children&&s.children.length>0&&(Ct(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),nN(s.children,e,u,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:G$(c,s.index),routesMeta:u})};return t.forEach((s,i)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))o(s,i);else for(let l of rN(s.path))o(s,i,l)}),e}function rN(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,o=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return o?[s,""]:[s];let i=rN(r.join("/")),a=[];return a.push(...i.map(l=>l===""?s:[s,l].join("/"))),o&&a.push(...i),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function $$(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:K$(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var F$=/^:[\w-]+$/,H$=3,z$=2,U$=1,W$=10,q$=-2,__=t=>t==="*";function G$(t,e){let n=t.split("/"),r=n.length;return n.some(__)&&(r+=q$),e&&(r+=z$),n.filter(o=>!__(o)).reduce((o,s)=>o+(F$.test(s)?H$:s===""?U$:W$),r)}function K$(t,e){return t.length===e.length&&t.slice(0,-1).every((r,o)=>r===e[o])?t[t.length-1]-e[e.length-1]:0}function Y$(t,e,n=!1){let{routesMeta:r}=t,o={},s="/",i=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=Um({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=Um({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(o,d.params),i.push({params:o,pathname:Ns([s,d.pathname]),pathnameBase:t8(Ns([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=Ns([s,d.pathnameBase]))}return i}function Um(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=X$(t.path,t.caseSensitive,t.end),o=e.match(n);if(!o)return null;let s=o[0],i=s.replace(/(.)\/+$/,"$1"),a=o.slice(1);return{params:r.reduce((c,{paramName:u,isOptional:d},h)=>{if(u==="*"){let p=a[h]||"";i=s.slice(0,s.length-p.length).replace(/(.)\/+$/,"$1")}const f=a[h];return d&&!f?c[u]=void 0:c[u]=(f||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:i,pattern:t}}function X$(t,e=!1,n=!0){vo(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),r]}function J$(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return vo(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Fs(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function Q$(t,e="/"){let{pathname:n,search:r="",hash:o=""}=typeof t=="string"?nu(t):t;return{pathname:n?n.startsWith("/")?n:Z$(n,e):e,search:n8(r),hash:r8(o)}}function Z$(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function B0(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function e8(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function oN(t){let e=e8(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function sN(t,e,n,r=!1){let o;typeof t=="string"?o=nu(t):(o={...t},Ct(!o.pathname||!o.pathname.includes("?"),B0("?","pathname","search",o)),Ct(!o.pathname||!o.pathname.includes("#"),B0("#","pathname","hash",o)),Ct(!o.search||!o.search.includes("#"),B0("#","search","hash",o)));let s=t===""||o.pathname==="",i=s?"/":o.pathname,a;if(i==null)a=n;else{let d=e.length-1;if(!r&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),d-=1;o.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=Q$(o,a),c=i&&i!=="/"&&i.endsWith("/"),u=(s||i===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var Ns=t=>t.join("/").replace(/\/\/+/g,"/"),t8=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),n8=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,r8=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function o8(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var iN=["POST","PUT","PATCH","DELETE"];new Set(iN);var s8=["GET",...iN];new Set(s8);var ru=v.createContext(null);ru.displayName="DataRouter";var Vy=v.createContext(null);Vy.displayName="DataRouterState";var aN=v.createContext({isTransitioning:!1});aN.displayName="ViewTransition";var i8=v.createContext(new Map);i8.displayName="Fetchers";var a8=v.createContext(null);a8.displayName="Await";var as=v.createContext(null);as.displayName="Navigation";var df=v.createContext(null);df.displayName="Location";var ls=v.createContext({outlet:null,matches:[],isDataRoute:!1});ls.displayName="Route";var gx=v.createContext(null);gx.displayName="RouteError";function l8(t,{relative:e}={}){Ct(hf(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=v.useContext(as),{hash:o,pathname:s,search:i}=ff(t,{relative:e}),a=s;return n!=="/"&&(a=s==="/"?n:Ns([n,s])),r.createHref({pathname:a,search:i,hash:o})}function hf(){return v.useContext(df)!=null}function Xs(){return Ct(hf(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(df).location}var lN="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function cN(t){v.useContext(as).static||v.useLayoutEffect(t)}function Ao(){let{isDataRoute:t}=v.useContext(ls);return t?C8():c8()}function c8(){Ct(hf(),"useNavigate() may be used only in the context of a <Router> component.");let t=v.useContext(ru),{basename:e,navigator:n}=v.useContext(as),{matches:r}=v.useContext(ls),{pathname:o}=Xs(),s=JSON.stringify(oN(r)),i=v.useRef(!1);return cN(()=>{i.current=!0}),v.useCallback((l,c={})=>{if(vo(i.current,lN),!i.current)return;if(typeof l=="number"){n.go(l);return}let u=sN(l,JSON.parse(s),o,c.relative==="path");t==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:Ns([e,u.pathname])),(c.replace?n.replace:n.push)(u,c.state,c)},[e,n,s,o,t])}v.createContext(null);function uN(){let{matches:t}=v.useContext(ls),e=t[t.length-1];return e?e.params:{}}function ff(t,{relative:e}={}){let{matches:n}=v.useContext(ls),{pathname:r}=Xs(),o=JSON.stringify(oN(n));return v.useMemo(()=>sN(t,JSON.parse(o),r,e==="path"),[t,o,r,e])}function u8(t,e){return dN(t,e)}function dN(t,e,n,r){var k;Ct(hf(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o,static:s}=v.useContext(as),{matches:i}=v.useContext(ls),a=i[i.length-1],l=a?a.params:{},c=a?a.pathname:"/",u=a?a.pathnameBase:"/",d=a&&a.route;{let x=d&&d.path||"";hN(c,!d||x.endsWith("*")||x.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${x}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${x}"> to <Route path="${x==="/"?"*":`${x}/*`}">.`)}let h=Xs(),f;if(e){let x=typeof e=="string"?nu(e):e;Ct(u==="/"||((k=x.pathname)==null?void 0:k.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${x.pathname}" was given in the \`location\` prop.`),f=x}else f=h;let p=f.pathname||"/",y=p;if(u!=="/"){let x=u.replace(/^\//,"").split("/");y="/"+p.replace(/^\//,"").split("/").slice(x.length).join("/")}let b=!s&&n&&n.matches&&n.matches.length>0?n.matches:tN(t,{pathname:y});vo(d||b!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),vo(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=m8(b&&b.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:Ns([u,o.encodeLocation?o.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?u:Ns([u,o.encodeLocation?o.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,n,r);return e&&w?v.createElement(df.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},w):w}function d8(){let t=w8(),e=o8(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},i=null;return console.error("Error handled by React Router default ErrorBoundary:",t),i=v.createElement(v.Fragment,null,v.createElement("p",null,"ðŸ’¿ Hey developer ðŸ‘‹"),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:s},"ErrorBoundary")," or"," ",v.createElement("code",{style:s},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),n?v.createElement("pre",{style:o},n):null,i)}var h8=v.createElement(d8,null),f8=class extends v.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?v.createElement(ls.Provider,{value:this.props.routeContext},v.createElement(gx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function p8({routeContext:t,match:e,children:n}){let r=v.useContext(ru);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),v.createElement(ls.Provider,{value:t},n)}function m8(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,s=n==null?void 0:n.errors;if(s!=null){let l=o.findIndex(c=>c.route.id&&(s==null?void 0:s[c.route.id])!==void 0);Ct(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),o=o.slice(0,Math.min(o.length,l+1))}let i=!1,a=-1;if(n)for(let l=0;l<o.length;l++){let c=o[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=l),c.route.id){let{loaderData:u,errors:d}=n,h=c.route.loader&&!u.hasOwnProperty(c.route.id)&&(!d||d[c.route.id]===void 0);if(c.route.lazy||h){i=!0,a>=0?o=o.slice(0,a+1):o=[o[0]];break}}}return o.reduceRight((l,c,u)=>{let d,h=!1,f=null,p=null;n&&(d=s&&c.route.id?s[c.route.id]:void 0,f=c.route.errorElement||h8,i&&(a<0&&u===0?(hN("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,p=null):a===u&&(h=!0,p=c.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,u+1)),b=()=>{let w;return d?w=f:h?w=p:c.route.Component?w=v.createElement(c.route.Component,null):c.route.element?w=c.route.element:w=l,v.createElement(p8,{match:c,routeContext:{outlet:l,matches:y,isDataRoute:n!=null},children:w})};return n&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?v.createElement(f8,{location:n.location,revalidation:n.revalidation,component:f,error:d,children:b(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):b()},null)}function yx(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function g8(t){let e=v.useContext(ru);return Ct(e,yx(t)),e}function y8(t){let e=v.useContext(Vy);return Ct(e,yx(t)),e}function b8(t){let e=v.useContext(ls);return Ct(e,yx(t)),e}function bx(t){let e=b8(t),n=e.matches[e.matches.length-1];return Ct(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function v8(){return bx("useRouteId")}function w8(){var r;let t=v.useContext(gx),e=y8("useRouteError"),n=bx("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function C8(){let{router:t}=g8("useNavigate"),e=bx("useNavigate"),n=v.useRef(!1);return cN(()=>{n.current=!0}),v.useCallback(async(o,s={})=>{vo(n.current,lN),n.current&&(typeof o=="number"?t.navigate(o):await t.navigate(o,{fromRouteId:e,...s}))},[t,e])}var A_={};function hN(t,e,n){!e&&!A_[t]&&(A_[t]=!0,vo(!1,n))}v.memo(x8);function x8({routes:t,future:e,state:n}){return dN(t,void 0,n,e)}function br(t){Ct(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function k8({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:o,static:s=!1}){Ct(!hf(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=t.replace(/^\/*/,"/"),a=v.useMemo(()=>({basename:i,navigator:o,static:s,future:{}}),[i,o,s]);typeof n=="string"&&(n=nu(n));let{pathname:l="/",search:c="",hash:u="",state:d=null,key:h="default"}=n,f=v.useMemo(()=>{let p=Fs(l,i);return p==null?null:{location:{pathname:p,search:c,hash:u,state:d,key:h},navigationType:r}},[i,l,c,u,d,h,r]);return vo(f!=null,`<Router basename="${i}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),f==null?null:v.createElement(as.Provider,{value:a},v.createElement(df.Provider,{children:e,value:f}))}function S8({children:t,location:e}){return u8(H1(t),e)}function H1(t,e=[]){let n=[];return v.Children.forEach(t,(r,o)=>{if(!v.isValidElement(r))return;let s=[...e,o];if(r.type===v.Fragment){n.push.apply(n,H1(r.props.children,s));return}Ct(r.type===br,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ct(!r.props.index||!r.props.children,"An index route cannot have child routes.");let i={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=H1(r.props.children,s)),n.push(i)}),n}var hm="get",fm="application/x-www-form-urlencoded";function jy(t){return t!=null&&typeof t.tagName=="string"}function E8(t){return jy(t)&&t.tagName.toLowerCase()==="button"}function T8(t){return jy(t)&&t.tagName.toLowerCase()==="form"}function _8(t){return jy(t)&&t.tagName.toLowerCase()==="input"}function A8(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function I8(t,e){return t.button===0&&(!e||e==="_self")&&!A8(t)}function z1(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(o=>[n,o]):[[n,r]])},[]))}function M8(t,e){let n=z1(t);return e&&e.forEach((r,o)=>{n.has(o)||e.getAll(o).forEach(s=>{n.append(o,s)})}),n}var xp=null;function R8(){if(xp===null)try{new FormData(document.createElement("form"),0),xp=!1}catch{xp=!0}return xp}var P8=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function $0(t){return t!=null&&!P8.has(t)?(vo(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${fm}"`),null):t}function D8(t,e){let n,r,o,s,i;if(T8(t)){let a=t.getAttribute("action");r=a?Fs(a,e):null,n=t.getAttribute("method")||hm,o=$0(t.getAttribute("enctype"))||fm,s=new FormData(t)}else if(E8(t)||_8(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?Fs(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||hm,o=$0(t.getAttribute("formenctype"))||$0(a.getAttribute("enctype"))||fm,s=new FormData(a,t),!R8()){let{name:c,type:u,value:d}=t;if(u==="image"){let h=c?`${c}.`:"";s.append(`${h}x`,"0"),s.append(`${h}y`,"0")}else c&&s.append(c,d)}}else{if(jy(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=hm,r=null,o=fm,i=t}return s&&o==="text/plain"&&(i=s,s=void 0),{action:r,method:n.toLowerCase(),encType:o,formData:s,body:i}}function vx(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function N8(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function O8(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function L8(t,e,n){let r=await Promise.all(t.map(async o=>{let s=e.routes[o.route.id];if(s){let i=await N8(s,n);return i.links?i.links():[]}return[]}));return $8(r.flat(1).filter(O8).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function I_(t,e,n,r,o,s){let i=(l,c)=>n[c]?l.route.id!==n[c].route.id:!0,a=(l,c)=>{var u;return n[c].pathname!==l.pathname||((u=n[c].route.path)==null?void 0:u.endsWith("*"))&&n[c].params["*"]!==l.params["*"]};return s==="assets"?e.filter((l,c)=>i(l,c)||a(l,c)):s==="data"?e.filter((l,c)=>{var d;let u=r.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(i(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let h=l.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function V8(t,e,{includeHydrateFallback:n}={}){return j8(t.map(r=>{let o=e.routes[r.route.id];if(!o)return[];let s=[o.module];return o.clientActionModule&&(s=s.concat(o.clientActionModule)),o.clientLoaderModule&&(s=s.concat(o.clientLoaderModule)),n&&o.hydrateFallbackModule&&(s=s.concat(o.hydrateFallbackModule)),o.imports&&(s=s.concat(o.imports)),s}).flat(1))}function j8(t){return[...new Set(t)]}function B8(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function $8(t,e){let n=new Set;return new Set(e),t.reduce((r,o)=>{let s=JSON.stringify(B8(o));return n.has(s)||(n.add(s),r.push({key:s,link:o})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var F8=new Set([100,101,204,205]);function H8(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&Fs(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function fN(){let t=v.useContext(ru);return vx(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function z8(){let t=v.useContext(Vy);return vx(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var wx=v.createContext(void 0);wx.displayName="FrameworkContext";function pN(){let t=v.useContext(wx);return vx(t,"You must render this element inside a <HydratedRouter> element"),t}function U8(t,e){let n=v.useContext(wx),[r,o]=v.useState(!1),[s,i]=v.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=e,h=v.useRef(null);v.useEffect(()=>{if(t==="render"&&i(!0),t==="viewport"){let y=w=>{w.forEach(k=>{i(k.isIntersecting)})},b=new IntersectionObserver(y,{threshold:.5});return h.current&&b.observe(h.current),()=>{b.disconnect()}}},[t]),v.useEffect(()=>{if(r){let y=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(y)}}},[r]);let f=()=>{o(!0)},p=()=>{o(!1),i(!1)};return n?t!=="intent"?[s,h,{}]:[s,h,{onFocus:Wu(a,f),onBlur:Wu(l,p),onMouseEnter:Wu(c,f),onMouseLeave:Wu(u,p),onTouchStart:Wu(d,f)}]:[!1,h,{}]}function Wu(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function W8({page:t,...e}){let{router:n}=fN(),r=v.useMemo(()=>tN(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?v.createElement(G8,{page:t,matches:r,...e}):null}function q8(t){let{manifest:e,routeModules:n}=pN(),[r,o]=v.useState([]);return v.useEffect(()=>{let s=!1;return L8(t,e,n).then(i=>{s||o(i)}),()=>{s=!0}},[t,e,n]),r}function G8({page:t,matches:e,...n}){let r=Xs(),{manifest:o,routeModules:s}=pN(),{basename:i}=fN(),{loaderData:a,matches:l}=z8(),c=v.useMemo(()=>I_(t,e,l,o,r,"data"),[t,e,l,o,r]),u=v.useMemo(()=>I_(t,e,l,o,r,"assets"),[t,e,l,o,r]),d=v.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let p=new Set,y=!1;if(e.forEach(w=>{var x;let k=o.routes[w.route.id];!k||!k.hasLoader||(!c.some(A=>A.route.id===w.route.id)&&w.route.id in a&&((x=s[w.route.id])!=null&&x.shouldRevalidate)||k.hasClientLoader?y=!0:p.add(w.route.id))}),p.size===0)return[];let b=H8(t,i);return y&&p.size>0&&b.searchParams.set("_routes",e.filter(w=>p.has(w.route.id)).map(w=>w.route.id).join(",")),[b.pathname+b.search]},[i,a,r,o,c,e,t,s]),h=v.useMemo(()=>V8(u,o),[u,o]),f=q8(u);return v.createElement(v.Fragment,null,d.map(p=>v.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...n})),h.map(p=>v.createElement("link",{key:p,rel:"modulepreload",href:p,...n})),f.map(({key:p,link:y})=>v.createElement("link",{key:p,...y})))}function K8(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var mN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{mN&&(window.__reactRouterVersion="7.6.0")}catch{}function Y8({basename:t,children:e,window:n}){let r=v.useRef();r.current==null&&(r.current=O$({window:n,v5Compat:!0}));let o=r.current,[s,i]=v.useState({action:o.action,location:o.location}),a=v.useCallback(l=>{v.startTransition(()=>i(l))},[i]);return v.useLayoutEffect(()=>o.listen(a),[o,a]),v.createElement(k8,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:o})}var gN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yN=v.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:o,reloadDocument:s,replace:i,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d,...h},f){let{basename:p}=v.useContext(as),y=typeof c=="string"&&gN.test(c),b,w=!1;if(typeof c=="string"&&y&&(b=c,mN))try{let _=new URL(window.location.href),R=c.startsWith("//")?new URL(_.protocol+c):new URL(c),D=Fs(R.pathname,p);R.origin===_.origin&&D!=null?c=D+R.search+R.hash:w=!0}catch{vo(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let k=l8(c,{relative:o}),[x,A,I]=U8(r,h),M=Z8(c,{replace:i,state:a,target:l,preventScrollReset:u,relative:o,viewTransition:d});function T(_){e&&e(_),_.defaultPrevented||M(_)}let S=v.createElement("a",{...h,...I,href:b||k,onClick:w||s?e:T,ref:K8(f,A),target:l,"data-discover":!y&&n==="render"?"true":void 0});return x&&!y?v.createElement(v.Fragment,null,S,v.createElement(W8,{page:k})):S});yN.displayName="Link";var X8=v.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:o=!1,style:s,to:i,viewTransition:a,children:l,...c},u){let d=ff(i,{relative:c.relative}),h=Xs(),f=v.useContext(Vy),{navigator:p,basename:y}=v.useContext(as),b=f!=null&&oF(d)&&a===!0,w=p.encodeLocation?p.encodeLocation(d).pathname:d.pathname,k=h.pathname,x=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;n||(k=k.toLowerCase(),x=x?x.toLowerCase():null,w=w.toLowerCase()),x&&y&&(x=Fs(x,y)||x);const A=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let I=k===w||!o&&k.startsWith(w)&&k.charAt(A)==="/",M=x!=null&&(x===w||!o&&x.startsWith(w)&&x.charAt(w.length)==="/"),T={isActive:I,isPending:M,isTransitioning:b},S=I?e:void 0,_;typeof r=="function"?_=r(T):_=[r,I?"active":null,M?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let R=typeof s=="function"?s(T):s;return v.createElement(yN,{...c,"aria-current":S,className:_,ref:u,style:R,to:i,viewTransition:a},typeof l=="function"?l(T):l)});X8.displayName="NavLink";var J8=v.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:o,state:s,method:i=hm,action:a,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:d,...h},f)=>{let p=nF(),y=rF(a,{relative:c}),b=i.toLowerCase()==="get"?"get":"post",w=typeof a=="string"&&gN.test(a),k=x=>{if(l&&l(x),x.defaultPrevented)return;x.preventDefault();let A=x.nativeEvent.submitter,I=(A==null?void 0:A.getAttribute("formmethod"))||i;p(A||x.currentTarget,{fetcherKey:e,method:I,navigate:n,replace:o,state:s,relative:c,preventScrollReset:u,viewTransition:d})};return v.createElement("form",{ref:f,method:b,action:y,onSubmit:r?l:k,...h,"data-discover":!w&&t==="render"?"true":void 0})});J8.displayName="Form";function Q8(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function bN(t){let e=v.useContext(ru);return Ct(e,Q8(t)),e}function Z8(t,{target:e,replace:n,state:r,preventScrollReset:o,relative:s,viewTransition:i}={}){let a=Ao(),l=Xs(),c=ff(t,{relative:s});return v.useCallback(u=>{if(I8(u,e)){u.preventDefault();let d=n!==void 0?n:oh(l)===oh(c);a(t,{replace:d,state:r,preventScrollReset:o,relative:s,viewTransition:i})}},[l,a,c,n,r,e,t,o,s,i])}function vN(t){vo(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=v.useRef(z1(t)),n=v.useRef(!1),r=Xs(),o=v.useMemo(()=>M8(r.search,n.current?null:e.current),[r.search]),s=Ao(),i=v.useCallback((a,l)=>{const c=z1(typeof a=="function"?a(o):a);n.current=!0,s("?"+c,l)},[s,o]);return[o,i]}var eF=0,tF=()=>`__${String(++eF)}__`;function nF(){let{router:t}=bN("useSubmit"),{basename:e}=v.useContext(as),n=v8();return v.useCallback(async(r,o={})=>{let{action:s,method:i,encType:a,formData:l,body:c}=D8(r,e);if(o.navigate===!1){let u=o.fetcherKey||tF();await t.fetch(u,n,o.action||s,{preventScrollReset:o.preventScrollReset,formData:l,body:c,formMethod:o.method||i,formEncType:o.encType||a,flushSync:o.flushSync})}else await t.navigate(o.action||s,{preventScrollReset:o.preventScrollReset,formData:l,body:c,formMethod:o.method||i,formEncType:o.encType||a,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[t,e,n])}function rF(t,{relative:e}={}){let{basename:n}=v.useContext(as),r=v.useContext(ls);Ct(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),s={...ff(t||".",{relative:e})},i=Xs();if(t==null){s.search=i.search;let a=new URLSearchParams(s.search),l=a.getAll("index");if(l.some(u=>u==="")){a.delete("index"),l.filter(d=>d).forEach(d=>a.append("index",d));let u=a.toString();s.search=u?`?${u}`:""}}return(!t||t===".")&&o.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(s.pathname=s.pathname==="/"?n:Ns([n,s.pathname])),oh(s)}function oF(t,e={}){let n=v.useContext(aN);Ct(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=bN("useViewTransitionState"),o=ff(t,{relative:e.relative});if(!n.isTransitioning)return!1;let s=Fs(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=Fs(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Um(o.pathname,i)!=null||Um(o.pathname,s)!=null}[...F8];const sF="_icon_1vtik_1",pf={icon:sF};function iF({className:t,...e}){return m.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",className:be(pf.icon,t),...e,children:m.jsx("g",{children:m.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.855 15.67C12.995 15.31 12.9049 14.9 12.625 14.62L10.5349 12.56L10.5649 12.53C12.3049 10.59 13.5449 8.35999 14.2749 6H16.215C16.755 6 17.205 5.54999 17.205 5.01001V4.98999C17.205 4.45001 16.755 4 16.215 4H10.205V3C10.205 2.45001 9.755 2 9.20496 2C8.65491 2 8.20496 2.45001 8.20496 3V4H2.19495C1.65491 4 1.20496 4.45001 1.20496 4.98999C1.20496 5.53998 1.65491 5.97998 2.19495 5.97998H12.375C11.705 7.91998 10.6449 9.75 9.20496 11.35C8.3949 10.46 7.71497 9.48999 7.1449 8.46997C6.98499 8.17999 6.69495 8 6.36499 8C5.67493 8 5.23499 8.75 5.57495 9.34998C6.20496 10.48 6.97498 11.56 7.875 12.56L3.505 16.87C3.10498 17.26 3.10498 17.9 3.505 18.29C3.8949 18.68 4.5249 18.68 4.92493 18.29L9.20496 14L11.225 16.02C11.735 16.53 12.605 16.34 12.855 15.67ZM17.705 10C17.105 10 16.5649 10.37 16.355 10.94L12.6849 20.74C12.4449 21.35 12.9049 22 13.5549 22C13.9449 22 14.2949 21.76 14.4349 21.39L15.325 19H20.075L20.975 21.39C21.1149 21.75 21.465 22 21.855 22C22.5049 22 22.965 21.35 22.7349 20.74L19.0649 10.94C18.845 10.37 18.3049 10 17.705 10ZM17.705 12.67L16.085 17H19.325L17.705 12.67Z",fillOpacity:"0.54"})})})}const aF="_primary_pdmgw_6",lF="_noMargin_pdmgw_10",F0={default:"_default_pdmgw_1",primary:aF,noMargin:lF};function cF({level:t,children:e,primary:n,noMargin:r,className:o,onClick:s}){const i=[F0.default,n&&F0.primary,r&&F0.noMargin,o];switch(t){case 1:return m.jsx("h1",{onClick:s,className:be(...i),children:e});case 2:return m.jsx("h2",{onClick:s,className:be(...i),children:e});case 3:return m.jsx("h3",{onClick:s,className:be(...i),children:e});case 4:return m.jsx("h4",{onClick:s,className:be(...i),children:e});default:return m.jsx("h5",{onClick:s,className:be(...i),children:e})}}const uF="_description_11sgl_6",dF="_noMargin_11sgl_12",hF="_underline_11sgl_16",fF="_bold_11sgl_20",Ai={default:"_default_11sgl_1",description:uF,noMargin:dF,underline:hF,bold:fF};function pF({children:t,isDescription:e,underline:n,className:r,...o}){return m.jsx("span",{className:be(Ai.default,e&&Ai.description,n&&Ai.underline,r),...o,children:t})}function mF({children:t,isDescription:e,noMargin:n,underline:r,bold:o,className:s}){return m.jsx("p",{className:be(Ai.default,e&&Ai.description,n&&Ai.noMargin,r&&Ai.underline,o&&Ai.bold,s),children:t})}const me={Title:cF,Paragraph:mF,Text:pF},gF="_container_bm79w_2",yF="_body_bm79w_13",M_={container:gF,body:yF};function bF({className:t,title:e,logo:n,description:r,rightComponent:o,onClick:s}){return m.jsxs("div",{className:be(M_.container,t),onClick:s,children:[n,m.jsxs("div",{className:M_.body,children:[m.jsx(me.Paragraph,{bold:!0,noMargin:!0,children:e}),m.jsx(me.Paragraph,{noMargin:!0,isDescription:!0,children:r})]}),o]})}const Ft={ItemMeta:bF},vF="_ghost_p15d2_12",wF="_sm_p15d2_20",CF="_lg_p15d2_25",xF="_md_p15d2_30",kF="_dash_p15d2_35",SF="_block_p15d2_41",EF="_disabled_p15d2_46",fi={default:"_default_p15d2_1",ghost:vF,sm:wF,lg:CF,md:xF,dash:kF,block:SF,disabled:EF};function Gt({onClick:t,disabled:e,children:n,type:r,className:o,block:s,size:i,...a}){return m.jsx("button",{onClick:t,className:be(fi.default,r==="ghost"&&fi.ghost,r==="dash"&&fi.dash,s&&fi.block,i==="sm"&&fi.sm,i==="lg"&&fi.lg,i==="md"&&fi.md,e&&fi.disabled,o),disabled:e,...a,children:n})}const TF="_button_aap0f_1",_F="_firstButton_aap0f_5",AF="_lastButton_aap0f_10",IF="_middleButton_aap0f_14",MF="_active_aap0f_18",RF="_leftActiveBorder_aap0f_24",PF="_rightActiveBorder_aap0f_28",DF="_rightActiveAndLastBorder_aap0f_32",pi={button:TF,firstButton:_F,lastButton:AF,middleButton:IF,active:MF,leftActiveBorder:RF,rightActiveBorder:PF,rightActiveAndLastBorder:DF};function U1({isButton:t,options:e,value:n,onChangeValue:r,classNameOption:o,getClassNameActiveOption:s=()=>""}){return t?m.jsx(m.Fragment,{children:e.map(({label:i,value:a},l)=>{const c=l>e.length-1&&e[l+1].value===n,u=l>0&&e[l-1].value===n;return m.jsx(Gt,{type:"ghost",size:"md",onClick:()=>r&&r(a),className:be(pi.button,l===0&&pi.firstButton,l===e.length-1&&pi.lastButton,l!==e.length-1&&l!==0&&pi.middleButton,a===n&&pi.active,a===n&&c&&pi.leftActiveBorder,u&&pi.rightActiveBorder,u&&l===e.length-1&&pi.rightActiveAndLastBorder,o,a===n&&s({label:i,value:a})),children:i},`${n}-${l}`)})}):null}function NF({className:t,...e}){return m.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",className:be(pf.icon,t),...e,children:m.jsx("g",{id:"color_lens_24px",children:m.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12 3C7.03003 3 3 7.03 3 12C3 16.97 7.03003 21 12 21C12.83 21 13.5 20.33 13.5 19.5C13.5 19.11 13.35 18.76 13.11 18.49C12.88 18.23 12.73 17.88 12.73 17.5C12.73 16.67 13.4 16 14.23 16H16C18.76 16 21 13.76 21 11C21 6.57999 16.97 3 12 3ZM6.5 12C5.66998 12 5 11.33 5 10.5C5 9.67001 5.66998 9 6.5 9C7.33002 9 8 9.67001 8 10.5C8 11.33 7.33002 12 6.5 12ZM8 6.5C8 7.32999 8.66998 8 9.5 8C10.33 8 11 7.32999 11 6.5C11 5.67001 10.33 5 9.5 5C8.66998 5 8 5.67001 8 6.5ZM14.5 8C13.67 8 13 7.32999 13 6.5C13 5.67001 13.67 5 14.5 5C15.33 5 16 5.67001 16 6.5C16 7.32999 15.33 8 14.5 8ZM16 10.5C16 11.33 16.67 12 17.5 12C18.33 12 19 11.33 19 10.5C19 9.67001 18.33 9 17.5 9C16.67 9 16 9.67001 16 10.5Z","fill-opacity":"0.54"})})})}var sh=(t=>(t.Vi="vi",t.En="en",t))(sh||{});const R_=t=>{let e;const n=new Set,r=(c,u)=>{const d=typeof c=="function"?c(e):c;if(!Object.is(d,e)){const h=e;e=u??(typeof d!="object"||d===null)?d:Object.assign({},e,d),n.forEach(f=>f(e,h))}},o=()=>e,a={setState:r,getState:o,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=e=t(r,o,a);return a},OF=t=>t?R_(t):R_,LF=t=>t;function VF(t,e=LF){const n=$.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return $.useDebugValue(n),n}const P_=t=>{const e=OF(t),n=r=>VF(e,r);return Object.assign(n,e),n},By=t=>t?P_(t):P_,H0=new Map;function Yr(t,e,{storeOnMount:n}={}){if(!H0.has(t)){const i=By(a=>({storedValue:(()=>{if(typeof window>"u")return e;try{const l=window.localStorage.getItem(t);return n&&!l&&e&&window.localStorage.setItem(t,JSON.stringify(e)),l?JSON.parse(l):e}catch(l){return console.log(l),e}})(),setValue:l=>{a(c=>{const u=l instanceof Function?l(c.storedValue):l;try{window.localStorage.setItem(t,JSON.stringify(u))}catch(d){console.log(d)}return{storedValue:u}})}}));H0.set(t,i)}const r=H0.get(t),{storedValue:o,setValue:s}=r();return[o,s]}var D_,N_;(function(t){t.CANCELED_BY_MOVEMENT="canceled-by-movement",t.CANCELED_BY_TIMEOUT="canceled-by-timeout"})(D_||(D_={})),function(t){t.BOTH="both",t.MOUSE="mouse",t.TOUCH="touch"}(N_||(N_={}));const wN=6048e5,jF=864e5,O_=Symbol.for("constructDateFrom");function Xo(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&O_ in t?t[O_](e):t instanceof Date?new t.constructor(e):new Date(e)}function xn(t,e){return Xo(e||t,t)}let BF={};function $y(){return BF}function ih(t,e){var a,l,c,u;const n=$y(),r=(e==null?void 0:e.weekStartsOn)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,o=xn(t,e==null?void 0:e.in),s=o.getDay(),i=(s<r?7:0)+s-r;return o.setDate(o.getDate()-i),o.setHours(0,0,0,0),o}function Wm(t,e){return ih(t,{...e,weekStartsOn:1})}function CN(t,e){const n=xn(t,e==null?void 0:e.in),r=n.getFullYear(),o=Xo(n,0);o.setFullYear(r+1,0,4),o.setHours(0,0,0,0);const s=Wm(o),i=Xo(n,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const a=Wm(i);return n.getTime()>=s.getTime()?r+1:n.getTime()>=a.getTime()?r:r-1}function L_(t){const e=xn(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function xN(t,...e){const n=Xo.bind(null,e.find(r=>typeof r=="object"));return e.map(n)}function qm(t,e){const n=xn(t,e==null?void 0:e.in);return n.setHours(0,0,0,0),n}function $F(t,e,n){const[r,o]=xN(n==null?void 0:n.in,t,e),s=qm(r),i=qm(o),a=+s-L_(s),l=+i-L_(i);return Math.round((a-l)/jF)}function FF(t,e){const n=CN(t,e),r=Xo(t,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),Wm(r)}function HF(t){return Xo(t,Date.now())}function zF(t,e,n){const[r,o]=xN(n==null?void 0:n.in,t,e);return+qm(r)==+qm(o)}function UF(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function WF(t){return!(!UF(t)&&typeof t!="number"||isNaN(+xn(t)))}function kN(t,e){const n=xn(t,e==null?void 0:e.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function SN(t,e){const n=xn(t,e==null?void 0:e.in);return n.setDate(1),n.setHours(0,0,0,0),n}function qF(t,e){const n=xn(t,e==null?void 0:e.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const GF={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},KF=(t,e,n)=>{let r;const o=GF[t];return typeof o=="string"?r=o:e===1?r=o.one:r=o.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function z0(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const YF={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},XF={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},JF={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},QF={date:z0({formats:YF,defaultWidth:"full"}),time:z0({formats:XF,defaultWidth:"full"}),dateTime:z0({formats:JF,defaultWidth:"full"})},ZF={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},eH=(t,e,n,r)=>ZF[t];function qu(t){return(e,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let o;if(r==="formatting"&&t.formattingValues){const i=t.defaultFormattingWidth||t.defaultWidth,a=n!=null&&n.width?String(n.width):i;o=t.formattingValues[a]||t.formattingValues[i]}else{const i=t.defaultWidth,a=n!=null&&n.width?String(n.width):t.defaultWidth;o=t.values[a]||t.values[i]}const s=t.argumentCallback?t.argumentCallback(e):e;return o[s]}}const tH={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},nH={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},rH={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},oH={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},sH={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},iH={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},aH=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},lH={ordinalNumber:aH,era:qu({values:tH,defaultWidth:"wide"}),quarter:qu({values:nH,defaultWidth:"wide",argumentCallback:t=>t-1}),month:qu({values:rH,defaultWidth:"wide"}),day:qu({values:oH,defaultWidth:"wide"}),dayPeriod:qu({values:sH,defaultWidth:"wide",formattingValues:iH,defaultFormattingWidth:"wide"})};function Gu(t){return(e,n={})=>{const r=n.width,o=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],s=e.match(o);if(!s)return null;const i=s[0],a=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?uH(a,d=>d.test(i)):cH(a,d=>d.test(i));let c;c=t.valueCallback?t.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=e.slice(i.length);return{value:c,rest:u}}}function cH(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function uH(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function dH(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const o=r[0],s=e.match(t.parsePattern);if(!s)return null;let i=t.valueCallback?t.valueCallback(s[0]):s[0];i=n.valueCallback?n.valueCallback(i):i;const a=e.slice(o.length);return{value:i,rest:a}}}const hH=/^(\d+)(th|st|nd|rd)?/i,fH=/\d+/i,pH={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},mH={any:[/^b/i,/^(a|c)/i]},gH={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},yH={any:[/1/i,/2/i,/3/i,/4/i]},bH={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},vH={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},wH={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},CH={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},xH={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},kH={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},SH={ordinalNumber:dH({matchPattern:hH,parsePattern:fH,valueCallback:t=>parseInt(t,10)}),era:Gu({matchPatterns:pH,defaultMatchWidth:"wide",parsePatterns:mH,defaultParseWidth:"any"}),quarter:Gu({matchPatterns:gH,defaultMatchWidth:"wide",parsePatterns:yH,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Gu({matchPatterns:bH,defaultMatchWidth:"wide",parsePatterns:vH,defaultParseWidth:"any"}),day:Gu({matchPatterns:wH,defaultMatchWidth:"wide",parsePatterns:CH,defaultParseWidth:"any"}),dayPeriod:Gu({matchPatterns:xH,defaultMatchWidth:"any",parsePatterns:kH,defaultParseWidth:"any"})},EH={code:"en-US",formatDistance:KF,formatLong:QF,formatRelative:eH,localize:lH,match:SH,options:{weekStartsOn:0,firstWeekContainsDate:1}};function TH(t,e){const n=xn(t,e==null?void 0:e.in);return $F(n,qF(n))+1}function _H(t,e){const n=xn(t,e==null?void 0:e.in),r=+Wm(n)-+FF(n);return Math.round(r/wN)+1}function EN(t,e){var u,d,h,f;const n=xn(t,e==null?void 0:e.in),r=n.getFullYear(),o=$y(),s=(e==null?void 0:e.firstWeekContainsDate)??((d=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??o.firstWeekContainsDate??((f=(h=o.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??1,i=Xo((e==null?void 0:e.in)||t,0);i.setFullYear(r+1,0,s),i.setHours(0,0,0,0);const a=ih(i,e),l=Xo((e==null?void 0:e.in)||t,0);l.setFullYear(r,0,s),l.setHours(0,0,0,0);const c=ih(l,e);return+n>=+a?r+1:+n>=+c?r:r-1}function AH(t,e){var a,l,c,u;const n=$y(),r=(e==null?void 0:e.firstWeekContainsDate)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,o=EN(t,e),s=Xo((e==null?void 0:e.in)||t,0);return s.setFullYear(o,0,r),s.setHours(0,0,0,0),ih(s,e)}function IH(t,e){const n=xn(t,e==null?void 0:e.in),r=+ih(n,e)-+AH(n,e);return Math.round(r/wN)+1}function Je(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const mi={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return Je(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):Je(n+1,2)},d(t,e){return Je(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return Je(t.getHours()%12||12,e.length)},H(t,e){return Je(t.getHours(),e.length)},m(t,e){return Je(t.getMinutes(),e.length)},s(t,e){return Je(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),o=Math.trunc(r*Math.pow(10,n-3));return Je(o,e.length)}},Wl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},V_={G:function(t,e,n){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const r=t.getFullYear(),o=r>0?r:1-r;return n.ordinalNumber(o,{unit:"year"})}return mi.y(t,e)},Y:function(t,e,n,r){const o=EN(t,r),s=o>0?o:1-o;if(e==="YY"){const i=s%100;return Je(i,2)}return e==="Yo"?n.ordinalNumber(s,{unit:"year"}):Je(s,e.length)},R:function(t,e){const n=CN(t);return Je(n,e.length)},u:function(t,e){const n=t.getFullYear();return Je(n,e.length)},Q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return Je(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return Je(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,n){const r=t.getMonth();switch(e){case"M":case"MM":return mi.M(t,e);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,n){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return Je(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,n,r){const o=IH(t,r);return e==="wo"?n.ordinalNumber(o,{unit:"week"}):Je(o,e.length)},I:function(t,e,n){const r=_H(t);return e==="Io"?n.ordinalNumber(r,{unit:"week"}):Je(r,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):mi.d(t,e)},D:function(t,e,n){const r=TH(t);return e==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):Je(r,e.length)},E:function(t,e,n){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,n,r){const o=t.getDay(),s=(o-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return Je(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(o,{width:"short",context:"formatting"});case"eeee":default:return n.day(o,{width:"wide",context:"formatting"})}},c:function(t,e,n,r){const o=t.getDay(),s=(o-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return Je(s,e.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(o,{width:"narrow",context:"standalone"});case"cccccc":return n.day(o,{width:"short",context:"standalone"});case"cccc":default:return n.day(o,{width:"wide",context:"standalone"})}},i:function(t,e,n){const r=t.getDay(),o=r===0?7:r;switch(e){case"i":return String(o);case"ii":return Je(o,e.length);case"io":return n.ordinalNumber(o,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,n){const o=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(t,e,n){const r=t.getHours();let o;switch(r===12?o=Wl.noon:r===0?o=Wl.midnight:o=r/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(t,e,n){const r=t.getHours();let o;switch(r>=17?o=Wl.evening:r>=12?o=Wl.afternoon:r>=4?o=Wl.morning:o=Wl.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return mi.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):mi.H(t,e)},K:function(t,e,n){const r=t.getHours()%12;return e==="Ko"?n.ordinalNumber(r,{unit:"hour"}):Je(r,e.length)},k:function(t,e,n){let r=t.getHours();return r===0&&(r=24),e==="ko"?n.ordinalNumber(r,{unit:"hour"}):Je(r,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):mi.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):mi.s(t,e)},S:function(t,e){return mi.S(t,e)},X:function(t,e,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return B_(r);case"XXXX":case"XX":return Fa(r);case"XXXXX":case"XXX":default:return Fa(r,":")}},x:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"x":return B_(r);case"xxxx":case"xx":return Fa(r);case"xxxxx":case"xxx":default:return Fa(r,":")}},O:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+j_(r,":");case"OOOO":default:return"GMT"+Fa(r,":")}},z:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+j_(r,":");case"zzzz":default:return"GMT"+Fa(r,":")}},t:function(t,e,n){const r=Math.trunc(+t/1e3);return Je(r,e.length)},T:function(t,e,n){return Je(+t,e.length)}};function j_(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),o=Math.trunc(r/60),s=r%60;return s===0?n+String(o):n+String(o)+e+Je(s,2)}function B_(t,e){return t%60===0?(t>0?"-":"+")+Je(Math.abs(t)/60,2):Fa(t,e)}function Fa(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),o=Je(Math.trunc(r/60),2),s=Je(r%60,2);return n+o+e+s}const $_=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},TN=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},MH=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],o=n[2];if(!o)return $_(t,e);let s;switch(r){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",$_(r,e)).replace("{{time}}",TN(o,e))},RH={p:TN,P:MH},PH=/^D+$/,DH=/^Y+$/,NH=["D","DD","YY","YYYY"];function OH(t){return PH.test(t)}function LH(t){return DH.test(t)}function VH(t,e,n){const r=jH(t,e,n);if(console.warn(r),NH.includes(t))throw new RangeError(r)}function jH(t,e,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const BH=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,$H=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,FH=/^'([^]*?)'?$/,HH=/''/g,zH=/[a-zA-Z]/;function UH(t,e,n){var u,d,h,f;const r=$y(),o=r.locale??EH,s=r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,i=r.weekStartsOn??((f=(h=r.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)??0,a=xn(t,n==null?void 0:n.in);if(!WF(a))throw new RangeError("Invalid time value");let l=e.match($H).map(p=>{const y=p[0];if(y==="p"||y==="P"){const b=RH[y];return b(p,o.formatLong)}return p}).join("").match(BH).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const y=p[0];if(y==="'")return{isToken:!1,value:WH(p)};if(V_[y])return{isToken:!0,value:p};if(y.match(zH))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:p}});o.localize.preprocessor&&(l=o.localize.preprocessor(a,l));const c={firstWeekContainsDate:s,weekStartsOn:i,locale:o};return l.map(p=>{if(!p.isToken)return p.value;const y=p.value;(LH(y)||OH(y))&&VH(y,e,String(t));const b=V_[y[0]];return b(a,y,o.localize,c)}).join("")}function WH(t){const e=t.match(FH);return e?e[1].replace(HH,"'"):t}function qH(t,e){return zF(Xo(t,t),HF(t))}function GH(t,e,n){const r=xn(t,n==null?void 0:n.in);return r.setHours(e),r}function KH(t,e,n){const r=xn(t,n==null?void 0:n.in);return r.setMilliseconds(e),r}function YH(t,e,n){const r=xn(t,n==null?void 0:n.in);return r.setMinutes(e),r}function XH(t,e,n){const r=xn(t,n==null?void 0:n.in);return r.setSeconds(e),r}const JH="baby",QH=()=>{const[t,e]=Yr(JH,{});return{baby:t,setBaby:e,calculateStartDateFromDueDate:r=>new Date(new Date(r).getTime()-24192e6).toISOString()}};var ln=[];for(var U0=0;U0<256;++U0)ln.push((U0+256).toString(16).slice(1));function ZH(t,e=0){return(ln[t[e+0]]+ln[t[e+1]]+ln[t[e+2]]+ln[t[e+3]]+"-"+ln[t[e+4]]+ln[t[e+5]]+"-"+ln[t[e+6]]+ln[t[e+7]]+"-"+ln[t[e+8]]+ln[t[e+9]]+"-"+ln[t[e+10]]+ln[t[e+11]]+ln[t[e+12]]+ln[t[e+13]]+ln[t[e+14]]+ln[t[e+15]]).toLowerCase()}var kp,ez=new Uint8Array(16);function tz(){if(!kp&&(kp=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!kp))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return kp(ez)}var nz=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const F_={randomUUID:nz};function qn(t,e,n){if(F_.randomUUID&&!t)return F_.randomUUID();t=t||{};var r=t.random||(t.rng||tz)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,ZH(r)}const rz="checklist_template",oz="selected_checklist_templates",Oa={repeat:{minute:"0",hour:"8",dayOfMonth:"*",month:"*",dayOfWeek:"*",startedAt:new Date().toISOString()},createdAt:new Date().toISOString(),records:[],fieldGroups:[]},sz=[{id:qn(),title:"Drink water",...Oa,avatar:{type:"icon",name:"mdi:water",color:"#00aaff"}},{id:qn(),title:"Drink Orange juice",...Oa,avatar:{type:"icon",name:"noto-v1:tropical-drink",color:"#ff9900"}},{id:qn(),title:"Take vitamin supplement",...Oa,avatar:{type:"icon",name:"game-icons:medicines",color:"#00ff00"}},{id:qn(),title:"Eat fruits(banana, seeds) and vegetables",...Oa,avatar:{type:"icon",name:"twemoji:pot-of-food",color:"#00aaff"}},{id:qn(),title:"Exercise",...Oa,avatar:{type:"icon",name:"healthicons:exercise-yoga-outline"}},{id:qn(),title:"Sleep early",...Oa,avatar:{type:"icon",name:"fxemoji:sleeping"}},{id:qn(),title:"Drink milk",...Oa,avatar:{type:"icon",name:"icon-park-outline:milk",color:"#ff9900"}}],iz=sz.reduce((t,e)=>({...t,[e.id]:e}),{}),Xi=()=>{const[t,e]=Yr(rz,iz,{storeOnMount:!0}),[n,r]=Yr(oz,[]),o=d=>{const h=qn();return e({...t,[h]:{...d,id:h,createdAt:new Date().toISOString()}}),a([...n,h]),{id:h}},s=d=>{var h;e({...t,[d.id]:{...d,createdAt:((h=t[d.id])==null?void 0:h.createdAt)||new Date().toISOString()}})},i=d=>{const h={...t};delete h[d],e(h),n.includes(d)&&a(n.filter(f=>f!==d))},a=(d=[])=>{r(d)};return{checklistTemplate:t,getChecklistTemplate:d=>t[d],addChecklistTemplate:o,updateChecklistTemplate:s,deleteChecklistTemplate:i,selectedChecklistTemplates:n,updateSelectedChecklistTemplate:a,getRecommendChecklistTemplates:()=>Object.values(t),getChecklistTemplateIdsByGivingDate:({date:d}={date:new Date})=>n.filter(h=>{var p,y;const f=t[h];return((p=f==null?void 0:f.repeat)==null?void 0:p.dayOfWeek.split(",").includes(d.getDay().toString()))||((y=f==null?void 0:f.repeat)==null?void 0:y.dayOfWeek)==="*"})}},az="checklist",Fy=()=>{const[t,e]=Yr(az,{}),{getChecklistTemplateIdsByGivingDate:n,checklistTemplate:r}=Xi(),[o,s]=$.useState([]),[i,a]=$.useState({}),l=({date:p}={date:new Date})=>{const y=Object.values(t).filter(k=>new Date(k.startedAt).toLocaleDateString()===p.toLocaleDateString()),w=n({date:p}).map(k=>{const x=y.find(A=>A.checklistTemplateId===k);return x||{id:qn(),clientOnly:!0,title:r[k].title,checklistTemplateId:k,startedAt:new Date(p).toISOString(),endedAt:new Date(new Date().setHours(23,59,59,999)).toISOString()}});return{checklistIds:w.map(k=>k.id),checklist:w.reduce((k,x)=>({...k,[x.id]:x}),{})}},c=p=>{e({...t,[p.id]:{...t[p.id],...p}})},u=p=>{const y=qn(),b={...p,id:y};return e({...t,[y]:b}),b},d=({date:p})=>{const{checklistIds:y,checklist:b}=l({date:p});s(y),a(b)},h=p=>Object.values(t).filter(y=>y.checklistTemplateId===p).sort((y,b)=>new Date(y.startedAt)-new Date(b.startedAt)),f=p=>t[p];return{updateChecklist:c,getChecklistByGivingDate:d,getAllChecklistWithTemplate:h,allChecklist:{...i,...t},addChecklist:u,checklistByGivingDateIds:o,getChecklistDetail:f}},lz="body_metric",cz=By(t=>({chartData:{},setChartData:e=>t({chartData:e})})),uz=By(t=>({currentDay:new Date,setCurrentDay:e=>t({currentDay:e}),currentBodyMetric:void 0,setCurrentBodyMetric:e=>t({currentBodyMetric:e})})),Cx=()=>{const[t,e]=Yr(lz,{}),{chartData:n,setChartData:r}=cz(),{currentBodyMetric:o,setCurrentBodyMetric:s,currentDay:i,setCurrentDay:a}=uz(),l=(h=t)=>{const f=Object.values(h).sort((w,k)=>new Date(w.createdAt).getTime()-new Date(k.createdAt).getTime()),p=f.map(w=>new Date(w.createdAt).toLocaleDateString()),y=f.map(w=>w.weight),b=f.map(w=>w.bellySize);return{categories:p,weights:y,bellySizes:b}},c=h=>{const f=l(h);r(f)},u=h=>{const f=Object.values(t).find(b=>new Date(b.createdAt).toLocaleDateString()===new Date(h.createdAt).toLocaleDateString());let p,y=(f==null?void 0:f.id)||"";f?p={...t,[f.id]:{...f,...h}}:(y=qn(),p={...t,[y]:{...h,id:y}}),e(p),c(p),s(p[y])},d=({date:h})=>{const f=Object.values(t).find(p=>new Date(p.createdAt).toLocaleDateString()===h.toLocaleDateString());return s(f),a(h),f};return $.useEffect(()=>{d({date:new Date})},[]),{addBodyMetric:u,getChartData:l,chartData:n,updateChartDate:c,setChartData:r,currentBodyMetric:o,updateCurrentBodyMetric:d,currentDay:i}};var pl=(t=>(t.Light="light",t.Dark="dark",t))(pl||{});const _N=$.createContext({pomodoro:0,setPomodoro:()=>{},shortBreak:0,setShortBreak:()=>{},longBreak:0,setLongBreak:()=>{},theme:pl.Light,setTheme:()=>{}});var AN=(t=>(t[t.Pomodoro=0]="Pomodoro",t[t.ShortBreak=1]="ShortBreak",t[t.LongBreak=2]="LongBreak",t))(AN||{});const W0={time:0,isPlaying:!1,pause:()=>{},start:()=>{},stop:()=>{}};$.createContext({pomodoroTimer:W0,shortBreakTimer:W0,longBreakTimer:W0,pomodoroPhase:AN.Pomodoro,setPomodoroPhase:()=>{},autoStartTimerWhenChangePomodoroPhase:()=>{}});const Hy=()=>$.useContext(_N),q0=60*1e3,dz=t=>function(e){const[n,r]=Yr("pomodoro",{pomodoro:25*q0,shortBreak:5*q0,longBreak:10*q0,theme:pl.Light});return m.jsx(_N.Provider,{value:{...n,setPomodoro:o=>r({...n,pomodoro:o}),setShortBreak:o=>r({...n,shortBreak:o}),setLongBreak:o=>r({...n,longBreak:o}),setTheme:o=>r({...n,theme:o})},children:m.jsx(t,{...e})})},hz=t=>`https://raw.githubusercontent.com/zTwist201/audio/main/${t}`;var W1=(t=>(t.MusicBox="mb",t.Chime="ch",t))(W1||{});W1.MusicBox+"",W1.Chime+"";const fz=(t,e,n)=>{const r=t[e];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((o,s)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+e+(e.split("/").length!==n?". Note that variables only represent file names one level deep.":""))))})},IN=$.createContext({messages:{},changeLanguage:()=>{},language:sh.En,formatMessage:()=>""}),pz=t=>function(n){const[r,o]=Yr("app_language",sh.En),[s,i]=$.useState({}),a=async c=>{const{default:u}=await fz(Object.assign({"./language/en.json":()=>hn(()=>import("./en-DO9OkQie.js"),[]),"./language/vi.json":()=>hn(()=>import("./vi-BU6JAnvG.js"),[])}),`./language/${c}.json`,3);i(u)};$.useEffect(()=>{a(r)},[]);const l=(c,u)=>{const{id:d,defaultMessage:h}=c,f=s[d]||h;return u?Object.entries(u).reduce((p,[y,b])=>p.replace(new RegExp(`{{${y}}}`,"gm"),b),f):f};return m.jsx(IN.Provider,{value:{messages:s,language:r,changeLanguage:async c=>{o(c),a(c)},formatMessage:l},children:m.jsx(t,{...n})})},kn=()=>$.useContext(IN),mz="_container_uzw7y_2",gz="_body_uzw7y_9",yz="_footer_uzw7y_13",bz="_version_uzw7y_19",vz="_link_uzw7y_24",Ku={container:mz,body:gz,footer:yz,version:bz,link:vz},wz="_container_t6uy9_2",Cz="_left_t6uy9_15",xz="_right_t6uy9_24",kz="_rightIcon_t6uy9_30",Sz="_backIcon_t6uy9_37",Is={container:wz,left:Cz,right:xz,rightIcon:kz,backIcon:Sz},MN=Object.freeze({left:0,top:0,width:16,height:16}),Gm=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),xx=Object.freeze({...MN,...Gm}),q1=Object.freeze({...xx,body:"",hidden:!1});function Ez(t,e){const n={};!t.hFlip!=!e.hFlip&&(n.hFlip=!0),!t.vFlip!=!e.vFlip&&(n.vFlip=!0);const r=((t.rotate||0)+(e.rotate||0))%4;return r&&(n.rotate=r),n}function H_(t,e){const n=Ez(t,e);for(const r in q1)r in Gm?r in t&&!(r in n)&&(n[r]=Gm[r]):r in e?n[r]=e[r]:r in t&&(n[r]=t[r]);return n}function Tz(t,e){const n=t.icons,r=t.aliases||Object.create(null),o=Object.create(null);function s(i){if(n[i])return o[i]=[];if(!(i in o)){o[i]=null;const a=r[i]&&r[i].parent,l=a&&s(a);l&&(o[i]=[a].concat(l))}return o[i]}return Object.keys(n).concat(Object.keys(r)).forEach(s),o}function _z(t,e,n){const r=t.icons,o=t.aliases||Object.create(null);let s={};function i(a){s=H_(r[a]||o[a],s)}return i(e),n.forEach(i),H_(t,s)}function RN(t,e){const n=[];if(typeof t!="object"||typeof t.icons!="object")return n;t.not_found instanceof Array&&t.not_found.forEach(o=>{e(o,null),n.push(o)});const r=Tz(t);for(const o in r){const s=r[o];s&&(e(o,_z(t,o,s)),n.push(o))}return n}const Az={provider:"",aliases:{},not_found:{},...MN};function G0(t,e){for(const n in e)if(n in t&&typeof t[n]!=typeof e[n])return!1;return!0}function PN(t){if(typeof t!="object"||t===null)return null;const e=t;if(typeof e.prefix!="string"||!t.icons||typeof t.icons!="object"||!G0(t,Az))return null;const n=e.icons;for(const o in n){const s=n[o];if(!o||typeof s.body!="string"||!G0(s,q1))return null}const r=e.aliases||Object.create(null);for(const o in r){const s=r[o],i=s.parent;if(!o||typeof i!="string"||!n[i]&&!r[i]||!G0(s,q1))return null}return e}const DN=/^[a-z0-9]+(-[a-z0-9]+)*$/,zy=(t,e,n,r="")=>{const o=t.split(":");if(t.slice(0,1)==="@"){if(o.length<2||o.length>3)return null;r=o.shift().slice(1)}if(o.length>3||!o.length)return null;if(o.length>1){const a=o.pop(),l=o.pop(),c={provider:o.length>0?o[0]:r,prefix:l,name:a};return e&&!pm(c)?null:c}const s=o[0],i=s.split("-");if(i.length>1){const a={provider:r,prefix:i.shift(),name:i.join("-")};return e&&!pm(a)?null:a}if(n&&r===""){const a={provider:r,prefix:"",name:s};return e&&!pm(a,n)?null:a}return null},pm=(t,e)=>t?!!((e&&t.prefix===""||t.prefix)&&t.name):!1,z_=Object.create(null);function Iz(t,e){return{provider:t,prefix:e,icons:Object.create(null),missing:new Set}}function Rc(t,e){const n=z_[t]||(z_[t]=Object.create(null));return n[e]||(n[e]=Iz(t,e))}function NN(t,e){return PN(e)?RN(e,(n,r)=>{r?t.icons[n]=r:t.missing.add(n)}):[]}function Mz(t,e,n){try{if(typeof n.body=="string")return t.icons[e]={...n},!0}catch{}return!1}let ah=!1;function ON(t){return typeof t=="boolean"&&(ah=t),ah}function U_(t){const e=typeof t=="string"?zy(t,!0,ah):t;if(e){const n=Rc(e.provider,e.prefix),r=e.name;return n.icons[r]||(n.missing.has(r)?null:void 0)}}function Rz(t,e){const n=zy(t,!0,ah);if(!n)return!1;const r=Rc(n.provider,n.prefix);return e?Mz(r,n.name,e):(r.missing.add(n.name),!0)}function Pz(t,e){if(typeof t!="object")return!1;if(typeof e!="string"&&(e=t.provider||""),ah&&!e&&!t.prefix){let o=!1;return PN(t)&&(t.prefix="",RN(t,(s,i)=>{Rz(s,i)&&(o=!0)})),o}const n=t.prefix;if(!pm({prefix:n,name:"a"}))return!1;const r=Rc(e,n);return!!NN(r,t)}const LN=Object.freeze({width:null,height:null}),VN=Object.freeze({...LN,...Gm}),Dz=/(-?[0-9.]*[0-9]+[0-9.]*)/g,Nz=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function W_(t,e,n){if(e===1)return t;if(n=n||100,typeof t=="number")return Math.ceil(t*e*n)/n;if(typeof t!="string")return t;const r=t.split(Dz);if(r===null||!r.length)return t;const o=[];let s=r.shift(),i=Nz.test(s);for(;;){if(i){const a=parseFloat(s);isNaN(a)?o.push(s):o.push(Math.ceil(a*e*n)/n)}else o.push(s);if(s=r.shift(),s===void 0)return o.join("");i=!i}}function Oz(t,e="defs"){let n="";const r=t.indexOf("<"+e);for(;r>=0;){const o=t.indexOf(">",r),s=t.indexOf("</"+e);if(o===-1||s===-1)break;const i=t.indexOf(">",s);if(i===-1)break;n+=t.slice(o+1,s).trim(),t=t.slice(0,r).trim()+t.slice(i+1)}return{defs:n,content:t}}function Lz(t,e){return t?"<defs>"+t+"</defs>"+e:e}function Vz(t,e,n){const r=Oz(t);return Lz(r.defs,e+r.content+n)}const jz=t=>t==="unset"||t==="undefined"||t==="none";function Bz(t,e){const n={...xx,...t},r={...VN,...e},o={left:n.left,top:n.top,width:n.width,height:n.height};let s=n.body;[n,r].forEach(y=>{const b=[],w=y.hFlip,k=y.vFlip;let x=y.rotate;w?k?x+=2:(b.push("translate("+(o.width+o.left).toString()+" "+(0-o.top).toString()+")"),b.push("scale(-1 1)"),o.top=o.left=0):k&&(b.push("translate("+(0-o.left).toString()+" "+(o.height+o.top).toString()+")"),b.push("scale(1 -1)"),o.top=o.left=0);let A;switch(x<0&&(x-=Math.floor(x/4)*4),x=x%4,x){case 1:A=o.height/2+o.top,b.unshift("rotate(90 "+A.toString()+" "+A.toString()+")");break;case 2:b.unshift("rotate(180 "+(o.width/2+o.left).toString()+" "+(o.height/2+o.top).toString()+")");break;case 3:A=o.width/2+o.left,b.unshift("rotate(-90 "+A.toString()+" "+A.toString()+")");break}x%2===1&&(o.left!==o.top&&(A=o.left,o.left=o.top,o.top=A),o.width!==o.height&&(A=o.width,o.width=o.height,o.height=A)),b.length&&(s=Vz(s,'<g transform="'+b.join(" ")+'">',"</g>"))});const i=r.width,a=r.height,l=o.width,c=o.height;let u,d;i===null?(d=a===null?"1em":a==="auto"?c:a,u=W_(d,l/c)):(u=i==="auto"?l:i,d=a===null?W_(u,c/l):a==="auto"?c:a);const h={},f=(y,b)=>{jz(b)||(h[y]=b.toString())};f("width",u),f("height",d);const p=[o.left,o.top,l,c];return h.viewBox=p.join(" "),{attributes:h,viewBox:p,body:s}}const $z=/\sid="(\S+)"/g,Fz="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let Hz=0;function zz(t,e=Fz){const n=[];let r;for(;r=$z.exec(t);)n.push(r[1]);if(!n.length)return t;const o="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(s=>{const i=typeof e=="function"?e(s):e+(Hz++).toString(),a=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");t=t.replace(new RegExp('([#;"])('+a+')([")]|\\.[a-z])',"g"),"$1"+i+o+"$3")}),t=t.replace(new RegExp(o,"g"),""),t}const G1=Object.create(null);function Uz(t,e){G1[t]=e}function K1(t){return G1[t]||G1[""]}function kx(t){let e;if(typeof t.resources=="string")e=[t.resources];else if(e=t.resources,!(e instanceof Array)||!e.length)return null;return{resources:e,path:t.path||"/",maxURL:t.maxURL||500,rotate:t.rotate||750,timeout:t.timeout||5e3,random:t.random===!0,index:t.index||0,dataAfterTimeout:t.dataAfterTimeout!==!1}}const Sx=Object.create(null),Yu=["https://api.simplesvg.com","https://api.unisvg.com"],mm=[];for(;Yu.length>0;)Yu.length===1||Math.random()>.5?mm.push(Yu.shift()):mm.push(Yu.pop());Sx[""]=kx({resources:["https://api.iconify.design"].concat(mm)});function Wz(t,e){const n=kx(e);return n===null?!1:(Sx[t]=n,!0)}function Ex(t){return Sx[t]}const qz=()=>{let t;try{if(t=fetch,typeof t=="function")return t}catch{}};let q_=qz();function Gz(t,e){const n=Ex(t);if(!n)return 0;let r;if(!n.maxURL)r=0;else{let o=0;n.resources.forEach(i=>{o=Math.max(o,i.length)});const s=e+".json?icons=";r=n.maxURL-o-n.path.length-s.length}return r}function Kz(t){return t===404}const Yz=(t,e,n)=>{const r=[],o=Gz(t,e),s="icons";let i={type:s,provider:t,prefix:e,icons:[]},a=0;return n.forEach((l,c)=>{a+=l.length+1,a>=o&&c>0&&(r.push(i),i={type:s,provider:t,prefix:e,icons:[]},a=l.length),i.icons.push(l)}),r.push(i),r};function Xz(t){if(typeof t=="string"){const e=Ex(t);if(e)return e.path}return"/"}const Jz=(t,e,n)=>{if(!q_){n("abort",424);return}let r=Xz(e.provider);switch(e.type){case"icons":{const s=e.prefix,a=e.icons.join(","),l=new URLSearchParams({icons:a});r+=s+".json?"+l.toString();break}case"custom":{const s=e.uri;r+=s.slice(0,1)==="/"?s.slice(1):s;break}default:n("abort",400);return}let o=503;q_(t+r).then(s=>{const i=s.status;if(i!==200){setTimeout(()=>{n(Kz(i)?"abort":"next",i)});return}return o=501,s.json()}).then(s=>{if(typeof s!="object"||s===null){setTimeout(()=>{s===404?n("abort",s):n("next",o)});return}setTimeout(()=>{n("success",s)})}).catch(()=>{n("next",o)})},Qz={prepare:Yz,send:Jz};function Zz(t){const e={loaded:[],missing:[],pending:[]},n=Object.create(null);t.sort((o,s)=>o.provider!==s.provider?o.provider.localeCompare(s.provider):o.prefix!==s.prefix?o.prefix.localeCompare(s.prefix):o.name.localeCompare(s.name));let r={provider:"",prefix:"",name:""};return t.forEach(o=>{if(r.name===o.name&&r.prefix===o.prefix&&r.provider===o.provider)return;r=o;const s=o.provider,i=o.prefix,a=o.name,l=n[s]||(n[s]=Object.create(null)),c=l[i]||(l[i]=Rc(s,i));let u;a in c.icons?u=e.loaded:i===""||c.missing.has(a)?u=e.missing:u=e.pending;const d={provider:s,prefix:i,name:a};u.push(d)}),e}function jN(t,e){t.forEach(n=>{const r=n.loaderCallbacks;r&&(n.loaderCallbacks=r.filter(o=>o.id!==e))})}function eU(t){t.pendingCallbacksFlag||(t.pendingCallbacksFlag=!0,setTimeout(()=>{t.pendingCallbacksFlag=!1;const e=t.loaderCallbacks?t.loaderCallbacks.slice(0):[];if(!e.length)return;let n=!1;const r=t.provider,o=t.prefix;e.forEach(s=>{const i=s.icons,a=i.pending.length;i.pending=i.pending.filter(l=>{if(l.prefix!==o)return!0;const c=l.name;if(t.icons[c])i.loaded.push({provider:r,prefix:o,name:c});else if(t.missing.has(c))i.missing.push({provider:r,prefix:o,name:c});else return n=!0,!0;return!1}),i.pending.length!==a&&(n||jN([t],s.id),s.callback(i.loaded.slice(0),i.missing.slice(0),i.pending.slice(0),s.abort))})}))}let tU=0;function nU(t,e,n){const r=tU++,o=jN.bind(null,n,r);if(!e.pending.length)return o;const s={id:r,icons:e,callback:t,abort:o};return n.forEach(i=>{(i.loaderCallbacks||(i.loaderCallbacks=[])).push(s)}),o}function rU(t,e=!0,n=!1){const r=[];return t.forEach(o=>{const s=typeof o=="string"?zy(o,e,n):o;s&&r.push(s)}),r}var oU={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function sU(t,e,n,r){const o=t.resources.length,s=t.random?Math.floor(Math.random()*o):t.index;let i;if(t.random){let M=t.resources.slice(0);for(i=[];M.length>1;){const T=Math.floor(Math.random()*M.length);i.push(M[T]),M=M.slice(0,T).concat(M.slice(T+1))}i=i.concat(M)}else i=t.resources.slice(s).concat(t.resources.slice(0,s));const a=Date.now();let l="pending",c=0,u,d=null,h=[],f=[];typeof r=="function"&&f.push(r);function p(){d&&(clearTimeout(d),d=null)}function y(){l==="pending"&&(l="aborted"),p(),h.forEach(M=>{M.status==="pending"&&(M.status="aborted")}),h=[]}function b(M,T){T&&(f=[]),typeof M=="function"&&f.push(M)}function w(){return{startTime:a,payload:e,status:l,queriesSent:c,queriesPending:h.length,subscribe:b,abort:y}}function k(){l="failed",f.forEach(M=>{M(void 0,u)})}function x(){h.forEach(M=>{M.status==="pending"&&(M.status="aborted")}),h=[]}function A(M,T,S){const _=T!=="success";switch(h=h.filter(R=>R!==M),l){case"pending":break;case"failed":if(_||!t.dataAfterTimeout)return;break;default:return}if(T==="abort"){u=S,k();return}if(_){u=S,h.length||(i.length?I():k());return}if(p(),x(),!t.random){const R=t.resources.indexOf(M.resource);R!==-1&&R!==t.index&&(t.index=R)}l="completed",f.forEach(R=>{R(S)})}function I(){if(l!=="pending")return;p();const M=i.shift();if(M===void 0){if(h.length){d=setTimeout(()=>{p(),l==="pending"&&(x(),k())},t.timeout);return}k();return}const T={status:"pending",resource:M,callback:(S,_)=>{A(T,S,_)}};h.push(T),c++,d=setTimeout(I,t.rotate),n(M,e,T.callback)}return setTimeout(I),w}function BN(t){const e={...oU,...t};let n=[];function r(){n=n.filter(a=>a().status==="pending")}function o(a,l,c){const u=sU(e,a,l,(d,h)=>{r(),c&&c(d,h)});return n.push(u),u}function s(a){return n.find(l=>a(l))||null}return{query:o,find:s,setIndex:a=>{e.index=a},getIndex:()=>e.index,cleanup:r}}function G_(){}const K0=Object.create(null);function iU(t){if(!K0[t]){const e=Ex(t);if(!e)return;const n=BN(e),r={config:e,redundancy:n};K0[t]=r}return K0[t]}function aU(t,e,n){let r,o;if(typeof t=="string"){const s=K1(t);if(!s)return n(void 0,424),G_;o=s.send;const i=iU(t);i&&(r=i.redundancy)}else{const s=kx(t);if(s){r=BN(s);const i=t.resources?t.resources[0]:"",a=K1(i);a&&(o=a.send)}}return!r||!o?(n(void 0,424),G_):r.query(e,o,n)().abort}function K_(){}function lU(t){t.iconsLoaderFlag||(t.iconsLoaderFlag=!0,setTimeout(()=>{t.iconsLoaderFlag=!1,eU(t)}))}function cU(t){const e=[],n=[];return t.forEach(r=>{(r.match(DN)?e:n).push(r)}),{valid:e,invalid:n}}function Xu(t,e,n){function r(){const o=t.pendingIcons;e.forEach(s=>{o&&o.delete(s),t.icons[s]||t.missing.add(s)})}if(n&&typeof n=="object")try{if(!NN(t,n).length){r();return}}catch(o){console.error(o)}r(),lU(t)}function Y_(t,e){t instanceof Promise?t.then(n=>{e(n)}).catch(()=>{e(null)}):e(t)}function uU(t,e){t.iconsToLoad?t.iconsToLoad=t.iconsToLoad.concat(e).sort():t.iconsToLoad=e,t.iconsQueueFlag||(t.iconsQueueFlag=!0,setTimeout(()=>{t.iconsQueueFlag=!1;const{provider:n,prefix:r}=t,o=t.iconsToLoad;if(delete t.iconsToLoad,!o||!o.length)return;const s=t.loadIcon;if(t.loadIcons&&(o.length>1||!s)){Y_(t.loadIcons(o,r,n),u=>{Xu(t,o,u)});return}if(s){o.forEach(u=>{const d=s(u,r,n);Y_(d,h=>{const f=h?{prefix:r,icons:{[u]:h}}:null;Xu(t,[u],f)})});return}const{valid:i,invalid:a}=cU(o);if(a.length&&Xu(t,a,null),!i.length)return;const l=r.match(DN)?K1(n):null;if(!l){Xu(t,i,null);return}l.prepare(n,r,i).forEach(u=>{aU(n,u,d=>{Xu(t,u.icons,d)})})}))}const dU=(t,e)=>{const n=rU(t,!0,ON()),r=Zz(n);if(!r.pending.length){let l=!0;return e&&setTimeout(()=>{l&&e(r.loaded,r.missing,r.pending,K_)}),()=>{l=!1}}const o=Object.create(null),s=[];let i,a;return r.pending.forEach(l=>{const{provider:c,prefix:u}=l;if(u===a&&c===i)return;i=c,a=u,s.push(Rc(c,u));const d=o[c]||(o[c]=Object.create(null));d[u]||(d[u]=[])}),r.pending.forEach(l=>{const{provider:c,prefix:u,name:d}=l,h=Rc(c,u),f=h.pendingIcons||(h.pendingIcons=new Set);f.has(d)||(f.add(d),o[c][u].push(d))}),s.forEach(l=>{const c=o[l.provider][l.prefix];c.length&&uU(l,c)}),e?nU(e,r,s):K_};function hU(t,e){const n={...t};for(const r in e){const o=e[r],s=typeof o;r in LN?(o===null||o&&(s==="string"||s==="number"))&&(n[r]=o):s===typeof n[r]&&(n[r]=r==="rotate"?o%4:o)}return n}const fU=/[\s,]+/;function pU(t,e){e.split(fU).forEach(n=>{switch(n.trim()){case"horizontal":t.hFlip=!0;break;case"vertical":t.vFlip=!0;break}})}function mU(t,e=0){const n=t.replace(/^-?[0-9.]*/,"");function r(o){for(;o<0;)o+=4;return o%4}if(n===""){const o=parseInt(t);return isNaN(o)?0:r(o)}else if(n!==t){let o=0;switch(n){case"%":o=25;break;case"deg":o=90}if(o){let s=parseFloat(t.slice(0,t.length-n.length));return isNaN(s)?0:(s=s/o,s%1===0?r(s):0)}}return e}function gU(t,e){let n=t.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in e)n+=" "+r+'="'+e[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+t+"</svg>"}function yU(t){return t.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function bU(t){return"data:image/svg+xml,"+yU(t)}function vU(t){return'url("'+bU(t)+'")'}let Td;function wU(){try{Td=window.trustedTypes.createPolicy("iconify",{createHTML:t=>t})}catch{Td=null}}function CU(t){return Td===void 0&&wU(),Td?Td.createHTML(t):t}const $N={...VN,inline:!1},xU={xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},kU={display:"inline-block"},Y1={backgroundColor:"currentColor"},FN={backgroundColor:"transparent"},X_={Image:"var(--svg)",Repeat:"no-repeat",Size:"100% 100%"},J_={WebkitMask:Y1,mask:Y1,background:FN};for(const t in J_){const e=J_[t];for(const n in X_)e[t+n]=X_[n]}const SU={...$N,inline:!0};function Q_(t){return t+(t.match(/^[-0-9.]+$/)?"px":"")}const EU=(t,e,n)=>{const r=e.inline?SU:$N,o=hU(r,e),s=e.mode||"svg",i={},a=e.style||{},l={...s==="svg"?xU:{}};if(n){const b=zy(n,!1,!0);if(b){const w=["iconify"],k=["provider","prefix"];for(const x of k)b[x]&&w.push("iconify--"+b[x]);l.className=w.join(" ")}}for(let b in e){const w=e[b];if(w!==void 0)switch(b){case"icon":case"style":case"children":case"onLoad":case"mode":case"ssr":break;case"_ref":l.ref=w;break;case"className":l[b]=(l[b]?l[b]+" ":"")+w;break;case"inline":case"hFlip":case"vFlip":o[b]=w===!0||w==="true"||w===1;break;case"flip":typeof w=="string"&&pU(o,w);break;case"color":i.color=w;break;case"rotate":typeof w=="string"?o[b]=mU(w):typeof w=="number"&&(o[b]=w);break;case"ariaHidden":case"aria-hidden":w!==!0&&w!=="true"&&delete l["aria-hidden"];break;default:r[b]===void 0&&(l[b]=w)}}const c=Bz(t,o),u=c.attributes;if(o.inline&&(i.verticalAlign="-0.125em"),s==="svg"){l.style={...i,...a},Object.assign(l,u);let b=0,w=e.id;return typeof w=="string"&&(w=w.replace(/-/g,"_")),l.dangerouslySetInnerHTML={__html:CU(zz(c.body,w?()=>w+"ID"+b++:"iconifyReact"))},v.createElement("svg",l)}const{body:d,width:h,height:f}=t,p=s==="mask"||(s==="bg"?!1:d.indexOf("currentColor")!==-1),y=gU(d,{...u,width:h+"",height:f+""});return l.style={...i,"--svg":vU(y),width:Q_(u.width),height:Q_(u.height),...kU,...p?Y1:FN,...a},v.createElement("span",l)};ON(!0);Uz("",Qz);if(typeof document<"u"&&typeof window<"u"){const t=window;if(t.IconifyPreload!==void 0){const e=t.IconifyPreload,n="Invalid IconifyPreload syntax.";typeof e=="object"&&e!==null&&(e instanceof Array?e:[e]).forEach(r=>{try{(typeof r!="object"||r===null||r instanceof Array||typeof r.icons!="object"||typeof r.prefix!="string"||!Pz(r))&&console.error(n)}catch{console.error(n)}})}if(t.IconifyProviders!==void 0){const e=t.IconifyProviders;if(typeof e=="object"&&e!==null)for(let n in e){const r="IconifyProviders["+n+"] is invalid.";try{const o=e[n];if(typeof o!="object"||!o||o.resources===void 0)continue;Wz(n,o)||console.error(r)}catch{console.error(r)}}}}function HN(t){const[e,n]=v.useState(!!t.ssr),[r,o]=v.useState({});function s(f){if(f){const p=t.icon;if(typeof p=="object")return{name:"",data:p};const y=U_(p);if(y)return{name:p,data:y}}return{name:""}}const[i,a]=v.useState(s(!!t.ssr));function l(){const f=r.callback;f&&(f(),o({}))}function c(f){if(JSON.stringify(i)!==JSON.stringify(f))return l(),a(f),!0}function u(){var f;const p=t.icon;if(typeof p=="object"){c({name:"",data:p});return}const y=U_(p);if(c({name:p,data:y}))if(y===void 0){const b=dU([p],u);o({callback:b})}else y&&((f=t.onLoad)===null||f===void 0||f.call(t,p))}v.useEffect(()=>(n(!0),l),[]),v.useEffect(()=>{e&&u()},[t.icon,e]);const{name:d,data:h}=i;return h?EU({...xx,...h},t,d):t.children?t.children:t.fallback?t.fallback:v.createElement("span",{})}const TU=v.forwardRef((t,e)=>HN({...t,_ref:e}));v.forwardRef((t,e)=>HN({inline:!0,...t,_ref:e}));const ae=({className:t,...e})=>m.jsx(TU,{className:be(pf.icon,t),...e}),_U=()=>{const t=Ao();return m.jsxs("div",{className:Is.container,children:[m.jsx("div",{className:Is.left,onClick:()=>t("/"),children:"DREAMER"}),m.jsxs("div",{className:Is.right,children:[m.jsx(ae,{className:Is.rightIcon,width:24,icon:"solar:notes-line-duotone",onClick:()=>{t("/notes")}}),m.jsx(ae,{className:Is.rightIcon,width:24,icon:"solar:settings-linear",onClick:()=>{t("/setting")}})]})]})},ou=({renderLeftComponent:t,renderRightComponent:e,onClickLeftButton:n})=>{const r=Ao();return m.jsxs("div",{className:Is.container,children:[m.jsxs("div",{className:Is.left,onClick:n||(()=>r(-1)),children:[m.jsx(ae,{icon:"solar:arrow-left-outline",width:24,className:Is.backIcon}),t==null?void 0:t()]}),m.jsx("div",{className:Is.right,children:e==null?void 0:e()})]})},AU="1.0.2";function IU(){const{shortBreak:t,setShortBreak:e,pomodoro:n,setPomodoro:r,longBreak:o,setLongBreak:s,theme:i,setTheme:a}=Hy(),l=Ao(),{language:c,changeLanguage:u,formatMessage:d}=kn();return m.jsxs("div",{className:Ku.container,children:[m.jsx(ou,{renderLeftComponent:()=>m.jsx(m.Fragment,{children:d({id:"setting-page.title",defaultMessage:"Setting"})})}),m.jsxs("div",{className:Ku.body,children:[m.jsx(Ft.ItemMeta,{logo:m.jsx(NF,{}),title:d({id:"setting-page.label-theme",defaultMessage:"Theme"}),description:d({id:"setting-page.description-theme",defaultMessage:"Config theme for whole page"}),rightComponent:m.jsx(U1,{isButton:!0,value:i,onChangeValue:h=>a(h),options:[{label:d({id:"setting-page.label-light",defaultMessage:"Light"}),value:pl.Light},{label:d({id:"setting-page.label-dark",defaultMessage:"Dark"}),value:pl.Dark}]})}),m.jsx(Ft.ItemMeta,{logo:m.jsx(iF,{}),title:"Language",description:"Config language for whole page",rightComponent:m.jsx(U1,{isButton:!0,value:c,onChangeValue:h=>u(h),options:[{label:"VN",value:sh.Vi},{label:"EN",value:sh.En}]})}),m.jsx(Ft.ItemMeta,{onClick:()=>l("/checklist-template"),logo:m.jsx(ae,{width:24,icon:"proicons:task-list"}),title:"Task Management",description:"Select/ Deselect Tasks"})]}),m.jsxs("div",{className:Ku.footer,children:[m.jsxs(me.Text,{className:Ku.version,onClick:()=>l("/setting/local-storage-editor"),children:["Version: ",AU]}),m.jsx("a",{href:"https://github.com/tomzaku/dreamer-web-public/issues",children:m.jsx(me.Text,{className:Ku.link,children:"| Feature Request | Bug Report"})})]})]})}const MU="record_field",RU={duration:{id:"duration",title:"Duration",icon:"solar:clock-square-broken",description:"Record duration for tracking purpose",type:"metric",unit:"minutes"},"push-ups":{id:"push-ups",title:"Push-ups",icon:"iconoir:gym",description:"For example: Push-ups, Squats",type:"metric",unit:"reps"},note:{id:"note",title:"Note",icon:"solar:notebook-minimalistic-linear",description:"Note for tracking purpose",type:"note",unit:"words"}},Uy=()=>{const[t,e]=Yr(MU,RU);return{getAllRecordFields:()=>Object.values(t),getRecordFields:s=>s.map(i=>t[i]),addRecordField:s=>{const i=qn();return e(a=>({...a,[i]:{id:i,...s}})),{id:i,...s}},removeRecordField:s=>{e(i=>{const a={...i};return delete a[s],a})}}},PU="_container_cj2x8_1",DU={container:PU};function Xr({children:t,className:e,onClick:n}){return m.jsx("div",{onClick:n,className:be(DU.container,e),children:t})}const NU="_container_yw9a7_2",OU="_title_yw9a7_8",LU="_button_yw9a7_12",VU="_buttonActive_yw9a7_19",jU="_addIcon_yw9a7_23",BU="_icon_yw9a7_27",$U="_iconActive_yw9a7_31",FU="_hr_yw9a7_35",gi={container:NU,title:OU,button:LU,buttonActive:VU,addIcon:jU,icon:BU,iconActive:$U,hr:FU},HU="_container_ngn4e_1",zU="_hr_ngn4e_11",Z_={container:HU,hr:zU},_d=({classes:t}={})=>m.jsx("div",{className:be(Z_.container,t==null?void 0:t.container),children:m.jsx("div",{className:be(Z_.hr,t==null?void 0:t.hr)})});var Wn=(t=>(t[t.Home=0]="Home",t[t.History=1]="History",t[t.Add=2]="Add",t[t.Metric=3]="Metric",t))(Wn||{});const UU=({onClickHome:t,onClickHistory:e,onClickAdd:n,onClickMetric:r,activeTab:o,renderTitle:s=()=>null})=>{const i=[{icon:"solar:home-2-line-duotone",iconActive:"solar:home-2-bold",onClick:t,isActive:o===0},{icon:"solar:clock-square-broken",iconActive:"solar:clock-square-bold",onClick:e,isActive:o===1},{icon:"solar:chart-square-linear",iconActive:"solar:chart-square-bold",onClick:r,isActive:o===3}],a=kn();return m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:gi.container,children:[m.jsx(me.Title,{level:4,noMargin:!0,className:gi.title,children:s()}),i.map(({icon:l,iconActive:c,onClick:u,isActive:d},h)=>m.jsx(ae,{onClick:u,className:be(gi.icon,d&&gi.iconActive),width:24,icon:d?c:l},h)),m.jsxs(Gt,{className:be(gi.button,o===2&&gi.buttonActive),type:"dash",onClick:n,children:[m.jsx(ae,{icon:"material-symbols:add",className:gi.addIcon}),a.formatMessage({id:"record-header.add-record",defaultMessage:"Add"})]})]}),m.jsx(_d,{classes:{hr:gi.hr}})]})},WU="_cardContainer_8jpqa_2",qU={cardContainer:WU},GU="_container_udzj2_2",KU="_dash_udzj2_18",YU="_solid_udzj2_22",Y0={container:GU,dash:KU,solid:YU},jo=$.forwardRef(({className:t,border:e,...n},r)=>m.jsx("input",{ref:r,className:be(Y0.container,e==="dash"&&Y0.dash,e==="solid"&&Y0.solid,t),...n}));function un(t){this.content=t}un.prototype={constructor:un,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,o=r.find(t),s=r.content.slice();return o==-1?s.push(n||t,e):(s[o+1]=e,n&&(s[o]=n)),new un(s)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new un(n)},addToStart:function(t,e){return new un([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new un(n)},addBefore:function(t,e,n){var r=this.remove(e),o=r.content.slice(),s=r.find(t);return o.splice(s==-1?o.length:s,0,e,n),new un(o)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=un.from(t),t.size?new un(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=un.from(t),t.size?new un(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=un.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};un.from=function(t){if(t instanceof un)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new un(e)};function zN(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let o=t.child(r),s=e.child(r);if(o==s){n+=o.nodeSize;continue}if(!o.sameMarkup(s))return n;if(o.isText&&o.text!=s.text){for(let i=0;o.text[i]==s.text[i];i++)n++;return n}if(o.content.size||s.content.size){let i=zN(o.content,s.content,n+1);if(i!=null)return i}n+=o.nodeSize}}function UN(t,e,n,r){for(let o=t.childCount,s=e.childCount;;){if(o==0||s==0)return o==s?null:{a:n,b:r};let i=t.child(--o),a=e.child(--s),l=i.nodeSize;if(i==a){n-=l,r-=l;continue}if(!i.sameMarkup(a))return{a:n,b:r};if(i.isText&&i.text!=a.text){let c=0,u=Math.min(i.text.length,a.text.length);for(;c<u&&i.text[i.text.length-c-1]==a.text[a.text.length-c-1];)c++,n--,r--;return{a:n,b:r}}if(i.content.size||a.content.size){let c=UN(i.content,a.content,n-1,r-1);if(c)return c}n-=l,r-=l}}class B{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,o=0,s){for(let i=0,a=0;a<n;i++){let l=this.content[i],c=a+l.nodeSize;if(c>e&&r(l,o+a,s||null,i)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,n-u),r,o+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,o){let s="",i=!0;return this.nodesBetween(e,n,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,n-l):a.isLeaf?o?typeof o=="function"?o(a):o:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(i?i=!1:s+=r),s+=c},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,o=this.content.slice(),s=0;for(n.isText&&n.sameMarkup(r)&&(o[o.length-1]=n.withText(n.text+r.text),s=1);s<e.content.length;s++)o.push(e.content[s]);return new B(o,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],o=0;if(n>e)for(let s=0,i=0;i<n;s++){let a=this.content[s],l=i+a.nodeSize;l>e&&((i<e||l>n)&&(a.isText?a=a.cut(Math.max(0,e-i),Math.min(a.text.length,n-i)):a=a.cut(Math.max(0,e-i-1),Math.min(a.content.size,n-i-1))),r.push(a),o+=a.nodeSize),i=l}return new B(r,o)}cutByIndex(e,n){return e==n?B.empty:e==0&&n==this.content.length?this:new B(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let o=this.content.slice(),s=this.size+n.nodeSize-r.nodeSize;return o[e]=n,new B(o,s)}addToStart(e){return new B([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new B(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let o=this.content[n];e(o,r,n),r+=o.nodeSize}}findDiffStart(e,n=0){return zN(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return UN(this,e,n,r)}findIndex(e,n=-1){if(e==0)return Sp(0,e);if(e==this.size)return Sp(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,o=0;;r++){let s=this.child(r),i=o+s.nodeSize;if(i>=e)return i==e||n>0?Sp(r+1,i):Sp(r,o);o=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return B.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new B(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return B.empty;let n,r=0;for(let o=0;o<e.length;o++){let s=e[o];r+=s.nodeSize,o&&s.isText&&e[o-1].sameMarkup(s)?(n||(n=e.slice(0,o)),n[n.length-1]=s.withText(n[n.length-1].text+s.text)):n&&n.push(s)}return new B(n||e,r)}static from(e){if(!e)return B.empty;if(e instanceof B)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new B([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}B.empty=new B([],0);const X0={index:0,offset:0};function Sp(t,e){return X0.index=t,X0.offset=e,X0}function Km(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!Km(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!Km(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let it=class X1{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let o=0;o<e.length;o++){let s=e[o];if(this.eq(s))return e;if(this.type.excludes(s.type))n||(n=e.slice(0,o));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(n||(n=e.slice(0,o)),n.push(this),r=!0),n&&n.push(s)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Km(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let o=r.create(n.attrs);return r.checkAttrs(o.attrs),o}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return X1.none;if(e instanceof X1)return[e];let n=e.slice();return n.sort((r,o)=>r.type.rank-o.type.rank),n}};it.none=[];class Ym extends Error{}class G{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=qN(this.content,e+this.openStart,n);return r&&new G(r,this.openStart,this.openEnd)}removeBetween(e,n){return new G(WN(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return G.empty;let r=n.openStart||0,o=n.openEnd||0;if(typeof r!="number"||typeof o!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new G(B.fromJSON(e,n.content),r,o)}static maxOpen(e,n=!0){let r=0,o=0;for(let s=e.firstChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)o++;return new G(e,r,o)}}G.empty=new G(B.empty,0,0);function WN(t,e,n){let{index:r,offset:o}=t.findIndex(e),s=t.maybeChild(r),{index:i,offset:a}=t.findIndex(n);if(o==e||s.isText){if(a!=n&&!t.child(i).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=i)throw new RangeError("Removing non-flat range");return t.replaceChild(r,s.copy(WN(s.content,e-o-1,n-o-1)))}function qN(t,e,n,r){let{index:o,offset:s}=t.findIndex(e),i=t.maybeChild(o);if(s==e||i.isText)return t.cut(0,e).append(n).append(t.cut(e));let a=qN(i.content,e-s-1,n);return a&&t.replaceChild(o,i.copy(a))}function XU(t,e,n){if(n.openStart>t.depth)throw new Ym("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Ym("Inconsistent open depths");return GN(t,e,n,0)}function GN(t,e,n,r){let o=t.index(r),s=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){let i=GN(t,e,n,r+1);return s.copy(s.content.replaceChild(o,i))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let i=t.parent,a=i.content;return sl(i,a.cut(0,t.parentOffset).append(n.content).append(a.cut(e.parentOffset)))}else{let{start:i,end:a}=JU(n,t);return sl(s,YN(t,i,a,e,r))}else return sl(s,Xm(t,e,r))}function KN(t,e){if(!e.type.compatibleContent(t.type))throw new Ym("Cannot join "+e.type.name+" onto "+t.type.name)}function J1(t,e,n){let r=t.node(n);return KN(r,e.node(n)),r}function ol(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Ad(t,e,n,r){let o=(e||t).node(n),s=0,i=e?e.index(n):o.childCount;t&&(s=t.index(n),t.depth>n?s++:t.textOffset&&(ol(t.nodeAfter,r),s++));for(let a=s;a<i;a++)ol(o.child(a),r);e&&e.depth==n&&e.textOffset&&ol(e.nodeBefore,r)}function sl(t,e){return t.type.checkContent(e),t.copy(e)}function YN(t,e,n,r,o){let s=t.depth>o&&J1(t,e,o+1),i=r.depth>o&&J1(n,r,o+1),a=[];return Ad(null,t,o,a),s&&i&&e.index(o)==n.index(o)?(KN(s,i),ol(sl(s,YN(t,e,n,r,o+1)),a)):(s&&ol(sl(s,Xm(t,e,o+1)),a),Ad(e,n,o,a),i&&ol(sl(i,Xm(n,r,o+1)),a)),Ad(r,null,o,a),new B(a)}function Xm(t,e,n){let r=[];if(Ad(null,t,n,r),t.depth>n){let o=J1(t,e,n+1);ol(sl(o,Xm(t,e,n+1)),r)}return Ad(e,null,n,r),new B(r)}function JU(t,e){let n=e.depth-t.openStart,o=e.node(n).copy(t.content);for(let s=n-1;s>=0;s--)o=e.node(s).copy(B.from(o));return{start:o.resolveNoCache(t.openStart+n),end:o.resolveNoCache(o.content.size-t.openEnd-n)}}class lh{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],o=e.child(n);return r?e.child(n).cut(r):o}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],o=n==0?0:this.path[n*3-1]+1;for(let s=0;s<e;s++)o+=r.child(s).nodeSize;return o}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return it.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),o=e.maybeChild(n);if(!r){let a=r;r=o,o=a}let s=r.marks;for(var i=0;i<s.length;i++)s[i].type.spec.inclusive===!1&&(!o||!s[i].isInSet(o.marks))&&(s=s[i--].removeFromSet(s));return s}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,o=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!o||!r[s].isInSet(o.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Jm(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],o=0,s=n;for(let i=e;;){let{index:a,offset:l}=i.content.findIndex(s),c=s-l;if(r.push(i,a,o+l),!c||(i=i.child(a),i.isText))break;s=c-1,o+=l+1}return new lh(n,r,s)}static resolveCached(e,n){let r=e2.get(e);if(r)for(let s=0;s<r.elts.length;s++){let i=r.elts[s];if(i.pos==n)return i}else e2.set(e,r=new QU);let o=r.elts[r.i]=lh.resolve(e,n);return r.i=(r.i+1)%ZU,o}}class QU{constructor(){this.elts=[],this.i=0}}const ZU=12,e2=new WeakMap;class Jm{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const eW=Object.create(null);let Os=class Q1{constructor(e,n,r,o=it.none){this.type=e,this.attrs=n,this.marks=o,this.content=r||B.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,o=0){this.content.nodesBetween(e,n,r,o,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,o){return this.content.textBetween(e,n,r,o)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&Km(this.attrs,n||e.defaultAttrs||eW)&&it.sameSet(this.marks,r||it.none)}copy(e=null){return e==this.content?this:new Q1(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Q1(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return G.empty;let o=this.resolve(e),s=this.resolve(n),i=r?0:o.sharedDepth(n),a=o.start(i),c=o.node(i).content.cut(o.pos-a,s.pos-a);return new G(c,o.depth-i,s.depth-i)}replace(e,n,r){return XU(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:o}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(o==e||n.isText)return n;e-=o+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}}resolve(e){return lh.resolveCached(this,e)}resolveNoCache(e){return lh.resolve(this,e)}rangeHasMark(e,n,r){let o=!1;return n>e&&this.nodesBetween(e,n,s=>(r.isInSet(s.marks)&&(o=!0),!o)),o}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),XN(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=B.empty,o=0,s=r.childCount){let i=this.contentMatchAt(e).matchFragment(r,o,s),a=i&&i.matchFragment(this.content,n);if(!a||!a.validEnd)return!1;for(let l=o;l<s;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,n,r,o){if(o&&!this.type.allowsMarks(o))return!1;let s=this.contentMatchAt(e).matchType(r),i=s&&s.matchFragment(this.content,n);return i?i.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=it.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!it.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let o=B.fromJSON(e,n.content),s=e.nodeType(n.type).create(n.attrs,o,r);return s.type.checkAttrs(s.attrs),s}};Os.prototype.text=void 0;class Qm extends Os{constructor(e,n,r,o){if(super(e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):XN(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Qm(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Qm(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function XN(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class ml{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new tW(e,n);if(r.next==null)return ml.empty;let o=JN(r);r.next&&r.err("Unexpected trailing text");let s=lW(aW(o));return cW(s,r),s}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let o=this;for(let s=n;o&&s<r;s++)o=o.matchType(e.child(s).type);return o}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let o=[this];function s(i,a){let l=i.matchFragment(e,r);if(l&&(!n||l.validEnd))return B.from(a.map(c=>c.createAndFill()));for(let c=0;c<i.next.length;c++){let{type:u,next:d}=i.next[c];if(!(u.isText||u.hasRequiredAttrs())&&o.indexOf(d)==-1){o.push(d);let h=s(d,a.concat(u));if(h)return h}}return null}return s(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let o=r.shift(),s=o.match;if(s.matchType(e)){let i=[];for(let a=o;a.type;a=a.via)i.push(a.type);return i.reverse()}for(let i=0;i<s.next.length;i++){let{type:a,next:l}=s.next[i];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in n)&&(!o.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:o}),n[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let o=0;o<r.next.length;o++)e.indexOf(r.next[o].next)==-1&&n(r.next[o].next)}return n(this),e.map((r,o)=>{let s=o+(r.validEnd?"*":" ")+" ";for(let i=0;i<r.next.length;i++)s+=(i?", ":"")+r.next[i].type.name+"->"+e.indexOf(r.next[i].next);return s}).join(`
`)}}ml.empty=new ml(!0);class tW{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function JN(t){let e=[];do e.push(nW(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function nW(t){let e=[];do e.push(rW(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function rW(t){let e=iW(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=oW(t,e);else break;return e}function t2(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function oW(t,e){let n=t2(t),r=n;return t.eat(",")&&(t.next!="}"?r=t2(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function sW(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let o=[];for(let s in n){let i=n[s];i.isInGroup(e)&&o.push(i)}return o.length==0&&t.err("No node type or group '"+e+"' found"),o}function iW(t){if(t.eat("(")){let e=JN(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=sW(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function aW(t){let e=[[]];return o(s(t,0),n()),e;function n(){return e.push([])-1}function r(i,a,l){let c={term:l,to:a};return e[i].push(c),c}function o(i,a){i.forEach(l=>l.to=a)}function s(i,a){if(i.type=="choice")return i.exprs.reduce((l,c)=>l.concat(s(c,a)),[]);if(i.type=="seq")for(let l=0;;l++){let c=s(i.exprs[l],a);if(l==i.exprs.length-1)return c;o(c,a=n())}else if(i.type=="star"){let l=n();return r(a,l),o(s(i.expr,l),l),[r(l)]}else if(i.type=="plus"){let l=n();return o(s(i.expr,a),l),o(s(i.expr,l),l),[r(l)]}else{if(i.type=="opt")return[r(a)].concat(s(i.expr,a));if(i.type=="range"){let l=a;for(let c=0;c<i.min;c++){let u=n();o(s(i.expr,l),u),l=u}if(i.max==-1)o(s(i.expr,l),l);else for(let c=i.min;c<i.max;c++){let u=n();r(l,u),o(s(i.expr,l),u),l=u}return[r(l)]}else{if(i.type=="name")return[r(a,void 0,i.value)];throw new Error("Unknown expr type")}}}}function QN(t,e){return e-t}function n2(t,e){let n=[];return r(e),n.sort(QN);function r(o){let s=t[o];if(s.length==1&&!s[0].term)return r(s[0].to);n.push(o);for(let i=0;i<s.length;i++){let{term:a,to:l}=s[i];!a&&n.indexOf(l)==-1&&r(l)}}}function lW(t){let e=Object.create(null);return n(n2(t,0));function n(r){let o=[];r.forEach(i=>{t[i].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<o.length;u++)o[u][0]==a&&(c=o[u][1]);n2(t,l).forEach(u=>{c||o.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let s=e[r.join(",")]=new ml(r.indexOf(t.length-1)>-1);for(let i=0;i<o.length;i++){let a=o[i][1].sort(QN);s.next.push({type:o[i][0],next:e[a.join(",")]||n(a)})}return s}}function cW(t,e){for(let n=0,r=[t];n<r.length;n++){let o=r[n],s=!o.validEnd,i=[];for(let a=0;a<o.next.length;a++){let{type:l,next:c}=o.next[a];i.push(l.name),s&&!(l.isText||l.hasRequiredAttrs())&&(s=!1),r.indexOf(c)==-1&&r.push(c)}s&&e.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function ZN(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function e4(t,e){let n=Object.create(null);for(let r in t){let o=e&&e[r];if(o===void 0){let s=t[r];if(s.hasDefault)o=s.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=o}return n}function t4(t,e,n,r){for(let o in e)if(!(o in t))throw new RangeError(`Unsupported attribute ${o} for ${n} of type ${o}`);for(let o in t){let s=t[o];s.validate&&s.validate(e[o])}}function n4(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new dW(t,r,e[r]);return n}let r2=class r4{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=n4(e,r.attrs),this.defaultAttrs=ZN(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ml.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:e4(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Os(this,this.computeAttrs(e),B.from(n),it.setFrom(r))}createChecked(e=null,n,r){return n=B.from(n),this.checkContent(n),new Os(this,this.computeAttrs(e),n,it.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=B.from(n),n.size){let i=this.contentMatch.fillBefore(n);if(!i)return null;n=i.append(n)}let o=this.contentMatch.matchFragment(n),s=o&&o.fillBefore(B.empty,!0);return s?new Os(this,e,n.append(s),it.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){t4(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:it.none:e}static compile(e,n){let r=Object.create(null);e.forEach((s,i)=>r[s]=new r4(s,n,i));let o=n.spec.topNode||"doc";if(!r[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function uW(t,e,n){let r=n.split("|");return o=>{let s=o===null?"null":typeof o;if(r.indexOf(s)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${s}`)}}class dW{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?uW(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Wy{constructor(e,n,r,o){this.name=e,this.rank=n,this.schema=r,this.spec=o,this.attrs=n4(e,o.attrs),this.excluded=null;let s=ZN(this.attrs);this.instance=s?new it(this,s):null}create(e=null){return!e&&this.instance?this.instance:new it(this,e4(this.attrs,e))}static compile(e,n){let r=Object.create(null),o=0;return e.forEach((s,i)=>r[s]=new Wy(s,o++,n,i)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){t4(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class o4{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let o in e)n[o]=e[o];n.nodes=un.from(e.nodes),n.marks=un.from(e.marks||{}),this.nodes=r2.compile(this.spec.nodes,this),this.marks=Wy.compile(this.spec.marks,this);let r=Object.create(null);for(let o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");let s=this.nodes[o],i=s.spec.content||"",a=s.spec.marks;if(s.contentMatch=r[i]||(r[i]=ml.parse(i,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=a=="_"?null:a?o2(this,a.split(" ")):a==""||!s.inlineContent?[]:null}for(let o in this.marks){let s=this.marks[o],i=s.spec.excludes;s.excluded=i==null?[s]:i==""?[]:o2(this,i.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,o){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof r2){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,o)}text(e,n){let r=this.nodes.text;return new Qm(r,r.defaultAttrs,e,it.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeFromJSON(e){return Os.fromJSON(this,e)}markFromJSON(e){return it.fromJSON(this,e)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function o2(t,e){let n=[];for(let r=0;r<e.length;r++){let o=e[r],s=t.marks[o],i=s;if(s)n.push(s);else for(let a in t.marks){let l=t.marks[a];(o=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(o)>-1)&&n.push(i=l)}if(!i)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function hW(t){return t.tag!=null}function fW(t){return t.style!=null}let Ls=class Z1{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(o=>{if(hW(o))this.tags.push(o);else if(fW(o)){let s=/[^=]*/.exec(o.style)[0];r.indexOf(s)<0&&r.push(s),this.styles.push(o)}}),this.normalizeLists=!this.tags.some(o=>{if(!/^(ul|ol)\b/.test(o.tag)||!o.node)return!1;let s=e.nodes[o.node];return s.contentMatch.matchType(s)})}parse(e,n={}){let r=new i2(this,n,!1);return r.addAll(e,it.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new i2(this,n,!0);return r.addAll(e,it.none,n.from,n.to),G.maxOpen(r.finish())}matchTag(e,n,r){for(let o=r?this.tags.indexOf(r)+1:0;o<this.tags.length;o++){let s=this.tags[o];if(gW(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||n.matchesContext(s.context))){if(s.getAttrs){let i=s.getAttrs(e);if(i===!1)continue;s.attrs=i||void 0}return s}}}matchStyle(e,n,r,o){for(let s=o?this.styles.indexOf(o)+1:0;s<this.styles.length;s++){let i=this.styles[s],a=i.style;if(!(a.indexOf(e)!=0||i.context&&!r.matchesContext(i.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=n))){if(i.getAttrs){let l=i.getAttrs(n);if(l===!1)continue;i.attrs=l||void 0}return i}}}static schemaRules(e){let n=[];function r(o){let s=o.priority==null?50:o.priority,i=0;for(;i<n.length;i++){let a=n[i];if((a.priority==null?50:a.priority)<s)break}n.splice(i,0,o)}for(let o in e.marks){let s=e.marks[o].spec.parseDOM;s&&s.forEach(i=>{r(i=a2(i)),i.mark||i.ignore||i.clearMark||(i.mark=o)})}for(let o in e.nodes){let s=e.nodes[o].spec.parseDOM;s&&s.forEach(i=>{r(i=a2(i)),i.node||i.ignore||i.mark||(i.node=o)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Z1(e,Z1.schemaRules(e)))}};const s4={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},pW={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},i4={ol:!0,ul:!0},ch=1,ew=2,gm=4;function s2(t,e,n){return e!=null?(e?ch:0)|(e==="full"?ew:0):t&&t.whitespace=="pre"?ch|ew:n&-5}class Ep{constructor(e,n,r,o,s,i){this.type=e,this.attrs=n,this.marks=r,this.solid=o,this.options=i,this.content=[],this.activeMarks=it.none,this.match=s||(i&gm?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(B.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,o;return(o=r.findWrapping(e.type))?(this.match=r,o):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&ch)){let r=this.content[this.content.length-1],o;if(r&&r.isText&&(o=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==o[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-o[0].length))}}let n=B.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(B.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!s4.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class i2{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let o=n.topNode,s,i=s2(null,n.preserveWhitespace,0)|(r?gm:0);o?s=new Ep(o.type,o.attrs,it.none,!0,n.topMatch||o.type.contentMatch,i):r?s=new Ep(null,null,it.none,!0,null,i):s=new Ep(e.schema.topNodeType,null,it.none,!0,null,i),this.nodes=[s],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,o=this.top,s=o.options&ew?"full":this.localPreserveWS||(o.options&ch)>0;if(s==="full"||o.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(s)s!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let i=o.content[o.content.length-1],a=e.previousSibling;(!i||a&&a.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let o=this.localPreserveWS,s=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let i=e.nodeName.toLowerCase(),a;i4.hasOwnProperty(i)&&this.parser.normalizeLists&&mW(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:pW.hasOwnProperty(i))this.findInside(e),this.ignoreFallback(e,n);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(s4.hasOwnProperty(i))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),c=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let d=l&&l.skip?n:this.readStyles(e,n);d&&this.addAll(e,d),c&&this.sync(s),this.needsBlock=u}else{let c=this.readStyles(e,n);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=o}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let o=0;o<this.parser.matchedStyles.length;o++){let s=this.parser.matchedStyles[o],i=r.getPropertyValue(s);if(i)for(let a=void 0;;){let l=this.parser.matchStyle(s,i,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?n=n.filter(c=>!l.clearMark(c)):n=n.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return n}addElementByRule(e,n,r,o){let s,i;if(n.node)if(i=this.parser.schema.nodes[n.node],i.isLeaf)this.insertNode(i.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let l=this.enter(i,n.attrs||null,r,n.preserveWhitespace);l&&(s=!0,r=l)}else{let l=this.parser.schema.marks[n.mark];r=r.concat(l.create(n.attrs))}let a=this.top;if(i&&i.isLeaf)this.findInside(e);else if(o)this.addElement(e,r,o);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=e;typeof n.contentElement=="string"?l=e.querySelector(n.contentElement):typeof n.contentElement=="function"?l=n.contentElement(e):n.contentElement&&(l=n.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}s&&this.sync(a)&&this.open--}addAll(e,n,r,o){let s=r||0;for(let i=r?e.childNodes[r]:e.firstChild,a=o==null?null:e.childNodes[o];i!=a;i=i.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(i,n);this.findAtPoint(e,s)}findPlace(e,n,r){let o,s;for(let i=this.open,a=0;i>=0;i--){let l=this.nodes[i],c=l.findWrapping(e);if(c&&(!o||o.length>c.length+a)&&(o=c,s=l,!c.length))break;if(l.solid){if(r)break;a+=2}}if(!o)return null;this.sync(s);for(let i=0;i<o.length;i++)n=this.enterInner(o[i],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(n=this.enterInner(s,null,n))}let o=this.findPlace(e,n,r);if(o){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(e.type));let i=it.none;for(let a of o.concat(e.marks))(s.type?s.type.allowsMarkType(a.type):l2(a.type,e.type))&&(i=a.addToSet(i));return s.content.push(e.mark(i)),!0}return!1}enter(e,n,r,o){let s=this.findPlace(e.create(n),r,!1);return s&&(s=this.enterInner(e,n,r,!0,o)),s}enterInner(e,n,r,o=!1,s){this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(e);let a=s2(e,s,i.options);i.options&gm&&i.content.length==0&&(a|=gm);let l=it.none;return r=r.filter(c=>(i.type?i.type.allowsMarkType(c.type):l2(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new Ep(e,n,l,o,null,a)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=ch)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let o=r.length-1;o>=0;o--)e+=r[o].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let o=0;o<this.find.length;o++)this.find[o].pos==null&&e.nodeType==1&&e.contains(this.find[o].node)&&n.compareDocumentPosition(this.find[o].node)&(r?2:4)&&(this.find[o].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(o?0:1),i=(a,l)=>{for(;a>=0;a--){let c=n[a];if(c==""){if(a==n.length-1||a==0)continue;for(;l>=s;l--)if(i(a-1,l))return!0;return!1}else{let u=l>0||l==0&&o?this.nodes[l].type:r&&l>=s?r.node(l-s).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return i(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function mW(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&i4.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function gW(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function a2(t){let e={};for(let n in t)e[n]=t[n];return e}function l2(t,e){let n=e.schema.nodes;for(let r in n){let o=n[r];if(!o.allowsMarkType(t))continue;let s=[],i=a=>{s.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||s.indexOf(u)<0&&i(u))return!0}};if(i(o.contentMatch))return!0}}class Js{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=J0(n).createDocumentFragment());let o=r,s=[];return e.forEach(i=>{if(s.length||i.marks.length){let a=0,l=0;for(;a<s.length&&l<i.marks.length;){let c=i.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(s[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<s.length;)o=s.pop()[1];for(;l<i.marks.length;){let c=i.marks[l++],u=this.serializeMark(c,i.isInline,n);u&&(s.push([c,o]),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(this.serializeNodeInner(i,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:o}=ym(J0(n),this.nodes[e.type.name](e),null,e.attrs);if(o){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,o)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let o=e.marks.length-1;o>=0;o--){let s=this.serializeMark(e.marks[o],e.isInline,n);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,n,r={}){let o=this.marks[e.type.name];return o&&ym(J0(r),o(e,n),null,e.attrs)}static renderSpec(e,n,r=null,o){return ym(e,n,r,o)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Js(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=c2(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return c2(e.marks)}}function c2(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function J0(t){return t.document||window.document}const u2=new WeakMap;function yW(t){let e=u2.get(t);return e===void 0&&u2.set(t,e=bW(t)),e}function bW(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let o=0;o<r.length;o++)n(r[o]);else for(let o in r)n(r[o])}return n(t),e}function ym(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let o=e[0],s;if(typeof o!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(s=yW(r))&&s.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let i=o.indexOf(" ");i>0&&(n=o.slice(0,i),o=o.slice(i+1));let a,l=n?t.createElementNS(n,o):t.createElement(o),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let d in c)if(c[d]!=null){let h=d.indexOf(" ");h>0?l.setAttributeNS(d.slice(0,h),d.slice(h+1),c[d]):l.setAttribute(d,c[d])}}for(let d=u;d<e.length;d++){let h=e[d];if(h===0){if(d<e.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:f,contentDOM:p}=ym(t,h,n,r);if(l.appendChild(f),p){if(a)throw new RangeError("Multiple content holes");a=p}}}return{dom:l,contentDOM:a}}const a4=65535,l4=Math.pow(2,16);function vW(t,e){return t+e*l4}function d2(t){return t&a4}function wW(t){return(t-(t&a4))/l4}const c4=1,u4=2,bm=4,d4=8;class tw{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&d4)>0}get deletedBefore(){return(this.delInfo&(c4|bm))>0}get deletedAfter(){return(this.delInfo&(u4|bm))>0}get deletedAcross(){return(this.delInfo&bm)>0}}class Cr{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Cr.empty)return Cr.empty}recover(e){let n=0,r=d2(e);if(!this.inverted)for(let o=0;o<r;o++)n+=this.ranges[o*3+2]-this.ranges[o*3+1];return this.ranges[r*3]+n+wW(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let o=0,s=this.inverted?2:1,i=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?o:0);if(l>e)break;let c=this.ranges[a+s],u=this.ranges[a+i],d=l+c;if(e<=d){let h=c?e==l?-1:e==d?1:n:n,f=l+o+(h<0?0:u);if(r)return f;let p=e==(n<0?l:d)?null:vW(a/3,e-l),y=e==l?u4:e==d?c4:bm;return(n<0?e!=l:e!=d)&&(y|=d4),new tw(f,y,p)}o+=u-c}return r?e+o:new tw(e+o,0,null)}touches(e,n){let r=0,o=d2(n),s=this.inverted?2:1,i=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+s],u=l+c;if(e<=u&&a==o*3)return!0;r+=this.ranges[a+i]-c}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let o=0,s=0;o<this.ranges.length;o+=3){let i=this.ranges[o],a=i-(this.inverted?s:0),l=i+(this.inverted?0:s),c=this.ranges[o+n],u=this.ranges[o+r];e(a,a+c,l,l+u),s+=u-c}}invert(){return new Cr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Cr.empty:new Cr(e<0?[0,-e,0]:[0,0,e])}}Cr.empty=new Cr([]);class Pc{constructor(e,n,r=0,o=e?e.length:0){this.mirror=n,this.from=r,this.to=o,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new Pc(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let o=e.getMirror(n);this.appendMap(e._maps[n],o!=null&&o<n?r+o:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let o=e.getMirror(n);this.appendMap(e._maps[n].invert(),o!=null&&o>n?r-o-1:void 0)}}invert(){let e=new Pc;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let o=0;for(let s=this.from;s<this.to;s++){let i=this._maps[s],a=i.mapResult(e,n);if(a.recover!=null){let l=this.getMirror(s);if(l!=null&&l>s&&l<this.to){s=l,e=this._maps[l].recover(a.recover);continue}}o|=a.delInfo,e=a.pos}return r?e:new tw(e,o,null)}}const Q0=Object.create(null);class $n{getMap(){return Cr.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Q0[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Q0)throw new RangeError("Duplicate use of step JSON ID "+e);return Q0[e]=n,n.prototype.jsonID=e,n}}class Ht{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new Ht(e,null)}static fail(e){return new Ht(null,e)}static fromReplace(e,n,r,o){try{return Ht.ok(e.replace(n,r,o))}catch(s){if(s instanceof Ym)return Ht.fail(s.message);throw s}}}function Tx(t,e,n){let r=[];for(let o=0;o<t.childCount;o++){let s=t.child(o);s.content.size&&(s=s.copy(Tx(s.content,e,s))),s.isInline&&(s=e(s,n,o)),r.push(s)}return B.fromArray(r)}class Di extends $n{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),o=r.node(r.sharedDepth(this.to)),s=new G(Tx(n.content,(i,a)=>!i.isAtom||!a.type.allowsMarkType(this.mark.type)?i:i.mark(this.mark.addToSet(i.marks)),o),n.openStart,n.openEnd);return Ht.fromReplace(e,this.from,this.to,s)}invert(){return new Bo(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Di(n.pos,r.pos,this.mark)}merge(e){return e instanceof Di&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Di(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Di(n.from,n.to,e.markFromJSON(n.mark))}}$n.jsonID("addMark",Di);class Bo extends $n{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new G(Tx(n.content,o=>o.mark(this.mark.removeFromSet(o.marks)),e),n.openStart,n.openEnd);return Ht.fromReplace(e,this.from,this.to,r)}invert(){return new Di(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Bo(n.pos,r.pos,this.mark)}merge(e){return e instanceof Bo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Bo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Bo(n.from,n.to,e.markFromJSON(n.mark))}}$n.jsonID("removeMark",Bo);class Ni extends $n{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Ht.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return Ht.fromReplace(e,this.pos,this.pos+1,new G(B.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let o=0;o<n.marks.length;o++)if(!n.marks[o].isInSet(r))return new Ni(this.pos,n.marks[o]);return new Ni(this.pos,this.mark)}}return new gl(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Ni(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Ni(n.pos,e.markFromJSON(n.mark))}}$n.jsonID("addNodeMark",Ni);class gl extends $n{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Ht.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return Ht.fromReplace(e,this.pos,this.pos+1,new G(B.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new Ni(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new gl(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new gl(n.pos,e.markFromJSON(n.mark))}}$n.jsonID("removeNodeMark",gl);class Bt extends $n{constructor(e,n,r,o=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=o}apply(e){return this.structure&&nw(e,this.from,this.to)?Ht.fail("Structure replace would overwrite content"):Ht.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Cr([this.from,this.to-this.from,this.slice.size])}invert(e){return new Bt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new Bt(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Bt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?G.empty:new G(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Bt(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?G.empty:new G(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Bt(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Bt(n.from,n.to,G.fromJSON(e,n.slice),!!n.structure)}}$n.jsonID("replace",Bt);class Nt extends $n{constructor(e,n,r,o,s,i,a=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=o,this.slice=s,this.insert=i,this.structure=a}apply(e){if(this.structure&&(nw(e,this.from,this.gapFrom)||nw(e,this.gapTo,this.to)))return Ht.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return Ht.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?Ht.fromReplace(e,this.from,this.to,r):Ht.fail("Content does not fit in gap")}getMap(){return new Cr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new Nt(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),o=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),s=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||o<n.pos||s>r.pos?null:new Nt(n.pos,r.pos,o,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Nt(n.from,n.to,n.gapFrom,n.gapTo,G.fromJSON(e,n.slice),n.insert,!!n.structure)}}$n.jsonID("replaceAround",Nt);function nw(t,e,n){let r=t.resolve(e),o=n-e,s=r.depth;for(;o>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,o--;if(o>0){let i=r.node(s).maybeChild(r.indexAfter(s));for(;o>0;){if(!i||i.isLeaf)return!0;i=i.firstChild,o--}}return!1}function CW(t,e,n,r){let o=[],s=[],i,a;t.doc.nodesBetween(e,n,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let h=Math.max(c,e),f=Math.min(c+l.nodeSize,n),p=r.addToSet(d);for(let y=0;y<d.length;y++)d[y].isInSet(p)||(i&&i.to==h&&i.mark.eq(d[y])?i.to=f:o.push(i=new Bo(h,f,d[y])));a&&a.to==h?a.to=f:s.push(a=new Di(h,f,r))}}),o.forEach(l=>t.step(l)),s.forEach(l=>t.step(l))}function xW(t,e,n,r){let o=[],s=0;t.doc.nodesBetween(e,n,(i,a)=>{if(!i.isInline)return;s++;let l=null;if(r instanceof Wy){let c=i.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(i.marks)&&(l=[r]):l=i.marks;if(l&&l.length){let c=Math.min(a+i.nodeSize,n);for(let u=0;u<l.length;u++){let d=l[u],h;for(let f=0;f<o.length;f++){let p=o[f];p.step==s-1&&d.eq(o[f].style)&&(h=p)}h?(h.to=c,h.step=s):o.push({style:d,from:Math.max(a,e),to:c,step:s})}}}),o.forEach(i=>t.step(new Bo(i.from,i.to,i.style)))}function _x(t,e,n,r=n.contentMatch,o=!0){let s=t.doc.nodeAt(e),i=[],a=e+1;for(let l=0;l<s.childCount;l++){let c=s.child(l),u=a+c.nodeSize,d=r.matchType(c.type);if(!d)i.push(new Bt(a,u,G.empty));else{r=d;for(let h=0;h<c.marks.length;h++)n.allowsMarkType(c.marks[h].type)||t.step(new Bo(a,u,c.marks[h]));if(o&&c.isText&&n.whitespace!="pre"){let h,f=/\r?\n|\r/g,p;for(;h=f.exec(c.text);)p||(p=new G(B.from(n.schema.text(" ",n.allowedMarks(c.marks))),0,0)),i.push(new Bt(a+h.index,a+h.index+h[0].length,p))}}a=u}if(!r.validEnd){let l=r.fillBefore(B.empty,!0);t.replace(a,a,new G(l,0,0))}for(let l=i.length-1;l>=0;l--)t.step(i[l])}function kW(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function su(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let o=t.$from.node(r),s=t.$from.index(r),i=t.$to.indexAfter(r);if(r<t.depth&&o.canReplace(s,i,n))return r;if(r==0||o.type.spec.isolating||!kW(o,s,i))break}return null}function SW(t,e,n){let{$from:r,$to:o,depth:s}=e,i=r.before(s+1),a=o.after(s+1),l=i,c=a,u=B.empty,d=0;for(let p=s,y=!1;p>n;p--)y||r.index(p)>0?(y=!0,u=B.from(r.node(p).copy(u)),d++):l--;let h=B.empty,f=0;for(let p=s,y=!1;p>n;p--)y||o.after(p+1)<o.end(p)?(y=!0,h=B.from(o.node(p).copy(h)),f++):c++;t.step(new Nt(l,c,i,a,new G(u.append(h),d,f),u.size-d,!0))}function h4(t,e,n=null,r=t){let o=EW(t,e),s=o&&TW(r,e);return s?o.map(h2).concat({type:e,attrs:n}).concat(s.map(h2)):null}function h2(t){return{type:t,attrs:null}}function EW(t,e){let{parent:n,startIndex:r,endIndex:o}=t,s=n.contentMatchAt(r).findWrapping(e);if(!s)return null;let i=s.length?s[0]:e;return n.canReplaceWith(r,o,i)?s:null}function TW(t,e){let{parent:n,startIndex:r,endIndex:o}=t,s=n.child(r),i=e.contentMatch.findWrapping(s.type);if(!i)return null;let l=(i.length?i[i.length-1]:e).contentMatch;for(let c=r;l&&c<o;c++)l=l.matchType(n.child(c).type);return!l||!l.validEnd?null:i}function _W(t,e,n){let r=B.empty;for(let i=n.length-1;i>=0;i--){if(r.size){let a=n[i].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=B.from(n[i].type.create(n[i].attrs,r))}let o=e.start,s=e.end;t.step(new Nt(o,s,o,s,new G(r,0,0),n.length,!0))}function AW(t,e,n,r,o){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,n,(i,a)=>{let l=typeof o=="function"?o(i):o;if(i.isTextblock&&!i.hasMarkup(r,l)&&IW(t.doc,t.mapping.slice(s).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let f=r.whitespace=="pre",p=!!r.contentMatch.matchType(r.schema.linebreakReplacement);f&&!p?c=!1:!f&&p&&(c=!0)}c===!1&&p4(t,i,a,s),_x(t,t.mapping.slice(s).map(a,1),r,void 0,c===null);let u=t.mapping.slice(s),d=u.map(a,1),h=u.map(a+i.nodeSize,1);return t.step(new Nt(d,h,d+1,h-1,new G(B.from(r.create(l,null,i.marks)),0,0),1,!0)),c===!0&&f4(t,i,a,s),!1}})}function f4(t,e,n,r){e.forEach((o,s)=>{if(o.isText){let i,a=/\r?\n|\r/g;for(;i=a.exec(o.text);){let l=t.mapping.slice(r).map(n+1+s+i.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function p4(t,e,n,r){e.forEach((o,s)=>{if(o.type==o.type.schema.linebreakReplacement){let i=t.mapping.slice(r).map(n+1+s);t.replaceWith(i,i+1,e.type.schema.text(`
`))}})}function IW(t,e,n){let r=t.resolve(e),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}function MW(t,e,n,r,o){let s=t.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let i=n.create(r,null,o||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,i);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new Nt(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new G(B.from(i),0,0),1,!0))}function Vs(t,e,n=1,r){let o=t.resolve(e),s=o.depth-n,i=r&&r[r.length-1]||o.parent;if(s<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!i.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let c=o.depth-1,u=n-2;c>s;c--,u--){let d=o.node(c),h=o.index(c);if(d.type.spec.isolating)return!1;let f=d.content.cutByIndex(h,d.childCount),p=r&&r[u+1];p&&(f=f.replaceChild(0,p.type.create(p.attrs)));let y=r&&r[u]||d;if(!d.canReplace(h+1,d.childCount)||!y.type.validContent(f))return!1}let a=o.indexAfter(s),l=r&&r[0];return o.node(s).canReplaceWith(a,a,l?l.type:o.node(s+1).type)}function RW(t,e,n=1,r){let o=t.doc.resolve(e),s=B.empty,i=B.empty;for(let a=o.depth,l=o.depth-n,c=n-1;a>l;a--,c--){s=B.from(o.node(a).copy(s));let u=r&&r[c];i=B.from(u?u.type.create(u.attrs,i):o.node(a).copy(i))}t.step(new Bt(e,e,new G(s.append(i),n,n),!0))}function Dl(t,e){let n=t.resolve(e),r=n.index();return m4(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function PW(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let o=0;o<e.childCount;o++){let s=e.child(o),i=s.type==r?t.type.schema.nodes.text:s.type;if(n=n.matchType(i),!n||!t.type.allowsMarks(s.marks))return!1}return n.validEnd}function m4(t,e){return!!(t&&e&&!t.isLeaf&&PW(t,e))}function qy(t,e,n=-1){let r=t.resolve(e);for(let o=r.depth;;o--){let s,i,a=r.index(o);if(o==r.depth?(s=r.nodeBefore,i=r.nodeAfter):n>0?(s=r.node(o+1),a++,i=r.node(o).maybeChild(a)):(s=r.node(o).maybeChild(a-1),i=r.node(o+1)),s&&!s.isTextblock&&m4(s,i)&&r.node(o).canReplace(a,a+1))return e;if(o==0)break;e=n<0?r.before(o):r.after(o)}}function DW(t,e,n){let r=null,{linebreakReplacement:o}=t.doc.type.schema,s=t.doc.resolve(e-n),i=s.node().type;if(o&&i.inlineContent){let u=i.whitespace=="pre",d=!!i.contentMatch.matchType(o);u&&!d?r=!1:!u&&d&&(r=!0)}let a=t.steps.length;if(r===!1){let u=t.doc.resolve(e+n);p4(t,u.node(),u.before(),a)}i.inlineContent&&_x(t,e+n-1,i,s.node().contentMatchAt(s.index()),r==null);let l=t.mapping.slice(a),c=l.map(e-n);if(t.step(new Bt(c,l.map(e+n,-1),G.empty,!0)),r===!0){let u=t.doc.resolve(c);f4(t,u.node(),u.before(),t.steps.length)}return t}function NW(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let o=r.depth-1;o>=0;o--){let s=r.index(o);if(r.node(o).canReplaceWith(s,s,n))return r.before(o+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let o=r.depth-1;o>=0;o--){let s=r.indexAfter(o);if(r.node(o).canReplaceWith(s,s,n))return r.after(o+1);if(s<r.node(o).childCount)return null}return null}function g4(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let o=n.content;for(let s=0;s<n.openStart;s++)o=o.firstChild.content;for(let s=1;s<=(n.openStart==0&&n.size?2:1);s++)for(let i=r.depth;i>=0;i--){let a=i==r.depth?0:r.pos<=(r.start(i+1)+r.end(i+1))/2?-1:1,l=r.index(i)+(a>0?1:0),c=r.node(i),u=!1;if(s==1)u=c.canReplace(l,l,o);else{let d=c.contentMatchAt(l).findWrapping(o.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(i+1):r.after(i+1)}return null}function Gy(t,e,n=e,r=G.empty){if(e==n&&!r.size)return null;let o=t.resolve(e),s=t.resolve(n);return y4(o,s,r)?new Bt(e,n,r):new OW(o,s,r).fit()}function y4(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class OW{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=B.empty;for(let o=0;o<=e.depth;o++){let s=e.node(o);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(o))})}for(let o=e.depth;o>0;o--)this.placed=B.from(e.node(o).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(e<0?this.$to:r.doc.resolve(e));if(!o)return null;let s=this.placed,i=r.depth,a=o.depth;for(;i&&a&&s.childCount==1;)s=s.firstChild.content,i--,a--;let l=new G(s,i,a);return e>-1?new Nt(r.pos,e,this.$to.pos,this.$to.end(),l,n):l.size||r.pos!=this.$to.pos?new Bt(r.pos,o.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,o=this.unplaced.openEnd;r<e;r++){let s=n.firstChild;if(n.childCount>1&&(o=0),s.type.spec.isolating&&o<=r){e=r;break}n=s.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let o,s=null;r?(s=Z0(this.unplaced.content,r-1).firstChild,o=s.content):o=this.unplaced.content;let i=o.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(n==1&&(i?c.matchType(i.type)||(d=c.fillBefore(B.from(i),!1)):s&&l.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:a,parent:s,inject:d};if(n==2&&i&&(u=c.findWrapping(i.type)))return{sliceDepth:r,frontierDepth:a,parent:s,wrap:u};if(s&&c.matchType(s.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,o=Z0(e,n);return!o.childCount||o.firstChild.isLeaf?!1:(this.unplaced=new G(e,n+1,Math.max(r,o.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,o=Z0(e,n);if(o.childCount<=1&&n>0){let s=e.size-n<=n+o.size;this.unplaced=new G(fd(e,n-1,1),n-1,s?n-1:r)}else this.unplaced=new G(fd(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:o,wrap:s}){for(;this.depth>n;)this.closeFrontierNode();if(s)for(let y=0;y<s.length;y++)this.openFrontierNode(s[y]);let i=this.unplaced,a=r?r.content:i.content,l=i.openStart-e,c=0,u=[],{match:d,type:h}=this.frontier[n];if(o){for(let y=0;y<o.childCount;y++)u.push(o.child(y));d=d.matchFragment(o)}let f=a.size+e-(i.content.size-i.openEnd);for(;c<a.childCount;){let y=a.child(c),b=d.matchType(y.type);if(!b)break;c++,(c>1||l==0||y.content.size)&&(d=b,u.push(b4(y.mark(h.allowedMarks(y.marks)),c==1?l:0,c==a.childCount?f:-1)))}let p=c==a.childCount;p||(f=-1),this.placed=pd(this.placed,n,B.from(u)),this.frontier[n].match=d,p&&f<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let y=0,b=a;y<f;y++){let w=b.lastChild;this.frontier.push({type:w.type,match:w.contentMatchAt(w.childCount)}),b=w.content}this.unplaced=p?e==0?G.empty:new G(fd(i.content,e-1,1),e-1,f<0?i.openEnd:e-1):new G(fd(i.content,e,c),i.openStart,i.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!ev(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,o=this.$to.after(r);for(;r>1&&o==this.$to.end(--r);)++o;return o}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:o}=this.frontier[n],s=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),i=ev(e,n,o,r,s);if(i){for(let a=n-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=ev(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:n,fit:i,move:s?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=pd(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let o=e.node(r),s=o.type.contentMatch.fillBefore(o.content,!0,e.index(r));this.openFrontierNode(o.type,o.attrs,s)}return e}openFrontierNode(e,n=null,r){let o=this.frontier[this.depth];o.match=o.match.matchType(e),this.placed=pd(this.placed,this.depth,B.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(B.empty,!0);n.childCount&&(this.placed=pd(this.placed,this.frontier.length,n))}}function fd(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(fd(t.firstChild.content,e-1,n)))}function pd(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(pd(t.lastChild.content,e-1,n)))}function Z0(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function b4(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,b4(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(B.empty,!0)))),t.copy(r)}function ev(t,e,n,r,o){let s=t.node(e),i=o?t.indexAfter(e):t.index(e);if(i==s.childCount&&!n.compatibleContent(s.type))return null;let a=r.fillBefore(s.content,!0,i);return a&&!LW(n,s.content,i)?a:null}function LW(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function VW(t){return t.spec.defining||t.spec.definingForContent}function jW(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let o=t.doc.resolve(e),s=t.doc.resolve(n);if(y4(o,s,r))return t.step(new Bt(e,n,r));let i=w4(o,t.doc.resolve(n));i[i.length-1]==0&&i.pop();let a=-(o.depth+1);i.unshift(a);for(let h=o.depth,f=o.pos-1;h>0;h--,f--){let p=o.node(h).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;i.indexOf(h)>-1?a=h:o.before(h)==f&&i.splice(1,0,-h)}let l=i.indexOf(a),c=[],u=r.openStart;for(let h=r.content,f=0;;f++){let p=h.firstChild;if(c.push(p),f==r.openStart)break;h=p.content}for(let h=u-1;h>=0;h--){let f=c[h],p=VW(f.type);if(p&&!f.sameMarkup(o.node(Math.abs(a)-1)))u=h;else if(p||!f.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let f=(h+u+1)%(r.openStart+1),p=c[f];if(p)for(let y=0;y<i.length;y++){let b=i[(y+l)%i.length],w=!0;b<0&&(w=!1,b=-b);let k=o.node(b-1),x=o.index(b-1);if(k.canReplaceWith(x,x,p.type,p.marks))return t.replace(o.before(b),w?s.after(b):n,new G(v4(r.content,0,r.openStart,f),f,r.openEnd))}}let d=t.steps.length;for(let h=i.length-1;h>=0&&(t.replace(e,n,r),!(t.steps.length>d));h--){let f=i[h];f<0||(e=o.before(f),n=s.after(f))}}function v4(t,e,n,r,o){if(e<n){let s=t.firstChild;t=t.replaceChild(0,s.copy(v4(s.content,e+1,n,r,s)))}if(e>r){let s=o.contentMatchAt(0),i=s.fillBefore(t).append(t);t=i.append(s.matchFragment(i).fillBefore(B.empty,!0))}return t}function BW(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let o=NW(t.doc,e,r.type);o!=null&&(e=n=o)}t.replaceRange(e,n,new G(B.from(r),0,0))}function $W(t,e,n){let r=t.doc.resolve(e),o=t.doc.resolve(n),s=w4(r,o);for(let i=0;i<s.length;i++){let a=s[i],l=i==s.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return t.delete(r.start(a),o.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),o.indexAfter(a-1))))return t.delete(r.before(a),o.after(a))}for(let i=1;i<=r.depth&&i<=o.depth;i++)if(e-r.start(i)==r.depth-i&&n>r.end(i)&&o.end(i)-n!=o.depth-i&&r.start(i-1)==o.start(i-1)&&r.node(i-1).canReplace(r.index(i-1),o.index(i-1)))return t.delete(r.before(i),n);t.delete(e,n)}function w4(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let o=r;o>=0;o--){let s=t.start(o);if(s<t.pos-(t.depth-o)||e.end(o)>e.pos+(e.depth-o)||t.node(o).type.spec.isolating||e.node(o).type.spec.isolating)break;(s==e.start(o)||o==t.depth&&o==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&o&&e.start(o-1)==s-1)&&n.push(o)}return n}class bc extends $n{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return Ht.fail("No node at attribute step's position");let r=Object.create(null);for(let s in n.attrs)r[s]=n.attrs[s];r[this.attr]=this.value;let o=n.type.create(r,null,n.marks);return Ht.fromReplace(e,this.pos,this.pos+1,new G(B.from(o),0,n.isLeaf?0:1))}getMap(){return Cr.empty}invert(e){return new bc(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new bc(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new bc(n.pos,n.attr,n.value)}}$n.jsonID("attr",bc);class uh extends $n{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let o in e.attrs)n[o]=e.attrs[o];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return Ht.ok(r)}getMap(){return Cr.empty}invert(e){return new uh(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new uh(n.attr,n.value)}}$n.jsonID("docAttr",uh);let Dc=class extends Error{};Dc=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};Dc.prototype=Object.create(Error.prototype);Dc.prototype.constructor=Dc;Dc.prototype.name="TransformError";class Ax{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Pc}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new Dc(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=G.empty){let o=Gy(this.doc,e,n,r);return o&&this.step(o),this}replaceWith(e,n,r){return this.replace(e,n,new G(B.from(r),0,0))}delete(e,n){return this.replace(e,n,G.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return jW(this,e,n,r),this}replaceRangeWith(e,n,r){return BW(this,e,n,r),this}deleteRange(e,n){return $W(this,e,n),this}lift(e,n){return SW(this,e,n),this}join(e,n=1){return DW(this,e,n),this}wrap(e,n){return _W(this,e,n),this}setBlockType(e,n=e,r,o=null){return AW(this,e,n,r,o),this}setNodeMarkup(e,n,r=null,o){return MW(this,e,n,r,o),this}setNodeAttribute(e,n,r){return this.step(new bc(e,n,r)),this}setDocAttribute(e,n){return this.step(new uh(e,n)),this}addNodeMark(e,n){return this.step(new Ni(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof it)n.isInSet(r.marks)&&this.step(new gl(e,n));else{let o=r.marks,s,i=[];for(;s=n.isInSet(o);)i.push(new gl(e,s)),o=s.removeFromSet(o);for(let a=i.length-1;a>=0;a--)this.step(i[a])}return this}split(e,n=1,r){return RW(this,e,n,r),this}addMark(e,n,r){return CW(this,e,n,r),this}removeMark(e,n,r){return xW(this,e,n,r),this}clearIncompatible(e,n,r){return _x(this,e,n,r),this}}const tv=Object.create(null);class fe{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new C4(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=G.empty){let r=n.content.lastChild,o=null;for(let a=0;a<n.openEnd;a++)o=r,r=r.lastChild;let s=e.steps.length,i=this.ranges;for(let a=0;a<i.length;a++){let{$from:l,$to:c}=i[a],u=e.mapping.slice(s);e.replaceRange(u.map(l.pos),u.map(c.pos),a?G.empty:n),a==0&&m2(e,s,(r?r.isInline:o&&o.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,o=this.ranges;for(let s=0;s<o.length;s++){let{$from:i,$to:a}=o[s],l=e.mapping.slice(r),c=l.map(i.pos),u=l.map(a.pos);s?e.deleteRange(c,u):(e.replaceRangeWith(c,u,n),m2(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let o=e.parent.inlineContent?new ee(e):nc(e.node(0),e.parent,e.pos,e.index(),n,r);if(o)return o;for(let s=e.depth-1;s>=0;s--){let i=n<0?nc(e.node(0),e.node(s),e.before(s+1),e.index(s),n,r):nc(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,n,r);if(i)return i}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new hr(e.node(0))}static atStart(e){return nc(e,e,0,0,1)||new hr(e)}static atEnd(e){return nc(e,e,e.content.size,e.childCount,-1)||new hr(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=tv[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in tv)throw new RangeError("Duplicate use of selection JSON ID "+e);return tv[e]=n,n.prototype.jsonID=e,n}getBookmark(){return ee.between(this.$anchor,this.$head).getBookmark()}}fe.prototype.visible=!0;class C4{constructor(e,n){this.$from=e,this.$to=n}}let f2=!1;function p2(t){!f2&&!t.parent.inlineContent&&(f2=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class ee extends fe{constructor(e,n=e){p2(e),p2(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return fe.near(r);let o=e.resolve(n.map(this.anchor));return new ee(o.parent.inlineContent?o:r,r)}replace(e,n=G.empty){if(super.replace(e,n),n==G.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof ee&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Ky(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ee(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let o=e.resolve(n);return new this(o,r==n?o:e.resolve(r))}static between(e,n,r){let o=e.pos-n.pos;if((!r||o)&&(r=o>=0?1:-1),!n.parent.inlineContent){let s=fe.findFrom(n,r,!0)||fe.findFrom(n,-r,!0);if(s)n=s.$head;else return fe.near(n,r)}return e.parent.inlineContent||(o==0?e=n:(e=(fe.findFrom(e,-r,!0)||fe.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=o<0&&(e=n))),new ee(e,n)}}fe.jsonID("text",ee);class Ky{constructor(e,n){this.anchor=e,this.head=n}map(e){return new Ky(e.map(this.anchor),e.map(this.head))}resolve(e){return ee.between(e.resolve(this.anchor),e.resolve(this.head))}}class se extends fe{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:o}=n.mapResult(this.anchor),s=e.resolve(o);return r?fe.near(s):new se(s)}content(){return new G(B.from(this.node),0,0)}eq(e){return e instanceof se&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Ix(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new se(e.resolve(n.anchor))}static create(e,n){return new se(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}se.prototype.visible=!1;fe.jsonID("node",se);class Ix{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new Ky(r,r):new Ix(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&se.isSelectable(r)?new se(n):fe.near(n)}}class hr extends fe{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=G.empty){if(n==G.empty){e.delete(0,e.doc.content.size);let r=fe.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new hr(e)}map(e){return new hr(e)}eq(e){return e instanceof hr}getBookmark(){return FW}}fe.jsonID("all",hr);const FW={map(){return this},resolve(t){return new hr(t)}};function nc(t,e,n,r,o,s=!1){if(e.inlineContent)return ee.create(t,n);for(let i=r-(o>0?0:1);o>0?i<e.childCount:i>=0;i+=o){let a=e.child(i);if(a.isAtom){if(!s&&se.isSelectable(a))return se.create(t,n-(o<0?a.nodeSize:0))}else{let l=nc(t,a,n+o,o<0?a.childCount:0,o,s);if(l)return l}n+=a.nodeSize*o}return null}function m2(t,e,n){let r=t.steps.length-1;if(r<e)return;let o=t.steps[r];if(!(o instanceof Bt||o instanceof Nt))return;let s=t.mapping.maps[r],i;s.forEach((a,l,c,u)=>{i==null&&(i=u)}),t.setSelection(fe.near(t.doc.resolve(i),n))}const g2=1,y2=2,b2=4;let HW=class extends Ax{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|g2)&-3,this.storedMarks=null,this}get selectionSet(){return(this.updated&g2)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=y2,this}ensureMarks(e){return it.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&y2)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&-3,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||it.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let o=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(o.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),r=r??n,!e)return this.deleteRange(n,r);let s=this.storedMarks;if(!s){let i=this.doc.resolve(n);s=r==n?i.marks():i.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,o.text(e,s)),this.selection.empty||this.setSelection(fe.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=b2,this}get scrolledIntoView(){return(this.updated&b2)>0}};function v2(t,e){return!e||!t?t:t.bind(e)}class md{constructor(e,n,r){this.name=e,this.init=v2(n.init,r),this.apply=v2(n.apply,r)}}const zW=[new md("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new md("selection",{init(t,e){return t.selection||fe.atStart(e.doc)},apply(t){return t.selection}}),new md("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new md("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class nv{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=zW.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new md(r.key,r.spec.state,r))})}}class Ya{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let o=this.config.plugins[r];if(o.spec.filterTransaction&&!o.spec.filterTransaction.call(o,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),o=null;for(;;){let s=!1;for(let i=0;i<this.config.plugins.length;i++){let a=this.config.plugins[i];if(a.spec.appendTransaction){let l=o?o[i].n:0,c=o?o[i].state:this,u=l<n.length&&a.spec.appendTransaction.call(a,l?n.slice(l):n,c,r);if(u&&r.filterTransaction(u,i)){if(u.setMeta("appendedTransaction",e),!o){o=[];for(let d=0;d<this.config.plugins.length;d++)o.push(d<i?{state:r,n:n.length}:{state:this,n:0})}n.push(u),r=r.applyInner(u),s=!0}o&&(o[i]={state:r,n:n.length})}}if(!s)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new Ya(this.config),r=this.config.fields;for(let o=0;o<r.length;o++){let s=r[o];n[s.name]=s.apply(e,this[s.name],this,n)}return n}get tr(){return new HW(this)}static create(e){let n=new nv(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Ya(n);for(let o=0;o<n.fields.length;o++)r[n.fields[o].name]=n.fields[o].init(e,r);return r}reconfigure(e){let n=new nv(this.schema,e.plugins),r=n.fields,o=new Ya(n);for(let s=0;s<r.length;s++){let i=r[s].name;o[i]=this.hasOwnProperty(i)?this[i]:r[s].init(e,o)}return o}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let o=e[r],s=o.spec.state;s&&s.toJSON&&(n[r]=s.toJSON.call(o,this[o.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let o=new nv(e.schema,e.plugins),s=new Ya(o);return o.fields.forEach(i=>{if(i.name=="doc")s.doc=Os.fromJSON(e.schema,n.doc);else if(i.name=="selection")s.selection=fe.fromJSON(s.doc,n.selection);else if(i.name=="storedMarks")n.storedMarks&&(s.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==i.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(n,a)){s[i.name]=c.fromJSON.call(l,e,n[a],s);return}}s[i.name]=i.init(e,s)}}),s}}function x4(t,e,n){for(let r in t){let o=t[r];o instanceof Function?o=o.bind(e):r=="handleDOMEvents"&&(o=x4(o,e,{})),n[r]=o}return n}class Re{constructor(e){this.spec=e,this.props={},e.props&&x4(e.props,this,this.props),this.key=e.key?e.key.key:k4("plugin")}getState(e){return e[this.key]}}const rv=Object.create(null);function k4(t){return t in rv?t+"$"+ ++rv[t]:(rv[t]=0,t+"$")}class We{constructor(e="key"){this.key=k4(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const pn=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Nc=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let rw=null;const _s=function(t,e,n){let r=rw||(rw=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},UW=function(){rw=null},yl=function(t,e,n,r){return n&&(w2(t,e,n,r,-1)||w2(t,e,n,r,1))},WW=/^(img|br|input|textarea|hr)$/i;function w2(t,e,n,r,o){for(;;){if(t==n&&e==r)return!0;if(e==(o<0?0:Hr(t))){let s=t.parentNode;if(!s||s.nodeType!=1||mf(t)||WW.test(t.nodeName)||t.contentEditable=="false")return!1;e=pn(t)+(o<0?0:1),t=s}else if(t.nodeType==1){if(t=t.childNodes[e+(o<0?-1:0)],t.contentEditable=="false")return!1;e=o<0?Hr(t):0}else return!1}}function Hr(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function qW(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Hr(t)}else if(t.parentNode&&!mf(t))e=pn(t),t=t.parentNode;else return null}}function GW(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!mf(t))e=pn(t)+1,t=t.parentNode;else return null}}function KW(t,e,n){for(let r=e==0,o=e==Hr(t);r||o;){if(t==n)return!0;let s=pn(t);if(t=t.parentNode,!t)return!1;r=r&&s==0,o=o&&s==Hr(t)}}function mf(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Yy=function(t){return t.focusNode&&yl(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Ua(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function YW(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function XW(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Hr(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Hr(r.startContainer),r.startOffset)}}}const Jo=typeof navigator<"u"?navigator:null,C2=typeof document<"u"?document:null,pa=Jo&&Jo.userAgent||"",ow=/Edge\/(\d+)/.exec(pa),S4=/MSIE \d/.exec(pa),sw=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(pa),fr=!!(S4||sw||ow),Fi=S4?document.documentMode:sw?+sw[1]:ow?+ow[1]:0,wo=!fr&&/gecko\/(\d+)/i.test(pa);wo&&+(/Firefox\/(\d+)/.exec(pa)||[0,0])[1];const iw=!fr&&/Chrome\/(\d+)/.exec(pa),On=!!iw,E4=iw?+iw[1]:0,Jn=!fr&&!!Jo&&/Apple Computer/.test(Jo.vendor),Oc=Jn&&(/Mobile\/\w+/.test(pa)||!!Jo&&Jo.maxTouchPoints>2),Br=Oc||(Jo?/Mac/.test(Jo.platform):!1),JW=Jo?/Win/.test(Jo.platform):!1,Rs=/Android \d/.test(pa),gf=!!C2&&"webkitFontSmoothing"in C2.documentElement.style,QW=gf?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function ZW(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function bs(t,e){return typeof t=="number"?t:t[e]}function eq(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function x2(t,e,n){let r=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,s=t.dom.ownerDocument;for(let i=n||t.dom;i;){if(i.nodeType!=1){i=Nc(i);continue}let a=i,l=a==s.body,c=l?ZW(s):eq(a),u=0,d=0;if(e.top<c.top+bs(r,"top")?d=-(c.top-e.top+bs(o,"top")):e.bottom>c.bottom-bs(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+bs(o,"top")-c.top:e.bottom-c.bottom+bs(o,"bottom")),e.left<c.left+bs(r,"left")?u=-(c.left-e.left+bs(o,"left")):e.right>c.right-bs(r,"right")&&(u=e.right-c.right+bs(o,"right")),u||d)if(l)s.defaultView.scrollBy(u,d);else{let f=a.scrollLeft,p=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let y=a.scrollLeft-f,b=a.scrollTop-p;e={left:e.left-y,top:e.top-b,right:e.right-y,bottom:e.bottom-b}}let h=l?"fixed":getComputedStyle(i).position;if(/^(fixed|sticky)$/.test(h))break;i=h=="absolute"?i.offsetParent:Nc(i)}}function tq(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,o;for(let s=(e.left+e.right)/2,i=n+1;i<Math.min(innerHeight,e.bottom);i+=5){let a=t.root.elementFromPoint(s,i);if(!a||a==t.dom||!t.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=n-20){r=a,o=l.top;break}}return{refDOM:r,refTop:o,stack:T4(t.dom)}}function T4(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Nc(r));return e}function nq({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;_4(n,r==0?0:r-e)}function _4(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:o,left:s}=t[n];r.scrollTop!=o+e&&(r.scrollTop=o+e),r.scrollLeft!=s&&(r.scrollLeft=s)}}let ql=null;function rq(t){if(t.setActive)return t.setActive();if(ql)return t.focus(ql);let e=T4(t);t.focus(ql==null?{get preventScroll(){return ql={preventScroll:!0},!0}}:void 0),ql||(ql=!1,_4(e,0))}function A4(t,e){let n,r=2e8,o,s=0,i=e.top,a=e.top,l,c;for(let u=t.firstChild,d=0;u;u=u.nextSibling,d++){let h;if(u.nodeType==1)h=u.getClientRects();else if(u.nodeType==3)h=_s(u).getClientRects();else continue;for(let f=0;f<h.length;f++){let p=h[f];if(p.top<=i&&p.bottom>=a){i=Math.max(p.bottom,i),a=Math.min(p.top,a);let y=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(y<r){n=u,r=y,o=y&&n.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,u.nodeType==1&&y&&(s=d+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!l&&p.left<=e.left&&p.right>=e.left&&(l=u,c={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!n&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(s=d+1)}}return!n&&l&&(n=l,o=c,r=0),n&&n.nodeType==3?oq(n,o):!n||r&&n.nodeType==1?{node:t,offset:s}:A4(n,o)}function oq(t,e){let n=t.nodeValue.length,r=document.createRange();for(let o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);let s=xi(r,1);if(s.top!=s.bottom&&Mx(e,s))return{node:t,offset:o+(e.left>=(s.left+s.right)/2?1:0)}}return{node:t,offset:0}}function Mx(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function sq(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function iq(t,e,n){let{node:r,offset:o}=A4(e,n),s=-1;if(r.nodeType==1&&!r.firstChild){let i=r.getBoundingClientRect();s=i.left!=i.right&&n.left>(i.left+i.right)/2?1:-1}return t.docView.posFromDOM(r,o,s)}function aq(t,e,n,r){let o=-1;for(let s=e,i=!1;s!=t.dom;){let a=t.docView.nearestDesc(s,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&(!i&&l.left>r.left||l.top>r.top?o=a.posBefore:(!i&&l.right<r.left||l.bottom<r.top)&&(o=a.posAfter),i=!0),!a.contentDOM&&o<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;s=a.dom.parentNode}return o>-1?o:t.docView.posFromDOM(e,n,-1)}function I4(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let o=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),s=o;;){let i=t.childNodes[s];if(i.nodeType==1){let a=i.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(Mx(e,c))return I4(i,e,c)}}if((s=(s+1)%r)==o)break}return t}function lq(t,e){let n=t.dom.ownerDocument,r,o=0,s=XW(n,e.left,e.top);s&&({node:r,offset:o}=s);let i=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),a;if(!i||!t.dom.contains(i.nodeType!=1?i.parentNode:i)){let c=t.dom.getBoundingClientRect();if(!Mx(e,c)||(i=I4(t.dom,e,c),!i))return null}if(Jn)for(let c=i;r&&c;c=Nc(c))c.draggable&&(r=void 0);if(i=sq(i,e),r){if(wo&&r.nodeType==1&&(o=Math.min(o,r.childNodes.length),o<r.childNodes.length)){let u=r.childNodes[o],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&o++}let c;gf&&o&&r.nodeType==1&&(c=r.childNodes[o-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&o--,r==t.dom&&o==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=t.state.doc.content.size:(o==0||r.nodeType!=1||r.childNodes[o-1].nodeName!="BR")&&(a=aq(t,r,o,e))}a==null&&(a=iq(t,i,e));let l=t.docView.nearestDesc(i,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function k2(t){return t.top<t.bottom||t.left<t.right}function xi(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(k2(r))return r}return Array.prototype.find.call(n,k2)||t.getBoundingClientRect()}const cq=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function M4(t,e,n){let{node:r,offset:o,atom:s}=t.docView.domFromPos(e,n<0?-1:1),i=gf||wo;if(r.nodeType==3)if(i&&(cq.test(r.nodeValue)||(n<0?!o:o==r.nodeValue.length))){let l=xi(_s(r,o,o),n);if(wo&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){let c=xi(_s(r,o-1,o-1),-1);if(c.top==l.top){let u=xi(_s(r,o,o+1),-1);if(u.top!=l.top)return Ju(u,u.left<c.left)}}return l}else{let l=o,c=o,u=n<0?1:-1;return n<0&&!o?(c++,u=-1):n>=0&&o==r.nodeValue.length?(l--,u=1):n<0?l--:c++,Ju(xi(_s(r,l,c),u),u<0)}if(!t.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&o&&(n<0||o==Hr(r))){let l=r.childNodes[o-1];if(l.nodeType==1)return ov(l.getBoundingClientRect(),!1)}if(s==null&&o<Hr(r)){let l=r.childNodes[o];if(l.nodeType==1)return ov(l.getBoundingClientRect(),!0)}return ov(r.getBoundingClientRect(),n>=0)}if(s==null&&o&&(n<0||o==Hr(r))){let l=r.childNodes[o-1],c=l.nodeType==3?_s(l,Hr(l)-(i?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Ju(xi(c,1),!1)}if(s==null&&o<Hr(r)){let l=r.childNodes[o];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?_s(l,0,i?0:1):l.nodeType==1?l:null:null;if(c)return Ju(xi(c,-1),!0)}return Ju(xi(r.nodeType==3?_s(r):r,-n),n>=0)}function Ju(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function ov(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function R4(t,e,n){let r=t.state,o=t.root.activeElement;r!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),o!=t.dom&&o&&o.focus()}}function uq(t,e,n){let r=e.selection,o=n=="up"?r.$from:r.$to;return R4(t,e,()=>{let{node:s}=t.docView.domFromPos(o.pos,n=="up"?-1:1);for(;;){let a=t.docView.nearestDesc(s,!0);if(!a)break;if(a.node.isBlock){s=a.contentDOM||a.dom;break}s=a.dom.parentNode}let i=M4(t,o.pos,1);for(let a=s.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=_s(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(n=="up"?i.top-u.top>(u.bottom-i.top)*2:u.bottom-i.bottom>(i.bottom-u.top)*2))return!1}}return!0})}const dq=/[\u0590-\u08ac]/;function hq(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let o=r.parentOffset,s=!o,i=o==r.parent.content.size,a=t.domSelection();return a?!dq.test(r.parent.textContent)||!a.modify?n=="left"||n=="backward"?s:i:R4(t,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=t.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",n,"character");let f=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:p,focusOffset:y}=t.domSelectionRange(),b=p&&!f.contains(p.nodeType==1?p:p.parentNode)||l==p&&c==y;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch{}return h!=null&&(a.caretBidiLevel=h),b}):r.pos==r.start()||r.pos==r.end()}let S2=null,E2=null,T2=!1;function fq(t,e,n){return S2==e&&E2==n?T2:(S2=e,E2=n,T2=n=="up"||n=="down"?uq(t,e,n):hq(t,e,n))}const qr=0,_2=1,Xa=2,Qo=3;class yf{constructor(e,n,r,o){this.parent=e,this.children=n,this.dom=r,this.contentDOM=o,this.dirty=qr,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let o=this.children[n];if(o==e)return r;r+=o.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let s,i;if(e==this.contentDOM)s=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((i=s.pmViewDesc)&&i.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(i)+i.size:this.posAtStart}else{let s,i;if(e==this.contentDOM)s=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((i=s.pmViewDesc)&&i.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(i):this.posAtEnd}let o;if(e==this.dom&&this.contentDOM)o=n>pn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))o=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let s=e;;s=s.parentNode){if(s==this.dom){o=!1;break}if(s.previousSibling)break}if(o==null&&n==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){o=!0;break}if(s.nextSibling)break}}return o??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,o=e;o;o=o.parentNode){let s=this.getDesc(o),i;if(s&&(!n||s.node))if(r&&(i=s.nodeDOM)&&!(i.nodeType==1?i.contains(e.nodeType==1?e:e.parentNode):i==e))r=!1;else return s}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let o=e;o;o=o.parentNode){let s=this.getDesc(o);if(s)return s.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let o=this.children[n],s=r+o.size;if(r==e&&s!=r){for(;!o.border&&o.children.length;)for(let i=0;i<o.children.length;i++){let a=o.children[i];if(a.size){o=a;break}}return o}if(e<s)return o.descAt(e-r-o.border);r=s}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,o=0;for(let s=0;r<this.children.length;r++){let i=this.children[r],a=s+i.size;if(a>e||i instanceof D4){o=e-s;break}s=a}if(o)return this.children[r].domFromPos(o-this.children[r].border,n);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof P4&&s.side>=0;r--);if(n<=0){let s,i=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,i=!1);return s&&n&&i&&!s.border&&!s.domAtom?s.domFromPos(s.size,n):{node:this.contentDOM,offset:s?pn(s.dom)+1:0}}else{let s,i=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,i=!1);return s&&i&&!s.border&&!s.domAtom?s.domFromPos(0,n):{node:this.contentDOM,offset:s?pn(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let o=-1,s=-1;for(let i=r,a=0;;a++){let l=this.children[a],c=i+l.size;if(o==-1&&e<=c){let u=i+l.border;if(e>=u&&n<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,n,u);e=i;for(let d=a;d>0;d--){let h=this.children[d-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){o=pn(h.dom)+1;break}e-=h.size}o==-1&&(o=0)}if(o>-1&&(c>n||a==this.children.length-1)){n=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){s=pn(d.dom);break}n+=d.size}s==-1&&(s=this.contentDOM.childNodes.length);break}i=c}return{node:this.contentDOM,from:e,to:n,fromOffset:o,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,o=!1){let s=Math.min(e,n),i=Math.max(e,n);for(let f=0,p=0;f<this.children.length;f++){let y=this.children[f],b=p+y.size;if(s>p&&i<b)return y.setSelection(e-p-y.border,n-p-y.border,r,o);p=b}let a=this.domFromPos(e,e?-1:1),l=n==e?a:this.domFromPos(n,n?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),d=!1;if((wo||Jn)&&e==n){let{node:f,offset:p}=a;if(f.nodeType==3){if(d=!!(p&&f.nodeValue[p-1]==`
`),d&&p==f.nodeValue.length)for(let y=f,b;y;y=y.parentNode){if(b=y.nextSibling){b.nodeName=="BR"&&(a=l={node:b.parentNode,offset:pn(b)+1});break}let w=y.pmViewDesc;if(w&&w.node&&w.node.isBlock)break}}else{let y=f.childNodes[p-1];d=y&&(y.nodeName=="BR"||y.contentEditable=="false")}}if(wo&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let f=u.focusNode.childNodes[u.focusOffset];f&&f.contentEditable=="false"&&(o=!0)}if(!(o||d&&Jn)&&yl(a.node,a.offset,u.anchorNode,u.anchorOffset)&&yl(l.node,l.offset,u.focusNode,u.focusOffset))return;let h=!1;if((c.extend||e==n)&&!d){c.collapse(a.node,a.offset);try{e!=n&&c.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(e>n){let p=a;a=l,l=p}let f=document.createRange();f.setEnd(l.node,l.offset),f.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(f)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,o=0;o<this.children.length;o++){let s=this.children[o],i=r+s.size;if(r==i?e<=i&&n>=r:e<i&&n>r){let a=r+s.border,l=i-s.border;if(e>=a&&n<=l){this.dirty=e==r||n==i?Xa:_2,e==a&&n==l&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=Qo:s.markDirty(e-a,n-a);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?Xa:Qo}r=i}this.dirty=Xa}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?Xa:_2;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class P4 extends yf{constructor(e,n,r,o){let s,i=n.type.toDOM;if(typeof i=="function"&&(i=i(r,()=>{if(!s)return o;if(s.parent)return s.parent.posBeforeChild(s)})),!n.type.spec.raw){if(i.nodeType!=1){let a=document.createElement("span");a.appendChild(i),i=a}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(e,[],i,null),this.widget=n,this.widget=n,s=this}matchesWidget(e){return this.dirty==qr&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class pq extends yf{constructor(e,n,r,o){super(e,[],n,null),this.textDOM=r,this.text=o}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class bl extends yf{constructor(e,n,r,o,s){super(e,[],r,o),this.mark=n,this.spec=s}static create(e,n,r,o){let s=o.nodeViews[n.type.name],i=s&&s(n,o,r);return(!i||!i.dom)&&(i=Js.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new bl(e,n,i.dom,i.contentDOM||i.dom,i)}parseRule(){return this.dirty&Qo||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Qo&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=qr){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=qr}}slice(e,n,r){let o=bl.create(this.parent,this.mark,!0,r),s=this.children,i=this.size;n<i&&(s=lw(s,n,i,r)),e>0&&(s=lw(s,0,e,r));for(let a=0;a<s.length;a++)s[a].parent=o;return o.children=s,o}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Hi extends yf{constructor(e,n,r,o,s,i,a,l,c){super(e,[],s,i),this.node=n,this.outerDeco=r,this.innerDeco=o,this.nodeDOM=a}static create(e,n,r,o,s,i){let a=s.nodeViews[n.type.name],l,c=a&&a(n,s,()=>{if(!l)return i;if(l.parent)return l.parent.posBeforeChild(l)},r,o),u=c&&c.dom,d=c&&c.contentDOM;if(n.isText){if(!u)u=document.createTextNode(n.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=Js.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!d&&!n.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),n.type.spec.draggable&&(u.draggable=!0));let h=u;return u=L4(u,r,n),c?l=new mq(e,n,r,o,u,d||null,h,c,s,i+1):n.isText?new Xy(e,n,r,o,u,h,s):new Hi(e,n,r,o,u,d||null,h,s,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>B.empty)}return e}matchesNode(e,n,r){return this.dirty==qr&&e.eq(this.node)&&Zm(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,o=n,s=e.composing?this.localCompositionInfo(e,n):null,i=s&&s.pos>-1?s:null,a=s&&s.pos<0,l=new yq(this,i&&i.node,e);wq(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?it.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,o)},(c,u,d,h)=>{l.syncToMarks(c.marks,r,e);let f;l.findNodeMatch(c,u,d,h)||a&&e.state.selection.from>o&&e.state.selection.to<o+c.nodeSize&&(f=l.findIndexWithChild(s.node))>-1&&l.updateNodeAt(c,u,d,f,e)||l.updateNextNode(c,u,d,e,h,o)||l.addNode(c,u,d,e,o),o+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Xa)&&(i&&this.protectLocalComposition(e,i),N4(this.contentDOM,this.children,e),Oc&&Cq(this.dom))}localCompositionInfo(e,n){let{from:r,to:o}=e.state.selection;if(!(e.state.selection instanceof ee)||r<n||o>n+this.node.content.size)return null;let s=e.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let i=s.nodeValue,a=xq(this.node.content,i,r-n,o-n);return a<0?null:{node:s,pos:a,text:i}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:o}){if(this.getDesc(n))return;let s=n;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let i=new pq(this,s,n,o);e.input.compositionNodes.push(i),this.children=lw(this.children,r,r+o.length,e,i)}update(e,n,r,o){return this.dirty==Qo||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,o),!0)}updateInner(e,n,r,o){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(o,this.posAtStart),this.dirty=qr}updateOuterDeco(e){if(Zm(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=O4(this.dom,this.nodeDOM,aw(this.outerDeco,this.node,n),aw(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function A2(t,e,n,r,o){L4(r,e,t);let s=new Hi(void 0,t,e,n,r,r,r,o,0);return s.contentDOM&&s.updateChildren(o,0),s}class Xy extends Hi{constructor(e,n,r,o,s,i,a){super(e,n,r,o,s,null,i,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,o){return this.dirty==Qo||this.dirty!=qr&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=qr||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,o.trackWrites==this.nodeDOM&&(o.trackWrites=null)),this.node=e,this.dirty=qr,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let o=this.node.cut(e,n),s=document.createTextNode(o.text);return new Xy(this.parent,o,this.outerDeco,this.innerDeco,s,s,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Qo)}get domAtom(){return!1}isText(e){return this.node.text==e}}class D4 extends yf{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==qr&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class mq extends Hi{constructor(e,n,r,o,s,i,a,l,c,u){super(e,n,r,o,s,i,a,c,u),this.spec=l}update(e,n,r,o){if(this.dirty==Qo)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let s=this.spec.update(e,n,r);return s&&this.updateInner(e,n,r,o),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,o)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,o){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,o)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function N4(t,e,n){let r=t.firstChild,o=!1;for(let s=0;s<e.length;s++){let i=e[s],a=i.dom;if(a.parentNode==t){for(;a!=r;)r=I2(r),o=!0;r=r.nextSibling}else o=!0,t.insertBefore(a,r);if(i instanceof bl){let l=r?r.previousSibling:t.lastChild;N4(i.contentDOM,i.children,n),r=l?l.nextSibling:t.firstChild}}for(;r;)r=I2(r),o=!0;o&&n.trackWrites==t&&(n.trackWrites=null)}const Id=function(t){t&&(this.nodeName=t)};Id.prototype=Object.create(null);const Ja=[new Id];function aw(t,e,n){if(t.length==0)return Ja;let r=n?Ja[0]:new Id,o=[r];for(let s=0;s<t.length;s++){let i=t[s].type.attrs;if(i){i.nodeName&&o.push(r=new Id(i.nodeName));for(let a in i){let l=i[a];l!=null&&(n&&o.length==1&&o.push(r=new Id(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return o}function O4(t,e,n,r){if(n==Ja&&r==Ja)return e;let o=e;for(let s=0;s<r.length;s++){let i=r[s],a=n[s];if(s){let l;a&&a.nodeName==i.nodeName&&o!=t&&(l=o.parentNode)&&l.nodeName.toLowerCase()==i.nodeName||(l=document.createElement(i.nodeName),l.pmIsDeco=!0,l.appendChild(o),a=Ja[0]),o=l}gq(o,a||Ja[0],i)}return o}function gq(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],o=n.class?n.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)o.indexOf(r[s])==-1&&t.classList.remove(r[s]);for(let s=0;s<o.length;s++)r.indexOf(o[s])==-1&&t.classList.add(o[s]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,o;for(;o=r.exec(e.style);)t.style.removeProperty(o[1])}n.style&&(t.style.cssText+=n.style)}}function L4(t,e,n){return O4(t,t,Ja,aw(e,n,t.nodeType!=1))}function Zm(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function I2(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class yq{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=bq(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let o=0,s=this.stack.length>>1,i=Math.min(s,e.length);for(;o<i&&(o==s-1?this.top:this.stack[o+1<<1]).matchesMark(e[o])&&e[o].type.spec.spanning!==!1;)o++;for(;o<s;)this.destroyRest(),this.top.dirty=qr,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[s])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=bl.create(this.top,e[s],n,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,s++}}findNodeMatch(e,n,r,o){let s=-1,i;if(o>=this.preMatch.index&&(i=this.preMatch.matches[o-this.preMatch.index]).parent==this.top&&i.matchesNode(e,n,r))s=this.top.children.indexOf(i,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,n,r)&&!this.preMatch.matched.has(c)){s=a;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,n,r,o,s){let i=this.top.children[o];return i.dirty==Qo&&i.dom==i.contentDOM&&(i.dirty=Xa),i.update(e,n,r,s)?(this.destroyBetween(this.index,o),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let o=this.index;o<this.top.children.length;o++)if(this.top.children[o]==r)return o}return-1}e=n}}updateNextNode(e,n,r,o,s,i){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Hi){let c=this.preMatch.matched.get(l);if(c!=null&&c!=s)return!1;let u=l.dom,d,h=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Qo&&Zm(n,l.outerDeco));if(!h&&l.update(e,n,r,o))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!h&&(d=this.recreateWrapper(l,e,n,r,o,i)))return this.destroyBetween(this.index,a),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=Xa,d.updateChildren(o,i+1),d.dirty=qr),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,o,s,i){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Zm(r,e.outerDeco)||!o.eq(e.innerDeco))return null;let a=Hi.create(this.top,n,r,o,s,i);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,n,r,o,s){let i=Hi.create(this.top,e,n,r,o,s);i.contentDOM&&i.updateChildren(o,s+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(e,n,r){let o=this.index<this.top.children.length?this.top.children[this.index]:null;if(o&&o.matchesWidget(e)&&(e==o.widget||!o.widget.type.toDOM.parentNode))this.index++;else{let s=new P4(this.top,e,n,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof bl;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof Xy)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Jn||On)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let o=new D4(this.top,[],r,null);n!=this.top?n.children.push(o):n.children.splice(this.index++,0,o),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function bq(t,e){let n=e,r=n.children.length,o=t.childCount,s=new Map,i=[];e:for(;o>0;){let a;for(;;)if(r){let c=n.children[r-1];if(c instanceof bl)n=c,r=c.children.length;else{a=c,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=t.child(o-1))break;--o,s.set(a,o),i.push(a)}}return{index:o,matched:s,matches:i.reverse()}}function vq(t,e){return t.type.side-e.type.side}function wq(t,e,n,r){let o=e.locals(t),s=0;if(o.length==0){for(let c=0;c<t.childCount;c++){let u=t.child(c);r(u,o,e.forChild(s,u),c),s+=u.nodeSize}return}let i=0,a=[],l=null;for(let c=0;;){let u,d;for(;i<o.length&&o[i].to==s;){let b=o[i++];b.widget&&(u?(d||(d=[u])).push(b):u=b)}if(u)if(d){d.sort(vq);for(let b=0;b<d.length;b++)n(d[b],c,!!l)}else n(u,c,!!l);let h,f;if(l)f=-1,h=l,l=null;else if(c<t.childCount)f=c,h=t.child(c++);else break;for(let b=0;b<a.length;b++)a[b].to<=s&&a.splice(b--,1);for(;i<o.length&&o[i].from<=s&&o[i].to>s;)a.push(o[i++]);let p=s+h.nodeSize;if(h.isText){let b=p;i<o.length&&o[i].from<b&&(b=o[i].from);for(let w=0;w<a.length;w++)a[w].to<b&&(b=a[w].to);b<p&&(l=h.cut(b-s),h=h.cut(0,b-s),p=b,f=-1)}else for(;i<o.length&&o[i].to<p;)i++;let y=h.isInline&&!h.isLeaf?a.filter(b=>!b.inline):a.slice();r(h,y,e.forChild(s,h),f),s=p}}function Cq(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function xq(t,e,n,r){for(let o=0,s=0;o<t.childCount&&s<=r;){let i=t.child(o++),a=s;if(s+=i.nodeSize,!i.isText)continue;let l=i.text;for(;o<t.childCount;){let c=t.child(o++);if(s+=c.nodeSize,!c.isText)break;l+=c.text}if(s>=n){if(s>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=n)return a+c;if(n==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function lw(t,e,n,r,o){let s=[];for(let i=0,a=0;i<t.length;i++){let l=t[i],c=a,u=a+=l.size;c>=n||u<=e?s.push(l):(c<e&&s.push(l.slice(0,e-c,r)),o&&(s.push(o),o=void 0),u>n&&s.push(l.slice(n-c,l.size,r)))}return s}function Rx(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let o=t.docView.nearestDesc(n.focusNode),s=o&&o.size==0,i=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(i<0)return null;let a=r.resolve(i),l,c;if(Yy(n)){for(l=i;o&&!o.node;)o=o.parent;let d=o.node;if(o&&d.isAtom&&se.isSelectable(d)&&o.parent&&!(d.isInline&&KW(n.focusNode,n.focusOffset,o.dom))){let h=o.posBefore;c=new se(i==h?a:r.resolve(h))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let d=i,h=i;for(let f=0;f<n.rangeCount;f++){let p=n.getRangeAt(f);d=Math.min(d,t.docView.posFromDOM(p.startContainer,p.startOffset,1)),h=Math.max(h,t.docView.posFromDOM(p.endContainer,p.endOffset,-1))}if(d<0)return null;[l,i]=h==t.state.selection.anchor?[h,d]:[d,h],a=r.resolve(i)}else l=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let d=e=="pointer"||t.state.selection.head<a.pos&&!s?1:-1;c=Px(t,u,a,d)}return c}function V4(t){return t.editable?t.hasFocus():B4(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function js(t,e=!1){let n=t.state.selection;if(j4(t,n),!!V4(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&On){let r=t.domSelectionRange(),o=t.domObserver.currentSelection;if(r.anchorNode&&o.anchorNode&&yl(r.anchorNode,r.anchorOffset,o.anchorNode,o.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)Sq(t);else{let{anchor:r,head:o}=n,s,i;M2&&!(n instanceof ee)&&(n.$from.parent.inlineContent||(s=R2(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(i=R2(t,n.to))),t.docView.setSelection(r,o,t,e),M2&&(s&&P2(s),i&&P2(i)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&kq(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const M2=Jn||On&&E4<63;function R2(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),o=r<n.childNodes.length?n.childNodes[r]:null,s=r?n.childNodes[r-1]:null;if(Jn&&o&&o.contentEditable=="false")return sv(o);if((!o||o.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(o)return sv(o);if(s)return sv(s)}}function sv(t){return t.contentEditable="true",Jn&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function P2(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function kq(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=o)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!V4(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function Sq(t){let e=t.domSelection(),n=document.createRange();if(!e)return;let r=t.cursorWrapper.dom,o=r.nodeName=="IMG";o?n.setStart(r.parentNode,pn(r)+1):n.setStart(r,0),n.collapse(!0),e.removeAllRanges(),e.addRange(n),!o&&!t.state.selection.visible&&fr&&Fi<=11&&(r.disabled=!0,r.disabled=!1)}function j4(t,e){if(e instanceof se){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(D2(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else D2(t)}function D2(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Px(t,e,n,r){return t.someProp("createSelectionBetween",o=>o(t,e,n))||ee.between(e,n,r)}function N2(t){return t.editable&&!t.hasFocus()?!1:B4(t)}function B4(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function Eq(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return yl(e.node,e.offset,n.anchorNode,n.anchorOffset)}function cw(t,e){let{$anchor:n,$head:r}=t.selection,o=e>0?n.max(r):n.min(r),s=o.parent.inlineContent?o.depth?t.doc.resolve(e>0?o.after():o.before()):null:o;return s&&fe.findFrom(s,e)}function Si(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function O2(t,e,n){let r=t.state.selection;if(r instanceof ee)if(n.indexOf("s")>-1){let{$head:o}=r,s=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let i=t.state.doc.resolve(o.pos+s.nodeSize*(e<0?-1:1));return Si(t,new ee(r.$anchor,i))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let o=cw(t.state,e);return o&&o instanceof se?Si(t,o):!1}else if(!(Br&&n.indexOf("m")>-1)){let o=r.$head,s=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter,i;if(!s||s.isText)return!1;let a=e<0?o.pos-s.nodeSize:o.pos;return s.isAtom||(i=t.docView.descAt(a))&&!i.contentDOM?se.isSelectable(s)?Si(t,new se(e<0?t.state.doc.resolve(o.pos-s.nodeSize):o)):gf?Si(t,new ee(t.state.doc.resolve(e<0?a:a+s.nodeSize))):!1:!1}}else return!1;else{if(r instanceof se&&r.node.isInline)return Si(t,new ee(e>0?r.$to:r.$from));{let o=cw(t.state,e);return o?Si(t,o):!1}}}function eg(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Md(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Gl(t,e){return e<0?Tq(t):_q(t)}function Tq(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let o,s,i=!1;for(wo&&n.nodeType==1&&r<eg(n)&&Md(n.childNodes[r],-1)&&(i=!0);;)if(r>0){if(n.nodeType!=1)break;{let a=n.childNodes[r-1];if(Md(a,-1))o=n,s=--r;else if(a.nodeType==3)n=a,r=n.nodeValue.length;else break}}else{if($4(n))break;{let a=n.previousSibling;for(;a&&Md(a,-1);)o=n.parentNode,s=pn(a),a=a.previousSibling;if(a)n=a,r=eg(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}i?uw(t,n,r):o&&uw(t,o,s)}function _q(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let o=eg(n),s,i;for(;;)if(r<o){if(n.nodeType!=1)break;let a=n.childNodes[r];if(Md(a,1))s=n,i=++r;else break}else{if($4(n))break;{let a=n.nextSibling;for(;a&&Md(a,1);)s=a.parentNode,i=pn(a)+1,a=a.nextSibling;if(a)n=a,r=0,o=eg(n);else{if(n=n.parentNode,n==t.dom)break;r=o=0}}}s&&uw(t,s,i)}function $4(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function Aq(t,e){for(;t&&e==t.childNodes.length&&!mf(t);)e=pn(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function Iq(t,e){for(;t&&!e&&!mf(t);)e=pn(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function uw(t,e,n){if(e.nodeType!=3){let s,i;(i=Aq(e,n))?(e=i,n=0):(s=Iq(e,n))&&(e=s,n=s.nodeValue.length)}let r=t.domSelection();if(!r)return;if(Yy(r)){let s=document.createRange();s.setEnd(e,n),s.setStart(e,n),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:o}=t;setTimeout(()=>{t.state==o&&js(t)},50)}function L2(t,e){let n=t.state.doc.resolve(e);if(!(On||JW)&&n.parent.inlineContent){let o=t.coordsAtPos(e);if(e>n.start()){let s=t.coordsAtPos(e-1),i=(s.top+s.bottom)/2;if(i>o.top&&i<o.bottom&&Math.abs(s.left-o.left)>1)return s.left<o.left?"ltr":"rtl"}if(e<n.end()){let s=t.coordsAtPos(e+1),i=(s.top+s.bottom)/2;if(i>o.top&&i<o.bottom&&Math.abs(s.left-o.left)>1)return s.left>o.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function V2(t,e,n){let r=t.state.selection;if(r instanceof ee&&!r.empty||n.indexOf("s")>-1||Br&&n.indexOf("m")>-1)return!1;let{$from:o,$to:s}=r;if(!o.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let i=cw(t.state,e);if(i&&i instanceof se)return Si(t,i)}if(!o.parent.inlineContent){let i=e<0?o:s,a=r instanceof hr?fe.near(i,e):fe.findFrom(i,e);return a?Si(t,a):!1}return!1}function j2(t,e){if(!(t.state.selection instanceof ee))return!0;let{$head:n,$anchor:r,empty:o}=t.state.selection;if(!n.sameParent(r))return!0;if(!o)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let i=t.state.tr;return e<0?i.delete(n.pos-s.nodeSize,n.pos):i.delete(n.pos,n.pos+s.nodeSize),t.dispatch(i),!0}return!1}function B2(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function Mq(t){if(!Jn||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;B2(t,r,"true"),setTimeout(()=>B2(t,r,"false"),20)}return!1}function Rq(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function Pq(t,e){let n=e.keyCode,r=Rq(e);if(n==8||Br&&n==72&&r=="c")return j2(t,-1)||Gl(t,-1);if(n==46&&!e.shiftKey||Br&&n==68&&r=="c")return j2(t,1)||Gl(t,1);if(n==13||n==27)return!0;if(n==37||Br&&n==66&&r=="c"){let o=n==37?L2(t,t.state.selection.from)=="ltr"?-1:1:-1;return O2(t,o,r)||Gl(t,o)}else if(n==39||Br&&n==70&&r=="c"){let o=n==39?L2(t,t.state.selection.from)=="ltr"?1:-1:1;return O2(t,o,r)||Gl(t,o)}else{if(n==38||Br&&n==80&&r=="c")return V2(t,-1,r)||Gl(t,-1);if(n==40||Br&&n==78&&r=="c")return Mq(t)||V2(t,1,r)||Gl(t,1);if(r==(Br?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function Dx(t,e){t.someProp("transformCopied",f=>{e=f(e,t)});let n=[],{content:r,openStart:o,openEnd:s}=e;for(;o>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){o--,s--;let f=r.firstChild;n.push(f.type.name,f.attrs!=f.type.defaultAttrs?f.attrs:null),r=f.content}let i=t.someProp("clipboardSerializer")||Js.fromSchema(t.state.schema),a=q4(),l=a.createElement("div");l.appendChild(i.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=W4[c.nodeName.toLowerCase()]);){for(let f=u.length-1;f>=0;f--){let p=a.createElement(u[f]);for(;l.firstChild;)p.appendChild(l.firstChild);l.appendChild(p),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${o} ${s}${d?` -${d}`:""} ${JSON.stringify(n)}`);let h=t.someProp("clipboardTextSerializer",f=>f(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:h,slice:e}}function F4(t,e,n,r,o){let s=o.parent.type.spec.code,i,a;if(!n&&!e)return null;let l=e&&(r||s||!n);if(l){if(t.someProp("transformPastedText",h=>{e=h(e,s||r,t)}),s)return e?new G(B.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):G.empty;let d=t.someProp("clipboardTextParser",h=>h(e,o,r,t));if(d)a=d;else{let h=o.marks(),{schema:f}=t.state,p=Js.fromSchema(f);i=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(y=>{let b=i.appendChild(document.createElement("p"));y&&b.appendChild(p.serializeNode(f.text(y,h)))})}}else t.someProp("transformPastedHTML",d=>{n=d(n,t)}),i=Lq(n),gf&&Vq(i);let c=i&&i.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let h=i.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;i=h}if(a||(a=(t.someProp("clipboardParser")||t.someProp("domParser")||Ls.fromSchema(t.state.schema)).parseSlice(i,{preserveWhitespace:!!(l||u),context:o,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!Dq.test(h.parentNode.nodeName)?{ignore:!0}:null}})),u)a=jq($2(a,+u[1],+u[2]),u[4]);else if(a=G.maxOpen(Nq(a.content,o),!0),a.openStart||a.openEnd){let d=0,h=0;for(let f=a.content.firstChild;d<a.openStart&&!f.type.spec.isolating;d++,f=f.firstChild);for(let f=a.content.lastChild;h<a.openEnd&&!f.type.spec.isolating;h++,f=f.lastChild);a=$2(a,d,h)}return t.someProp("transformPasted",d=>{a=d(a,t)}),a}const Dq=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Nq(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let o=e.node(n).contentMatchAt(e.index(n)),s,i=[];if(t.forEach(a=>{if(!i)return;let l=o.findWrapping(a.type),c;if(!l)return i=null;if(c=i.length&&s.length&&z4(l,s,a,i[i.length-1],0))i[i.length-1]=c;else{i.length&&(i[i.length-1]=U4(i[i.length-1],s.length));let u=H4(a,l);i.push(u),o=o.matchType(u.type),s=l}}),i)return B.from(i)}return t}function H4(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,B.from(t));return t}function z4(t,e,n,r,o){if(o<t.length&&o<e.length&&t[o]==e[o]){let s=z4(t,e,n,r.lastChild,o+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(o==t.length-1?n.type:t[o+1]))return r.copy(r.content.append(B.from(H4(n,t,o+1))))}}function U4(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,U4(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(B.empty,!0);return t.copy(n.append(r))}function dw(t,e,n,r,o,s){let i=e<0?t.firstChild:t.lastChild,a=i.content;return t.childCount>1&&(s=0),o<r-1&&(a=dw(a,e,n,r,o+1,s)),o>=n&&(a=e<0?i.contentMatchAt(0).fillBefore(a,s<=o).append(a):a.append(i.contentMatchAt(i.childCount).fillBefore(B.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,i.copy(a))}function $2(t,e,n){return e<t.openStart&&(t=new G(dw(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new G(dw(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const W4={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let F2=null;function q4(){return F2||(F2=document.implementation.createHTMLDocument("title"))}let iv=null;function Oq(t){let e=window.trustedTypes;return e?(iv||(iv=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),iv.createHTML(t)):t}function Lq(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=q4().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),o;if((o=r&&W4[r[1].toLowerCase()])&&(t=o.map(s=>"<"+s+">").join("")+t+o.map(s=>"</"+s+">").reverse().join("")),n.innerHTML=Oq(t),o)for(let s=0;s<o.length;s++)n=n.querySelector(o[s])||n;return n}function Vq(t){let e=t.querySelectorAll(On?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent=="Â "&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function jq(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:o,openStart:s,openEnd:i}=t;for(let a=r.length-2;a>=0;a-=2){let l=n.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;o=B.from(l.create(r[a+1],o)),s++,i++}return new G(o,s,i)}const Qn={},Zn={},Bq={touchstart:!0,touchmove:!0};class $q{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Fq(t){for(let e in Qn){let n=Qn[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{zq(t,r)&&!Nx(t,r)&&(t.editable||!(r.type in Zn))&&n(t,r)},Bq[e]?{passive:!0}:void 0)}Jn&&t.dom.addEventListener("input",()=>null),hw(t)}function Oi(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function Hq(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function hw(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>Nx(t,r))})}function Nx(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function zq(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function Uq(t,e){!Nx(t,e)&&Qn[e.type]&&(t.editable||!(e.type in Zn))&&Qn[e.type](t,e)}Zn.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!K4(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Rs&&On&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),Oc&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",o=>o(t,Ua(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||Pq(t,n)?n.preventDefault():Oi(t,"key")};Zn.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};Zn.keypress=(t,e)=>{let n=e;if(K4(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Br&&n.metaKey)return;if(t.someProp("handleKeyPress",o=>o(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof ee)||!r.$from.sameParent(r.$to)){let o=String.fromCharCode(n.charCode);!/[\r\n]/.test(o)&&!t.someProp("handleTextInput",s=>s(t,r.$from.pos,r.$to.pos,o))&&t.dispatch(t.state.tr.insertText(o).scrollIntoView()),n.preventDefault()}};function Jy(t){return{left:t.clientX,top:t.clientY}}function Wq(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function Ox(t,e,n,r,o){if(r==-1)return!1;let s=t.state.doc.resolve(r);for(let i=s.depth+1;i>0;i--)if(t.someProp(e,a=>i>s.depth?a(t,n,s.nodeAfter,s.before(i),o,!0):a(t,n,s.node(i),s.before(i),o,!1)))return!0;return!1}function vc(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function qq(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&se.isSelectable(r)?(vc(t,new se(n)),!0):!1}function Gq(t,e){if(e==-1)return!1;let n=t.state.selection,r,o;n instanceof se&&(r=n.node);let s=t.state.doc.resolve(e);for(let i=s.depth+1;i>0;i--){let a=i>s.depth?s.nodeAfter:s.node(i);if(se.isSelectable(a)){r&&n.$from.depth>0&&i>=n.$from.depth&&s.before(n.$from.depth+1)==n.$from.pos?o=s.before(n.$from.depth):o=s.before(i);break}}return o!=null?(vc(t,se.create(t.state.doc,o)),!0):!1}function Kq(t,e,n,r,o){return Ox(t,"handleClickOn",e,n,r)||t.someProp("handleClick",s=>s(t,e,r))||(o?Gq(t,n):qq(t,n))}function Yq(t,e,n,r){return Ox(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",o=>o(t,e,r))}function Xq(t,e,n,r){return Ox(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",o=>o(t,e,r))||Jq(t,n,r)}function Jq(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(vc(t,ee.create(r,0,r.content.size)),!0):!1;let o=r.resolve(e);for(let s=o.depth+1;s>0;s--){let i=s>o.depth?o.nodeAfter:o.node(s),a=o.before(s);if(i.inlineContent)vc(t,ee.create(r,a+1,a+1+i.content.size));else if(se.isSelectable(i))vc(t,se.create(r,a));else continue;return!0}}function Lx(t){return tg(t)}const G4=Br?"metaKey":"ctrlKey";Qn.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=Lx(t),o=Date.now(),s="singleClick";o-t.input.lastClick.time<500&&Wq(n,t.input.lastClick)&&!n[G4]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?s="doubleClick":t.input.lastClick.type=="doubleClick"&&(s="tripleClick")),t.input.lastClick={time:o,x:n.clientX,y:n.clientY,type:s,button:n.button};let i=t.posAtCoords(Jy(n));i&&(s=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new Qq(t,i,n,!!r)):(s=="doubleClick"?Yq:Xq)(t,i.pos,i.inside,n)?n.preventDefault():Oi(t,"pointer"))};class Qq{constructor(e,n,r,o){this.view=e,this.pos=n,this.event=r,this.flushed=o,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[G4],this.allowDefault=r.shiftKey;let s,i;if(n.inside>-1)s=e.state.doc.nodeAt(n.inside),i=n.inside;else{let u=e.state.doc.resolve(n.pos);s=u.parent,i=u.depth?u.before():0}const a=o?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:c}=e.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||c instanceof se&&c.from<=i&&c.to>i)&&(this.mightDrag={node:s,pos:i,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&wo&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Oi(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>js(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Jy(e))),this.updateAllowDefault(e),this.allowDefault||!n?Oi(this.view,"pointer"):Kq(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Jn&&this.mightDrag&&!this.mightDrag.node.isAtom||On&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(vc(this.view,fe.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):Oi(this.view,"pointer")}move(e){this.updateAllowDefault(e),Oi(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Qn.touchstart=t=>{t.input.lastTouch=Date.now(),Lx(t),Oi(t,"pointer")};Qn.touchmove=t=>{t.input.lastTouch=Date.now(),Oi(t,"pointer")};Qn.contextmenu=t=>Lx(t);function K4(t,e){return t.composing?!0:Jn&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const Zq=Rs?5e3:-1;Zn.compositionstart=Zn.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof ee&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),tg(t,!0),t.markCursor=null;else if(tg(t,!e.selection.empty),wo&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let o=r.focusNode,s=r.focusOffset;o&&o.nodeType==1&&s!=0;){let i=s<0?o.lastChild:o.childNodes[s-1];if(!i)break;if(i.nodeType==3){let a=t.domSelection();a&&a.collapse(i,i.nodeValue.length);break}else o=i,s=-1}}t.input.composing=!0}Y4(t,Zq)};Zn.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,Y4(t,20))};function Y4(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>tg(t),e))}function X4(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=tG());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function eG(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=qW(e.focusNode,e.focusOffset),r=GW(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let o=r.pmViewDesc,s=t.domObserver.lastChangedTextNode;if(n==s||r==s)return s;if(!o||!o.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let i=n.pmViewDesc;if(!(!i||!i.isText(n.nodeValue)))return r}}return n||r}function tG(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function tg(t,e=!1){if(!(Rs&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),X4(t),e||t.docView&&t.docView.dirty){let n=Rx(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function nG(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),o=document.createRange();o.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const dh=fr&&Fi<15||Oc&&QW<604;Qn.copy=Zn.cut=(t,e)=>{let n=e,r=t.state.selection,o=n.type=="cut";if(r.empty)return;let s=dh?null:n.clipboardData,i=r.content(),{dom:a,text:l}=Dx(t,i);s?(n.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):nG(t,a),o&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function rG(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function oG(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let o=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?hh(t,r.value,null,o,e):hh(t,r.textContent,r.innerHTML,o,e)},50)}function hh(t,e,n,r,o){let s=F4(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,o,s||G.empty)))return!0;if(!s)return!1;let i=rG(s),a=i?t.state.tr.replaceSelectionWith(i,r):t.state.tr.replaceSelection(s);return t.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function J4(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Zn.paste=(t,e)=>{let n=e;if(t.composing&&!Rs)return;let r=dh?null:n.clipboardData,o=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&hh(t,J4(r),r.getData("text/html"),o,n)?n.preventDefault():oG(t,n)};class Q4{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const sG=Br?"altKey":"ctrlKey";function Z4(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[sG]}Qn.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let o=t.state.selection,s=o.empty?null:t.posAtCoords(Jy(n)),i;if(!(s&&s.pos>=o.from&&s.pos<=(o instanceof se?o.to-1:o.to))){if(r&&r.mightDrag)i=se.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let d=t.docView.nearestDesc(n.target,!0);d&&d.node.type.spec.draggable&&d!=t.docView&&(i=se.create(t.state.doc,d.posBefore))}}let a=(i||t.state.selection).content(),{dom:l,text:c,slice:u}=Dx(t,a);(!n.dataTransfer.files.length||!On||E4>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(dh?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",dh||n.dataTransfer.setData("text/plain",c),t.dragging=new Q4(u,Z4(t,n),i)};Qn.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};Zn.dragover=Zn.dragenter=(t,e)=>e.preventDefault();Zn.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let o=t.posAtCoords(Jy(n));if(!o)return;let s=t.state.doc.resolve(o.pos),i=r&&r.slice;i?t.someProp("transformPasted",p=>{i=p(i,t)}):i=F4(t,J4(n.dataTransfer),dh?null:n.dataTransfer.getData("text/html"),!1,s);let a=!!(r&&Z4(t,n));if(t.someProp("handleDrop",p=>p(t,n,i||G.empty,a))){n.preventDefault();return}if(!i)return;n.preventDefault();let l=i?g4(t.state.doc,s.pos,i):s.pos;l==null&&(l=s.pos);let c=t.state.tr;if(a){let{node:p}=r;p?p.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=i.openStart==0&&i.openEnd==0&&i.content.childCount==1,h=c.doc;if(d?c.replaceRangeWith(u,u,i.content.firstChild):c.replaceRange(u,u,i),c.doc.eq(h))return;let f=c.doc.resolve(u);if(d&&se.isSelectable(i.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(i.content.firstChild))c.setSelection(new se(f));else{let p=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((y,b,w,k)=>p=k),c.setSelection(Px(t,f,c.doc.resolve(p)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))};Qn.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&js(t)},20))};Qn.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Qn.beforeinput=(t,e)=>{if(On&&Rs&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",s=>s(t,Ua(8,"Backspace")))))return;let{$cursor:o}=t.state.selection;o&&o.pos>0&&t.dispatch(t.state.tr.delete(o.pos-1,o.pos).scrollIntoView())},50)}};for(let t in Zn)Qn[t]=Zn[t];function fh(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class ng{constructor(e,n){this.toDOM=e,this.spec=n||il,this.side=this.spec.side||0}map(e,n,r,o){let{pos:s,deleted:i}=e.mapResult(n.from+o,this.side<0?-1:1);return i?null:new et(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof ng&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&fh(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class zi{constructor(e,n){this.attrs=e,this.spec=n||il}map(e,n,r,o){let s=e.map(n.from+o,this.spec.inclusiveStart?-1:1)-r,i=e.map(n.to+o,this.spec.inclusiveEnd?1:-1)-r;return s>=i?null:new et(s,i,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof zi&&fh(this.attrs,e.attrs)&&fh(this.spec,e.spec)}static is(e){return e.type instanceof zi}destroy(){}}class Vx{constructor(e,n){this.attrs=e,this.spec=n||il}map(e,n,r,o){let s=e.mapResult(n.from+o,1);if(s.deleted)return null;let i=e.mapResult(n.to+o,-1);return i.deleted||i.pos<=s.pos?null:new et(s.pos-r,i.pos-r,this)}valid(e,n){let{index:r,offset:o}=e.content.findIndex(n.from),s;return o==n.from&&!(s=e.child(r)).isText&&o+s.nodeSize==n.to}eq(e){return this==e||e instanceof Vx&&fh(this.attrs,e.attrs)&&fh(this.spec,e.spec)}destroy(){}}class et{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new et(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new et(e,e,new ng(n,r))}static inline(e,n,r,o){return new et(e,n,new zi(r,o))}static node(e,n,r,o){return new et(e,n,new Vx(r,o))}get spec(){return this.type.spec}get inline(){return this.type instanceof zi}get widget(){return this.type instanceof ng}}const rc=[],il={};class Oe{constructor(e,n){this.local=e.length?e:rc,this.children=n.length?n:rc}static create(e,n){return n.length?rg(n,e,0,il):Rn}find(e,n,r){let o=[];return this.findInner(e??0,n??1e9,o,0,r),o}findInner(e,n,r,o,s){for(let i=0;i<this.local.length;i++){let a=this.local[i];a.from<=n&&a.to>=e&&(!s||s(a.spec))&&r.push(a.copy(a.from+o,a.to+o))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<n&&this.children[i+1]>e){let a=this.children[i]+1;this.children[i+2].findInner(e-a,n-a,r,o+a,s)}}map(e,n,r){return this==Rn||e.maps.length==0?this:this.mapInner(e,n,0,0,r||il)}mapInner(e,n,r,o,s){let i;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,o);l&&l.type.valid(n,l)?(i||(i=[])).push(l):s.onRemove&&s.onRemove(this.local[a].spec)}return this.children.length?iG(this.children,i||[],e,n,r,o,s):i?new Oe(i.sort(al),rc):Rn}add(e,n){return n.length?this==Rn?Oe.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let o,s=0;e.forEach((a,l)=>{let c=l+r,u;if(u=tO(n,a,c)){for(o||(o=this.children.slice());s<o.length&&o[s]<l;)s+=3;o[s]==l?o[s+2]=o[s+2].addInner(a,u,c+1):o.splice(s,0,l,l+a.nodeSize,rg(u,a,c+1,il)),s+=3}});let i=eO(s?nO(n):n,-r);for(let a=0;a<i.length;a++)i[a].type.valid(e,i[a])||i.splice(a--,1);return new Oe(i.length?this.local.concat(i).sort(al):this.local,o||this.children)}remove(e){return e.length==0||this==Rn?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,o=this.local;for(let s=0;s<r.length;s+=3){let i,a=r[s]+n,l=r[s+1]+n;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(i||(i=[])).push(d));if(!i)continue;r==this.children&&(r=this.children.slice());let c=r[s+2].removeInner(i,a+1);c!=Rn?r[s+2]=c:(r.splice(s,3),s-=3)}if(o.length){for(let s=0,i;s<e.length;s++)if(i=e[s])for(let a=0;a<o.length;a++)o[a].eq(i,n)&&(o==this.local&&(o=this.local.slice()),o.splice(a--,1))}return r==this.children&&o==this.local?this:o.length||r.length?new Oe(o,r):Rn}forChild(e,n){if(this==Rn)return this;if(n.isLeaf)return Oe.empty;let r,o;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let s=e+1,i=s+n.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<i&&l.to>s&&l.type instanceof zi){let c=Math.max(s,l.from)-s,u=Math.min(i,l.to)-s;c<u&&(o||(o=[])).push(l.copy(c,u))}}if(o){let a=new Oe(o.sort(al),rc);return r?new Ii([a,r]):a}return r||Rn}eq(e){if(this==e)return!0;if(!(e instanceof Oe)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return jx(this.localsInner(e))}localsInner(e){if(this==Rn)return rc;if(e.inlineContent||!this.local.some(zi.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof zi||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Oe.empty=new Oe([],[]);Oe.removeOverlap=jx;const Rn=Oe.empty;class Ii{constructor(e){this.members=e}map(e,n){const r=this.members.map(o=>o.map(e,n,il));return Ii.from(r)}forChild(e,n){if(n.isLeaf)return Oe.empty;let r=[];for(let o=0;o<this.members.length;o++){let s=this.members[o].forChild(e,n);s!=Rn&&(s instanceof Ii?r=r.concat(s.members):r.push(s))}return Ii.from(r)}eq(e){if(!(e instanceof Ii)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let o=0;o<this.members.length;o++){let s=this.members[o].localsInner(e);if(s.length)if(!n)n=s;else{r&&(n=n.slice(),r=!1);for(let i=0;i<s.length;i++)n.push(s[i])}}return n?jx(r?n:n.sort(al)):rc}static from(e){switch(e.length){case 0:return Rn;case 1:return e[0];default:return new Ii(e.every(n=>n instanceof Oe)?e:e.reduce((n,r)=>n.concat(r instanceof Oe?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function iG(t,e,n,r,o,s,i){let a=t.slice();for(let c=0,u=s;c<n.maps.length;c++){let d=0;n.maps[c].forEach((h,f,p,y)=>{let b=y-p-(f-h);for(let w=0;w<a.length;w+=3){let k=a[w+1];if(k<0||h>k+u-d)continue;let x=a[w]+u-d;f>=x?a[w+1]=h<=x?-2:-1:h>=u&&b&&(a[w]+=b,a[w+1]+=b)}d+=b}),u=n.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=n.map(t[c]+s),d=u-o;if(d<0||d>=r.content.size){l=!0;continue}let h=n.map(t[c+1]+s,-1),f=h-o,{index:p,offset:y}=r.content.findIndex(d),b=r.maybeChild(p);if(b&&y==d&&y+b.nodeSize==f){let w=a[c+2].mapInner(n,b,u+1,t[c]+s+1,i);w!=Rn?(a[c]=d,a[c+1]=f,a[c+2]=w):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=aG(a,t,e,n,o,s,i),u=rg(c,r,0,i);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,h=0;d<u.children.length;d+=3){let f=u.children[d];for(;h<a.length&&a[h]<f;)h+=3;a.splice(h,0,u.children[d],u.children[d+1],u.children[d+2])}}return new Oe(e.sort(al),a)}function eO(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let o=t[r];n.push(new et(o.from+e,o.to+e,o.type))}return n}function aG(t,e,n,r,o,s,i){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,o,c);d?n.push(d):i.onRemove&&i.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&a(t[l+2],e[l]+s+1);return n}function tO(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,o=null;for(let s=0,i;s<t.length;s++)(i=t[s])&&i.from>n&&i.to<r&&((o||(o=[])).push(i),t[s]=null);return o}function nO(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function rg(t,e,n,r){let o=[],s=!1;e.forEach((a,l)=>{let c=tO(t,a,l+n);if(c){s=!0;let u=rg(c,a,n+l+1,r);u!=Rn&&o.push(l,l+a.nodeSize,u)}});let i=eO(s?nO(t):t,-n).sort(al);for(let a=0;a<i.length;a++)i[a].type.valid(e,i[a])||(r.onRemove&&r.onRemove(i[a].spec),i.splice(a--,1));return i.length||o.length?new Oe(i,o):Rn}function al(t,e){return t.from-e.from||t.to-e.to}function jx(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let o=n+1;o<e.length;o++){let s=e[o];if(s.from==r.from){s.to!=r.to&&(e==t&&(e=t.slice()),e[o]=s.copy(s.from,r.to),H2(e,o+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,s.from),H2(e,o,r.copy(s.from,r.to)));break}}}return e}function H2(t,e,n){for(;e<t.length&&al(n,t[e])>0;)e++;t.splice(e,0,n)}function av(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=Rn&&e.push(r)}),t.cursorWrapper&&e.push(Oe.create(t.state.doc,[t.cursorWrapper.deco])),Ii.from(e)}const lG={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},cG=fr&&Fi<=11;class uG{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class dG{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new uG,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let o=0;o<r.length;o++)this.queue.push(r[o]);fr&&Fi<=11&&r.some(o=>o.type=="childList"&&o.removedNodes.length||o.type=="characterData"&&o.oldValue.length>o.target.nodeValue.length)?this.flushSoon():this.flush()}),cG&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,lG)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(N2(this.view)){if(this.suppressingSelectionUpdates)return js(this.view);if(fr&&Fi<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&yl(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let s=e.focusNode;s;s=Nc(s))n.add(s);for(let s=e.anchorNode;s;s=Nc(s))if(n.has(s)){r=s;break}let o=r&&this.view.docView.nearestDesc(r);if(o&&o.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&N2(e)&&!this.ignoreSelectionChange(r),s=-1,i=-1,a=!1,l=[];if(e.editable)for(let u=0;u<n.length;u++){let d=this.registerMutation(n[u],l);d&&(s=s<0?d.from:Math.min(d.from,s),i=i<0?d.to:Math.max(d.to,i),d.typeOver&&(a=!0))}if(wo&&l.length){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let[d,h]=u;d.parentNode&&d.parentNode.parentNode==h.parentNode?h.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let h of u){let f=h.parentNode;f&&f.nodeName=="LI"&&(!d||pG(e,d)!=f)&&h.remove()}}}let c=null;s<0&&o&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Yy(r)&&(c=Rx(e))&&c.eq(fe.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,js(e),this.currentSelection.set(r),e.scrollToSelection()):(s>-1||o)&&(s>-1&&(e.docView.markDirty(s,i),hG(e)),this.handleDOMChange(s,i,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||js(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let d=e.addedNodes[u];n.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let o=e.previousSibling,s=e.nextSibling;if(fr&&Fi<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:h}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(o=d),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(s=h)}let i=o&&o.parentNode==e.target?pn(o)+1:0,a=r.localPosFromDOM(e.target,i,-1),l=s&&s.parentNode==e.target?pn(s):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let z2=new WeakMap,U2=!1;function hG(t){if(!z2.has(t)&&(z2.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=wo,U2)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),U2=!0}}function W2(t,e){let n=e.startContainer,r=e.startOffset,o=e.endContainer,s=e.endOffset,i=t.domAtPos(t.state.selection.anchor);return yl(i.node,i.offset,o,s)&&([n,r,o,s]=[o,s,n,r]),{anchorNode:n,anchorOffset:r,focusNode:o,focusOffset:s}}function fG(t,e){if(e.getComposedRanges){let o=e.getComposedRanges(t.root)[0];if(o)return W2(t,o)}let n;function r(o){o.preventDefault(),o.stopImmediatePropagation(),n=o.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?W2(t,n):null}function pG(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function mG(t,e,n){let{node:r,fromOffset:o,toOffset:s,from:i,to:a}=t.docView.parseRange(e,n),l=t.domSelectionRange(),c,u=l.anchorNode;if(u&&t.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],Yy(l)||c.push({node:l.focusNode,offset:l.focusOffset})),On&&t.input.lastKeyCode===8)for(let b=s;b>o;b--){let w=r.childNodes[b-1],k=w.pmViewDesc;if(w.nodeName=="BR"&&!k){s=b;break}if(!k||k.size)break}let d=t.state.doc,h=t.someProp("domParser")||Ls.fromSchema(t.state.schema),f=d.resolve(i),p=null,y=h.parse(r,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:o,to:s,preserveWhitespace:f.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:gG,context:f});if(c&&c[0].pos!=null){let b=c[0].pos,w=c[1]&&c[1].pos;w==null&&(w=b),p={anchor:b+i,head:w+i}}return{doc:y,sel:p,from:i,to:a}}function gG(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Jn&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Jn&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const yG=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function bG(t,e,n,r,o){let s=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let _=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,R=Rx(t,_);if(R&&!t.state.selection.eq(R)){if(On&&Rs&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",O=>O(t,Ua(13,"Enter"))))return;let D=t.state.tr.setSelection(R);_=="pointer"?D.setMeta("pointer",!0):_=="key"&&D.scrollIntoView(),s&&D.setMeta("composition",s),t.dispatch(D)}return}let i=t.state.doc.resolve(e),a=i.sharedDepth(n);e=i.before(a+1),n=t.state.doc.resolve(n).after(a+1);let l=t.state.selection,c=mG(t,e,n),u=t.state.doc,d=u.slice(c.from,c.to),h,f;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(h=t.state.selection.to,f="end"):(h=t.state.selection.from,f="start"),t.input.lastKeyCode=null;let p=CG(d.content,c.doc.content,c.from,h,f);if(p&&t.input.domChangeCount++,(Oc&&t.input.lastIOSEnter>Date.now()-225||Rs)&&o.some(_=>_.nodeType==1&&!yG.test(_.nodeName))&&(!p||p.endA>=p.endB)&&t.someProp("handleKeyDown",_=>_(t,Ua(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!p)if(r&&l instanceof ee&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))p={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let _=q2(t,t.state.doc,c.sel);if(_&&!_.eq(t.state.selection)){let R=t.state.tr.setSelection(_);s&&R.setMeta("composition",s),t.dispatch(R)}}return}t.state.selection.from<t.state.selection.to&&p.start==p.endB&&t.state.selection instanceof ee&&(p.start>t.state.selection.from&&p.start<=t.state.selection.from+2&&t.state.selection.from>=c.from?p.start=t.state.selection.from:p.endA<t.state.selection.to&&p.endA>=t.state.selection.to-2&&t.state.selection.to<=c.to&&(p.endB+=t.state.selection.to-p.endA,p.endA=t.state.selection.to)),fr&&Fi<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>c.from&&c.doc.textBetween(p.start-c.from-1,p.start-c.from+1)==" Â "&&(p.start--,p.endA--,p.endB--);let y=c.doc.resolveNoCache(p.start-c.from),b=c.doc.resolveNoCache(p.endB-c.from),w=u.resolve(p.start),k=y.sameParent(b)&&y.parent.inlineContent&&w.end()>=p.endA,x;if((Oc&&t.input.lastIOSEnter>Date.now()-225&&(!k||o.some(_=>_.nodeName=="DIV"||_.nodeName=="P"))||!k&&y.pos<c.doc.content.size&&(!y.sameParent(b)||!y.parent.inlineContent)&&!/\S/.test(c.doc.textBetween(y.pos,b.pos,"",""))&&(x=fe.findFrom(c.doc.resolve(y.pos+1),1,!0))&&x.head>y.pos)&&t.someProp("handleKeyDown",_=>_(t,Ua(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>p.start&&wG(u,p.start,p.endA,y,b)&&t.someProp("handleKeyDown",_=>_(t,Ua(8,"Backspace")))){Rs&&On&&t.domObserver.suppressSelectionUpdates();return}On&&p.endB==p.start&&(t.input.lastChromeDelete=Date.now()),Rs&&!k&&y.start()!=b.start()&&b.parentOffset==0&&y.depth==b.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==p.endA&&(p.endB-=2,b=c.doc.resolveNoCache(p.endB-c.from),setTimeout(()=>{t.someProp("handleKeyDown",function(_){return _(t,Ua(13,"Enter"))})},20));let A=p.start,I=p.endA,M,T,S;if(k){if(y.pos==b.pos)fr&&Fi<=11&&y.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>js(t),20)),M=t.state.tr.delete(A,I),T=u.resolve(p.start).marksAcross(u.resolve(p.endA));else if(p.endA==p.endB&&(S=vG(y.parent.content.cut(y.parentOffset,b.parentOffset),w.parent.content.cut(w.parentOffset,p.endA-w.start()))))M=t.state.tr,S.type=="add"?M.addMark(A,I,S.mark):M.removeMark(A,I,S.mark);else if(y.parent.child(y.index()).isText&&y.index()==b.index()-(b.textOffset?0:1)){let _=y.parent.textBetween(y.parentOffset,b.parentOffset);if(t.someProp("handleTextInput",R=>R(t,A,I,_)))return;M=t.state.tr.insertText(_,A,I)}}if(M||(M=t.state.tr.replace(A,I,c.doc.slice(p.start-c.from,p.endB-c.from))),c.sel){let _=q2(t,M.doc,c.sel);_&&!(On&&t.composing&&_.empty&&(p.start!=p.endB||t.input.lastChromeDelete<Date.now()-100)&&(_.head==A||_.head==M.mapping.map(I)-1)||fr&&_.empty&&_.head==A)&&M.setSelection(_)}T&&M.ensureMarks(T),s&&M.setMeta("composition",s),t.dispatch(M.scrollIntoView())}function q2(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Px(t,e.resolve(n.anchor),e.resolve(n.head))}function vG(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,o=n,s=r,i,a,l;for(let u=0;u<r.length;u++)o=r[u].removeFromSet(o);for(let u=0;u<n.length;u++)s=n[u].removeFromSet(s);if(o.length==1&&s.length==0)a=o[0],i="add",l=u=>u.mark(a.addToSet(u.marks));else if(o.length==0&&s.length==1)a=s[0],i="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(B.from(c).eq(t))return{mark:a,type:i}}function wG(t,e,n,r,o){if(n-e<=o.pos-r.pos||lv(r,!0,!1)<o.pos)return!1;let s=t.resolve(e);if(!r.parent.isTextblock){let a=s.nodeAfter;return a!=null&&n==e+a.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let i=t.resolve(lv(s,!0,!0));return!i.parent.isTextblock||i.pos>n||lv(i,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(i.parent.content)}function lv(t,e,n){let r=t.depth,o=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n){let s=t.node(r).maybeChild(t.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,o++}return o}function CG(t,e,n,r,o){let s=t.findDiffStart(e,n);if(s==null)return null;let{a:i,b:a}=t.findDiffEnd(e,n+t.size,n+e.size);if(o=="end"){let l=Math.max(0,s-Math.min(i,a));r-=i+l-s}if(i<s&&t.size<e.size){let l=r<=s&&r>=i?s-r:0;s-=l,s&&s<e.size&&G2(e.textBetween(s-1,s+1))&&(s+=l?1:-1),a=s+(a-i),i=s}else if(a<s){let l=r<=s&&r>=a?s-r:0;s-=l,s&&s<t.size&&G2(t.textBetween(s-1,s+1))&&(s+=l?1:-1),i=s+(i-a),a=s}return{start:s,endA:i,endB:a}}function G2(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class rO{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new $q,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(Q2),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=X2(this),Y2(this),this.nodeViews=J2(this),this.docView=A2(this.state.doc,K2(this),av(this),this.dom,this),this.domObserver=new dG(this,(r,o,s,i)=>bG(this,r,o,s,i)),this.domObserver.start(),Fq(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&hw(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Q2),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let o=this.state,s=!1,i=!1;e.storedMarks&&this.composing&&(X4(this),i=!0),this.state=e;let a=o.plugins!=e.plugins||this._props.plugins!=n.plugins;if(a||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let f=J2(this);kG(f,this.nodeViews)&&(this.nodeViews=f,s=!0)}(a||n.handleDOMEvents!=this._props.handleDOMEvents)&&hw(this),this.editable=X2(this),Y2(this);let l=av(this),c=K2(this),u=o.plugins!=e.plugins&&!o.doc.eq(e.doc)?"reset":e.scrollToSelection>o.scrollToSelection?"to selection":"preserve",d=s||!this.docView.matchesNode(e.doc,c,l);(d||!e.selection.eq(o.selection))&&(i=!0);let h=u=="preserve"&&i&&this.dom.style.overflowAnchor==null&&tq(this);if(i){this.domObserver.stop();let f=d&&(fr||On)&&!this.composing&&!o.selection.empty&&!e.selection.empty&&xG(o.selection,e.selection);if(d){let p=On?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=eG(this)),(s||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=A2(e.doc,c,l,this.dom,this)),p&&!this.trackWrites&&(f=!0)}f||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&Eq(this))?js(this,f):(j4(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(o),!((r=this.dragging)===null||r===void 0)&&r.node&&!o.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,o),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():h&&nq(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof se){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&x2(this,n.getBoundingClientRect(),e)}else x2(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,o=-1;if(this.state.doc.nodeAt(r.from)==r.node)o=r.from;else{let s=r.from+(this.state.doc.content.size-n.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==r.node&&(o=s)}this.dragging=new Q4(e.slice,e.move,o<0?void 0:se.create(this.state.doc,o))}someProp(e,n){let r=this._props&&this._props[e],o;if(r!=null&&(o=n?n(r):r))return o;for(let i=0;i<this.directPlugins.length;i++){let a=this.directPlugins[i].props[e];if(a!=null&&(o=n?n(a):a))return o}let s=this.state.plugins;if(s)for(let i=0;i<s.length;i++){let a=s[i].props[e];if(a!=null&&(o=n?n(a):a))return o}}hasFocus(){if(fr){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&rq(this.dom),js(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return lq(this,e)}coordsAtPos(e,n=1){return M4(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let o=this.docView.posFromDOM(e,n,r);if(o==null)throw new RangeError("DOM position not inside the editor");return o}endOfTextblock(e,n){return fq(this,n||this.state,e)}pasteHTML(e,n){return hh(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return hh(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return Dx(this,e)}destroy(){this.docView&&(Hq(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],av(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,UW())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return Uq(this,e)}dispatch(e){let n=this._props.dispatchTransaction;n?n.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?Jn&&this.root.nodeType===11&&YW(this.dom.ownerDocument)==this.dom&&fG(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function K2(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[et.node(0,t.state.doc.content.size,e)]}function Y2(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:et.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function X2(t){return!t.someProp("editable",e=>e(t.state)===!1)}function xG(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function J2(t){let e=Object.create(null);function n(r){for(let o in r)Object.prototype.hasOwnProperty.call(e,o)||(e[o]=r[o])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function kG(t,e){let n=0,r=0;for(let o in t){if(t[o]!=e[o])return!0;n++}for(let o in e)r++;return n!=r}function Q2(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}const SG=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),EG=typeof navigator<"u"&&/Win/.test(navigator.platform);function TG(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,o,s,i;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))i=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))o=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))SG?i=!0:o=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(n="Alt-"+n),o&&(n="Ctrl-"+n),i&&(n="Meta-"+n),s&&(n="Shift-"+n),n}function _G(t){let e=Object.create(null);for(let n in t)e[TG(n)]=t[n];return e}function cv(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function AG(t){return new Re({props:{handleKeyDown:Bx(t)}})}function Bx(t){let e=_G(t);return function(n,r){let o=C$(r),s,i=e[cv(o,r)];if(i&&i(n.state,n.dispatch,n))return!0;if(o.length==1&&o!=" "){if(r.shiftKey){let a=e[cv(o,r,!1)];if(a&&a(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(EG&&r.ctrlKey&&r.altKey)&&(s=x$[r.keyCode])&&s!=o){let a=e[cv(s,r)];if(a&&a(n.state,n.dispatch,n))return!0}}return!1}}const $x=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function oO(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const sO=(t,e,n)=>{let r=oO(t,n);if(!r)return!1;let o=Fx(r);if(!o){let i=r.blockRange(),a=i&&su(i);return a==null?!1:(e&&e(t.tr.lift(i,a).scrollIntoView()),!0)}let s=o.nodeBefore;if(pO(t,o,e,-1))return!0;if(r.parent.content.size==0&&(Lc(s,"end")||se.isSelectable(s)))for(let i=r.depth;;i--){let a=Gy(t.doc,r.before(i),r.after(i),G.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=t.tr.step(a);l.setSelection(Lc(s,"end")?fe.findFrom(l.doc.resolve(l.mapping.map(o.pos,-1)),-1):se.create(l.doc,o.pos-s.nodeSize)),e(l.scrollIntoView())}return!0}if(i==1||r.node(i-1).childCount>1)break}return s.isAtom&&o.depth==r.depth-1?(e&&e(t.tr.delete(o.pos-s.nodeSize,o.pos).scrollIntoView()),!0):!1},IG=(t,e,n)=>{let r=oO(t,n);if(!r)return!1;let o=Fx(r);return o?iO(t,o,e):!1},MG=(t,e,n)=>{let r=lO(t,n);if(!r)return!1;let o=Hx(r);return o?iO(t,o,e):!1};function iO(t,e,n){let r=e.nodeBefore,o=r,s=e.pos-1;for(;!o.isTextblock;s--){if(o.type.spec.isolating)return!1;let u=o.lastChild;if(!u)return!1;o=u}let i=e.nodeAfter,a=i,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=Gy(t.doc,s,l,G.empty);if(!c||c.from!=s||c instanceof Bt&&c.slice.size>=l-s)return!1;if(n){let u=t.tr.step(c);u.setSelection(ee.create(u.doc,s)),n(u.scrollIntoView())}return!0}function Lc(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const aO=(t,e,n)=>{let{$head:r,empty:o}=t.selection,s=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;s=Fx(r)}let i=s&&s.nodeBefore;return!i||!se.isSelectable(i)?!1:(e&&e(t.tr.setSelection(se.create(t.doc,s.pos-i.nodeSize)).scrollIntoView()),!0)};function Fx(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function lO(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const cO=(t,e,n)=>{let r=lO(t,n);if(!r)return!1;let o=Hx(r);if(!o)return!1;let s=o.nodeAfter;if(pO(t,o,e,1))return!0;if(r.parent.content.size==0&&(Lc(s,"start")||se.isSelectable(s))){let i=Gy(t.doc,r.before(),r.after(),G.empty);if(i&&i.slice.size<i.to-i.from){if(e){let a=t.tr.step(i);a.setSelection(Lc(s,"start")?fe.findFrom(a.doc.resolve(a.mapping.map(o.pos)),1):se.create(a.doc,a.mapping.map(o.pos))),e(a.scrollIntoView())}return!0}}return s.isAtom&&o.depth==r.depth-1?(e&&e(t.tr.delete(o.pos,o.pos+s.nodeSize).scrollIntoView()),!0):!1},uO=(t,e,n)=>{let{$head:r,empty:o}=t.selection,s=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;s=Hx(r)}let i=s&&s.nodeAfter;return!i||!se.isSelectable(i)?!1:(e&&e(t.tr.setSelection(se.create(t.doc,s.pos)).scrollIntoView()),!0)};function Hx(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const RG=(t,e)=>{let n=t.selection,r=n instanceof se,o;if(r){if(n.node.isTextblock||!Dl(t.doc,n.from))return!1;o=n.from}else if(o=qy(t.doc,n.from,-1),o==null)return!1;if(e){let s=t.tr.join(o);r&&s.setSelection(se.create(s.doc,o-t.doc.resolve(o).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},PG=(t,e)=>{let n=t.selection,r;if(n instanceof se){if(n.node.isTextblock||!Dl(t.doc,n.to))return!1;r=n.to}else if(r=qy(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},DG=(t,e)=>{let{$from:n,$to:r}=t.selection,o=n.blockRange(r),s=o&&su(o);return s==null?!1:(e&&e(t.tr.lift(o,s).scrollIntoView()),!0)},dO=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function zx(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const NG=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let o=n.node(-1),s=n.indexAfter(-1),i=zx(o.contentMatchAt(s));if(!i||!o.canReplaceWith(s,s,i))return!1;if(e){let a=n.after(),l=t.tr.replaceWith(a,a,i.createAndFill());l.setSelection(fe.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},hO=(t,e)=>{let n=t.selection,{$from:r,$to:o}=n;if(n instanceof hr||r.parent.inlineContent||o.parent.inlineContent)return!1;let s=zx(o.parent.contentMatchAt(o.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let i=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,a=t.tr.insert(i,s.createAndFill());a.setSelection(ee.create(a.doc,i+1)),e(a.scrollIntoView())}return!0},fO=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let s=n.before();if(Vs(t.doc,s))return e&&e(t.tr.split(s).scrollIntoView()),!0}let r=n.blockRange(),o=r&&su(r);return o==null?!1:(e&&e(t.tr.lift(r,o).scrollIntoView()),!0)};function OG(t){return(e,n)=>{let{$from:r,$to:o}=e.selection;if(e.selection instanceof se&&e.selection.node.isBlock)return!r.parentOffset||!Vs(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let s=[],i,a,l=!1,c=!1;for(let f=r.depth;;f--)if(r.node(f).isBlock){l=r.end(f)==r.pos+(r.depth-f),c=r.start(f)==r.pos-(r.depth-f),a=zx(r.node(f-1).contentMatchAt(r.indexAfter(f-1))),s.unshift(l&&a?{type:a}:null),i=f;break}else{if(f==1)return!1;s.unshift(null)}let u=e.tr;(e.selection instanceof ee||e.selection instanceof hr)&&u.deleteSelection();let d=u.mapping.map(r.pos),h=Vs(u.doc,d,s.length,s);if(h||(s[0]=a?{type:a}:null,h=Vs(u.doc,d,s.length,s)),!h)return!1;if(u.split(d,s.length,s),!l&&c&&r.node(i).type!=a){let f=u.mapping.map(r.before(i)),p=u.doc.resolve(f);a&&r.node(i-1).canReplaceWith(p.index(),p.index()+1,a)&&u.setNodeMarkup(u.mapping.map(r.before(i)),a)}return n&&n(u.scrollIntoView()),!0}}const LG=OG(),VG=(t,e)=>{let{$from:n,to:r}=t.selection,o,s=n.sharedDepth(r);return s==0?!1:(o=n.before(s),e&&e(t.tr.setSelection(se.create(t.doc,o))),!0)};function jG(t,e,n){let r=e.nodeBefore,o=e.nodeAfter,s=e.index();return!r||!o||!r.type.compatibleContent(o.type)?!1:!r.content.size&&e.parent.canReplace(s-1,s)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(o.isTextblock||Dl(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function pO(t,e,n,r){let o=e.nodeBefore,s=e.nodeAfter,i,a,l=o.type.spec.isolating||s.type.spec.isolating;if(!l&&jG(t,e,n))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(i=(a=o.contentMatchAt(o.childCount)).findWrapping(s.type))&&a.matchType(i[0]||s.type).validEnd){if(n){let f=e.pos+s.nodeSize,p=B.empty;for(let w=i.length-1;w>=0;w--)p=B.from(i[w].create(null,p));p=B.from(o.copy(p));let y=t.tr.step(new Nt(e.pos-1,f,e.pos,f,new G(p,1,0),i.length,!0)),b=y.doc.resolve(f+2*i.length);b.nodeAfter&&b.nodeAfter.type==o.type&&Dl(y.doc,b.pos)&&y.join(b.pos),n(y.scrollIntoView())}return!0}let u=s.type.spec.isolating||r>0&&l?null:fe.findFrom(e,1),d=u&&u.$from.blockRange(u.$to),h=d&&su(d);if(h!=null&&h>=e.depth)return n&&n(t.tr.lift(d,h).scrollIntoView()),!0;if(c&&Lc(s,"start",!0)&&Lc(o,"end")){let f=o,p=[];for(;p.push(f),!f.isTextblock;)f=f.lastChild;let y=s,b=1;for(;!y.isTextblock;y=y.firstChild)b++;if(f.canReplace(f.childCount,f.childCount,y.content)){if(n){let w=B.empty;for(let x=p.length-1;x>=0;x--)w=B.from(p[x].copy(w));let k=t.tr.step(new Nt(e.pos-p.length,e.pos+s.nodeSize,e.pos+b,e.pos+s.nodeSize-b,new G(w,p.length,0),0,!0));n(k.scrollIntoView())}return!0}}return!1}function mO(t){return function(e,n){let r=e.selection,o=t<0?r.$from:r.$to,s=o.depth;for(;o.node(s).isInline;){if(!s)return!1;s--}return o.node(s).isTextblock?(n&&n(e.tr.setSelection(ee.create(e.doc,t<0?o.start(s):o.end(s)))),!0):!1}}const BG=mO(-1),$G=mO(1);function FG(t,e=null){return function(n,r){let{$from:o,$to:s}=n.selection,i=o.blockRange(s),a=i&&h4(i,t,e);return a?(r&&r(n.tr.wrap(i,a).scrollIntoView()),!0):!1}}function Z2(t,e=null){return function(n,r){let o=!1;for(let s=0;s<n.selection.ranges.length&&!o;s++){let{$from:{pos:i},$to:{pos:a}}=n.selection.ranges[s];n.doc.nodesBetween(i,a,(l,c)=>{if(o)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)o=!0;else{let u=n.doc.resolve(c),d=u.index();o=u.parent.canReplaceWith(d,d+1,t)}})}if(!o)return!1;if(r){let s=n.tr;for(let i=0;i<n.selection.ranges.length;i++){let{$from:{pos:a},$to:{pos:l}}=n.selection.ranges[i];s.setBlockType(a,l,t,e)}r(s.scrollIntoView())}return!0}}function Ux(...t){return function(e,n,r){for(let o=0;o<t.length;o++)if(t[o](e,n,r))return!0;return!1}}Ux($x,sO,aO);Ux($x,cO,uO);Ux(dO,hO,fO,LG);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function HG(t,e=null){return function(n,r){let{$from:o,$to:s}=n.selection,i=o.blockRange(s);if(!i)return!1;let a=r?n.tr:null;return zG(a,i,t,e)?(r&&r(a.scrollIntoView()),!0):!1}}function zG(t,e,n,r=null){let o=!1,s=e,i=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=i.resolve(e.start-2);s=new Jm(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new Jm(e.$from,i.resolve(e.$to.end(e.depth)),e.depth)),o=!0}let a=h4(s,n,r,e);return a?(t&&UG(t,e,a,o,n),!0):!1}function UG(t,e,n,r,o){let s=B.empty;for(let u=n.length-1;u>=0;u--)s=B.from(n[u].type.create(n[u].attrs,s));t.step(new Nt(e.start-(r?2:0),e.end,e.start,e.end,new G(s,0,0),n.length,!0));let i=0;for(let u=0;u<n.length;u++)n[u].type==o&&(i=u+1);let a=n.length-i,l=e.start+n.length-(r?2:0),c=e.parent;for(let u=e.startIndex,d=e.endIndex,h=!0;u<d;u++,h=!1)!h&&Vs(t.doc,l,a)&&(t.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return t}function WG(t){return function(e,n){let{$from:r,$to:o}=e.selection,s=r.blockRange(o,i=>i.childCount>0&&i.firstChild.type==t);return s?n?r.node(s.depth-1).type==t?qG(e,n,t,s):GG(e,n,s):!0:!1}}function qG(t,e,n,r){let o=t.tr,s=r.end,i=r.$to.end(r.depth);s<i&&(o.step(new Nt(s-1,i,s,i,new G(B.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Jm(o.doc.resolve(r.$from.pos),o.doc.resolve(i),r.depth));const a=su(r);if(a==null)return!1;o.lift(r,a);let l=o.doc.resolve(o.mapping.map(s,-1)-1);return Dl(o.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&o.join(l.pos),e(o.scrollIntoView()),!0}function GG(t,e,n){let r=t.tr,o=n.parent;for(let f=n.end,p=n.endIndex-1,y=n.startIndex;p>y;p--)f-=o.child(p).nodeSize,r.delete(f-1,f+1);let s=r.doc.resolve(n.start),i=s.nodeAfter;if(r.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let a=n.startIndex==0,l=n.endIndex==o.childCount,c=s.node(-1),u=s.index(-1);if(!c.canReplace(u+(a?0:1),u+1,i.content.append(l?B.empty:B.from(o))))return!1;let d=s.pos,h=d+i.nodeSize;return r.step(new Nt(d-(a?1:0),h+(l?1:0),d+1,h-1,new G((a?B.empty:B.from(o.copy(B.empty))).append(l?B.empty:B.from(o.copy(B.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function KG(t){return function(e,n){let{$from:r,$to:o}=e.selection,s=r.blockRange(o,c=>c.childCount>0&&c.firstChild.type==t);if(!s)return!1;let i=s.startIndex;if(i==0)return!1;let a=s.parent,l=a.child(i-1);if(l.type!=t)return!1;if(n){let c=l.lastChild&&l.lastChild.type==a.type,u=B.from(c?t.create():null),d=new G(B.from(t.create(null,B.from(a.type.create(null,u)))),c?3:1,0),h=s.start,f=s.end;n(e.tr.step(new Nt(h-(c?3:1),f,h,f,d,1,!0)).scrollIntoView())}return!0}}function Qy(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:o}=n,{storedMarks:s}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return r},get doc(){return o},get tr(){return r=n.selection,o=n.doc,s=n.storedMarks,n}}}class Zy{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:r}=this,{view:o}=n,{tr:s}=r,i=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const d=l(...u)(i);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(s),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:r,editor:o,state:s}=this,{view:i}=o,a=[],l=!!e,c=e||s.tr,u=()=>(!l&&n&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(c),a.every(h=>h===!0)),d={...Object.fromEntries(Object.entries(r).map(([h,f])=>[h,(...y)=>{const b=this.buildProps(c,n),w=f(...y)(b);return a.push(w),d}])),run:u};return d}createCan(e){const{rawCommands:n,state:r}=this,o=!1,s=e||r.tr,i=this.buildProps(s,o);return{...Object.fromEntries(Object.entries(n).map(([l,c])=>[l,(...u)=>c(...u)({...i,dispatch:void 0})])),chain:()=>this.createChain(s,o)}}buildProps(e,n=!0){const{rawCommands:r,editor:o,state:s}=this,{view:i}=o,a={tr:e,editor:o,view:i,state:Qy({state:s,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e,n),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class YG{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const r=this.callbacks[e];return r&&r.forEach(o=>o.apply(this,n)),this}off(e,n){const r=this.callbacks[e];return r&&(n?this.callbacks[e]=r.filter(o=>o!==n):delete this.callbacks[e]),this}once(e,n){const r=(...o)=>{this.off(e,r),n.apply(this,o)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function ne(t,e,n){return t.config[e]===void 0&&t.parent?ne(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?ne(t.parent,e,n):null}):t.config[e]}function eb(t){const e=t.filter(o=>o.type==="extension"),n=t.filter(o=>o.type==="node"),r=t.filter(o=>o.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function gO(t){const e=[],{nodeExtensions:n,markExtensions:r}=eb(t),o=[...n,...r],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage,extensions:o},l=ne(i,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([h,f])=>{e.push({type:d,name:h,attribute:{...s,...f}})})})})}),o.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage},l=ne(i,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const h={...s,...d};typeof(h==null?void 0:h.default)=="function"&&(h.default=h.default()),h!=null&&h.isRequired&&(h==null?void 0:h.default)===void 0&&delete h.default,e.push({type:i.name,name:u,attribute:h})})}),e}function nn(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function _r(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([o,s])=>{if(!r[o]){r[o]=s;return}if(o==="class"){const a=s?String(s).split(" "):[],l=r[o]?r[o].split(" "):[],c=a.filter(u=>!l.includes(u));r[o]=[...l,...c].join(" ")}else if(o==="style"){const a=s?s.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[o]?r[o].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[d,h]=u.split(":").map(f=>f.trim());c.set(d,h)}),a.forEach(u=>{const[d,h]=u.split(":").map(f=>f.trim());c.set(d,h)}),r[o]=Array.from(c.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else r[o]=s}),r},{})}function og(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>_r(n,r),{})}function yO(t){return typeof t=="function"}function Ne(t,e=void 0,...n){return yO(t)?e?t.bind(e)(...n):t(...n):t}function XG(t={}){return Object.keys(t).length===0&&t.constructor===Object}function JG(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function eA(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const o=e.reduce((s,i)=>{const a=i.attribute.parseHTML?i.attribute.parseHTML(n):JG(n.getAttribute(i.name));return a==null?s:{...s,[i.name]:a}},{});return{...r,...o}}}}function tA(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&XG(n)?!1:n!=null))}function bO(t,e){var n;const r=gO(t),{nodeExtensions:o,markExtensions:s}=eb(t),i=(n=o.find(c=>ne(c,"topNode")))===null||n===void 0?void 0:n.name,a=Object.fromEntries(o.map(c=>{const u=r.filter(w=>w.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},h=t.reduce((w,k)=>{const x=ne(k,"extendNodeSchema",d);return{...w,...x?x(c):{}}},{}),f=tA({...h,content:Ne(ne(c,"content",d)),marks:Ne(ne(c,"marks",d)),group:Ne(ne(c,"group",d)),inline:Ne(ne(c,"inline",d)),atom:Ne(ne(c,"atom",d)),selectable:Ne(ne(c,"selectable",d)),draggable:Ne(ne(c,"draggable",d)),code:Ne(ne(c,"code",d)),whitespace:Ne(ne(c,"whitespace",d)),linebreakReplacement:Ne(ne(c,"linebreakReplacement",d)),defining:Ne(ne(c,"defining",d)),isolating:Ne(ne(c,"isolating",d)),attrs:Object.fromEntries(u.map(w=>{var k;return[w.name,{default:(k=w==null?void 0:w.attribute)===null||k===void 0?void 0:k.default}]}))}),p=Ne(ne(c,"parseHTML",d));p&&(f.parseDOM=p.map(w=>eA(w,u)));const y=ne(c,"renderHTML",d);y&&(f.toDOM=w=>y({node:w,HTMLAttributes:og(w,u)}));const b=ne(c,"renderText",d);return b&&(f.toText=b),[c.name,f]})),l=Object.fromEntries(s.map(c=>{const u=r.filter(b=>b.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},h=t.reduce((b,w)=>{const k=ne(w,"extendMarkSchema",d);return{...b,...k?k(c):{}}},{}),f=tA({...h,inclusive:Ne(ne(c,"inclusive",d)),excludes:Ne(ne(c,"excludes",d)),group:Ne(ne(c,"group",d)),spanning:Ne(ne(c,"spanning",d)),code:Ne(ne(c,"code",d)),attrs:Object.fromEntries(u.map(b=>{var w;return[b.name,{default:(w=b==null?void 0:b.attribute)===null||w===void 0?void 0:w.default}]}))}),p=Ne(ne(c,"parseHTML",d));p&&(f.parseDOM=p.map(b=>eA(b,u)));const y=ne(c,"renderHTML",d);return y&&(f.toDOM=b=>y({mark:b,HTMLAttributes:og(b,u)})),[c.name,f]}));return new o4({topNode:i,nodes:a,marks:l})}function uv(t,e){return e.nodes[t]||e.marks[t]||null}function nA(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function Wx(t,e){const n=Js.fromSchema(e).serializeFragment(t),o=document.implementation.createHTMLDocument().createElement("div");return o.appendChild(n),o.innerHTML}const QG=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(o,s,i,a)=>{var l,c;const u=((c=(l=o.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:o,pos:s,parent:i,index:a}))||o.textContent||"%leaf%";n+=o.isAtom&&!o.isText?u:u.slice(0,Math.max(0,r-s))}),n};function qx(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class Ji{constructor(e){this.find=e.find,this.handler=e.handler}}const ZG=(t,e)=>{if(qx(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function Tp(t){var e;const{editor:n,from:r,to:o,text:s,rules:i,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(h=>h.type.spec.code))return!1;let u=!1;const d=QG(c)+s;return i.forEach(h=>{if(u)return;const f=ZG(d,h.find);if(!f)return;const p=l.state.tr,y=Qy({state:l.state,transaction:p}),b={from:r-(f[0].length-s.length),to:o},{commands:w,chain:k,can:x}=new Zy({editor:n,state:y});h.handler({state:y,range:b,match:f,commands:w,chain:k,can:x})===null||!p.steps.length||(p.setMeta(a,{transform:p,from:r,to:o,text:s}),l.dispatch(p),u=!0)}),u}function eK(t){const{editor:e,rules:n}=t,r=new Re({state:{init(){return null},apply(o,s,i){const a=o.getMeta(r);if(a)return a;const l=o.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=Wx(B.from(u),i.schema);const{from:d}=l,h=d+u.length;Tp({editor:e,from:d,to:h,text:u,rules:n,plugin:r})}),o.selectionSet||o.docChanged?null:s}},props:{handleTextInput(o,s,i,a){return Tp({editor:e,from:s,to:i,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:o=>(setTimeout(()=>{const{$cursor:s}=o.state.selection;s&&Tp({editor:e,from:s.pos,to:s.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(o,s){if(s.key!=="Enter")return!1;const{$cursor:i}=o.state.selection;return i?Tp({editor:e,from:i.pos,to:i.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function tK(t){return Object.prototype.toString.call(t).slice(8,-1)}function _p(t){return tK(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function tb(t,e){const n={...t};return _p(t)&&_p(e)&&Object.keys(e).forEach(r=>{_p(e[r])&&_p(t[r])?n[r]=tb(t[r],e[r]):n[r]=e[r]}),n}class vn{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Ne(ne(this,"addOptions",{name:this.name}))),this.storage=Ne(ne(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new vn(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>tb(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new vn(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Ne(ne(n,"addOptions",{name:n.name})),n.storage=Ne(ne(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,o=e.state.selection.$from;if(o.pos===o.end()){const i=o.marks();if(!!!i.find(c=>(c==null?void 0:c.type.name)===n.name))return!1;const l=i.find(c=>(c==null?void 0:c.type.name)===n.name);return l&&r.removeStoredMark(l),r.insertText(" ",o.pos),e.view.dispatch(r),!0}return!1}}function nK(t){return typeof t=="number"}class rK{constructor(e){this.find=e.find,this.handler=e.handler}}const oK=(t,e,n)=>{if(qx(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(o=>{const s=[o.text];return s.index=o.index,s.input=t,s.data=o.data,o.replaceWith&&(o.text.includes(o.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(o.replaceWith)),s}):[]};function sK(t){const{editor:e,state:n,from:r,to:o,rule:s,pasteEvent:i,dropEvent:a}=t,{commands:l,chain:c,can:u}=new Zy({editor:e,state:n}),d=[];return n.doc.nodesBetween(r,o,(f,p)=>{if(!f.isTextblock||f.type.spec.code)return;const y=Math.max(r,p),b=Math.min(o,p+f.content.size),w=f.textBetween(y-p,b-p,void 0,"ï¿¼");oK(w,s.find,i).forEach(x=>{if(x.index===void 0)return;const A=y+x.index+1,I=A+x[0].length,M={from:n.tr.mapping.map(A),to:n.tr.mapping.map(I)},T=s.handler({state:n,range:M,match:x,commands:l,chain:c,can:u,pasteEvent:i,dropEvent:a});d.push(T)})}),d.every(f=>f!==null)}let Ap=null;const iK=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)===null||e===void 0||e.setData("text/html",t),n};function aK(t){const{editor:e,rules:n}=t;let r=null,o=!1,s=!1,i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:d,to:h,rule:f,pasteEvt:p})=>{const y=u.tr,b=Qy({state:u,transaction:y});if(!(!sK({editor:e,state:b,from:Math.max(d-1,0),to:h.b-1,rule:f,pasteEvent:p,dropEvent:a})||!y.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,y}};return n.map(u=>new Re({view(d){const h=p=>{var y;r=!((y=d.dom.parentElement)===null||y===void 0)&&y.contains(p.target)?d.dom.parentElement:null,r&&(Ap=e)},f=()=>{Ap&&(Ap=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",f),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",f)}}},props:{handleDOMEvents:{drop:(d,h)=>{if(s=r===d.dom.parentElement,a=h,!s){const f=Ap;f&&setTimeout(()=>{const p=f.state.selection;p&&f.commands.deleteRange({from:p.from,to:p.to})},10)}return!1},paste:(d,h)=>{var f;const p=(f=h.clipboardData)===null||f===void 0?void 0:f.getData("text/html");return i=h,o=!!(p!=null&&p.includes("data-pm-slice")),!1}}},appendTransaction:(d,h,f)=>{const p=d[0],y=p.getMeta("uiEvent")==="paste"&&!o,b=p.getMeta("uiEvent")==="drop"&&!s,w=p.getMeta("applyPasteRules"),k=!!w;if(!y&&!b&&!k)return;if(k){let{text:I}=w;typeof I=="string"?I=I:I=Wx(B.from(I),f.schema);const{from:M}=w,T=M+I.length,S=iK(I);return l({rule:u,state:f,from:M,to:{b:T},pasteEvt:S})}const x=h.doc.content.findDiffStart(f.doc.content),A=h.doc.content.findDiffEnd(f.doc.content);if(!(!nK(x)||!A||x===A.b))return l({rule:u,state:f,from:x,to:A,pasteEvt:i})}}))}function lK(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}class Qa{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=Qa.resolve(e),this.schema=bO(this.extensions,n),this.setupExtensions()}static resolve(e){const n=Qa.sort(Qa.flatten(e)),r=lK(n.map(o=>o.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(o=>`'${o}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},o=ne(n,"addExtensions",r);return o?[n,...this.flatten(o())]:n}).flat(10)}static sort(e){return e.sort((r,o)=>{const s=ne(r,"priority")||100,i=ne(o,"priority")||100;return s>i?-1:s<i?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:uv(n.name,this.schema)},o=ne(n,"addCommands",r);return o?{...e,...o()}:e},{})}get plugins(){const{editor:e}=this,n=Qa.sort([...this.extensions].reverse()),r=[],o=[],s=n.map(i=>{const a={name:i.name,options:i.options,storage:i.storage,editor:e,type:uv(i.name,this.schema)},l=[],c=ne(i,"addKeyboardShortcuts",a);let u={};if(i.type==="mark"&&ne(i,"exitable",a)&&(u.ArrowRight=()=>vn.handleExit({editor:e,mark:i})),c){const y=Object.fromEntries(Object.entries(c()).map(([b,w])=>[b,()=>w({editor:e})]));u={...u,...y}}const d=AG(u);l.push(d);const h=ne(i,"addInputRules",a);nA(i,e.options.enableInputRules)&&h&&r.push(...h());const f=ne(i,"addPasteRules",a);nA(i,e.options.enablePasteRules)&&f&&o.push(...f());const p=ne(i,"addProseMirrorPlugins",a);if(p){const y=p();l.push(...y)}return l}).flat();return[eK({editor:e,rules:r}),...aK({editor:e,rules:o}),...s]}get attributes(){return gO(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=eb(this.extensions);return Object.fromEntries(n.filter(r=>!!ne(r,"addNodeView")).map(r=>{const o=this.attributes.filter(l=>l.type===r.name),s={name:r.name,options:r.options,storage:r.storage,editor:e,type:nn(r.name,this.schema)},i=ne(r,"addNodeView",s);if(!i)return[];const a=(l,c,u,d,h)=>{const f=og(l,o);return i()({node:l,view:c,getPos:u,decorations:d,innerDecorations:h,editor:e,extension:r,HTMLAttributes:f})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var n;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:uv(e.name,this.schema)};e.type==="mark"&&(!((n=Ne(ne(e,"keepOnSplit",r)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(e.name);const o=ne(e,"onBeforeCreate",r),s=ne(e,"onCreate",r),i=ne(e,"onUpdate",r),a=ne(e,"onSelectionUpdate",r),l=ne(e,"onTransaction",r),c=ne(e,"onFocus",r),u=ne(e,"onBlur",r),d=ne(e,"onDestroy",r);o&&this.editor.on("beforeCreate",o),s&&this.editor.on("create",s),i&&this.editor.on("update",i),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}}class at{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Ne(ne(this,"addOptions",{name:this.name}))),this.storage=Ne(ne(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new at(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>tb(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new at({...this.config,...e});return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Ne(ne(n,"addOptions",{name:n.name})),n.storage=Ne(ne(n,"addStorage",{name:n.name,options:n.options})),n}}function vO(t,e,n){const{from:r,to:o}=e,{blockSeparator:s=`

`,textSerializers:i={}}=n||{};let a="";return t.nodesBetween(r,o,(l,c,u,d)=>{var h;l.isBlock&&c>r&&(a+=s);const f=i==null?void 0:i[l.type.name];if(f)return u&&(a+=f({node:l,pos:c,parent:u,index:d,range:e})),!1;l.isText&&(a+=(h=l==null?void 0:l.text)===null||h===void 0?void 0:h.slice(Math.max(r,c)-c,o-c))}),a}function wO(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const CO=at.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Re({key:new We("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:o}=e,{ranges:s}=o,i=Math.min(...s.map(u=>u.$from.pos)),a=Math.max(...s.map(u=>u.$to.pos)),l=wO(n);return vO(r,{from:i,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),cK=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),uK=(t=!1)=>({commands:e})=>e.setContent("",t),dK=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:o}=r;return n&&o.forEach(({$from:s,$to:i})=>{t.doc.nodesBetween(s.pos,i.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(l)),h=c.resolve(u.map(l+a.nodeSize)),f=d.blockRange(h);if(!f)return;const p=su(f);if(a.type.isTextblock){const{defaultType:y}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(f.start,y)}(p||p===0)&&e.lift(f,p)})}),!0},hK=t=>e=>t(e),fK=()=>({state:t,dispatch:e})=>hO(t,e),pK=(t,e)=>({editor:n,tr:r})=>{const{state:o}=n,s=o.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const i=r.mapping.map(e);return r.insert(i,s.content),r.setSelection(new ee(r.doc.resolve(i-1))),!0},mK=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const o=t.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===r.type){if(e){const a=o.before(s),l=o.after(s);t.delete(a,l).scrollIntoView()}return!0}return!1},gK=t=>({tr:e,state:n,dispatch:r})=>{const o=nn(t,n.schema),s=e.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===o){if(r){const l=s.before(i),c=s.after(i);e.delete(l,c).scrollIntoView()}return!0}return!1},yK=t=>({tr:e,dispatch:n})=>{const{from:r,to:o}=t;return n&&e.delete(r,o),!0},bK=()=>({state:t,dispatch:e})=>$x(t,e),vK=()=>({commands:t})=>t.keyboardShortcut("Enter"),wK=()=>({state:t,dispatch:e})=>NG(t,e);function sg(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(o=>n.strict?e[o]===t[o]:qx(e[o])?e[o].test(t[o]):e[o]===t[o]):!0}function xO(t,e,n={}){return t.find(r=>r.type===e&&sg(Object.fromEntries(Object.keys(n).map(o=>[o,r.attrs[o]])),n))}function rA(t,e,n={}){return!!xO(t,e,n)}function ph(t,e,n){var r;if(!t||!e)return;let o=t.parent.childAfter(t.parentOffset);if((!o.node||!o.node.marks.some(u=>u.type===e))&&(o=t.parent.childBefore(t.parentOffset)),!o.node||!o.node.marks.some(u=>u.type===e)||(n=n||((r=o.node.marks[0])===null||r===void 0?void 0:r.attrs),!xO([...o.node.marks],e,n)))return;let i=o.index,a=t.start()+o.offset,l=i+1,c=a+o.node.nodeSize;for(;i>0&&rA([...t.parent.child(i-1).marks],e,n);)i-=1,a-=t.parent.child(i).nodeSize;for(;l<t.parent.childCount&&rA([...t.parent.child(l).marks],e,n);)c+=t.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function ma(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const CK=(t,e={})=>({tr:n,state:r,dispatch:o})=>{const s=ma(t,r.schema),{doc:i,selection:a}=n,{$from:l,from:c,to:u}=a;if(o){const d=ph(l,s,e);if(d&&d.from<=c&&d.to>=u){const h=ee.create(i,d.from,d.to);n.setSelection(h)}}return!0},xK=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function nb(t){return t instanceof ee}function Ps(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function kO(t,e=null){if(!e)return null;const n=fe.atStart(t),r=fe.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const o=n.from,s=r.to;return e==="all"?ee.create(t,Ps(0,o,s),Ps(t.content.size,o,s)):ee.create(t,Ps(e,o,s),Ps(e,o,s))}function SO(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function rb(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const kK=(t=null,e={})=>({editor:n,view:r,tr:o,dispatch:s})=>{e={scrollIntoView:!0,...e};const i=()=>{(rb()||SO())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(s&&t===null&&!nb(n.state.selection))return i(),!0;const a=kO(o.doc,t)||n.state.selection,l=n.state.selection.eq(a);return s&&(l||o.setSelection(a),l&&o.storedMarks&&o.setStoredMarks(o.storedMarks),i()),!0},SK=(t,e)=>n=>t.every((r,o)=>e(r,{...n,index:o})),EK=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),EO=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&EO(r)}return t};function Ip(t){const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return EO(n)}function ig(t,e,n){if(t instanceof Os||t instanceof B)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,o=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return B.fromArray(t.map(a=>e.nodeFromJSON(a)));const i=e.nodeFromJSON(t);return n.errorOnInvalidContent&&i.check(),i}catch(s){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",s),ig("",e,n)}if(o){if(n.errorOnInvalidContent){let i=!1,a="";const l=new o4({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(i=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(n.slice?Ls.fromSchema(l).parseSlice(Ip(t),n.parseOptions):Ls.fromSchema(l).parse(Ip(t),n.parseOptions),n.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const s=Ls.fromSchema(e);return n.slice?s.parseSlice(Ip(t),n.parseOptions).content:s.parse(Ip(t),n.parseOptions)}return ig("",e,n)}function TO(t,e,n){const r=t.steps.length-1;if(r<e)return;const o=t.steps[r];if(!(o instanceof Bt||o instanceof Nt))return;const s=t.mapping.maps[r];let i=0;s.forEach((a,l,c,u)=>{i===0&&(i=u)}),t.setSelection(fe.near(t.doc.resolve(i),n))}const TK=t=>!("type"in t),_K=(t,e,n)=>({tr:r,dispatch:o,editor:s})=>{var i;if(o){n={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a;try{a=ig(e,s.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions},errorOnInvalidContent:(i=n.errorOnInvalidContent)!==null&&i!==void 0?i:s.options.enableContentCheck})}catch(p){return s.emit("contentError",{editor:s,error:p,disableCollaboration:()=>{s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}}),!1}let{from:l,to:c}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},u=!0,d=!0;if((TK(a)?a:[a]).forEach(p=>{p.check(),u=u?p.isText&&p.marks.length===0:!1,d=d?p.isBlock:!1}),l===c&&d){const{parent:p}=r.doc.resolve(l);p.isTextblock&&!p.type.spec.code&&!p.childCount&&(l-=1,c+=1)}let f;if(u){if(Array.isArray(e))f=e.map(p=>p.text||"").join("");else if(e instanceof B){let p="";e.forEach(y=>{y.text&&(p+=y.text)}),f=p}else typeof e=="object"&&e&&e.text?f=e.text:f=e;r.insertText(f,l,c)}else f=a,r.replaceWith(l,c,f);n.updateSelection&&TO(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:l,text:f}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:l,text:f})}return!0},AK=()=>({state:t,dispatch:e})=>RG(t,e),IK=()=>({state:t,dispatch:e})=>PG(t,e),MK=()=>({state:t,dispatch:e})=>sO(t,e),RK=()=>({state:t,dispatch:e})=>cO(t,e),PK=()=>({state:t,dispatch:e,tr:n})=>{try{const r=qy(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},DK=()=>({state:t,dispatch:e,tr:n})=>{try{const r=qy(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},NK=()=>({state:t,dispatch:e})=>IG(t,e),OK=()=>({state:t,dispatch:e})=>MG(t,e);function _O(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function LK(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,o,s,i;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))i=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))o=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))rb()||_O()?i=!0:o=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(n=`Alt-${n}`),o&&(n=`Ctrl-${n}`),i&&(n=`Meta-${n}`),s&&(n=`Shift-${n}`),n}const VK=t=>({editor:e,view:n,tr:r,dispatch:o})=>{const s=LK(t).split(/-(?!$)/),i=s.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&o&&r.maybeStep(u)}),!0};function mh(t,e,n={}){const{from:r,to:o,empty:s}=t.selection,i=e?nn(e,t.schema):null,a=[];t.doc.nodesBetween(r,o,(d,h)=>{if(d.isText)return;const f=Math.max(r,h),p=Math.min(o,h+d.nodeSize);a.push({node:d,from:f,to:p})});const l=o-r,c=a.filter(d=>i?i.name===d.node.type.name:!0).filter(d=>sg(d.node.attrs,n,{strict:!1}));return s?!!c.length:c.reduce((d,h)=>d+h.to-h.from,0)>=l}const jK=(t,e={})=>({state:n,dispatch:r})=>{const o=nn(t,n.schema);return mh(n,o,e)?DG(n,r):!1},BK=()=>({state:t,dispatch:e})=>fO(t,e),$K=t=>({state:e,dispatch:n})=>{const r=nn(t,e.schema);return WG(r)(e,n)},FK=()=>({state:t,dispatch:e})=>dO(t,e);function ob(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function oA(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,o)=>(n.includes(o)||(r[o]=t[o]),r),{})}const HK=(t,e)=>({tr:n,state:r,dispatch:o})=>{let s=null,i=null;const a=ob(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(s=nn(t,r.schema)),a==="mark"&&(i=ma(t,r.schema)),o&&n.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{s&&s===c.type&&n.setNodeMarkup(u,void 0,oA(c.attrs,e)),i&&c.marks.length&&c.marks.forEach(d=>{i===d.type&&n.addMark(u,u+c.nodeSize,i.create(oA(d.attrs,e)))})})}),!0):!1},zK=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),UK=()=>({tr:t,dispatch:e})=>{if(e){const n=new hr(t.doc);t.setSelection(n)}return!0},WK=()=>({state:t,dispatch:e})=>aO(t,e),qK=()=>({state:t,dispatch:e})=>uO(t,e),GK=()=>({state:t,dispatch:e})=>VG(t,e),KK=()=>({state:t,dispatch:e})=>$G(t,e),YK=()=>({state:t,dispatch:e})=>BG(t,e);function ag(t,e,n={},r={}){return ig(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}const XK=(t,e=!1,n={},r={})=>({editor:o,tr:s,dispatch:i,commands:a})=>{var l,c;const{doc:u}=s;if(n.preserveWhitespace!=="full"){const d=ag(t,o.schema,n,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:o.options.enableContentCheck});return i&&s.replaceWith(0,u.content.size,d).setMeta("preventUpdate",!e),!0}return i&&s.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:u.content.size},t,{parseOptions:n,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:o.options.enableContentCheck})};function AO(t,e){const n=ma(e,t.schema),{from:r,to:o,empty:s}=t.selection,i=[];s?(t.storedMarks&&i.push(...t.storedMarks),i.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,o,l=>{i.push(...l.marks)});const a=i.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function Gx(t,e){const n=new Ax(t);return e.forEach(r=>{r.steps.forEach(o=>{n.step(o)})}),n}function JK(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function sA(t,e){const n=[];return t.descendants((r,o)=>{e(r)&&n.push({node:r,pos:o})}),n}function lg(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(o,s)=>{n(o)&&r.push({node:o,pos:s})}),r}function QK(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function sb(t){return e=>QK(e.$from,t)}function ZK(t,e){const n=Qa.resolve(t);return bO(n,e)}function eY(t,e){const n={from:0,to:t.content.size};return vO(t,n,e)}function tY(t,e){const n=nn(e,t.schema),{from:r,to:o}=t.selection,s=[];t.doc.nodesBetween(r,o,a=>{s.push(a)});const i=s.reverse().find(a=>a.type.name===n.name);return i?{...i.attrs}:{}}function IO(t,e){const n=ob(typeof e=="string"?e:e.name,t.schema);return n==="node"?tY(t,e):n==="mark"?AO(t,e):{}}function nY(t,e=JSON.stringify){const n={};return t.filter(r=>{const o=e(r);return Object.prototype.hasOwnProperty.call(n,o)?!1:n[o]=!0})}function rY(t){const e=nY(t);return e.length===1?e:e.filter((n,r)=>!e.filter((s,i)=>i!==r).some(s=>n.oldRange.from>=s.oldRange.from&&n.oldRange.to<=s.oldRange.to&&n.newRange.from>=s.newRange.from&&n.newRange.to<=s.newRange.to))}function Kx(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((o,s)=>{const i=[];if(o.ranges.length)o.forEach((a,l)=>{i.push({from:a,to:l})});else{const{from:a,to:l}=n[s];if(a===void 0||l===void 0)return;i.push({from:a,to:l})}i.forEach(({from:a,to:l})=>{const c=e.slice(s).map(a,-1),u=e.slice(s).map(l),d=e.invert().map(c,-1),h=e.invert().map(u);r.push({oldRange:{from:d,to:h},newRange:{from:c,to:u}})})}),rY(r)}function Yx(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(o=>{const s=n.resolve(t),i=ph(s,o.type);i&&r.push({mark:o,...i})}):n.nodesBetween(t,e,(o,s)=>{!o||(o==null?void 0:o.nodeSize)===void 0||r.push(...o.marks.map(i=>({from:s,to:s+o.nodeSize,mark:i})))}),r}function vm(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const o=t.find(s=>s.type===e&&s.name===r);return o?o.attribute.keepOnSplit:!1}))}function fw(t,e,n={}){const{empty:r,ranges:o}=t.selection,s=e?ma(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(d=>s?s.name===d.type.name:!0).find(d=>sg(d.attrs,n,{strict:!1}));let i=0;const a=[];if(o.forEach(({$from:d,$to:h})=>{const f=d.pos,p=h.pos;t.doc.nodesBetween(f,p,(y,b)=>{if(!y.isText&&!y.marks.length)return;const w=Math.max(f,b),k=Math.min(p,b+y.nodeSize),x=k-w;i+=x,a.push(...y.marks.map(A=>({mark:A,from:w,to:k})))})}),i===0)return!1;const l=a.filter(d=>s?s.name===d.mark.type.name:!0).filter(d=>sg(d.mark.attrs,n,{strict:!1})).reduce((d,h)=>d+h.to-h.from,0),c=a.filter(d=>s?d.mark.type!==s&&d.mark.type.excludes(s):!0).reduce((d,h)=>d+h.to-h.from,0);return(l>0?l+c:l)>=i}function oY(t,e,n={}){if(!e)return mh(t,null,n)||fw(t,null,n);const r=ob(e,t.schema);return r==="node"?mh(t,e,n):r==="mark"?fw(t,e,n):!1}function iA(t,e){const{nodeExtensions:n}=eb(e),r=n.find(i=>i.name===t);if(!r)return!1;const o={name:r.name,options:r.options,storage:r.storage},s=Ne(ne(r,"group",o));return typeof s!="string"?!1:s.split(" ").includes("list")}function Xx(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!==null&&r!==void 0?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let o=!0;return t.content.forEach(s=>{o!==!1&&(Xx(s,{ignoreWhitespace:n,checkChildren:e})||(o=!1))}),o}return!1}function pw(t){return t instanceof se}function cg(t,e,n){const o=t.state.doc.content.size,s=Ps(e,0,o),i=Ps(n,0,o),a=t.coordsAtPos(s),l=t.coordsAtPos(i,-1),c=Math.min(a.top,l.top),u=Math.max(a.bottom,l.bottom),d=Math.min(a.left,l.left),h=Math.max(a.right,l.right),f=h-d,p=u-c,w={top:c,bottom:u,left:d,right:h,width:f,height:p,x:d,y:c};return{...w,toJSON:()=>w}}function sY(t,e,n){var r;const{selection:o}=e;let s=null;if(nb(o)&&(s=o.$cursor),s){const a=(r=t.storedMarks)!==null&&r!==void 0?r:s.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:i}=o;return i.some(({$from:a,$to:l})=>{let c=a.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(a.pos,l.pos,(u,d,h)=>{if(c)return!1;if(u.isInline){const f=!h||h.type.allowsMarkType(n),p=!!n.isInSet(u.marks)||!u.marks.some(y=>y.type.excludes(n));c=f&&p}return!c}),c})}const iY=(t,e={})=>({tr:n,state:r,dispatch:o})=>{const{selection:s}=n,{empty:i,ranges:a}=s,l=ma(t,r.schema);if(o)if(i){const c=AO(r,l);n.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(h,f)=>{const p=Math.max(f,u),y=Math.min(f+h.nodeSize,d);h.marks.find(w=>w.type===l)?h.marks.forEach(w=>{l===w.type&&n.addMark(p,y,l.create({...w.attrs,...e}))}):n.addMark(p,y,l.create(e))})});return sY(r,n,l)},aY=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),lY=(t,e={})=>({state:n,dispatch:r,chain:o})=>{const s=nn(t,n.schema);let i;return n.selection.$anchor.sameParent(n.selection.$head)&&(i=n.selection.$anchor.parent.attrs),s.isTextblock?o().command(({commands:a})=>Z2(s,{...i,...e})(n)?!0:a.clearNodes()).command(({state:a})=>Z2(s,{...i,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},cY=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,o=Ps(t,0,r.content.size),s=se.create(r,o);e.setSelection(s)}return!0},uY=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:o,to:s}=typeof t=="number"?{from:t,to:t}:t,i=ee.atStart(r).from,a=ee.atEnd(r).to,l=Ps(o,i,a),c=Ps(s,i,a),u=ee.create(r,l,c);e.setSelection(u)}return!0},dY=t=>({state:e,dispatch:n})=>{const r=nn(t,e.schema);return KG(r)(e,n)};function aA(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(o=>e==null?void 0:e.includes(o.type.name));t.tr.ensureMarks(r)}}const hY=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:o})=>{const{selection:s,doc:i}=e,{$from:a,$to:l}=s,c=o.extensionManager.attributes,u=vm(c,a.node().type.name,a.node().attrs);if(s instanceof se&&s.node.isBlock)return!a.parentOffset||!Vs(i,a.pos)?!1:(r&&(t&&aA(n,o.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,h=a.depth===0?void 0:JK(a.node(-1).contentMatchAt(a.indexAfter(-1)));let f=d&&h?[{type:h,attrs:u}]:void 0,p=Vs(e.doc,e.mapping.map(a.pos),1,f);if(!f&&!p&&Vs(e.doc,e.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(p=!0,f=h?[{type:h,attrs:u}]:void 0),r){if(p&&(s instanceof ee&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,f),h&&!d&&!a.parentOffset&&a.parent.type!==h)){const y=e.mapping.map(a.before()),b=e.doc.resolve(y);a.node(-1).canReplaceWith(b.index(),b.index()+1,h)&&e.setNodeMarkup(e.mapping.map(a.before()),h)}t&&aA(n,o.extensionManager.splittableMarks),e.scrollIntoView()}return p},fY=(t,e={})=>({tr:n,state:r,dispatch:o,editor:s})=>{var i;const a=nn(t,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const d=l.node(-1);if(d.type!==a)return!1;const h=s.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(o){let w=B.empty;const k=l.index(-1)?1:l.index(-2)?2:3;for(let S=l.depth-k;S>=l.depth-3;S-=1)w=B.from(l.node(S).copy(w));const x=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,A={...vm(h,l.node().type.name,l.node().attrs),...e},I=((i=a.contentMatch.defaultType)===null||i===void 0?void 0:i.createAndFill(A))||void 0;w=w.append(B.from(a.createAndFill(null,I)||void 0));const M=l.before(l.depth-(k-1));n.replace(M,l.after(-x),new G(w,4-k,0));let T=-1;n.doc.nodesBetween(M,n.doc.content.size,(S,_)=>{if(T>-1)return!1;S.isTextblock&&S.content.size===0&&(T=_+1)}),T>-1&&n.setSelection(ee.near(n.doc.resolve(T))),n.scrollIntoView()}return!0}const f=c.pos===l.end()?d.contentMatchAt(0).defaultType:null,p={...vm(h,d.type.name,d.attrs),...e},y={...vm(h,l.node().type.name,l.node().attrs),...e};n.delete(l.pos,c.pos);const b=f?[{type:a,attrs:p},{type:f,attrs:y}]:[{type:a,attrs:p}];if(!Vs(n.doc,l.pos,2))return!1;if(o){const{selection:w,storedMarks:k}=r,{splittableMarks:x}=s.extensionManager,A=k||w.$to.parentOffset&&w.$from.marks();if(n.split(l.pos,2,b).scrollIntoView(),!A||!o)return!0;const I=A.filter(M=>x.includes(M.type.name));n.ensureMarks(I)}return!0},dv=(t,e)=>{const n=sb(i=>i.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const o=t.doc.nodeAt(r);return n.node.type===(o==null?void 0:o.type)&&Dl(t.doc,n.pos)&&t.join(n.pos),!0},hv=(t,e)=>{const n=sb(i=>i.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const o=t.doc.nodeAt(r);return n.node.type===(o==null?void 0:o.type)&&Dl(t.doc,r)&&t.join(r),!0},pY=(t,e,n,r={})=>({editor:o,tr:s,state:i,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:h}=o.extensionManager,f=nn(t,i.schema),p=nn(e,i.schema),{selection:y,storedMarks:b}=i,{$from:w,$to:k}=y,x=w.blockRange(k),A=b||y.$to.parentOffset&&y.$from.marks();if(!x)return!1;const I=sb(M=>iA(M.type.name,d))(y);if(x.depth>=1&&I&&x.depth-I.depth<=1){if(I.node.type===f)return c.liftListItem(p);if(iA(I.node.type.name,d)&&f.validContent(I.node.content)&&a)return l().command(()=>(s.setNodeMarkup(I.pos,f),!0)).command(()=>dv(s,f)).command(()=>hv(s,f)).run()}return!n||!A||!a?l().command(()=>u().wrapInList(f,r)?!0:c.clearNodes()).wrapInList(f,r).command(()=>dv(s,f)).command(()=>hv(s,f)).run():l().command(()=>{const M=u().wrapInList(f,r),T=A.filter(S=>h.includes(S.type.name));return s.ensureMarks(T),M?!0:c.clearNodes()}).wrapInList(f,r).command(()=>dv(s,f)).command(()=>hv(s,f)).run()},mY=(t,e={},n={})=>({state:r,commands:o})=>{const{extendEmptyMarkRange:s=!1}=n,i=ma(t,r.schema);return fw(r,i,e)?o.unsetMark(i,{extendEmptyMarkRange:s}):o.setMark(i,e)},gY=(t,e,n={})=>({state:r,commands:o})=>{const s=nn(t,r.schema),i=nn(e,r.schema),a=mh(r,s,n);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?o.setNode(i,l):o.setNode(s,{...l,...n})},yY=(t,e={})=>({state:n,commands:r})=>{const o=nn(t,n.schema);return mh(n,o,e)?r.lift(o):r.wrapIn(o,e)},bY=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const o=n[r];let s;if(o.spec.isInputRules&&(s=o.getState(t))){if(e){const i=t.tr,a=s.transform;for(let l=a.steps.length-1;l>=0;l-=1)i.step(a.steps[l].invert(a.docs[l]));if(s.text){const l=i.doc.resolve(s.from).marks();i.replaceWith(s.from,s.to,t.schema.text(s.text,l))}else i.delete(s.from,s.to)}return!0}}return!1},vY=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:o}=n;return r||e&&o.forEach(s=>{t.removeMark(s.$from.pos,s.$to.pos)}),!0},wY=(t,e={})=>({tr:n,state:r,dispatch:o})=>{var s;const{extendEmptyMarkRange:i=!1}=e,{selection:a}=n,l=ma(t,r.schema),{$from:c,empty:u,ranges:d}=a;if(!o)return!0;if(u&&i){let{from:h,to:f}=a;const p=(s=c.marks().find(b=>b.type===l))===null||s===void 0?void 0:s.attrs,y=ph(c,l,p);y&&(h=y.from,f=y.to),n.removeMark(h,f,l)}else d.forEach(h=>{n.removeMark(h.$from.pos,h.$to.pos,l)});return n.removeStoredMark(l),!0},CY=(t,e={})=>({tr:n,state:r,dispatch:o})=>{let s=null,i=null;const a=ob(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(s=nn(t,r.schema)),a==="mark"&&(i=ma(t,r.schema)),o&&n.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let d,h,f,p;n.selection.empty?r.doc.nodesBetween(c,u,(y,b)=>{s&&s===y.type&&(f=Math.max(b,c),p=Math.min(b+y.nodeSize,u),d=b,h=y)}):r.doc.nodesBetween(c,u,(y,b)=>{b<c&&s&&s===y.type&&(f=Math.max(b,c),p=Math.min(b+y.nodeSize,u),d=b,h=y),b>=c&&b<=u&&(s&&s===y.type&&n.setNodeMarkup(b,void 0,{...y.attrs,...e}),i&&y.marks.length&&y.marks.forEach(w=>{if(i===w.type){const k=Math.max(b,c),x=Math.min(b+y.nodeSize,u);n.addMark(k,x,i.create({...w.attrs,...e}))}}))}),h&&(d!==void 0&&n.setNodeMarkup(d,void 0,{...h.attrs,...e}),i&&h.marks.length&&h.marks.forEach(y=>{i===y.type&&n.addMark(f,p,i.create({...y.attrs,...e}))}))}),!0):!1},xY=(t,e={})=>({state:n,dispatch:r})=>{const o=nn(t,n.schema);return FG(o,e)(n,r)},kY=(t,e={})=>({state:n,dispatch:r})=>{const o=nn(t,n.schema);return HG(o,e)(n,r)};var SY=Object.freeze({__proto__:null,blur:cK,clearContent:uK,clearNodes:dK,command:hK,createParagraphNear:fK,cut:pK,deleteCurrentNode:mK,deleteNode:gK,deleteRange:yK,deleteSelection:bK,enter:vK,exitCode:wK,extendMarkRange:CK,first:xK,focus:kK,forEach:SK,insertContent:EK,insertContentAt:_K,joinBackward:MK,joinDown:IK,joinForward:RK,joinItemBackward:PK,joinItemForward:DK,joinTextblockBackward:NK,joinTextblockForward:OK,joinUp:AK,keyboardShortcut:VK,lift:jK,liftEmptyBlock:BK,liftListItem:$K,newlineInCode:FK,resetAttributes:HK,scrollIntoView:zK,selectAll:UK,selectNodeBackward:WK,selectNodeForward:qK,selectParentNode:GK,selectTextblockEnd:KK,selectTextblockStart:YK,setContent:XK,setMark:iY,setMeta:aY,setNode:lY,setNodeSelection:cY,setTextSelection:uY,sinkListItem:dY,splitBlock:hY,splitListItem:fY,toggleList:pY,toggleMark:mY,toggleNode:gY,toggleWrap:yY,undoInputRule:bY,unsetAllMarks:vY,unsetMark:wY,updateAttributes:CY,wrapIn:xY,wrapInList:kY});const MO=at.create({name:"commands",addCommands(){return{...SY}}}),RO=at.create({name:"drop",addProseMirrorPlugins(){return[new Re({key:new We("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),PO=at.create({name:"editable",addProseMirrorPlugins(){return[new Re({key:new We("editable"),props:{editable:()=>this.editor.options.editable}})]}}),DO=new We("focusEvents"),NO=at.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Re({key:DO,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),OO=at.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:h,parent:f}=d,p=d.parent.isTextblock&&h>0?a.doc.resolve(h-1):d,y=p.parent.type.spec.isolating,b=d.pos-d.parentOffset,w=y&&p.parent.childCount===1?b===d.pos:fe.atStart(c).from===h;return!u||!f.type.isTextblock||f.textContent.length||!w||w&&d.parent.type.name==="paragraph"?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},o={...r},s={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return rb()||_O()?s:o},addProseMirrorPlugins(){return[new Re({key:new We("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(y=>y.getMeta("composition")))return;const r=t.some(y=>y.docChanged)&&!e.doc.eq(n.doc),o=t.some(y=>y.getMeta("preventClearDocument"));if(!r||o)return;const{empty:s,from:i,to:a}=e.selection,l=fe.atStart(e.doc).from,c=fe.atEnd(e.doc).to;if(s||!(i===l&&a===c)||!Xx(n.doc))return;const h=n.tr,f=Qy({state:n,transaction:h}),{commands:p}=new Zy({editor:this.editor,state:f});if(p.clearNodes(),!!h.steps.length)return h}})]}}),LO=at.create({name:"paste",addProseMirrorPlugins(){return[new Re({key:new We("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),VO=at.create({name:"tabindex",addProseMirrorPlugins(){return[new Re({key:new We("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});var Qu=Object.freeze({__proto__:null,ClipboardTextSerializer:CO,Commands:MO,Drop:RO,Editable:PO,FocusEvents:NO,Keymap:OO,Paste:LO,Tabindex:VO,focusEventsPluginKey:DO});class Wa{get name(){return this.node.type.name}constructor(e,n,r=!1,o=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=o}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You canâ€™t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new Wa(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Wa(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Wa(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const o=n.isBlock&&!n.isTextblock,s=n.isAtom&&!n.isText,i=this.pos+r+(s?0:1),a=this.resolvedPos.doc.resolve(i);if(!o&&a.depth<=this.depth)return;const l=new Wa(a,this.editor,o,o?n:null);o&&(l.actualDepth=this.depth+1),e.push(new Wa(a,this.editor,o,o?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,o=this.parent;for(;o&&!r;){if(o.node.type.name===e)if(Object.keys(n).length>0){const s=o.node.attrs,i=Object.keys(n);for(let a=0;a<i.length;a+=1){const l=i[a];if(s[l]!==n[l])break}}else r=o;o=o.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let o=[];if(!this.children||this.children.length===0)return o;const s=Object.keys(n);return this.children.forEach(i=>{r&&o.length>0||(i.node.type.name===e&&s.every(l=>n[l]===i.node.attrs[l])&&o.push(i),!(r&&o.length>0)&&(o=o.concat(i.querySelectorAll(e,n,r))))}),o}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}}const EY=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function TY(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const o=document.createElement("style");return e&&o.setAttribute("nonce",e),o.setAttribute("data-tiptap-style",""),o.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(o),o}class _Y extends YG{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:o})=>this.options.onDrop(n,r,o)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=TY(EY,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const r=yO(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],o=this.state.reconfigure({plugins:r});return this.view.updateState(o),o}unregisterPlugin(e){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(e).forEach(s=>{const i=typeof s=="string"?`${s}$`:s.key;r=r.filter(a=>!a.key.startsWith(i))}),n.length===r.length)return;const o=this.state.reconfigure({plugins:r});return this.view.updateState(o),o}createExtensionManager(){var e,n;const o=[...this.options.enableCoreExtensions?[PO,CO.configure({blockSeparator:(n=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),MO,NO,OO,VO,RO,LO].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s==null?void 0:s.type));this.extensionManager=new Qa(o,this)}createCommandManager(){this.commandManager=new Zy({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let n;try{n=ag(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(i){if(!(i instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(i.message))throw i;this.emit("contentError",{editor:this,error:i,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),n=ag(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=kO(n,this.options.autofocus);this.view=new rO(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:Ya.create({doc:n,selection:r||void 0})});const o=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(o),this.createNodeViews(),this.prependClass();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(i=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(i)});return}const n=this.state.apply(e),r=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const o=e.getMeta("focus"),s=e.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:e}),s&&this.emit("blur",{editor:this,event:s.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return IO(this.state,e)}isActive(e,n){const r=typeof e=="string"?e:null,o=typeof e=="string"?n:e;return oY(this.state,r,o)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Wx(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:r={}}=e||{};return eY(this.state.doc,{blockSeparator:n,textSerializers:{...wO(this.schema),...r}})}get isEmpty(){return Xx(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,n))||null}$nodes(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,n))||null}$pos(e){const n=this.state.doc.resolve(e);return new Wa(n,this)}get $doc(){return this.$pos(0)}}function Vc(t){return new Ji({find:t.find,handler:({state:e,range:n,match:r})=>{const o=Ne(t.getAttributes,void 0,r);if(o===!1||o===null)return null;const{tr:s}=e,i=r[r.length-1],a=r[0];if(i){const l=a.search(/\S/),c=n.from+a.indexOf(i),u=c+i.length;if(Yx(n.from,n.to,e.doc).filter(f=>f.mark.type.excluded.find(y=>y===t.type&&y!==f.mark.type)).filter(f=>f.to>c).length)return null;u<n.to&&s.delete(u,n.to),c>n.from&&s.delete(n.from+l,c);const h=n.from+l+i.length;s.addMark(n.from+l,h,t.type.create(o||{})),s.removeStoredMark(t.type)}}})}let cs=class mw{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Ne(ne(this,"addOptions",{name:this.name}))),this.storage=Ne(ne(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new mw(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>tb(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new mw(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Ne(ne(n,"addOptions",{name:n.name})),n.storage=Ne(ne(n,"addStorage",{name:n.name,options:n.options})),n}};class AY{constructor(e,n,r){this.isDragging=!1,this.component=e,this.editor=n.editor,this.options={stopEvent:null,ignoreMutation:null,...r},this.extension=n.extension,this.node=n.node,this.decorations=n.decorations,this.innerDecorations=n.innerDecorations,this.view=n.view,this.HTMLAttributes=n.HTMLAttributes,this.getPos=n.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(e){var n,r,o,s,i,a,l;const{view:c}=this.editor,u=e.target,d=u.nodeType===3?(n=u.parentElement)===null||n===void 0?void 0:n.closest("[data-drag-handle]"):u.closest("[data-drag-handle]");if(!this.dom||!((r=this.contentDOM)===null||r===void 0)&&r.contains(u)||!d)return;let h=0,f=0;if(this.dom!==d){const k=this.dom.getBoundingClientRect(),x=d.getBoundingClientRect(),A=(o=e.offsetX)!==null&&o!==void 0?o:(s=e.nativeEvent)===null||s===void 0?void 0:s.offsetX,I=(i=e.offsetY)!==null&&i!==void 0?i:(a=e.nativeEvent)===null||a===void 0?void 0:a.offsetY;h=x.x-k.x+A,f=x.y-k.y+I}const p=this.dom.cloneNode(!0);(l=e.dataTransfer)===null||l===void 0||l.setDragImage(p,h,f);const y=this.getPos();if(typeof y!="number")return;const b=se.create(c.state.doc,y),w=c.state.tr.setSelection(b);c.dispatch(w)}stopEvent(e){var n;if(!this.dom)return!1;if(typeof this.options.stopEvent=="function")return this.options.stopEvent({event:e});const r=e.target;if(!(this.dom.contains(r)&&!(!((n=this.contentDOM)===null||n===void 0)&&n.contains(r))))return!1;const s=e.type.startsWith("drag"),i=e.type==="drop";if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(r.tagName)||r.isContentEditable)&&!i&&!s)return!0;const{isEditable:l}=this.editor,{isDragging:c}=this,u=!!this.node.type.spec.draggable,d=se.isSelectable(this.node),h=e.type==="copy",f=e.type==="paste",p=e.type==="cut",y=e.type==="mousedown";if(!u&&d&&s&&e.target===this.dom&&e.preventDefault(),u&&s&&!c&&e.target===this.dom)return e.preventDefault(),!1;if(u&&l&&!c&&y){const b=r.closest("[data-drag-handle]");b&&(this.dom===b||this.dom.contains(b))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(c||i||h||f||p||y&&d)}ignoreMutation(e){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:e}):this.node.isLeaf||this.node.isAtom?!0:e.type==="selection"||this.dom.contains(e.target)&&e.type==="childList"&&(rb()||SO())&&this.editor.isFocused&&[...Array.from(e.addedNodes),...Array.from(e.removedNodes)].every(r=>r.isContentEditable)?!1:this.contentDOM===e.target&&e.type==="attributes"?!0:!this.contentDOM.contains(e.target)}updateAttributes(e){this.editor.commands.command(({tr:n})=>{const r=this.getPos();return typeof r!="number"?!1:(n.setNodeMarkup(r,void 0,{...this.node.attrs,...e}),!0)})}deleteNode(){const e=this.getPos();if(typeof e!="number")return;const n=e+this.node.nodeSize;this.editor.commands.deleteRange({from:e,to:n})}}function vl(t){return new rK({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:o})=>{const s=Ne(t.getAttributes,void 0,r,o);if(s===!1||s===null)return null;const{tr:i}=e,a=r[r.length-1],l=r[0];let c=n.to;if(a){const u=l.search(/\S/),d=n.from+l.indexOf(a),h=d+a.length;if(Yx(n.from,n.to,e.doc).filter(p=>p.mark.type.excluded.find(b=>b===t.type&&b!==p.mark.type)).filter(p=>p.to>d).length)return null;h<n.to&&i.delete(h,n.to),d>n.from&&i.delete(n.from+u,d),c=n.from+u+a.length,i.addMark(n.from+u,c,t.type.create(s||{})),i.removeStoredMark(t.type)}}})}var Mp,IY=new Uint8Array(16);function MY(){if(!Mp&&(Mp=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Mp))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Mp(IY)}const RY=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function PY(t){return typeof t=="string"&&RY.test(t)}var cn=[];for(var fv=0;fv<256;++fv)cn.push((fv+256).toString(16).substr(1));function DY(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(cn[t[e+0]]+cn[t[e+1]]+cn[t[e+2]]+cn[t[e+3]]+"-"+cn[t[e+4]]+cn[t[e+5]]+"-"+cn[t[e+6]]+cn[t[e+7]]+"-"+cn[t[e+8]]+cn[t[e+9]]+"-"+cn[t[e+10]]+cn[t[e+11]]+cn[t[e+12]]+cn[t[e+13]]+cn[t[e+14]]+cn[t[e+15]]).toLowerCase();if(!PY(n))throw TypeError("Stringified UUID is invalid");return n}function jO(t,e,n){t=t||{};var r=t.random||(t.rng||MY)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,DY(r)}var NY=class BO{constructor(e){this.cache=new Map(e)}get(e){return this.cache.get(e)}set(e,n,r){e<0||this.cache.set(e,[n,r])}replace(e,n,r,o){this.remove(e),this.set(n,r,o)}remove(e){this.cache.delete(e)}invalidate(e){const n=new BO(this.cache),r=e.mapping;return this.cache.forEach(([o,s],i)=>{if(i<0)return;const a=r.mapResult(i),l=e.doc.nodeAt(a.pos);if(a.deleted||!(l!=null&&l.eq(o)))n.remove(i);else if(i!==a.pos){const c=s.map(u=>u.map(r,0,0)).filter(u=>u!=null);n.replace(i,a.pos,l,c)}}),n}};function OY({parser:t,nodeTypes:e=["code_block","codeBlock"],languageExtractor:n=r=>r.attrs.language}){const r=new We("prosemirror-highlight");return new Re({key:r,state:{init(o,s){const i=new NY,[a,l]=lA(s.doc,t,e,n,i);return{cache:i,decorations:a,promises:l}},apply:(o,s)=>{const i=s.cache.invalidate(o),a=!!o.getMeta("prosemirror-highlight-refresh");if(!o.docChanged&&!a){const u=s.decorations.map(o.mapping,o.doc),d=s.promises;return{cache:i,decorations:u,promises:d}}const[l,c]=lA(o.doc,t,e,n,i);return{cache:i,decorations:l,promises:c}}},view:o=>{const s=new Set,i=()=>{if(s.size>0)return;const l=o.state.tr.setMeta("prosemirror-highlight-refresh",!0);o.dispatch(l)},a=()=>{var l;const c=r.getState(o.state);for(const u of(l=c==null?void 0:c.promises)!=null?l:[])s.add(u),u.then(()=>{s.delete(u),i()}).catch(()=>{s.delete(u)})};return a(),{update:()=>{a()}}},props:{decorations(o){var s;return(s=this.getState(o))==null?void 0:s.decorations}}})}function lA(t,e,n,r,o){const s=[],i=[];return t.descendants((a,l)=>{if(!a.type.isTextblock)return!0;if(n.includes(a.type.name)){const c=r(a),u=o.get(l);if(u){const[d,h]=u;s.push(...h)}else{const d=e({content:a.textContent,language:c||void 0,pos:l,size:a.nodeSize});d&&Array.isArray(d)?(o.set(l,a,d),s.push(...d)):d instanceof Promise&&(o.remove(l),i.push(d))}}return!1}),[Oe.create(t,s),i]}function LY(t,e){return function({content:r,language:o,pos:s,size:i}){var a;const l=[],{tokens:c,fg:u,bg:d,rootStyle:h}=t.codeToTokens(r,{lang:o,theme:t.getLoadedThemes()[0]}),f=h||(u&&d?`--prosemirror-highlight:${u};--prosemirror-highlight-bg:${d}`:"");if(f){const y=et.node(s,s+i,{style:f});l.push(y)}let p=s+1;for(const y of c){for(const b of y){const w=p+b.content.length,k=et.inline(p,w,{style:VY((a=b.htmlStyle)!=null?a:`color: ${b.color}`),class:"shiki"});l.push(k),p=w}p+=1}return l}}function VY(t){return typeof t=="string"?t:Object.entries(t).map(([e,n])=>`${e}:${n}`).join(";")}const jY=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,BY=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,$Y=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,FY=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,HY=vn.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",_r(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Vc({find:jY,type:this.type}),Vc({find:$Y,type:this.type})]},addPasteRules(){return[vl({find:BY,type:this.type}),vl({find:FY,type:this.type})]}}),zY=/(^|[^`])`([^`]+)`(?!`)/,UY=/(^|[^`])`([^`]+)`(?!`)/g,WY=vn.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",_r(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Vc({find:zY,type:this.type})]},addPasteRules(){return[vl({find:UY,type:this.type})]}}),qY=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,GY=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,KY=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,YY=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,XY=vn.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",_r(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Vc({find:qY,type:this.type}),Vc({find:KY,type:this.type})]},addPasteRules(){return[vl({find:GY,type:this.type}),vl({find:YY,type:this.type})]}}),JY=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,QY=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,ZY=vn.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",_r(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Vc({find:JY,type:this.type})]},addPasteRules(){return[vl({find:QY,type:this.type})]}}),eX=vn.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",_r(this.options.HTMLAttributes,t),0]},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),tX=cs.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth");return e?e.split(",").map(r=>parseInt(r,10)):null}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:t}){return["td",_r(this.options.HTMLAttributes,t),0]}}),nX=cs.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth");return e?e.split(",").map(r=>parseInt(r,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:t}){return["th",_r(this.options.HTMLAttributes,t),0]}});var gw,yw;if(typeof WeakMap<"u"){let t=new WeakMap;gw=e=>t.get(e),yw=(e,n)=>(t.set(e,n),n)}else{const t=[];let n=0;gw=r=>{for(let o=0;o<t.length;o+=2)if(t[o]==r)return t[o+1]},yw=(r,o)=>(n==10&&(n=0),t[n++]=r,t[n++]=o)}var bt=class{constructor(t,e,n,r){this.width=t,this.height=e,this.map=n,this.problems=r}findCell(t){for(let e=0;e<this.map.length;e++){const n=this.map[e];if(n!=t)continue;const r=e%this.width,o=e/this.width|0;let s=r+1,i=o+1;for(let a=1;s<this.width&&this.map[e+a]==n;a++)s++;for(let a=1;i<this.height&&this.map[e+this.width*a]==n;a++)i++;return{left:r,top:o,right:s,bottom:i}}throw new RangeError(`No cell with offset ${t} found`)}colCount(t){for(let e=0;e<this.map.length;e++)if(this.map[e]==t)return e%this.width;throw new RangeError(`No cell with offset ${t} found`)}nextCell(t,e,n){const{left:r,right:o,top:s,bottom:i}=this.findCell(t);return e=="horiz"?(n<0?r==0:o==this.width)?null:this.map[s*this.width+(n<0?r-1:o)]:(n<0?s==0:i==this.height)?null:this.map[r+this.width*(n<0?s-1:i)]}rectBetween(t,e){const{left:n,right:r,top:o,bottom:s}=this.findCell(t),{left:i,right:a,top:l,bottom:c}=this.findCell(e);return{left:Math.min(n,i),top:Math.min(o,l),right:Math.max(r,a),bottom:Math.max(s,c)}}cellsInRect(t){const e=[],n={};for(let r=t.top;r<t.bottom;r++)for(let o=t.left;o<t.right;o++){const s=r*this.width+o,i=this.map[s];n[i]||(n[i]=!0,!(o==t.left&&o&&this.map[s-1]==i||r==t.top&&r&&this.map[s-this.width]==i)&&e.push(i))}return e}positionAt(t,e,n){for(let r=0,o=0;;r++){const s=o+n.child(r).nodeSize;if(r==t){let i=e+t*this.width;const a=(t+1)*this.width;for(;i<a&&this.map[i]<o;)i++;return i==a?s-1:this.map[i]}o=s}}static get(t){return gw(t)||yw(t,rX(t))}};function rX(t){if(t.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+t.type.name);const e=oX(t),n=t.childCount,r=[];let o=0,s=null;const i=[];for(let c=0,u=e*n;c<u;c++)r[c]=0;for(let c=0,u=0;c<n;c++){const d=t.child(c);u++;for(let p=0;;p++){for(;o<r.length&&r[o]!=0;)o++;if(p==d.childCount)break;const y=d.child(p),{colspan:b,rowspan:w,colwidth:k}=y.attrs;for(let x=0;x<w;x++){if(x+c>=n){(s||(s=[])).push({type:"overlong_rowspan",pos:u,n:w-x});break}const A=o+x*e;for(let I=0;I<b;I++){r[A+I]==0?r[A+I]=u:(s||(s=[])).push({type:"collision",row:c,pos:u,n:b-I});const M=k&&k[I];if(M){const T=(A+I)%e*2,S=i[T];S==null||S!=M&&i[T+1]==1?(i[T]=M,i[T+1]=1):S==M&&i[T+1]++}}}o+=b,u+=y.nodeSize}const h=(c+1)*e;let f=0;for(;o<h;)r[o++]==0&&f++;f&&(s||(s=[])).push({type:"missing",row:c,n:f}),u++}(e===0||n===0)&&(s||(s=[])).push({type:"zero_sized"});const a=new bt(e,n,r,s);let l=!1;for(let c=0;!l&&c<i.length;c+=2)i[c]!=null&&i[c+1]<n&&(l=!0);return l&&sX(a,i,t),a}function oX(t){let e=-1,n=!1;for(let r=0;r<t.childCount;r++){const o=t.child(r);let s=0;if(n)for(let i=0;i<r;i++){const a=t.child(i);for(let l=0;l<a.childCount;l++){const c=a.child(l);i+c.attrs.rowspan>r&&(s+=c.attrs.colspan)}}for(let i=0;i<o.childCount;i++){const a=o.child(i);s+=a.attrs.colspan,a.attrs.rowspan>1&&(n=!0)}e==-1?e=s:e!=s&&(e=Math.max(e,s))}return e}function sX(t,e,n){t.problems||(t.problems=[]);const r={};for(let o=0;o<t.map.length;o++){const s=t.map[o];if(r[s])continue;r[s]=!0;const i=n.nodeAt(s);if(!i)throw new RangeError(`No cell with offset ${s} found`);let a=null;const l=i.attrs;for(let c=0;c<l.colspan;c++){const u=(o+c)%t.width,d=e[u*2];d!=null&&(!l.colwidth||l.colwidth[c]!=d)&&((a||(a=iX(l)))[c]=d)}a&&t.problems.unshift({type:"colwidth mismatch",pos:s,colwidth:a})}}function iX(t){if(t.colwidth)return t.colwidth.slice();const e=[];for(let n=0;n<t.colspan;n++)e.push(0);return e}function Bn(t){let e=t.cached.tableNodeTypes;if(!e){e=t.cached.tableNodeTypes={};for(const n in t.nodes){const r=t.nodes[n],o=r.spec.tableRole;o&&(e[o]=r)}}return e}var Mi=new We("selectingCells");function iu(t){for(let e=t.depth-1;e>0;e--)if(t.node(e).type.spec.tableRole=="row")return t.node(0).resolve(t.before(e+1));return null}function aX(t){for(let e=t.depth;e>0;e--){const n=t.node(e).type.spec.tableRole;if(n==="cell"||n==="header_cell")return t.node(e)}return null}function us(t){const e=t.selection.$head;for(let n=e.depth;n>0;n--)if(e.node(n).type.spec.tableRole=="row")return!0;return!1}function Jx(t){const e=t.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const n=iu(e.$head)||lX(e.$head);if(n)return n;throw new RangeError(`No cell found around position ${e.head}`)}function lX(t){for(let e=t.nodeAfter,n=t.pos;e;e=e.firstChild,n++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n)}for(let e=t.nodeBefore,n=t.pos;e;e=e.lastChild,n--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n-e.nodeSize)}}function bw(t){return t.parent.type.spec.tableRole=="row"&&!!t.nodeAfter}function cX(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function Qx(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function $O(t,e,n){const r=t.node(-1),o=bt.get(r),s=t.start(-1),i=o.nextCell(t.pos-s,e,n);return i==null?null:t.node(0).resolve(s+i)}function wl(t,e,n=1){const r={...t,colspan:t.colspan-n};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,n),r.colwidth.some(o=>o>0)||(r.colwidth=null)),r}function FO(t,e,n=1){const r={...t,colspan:t.colspan+n};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let o=0;o<n;o++)r.colwidth.splice(e,0,0)}return r}function uX(t,e,n){const r=Bn(e.type.schema).header_cell;for(let o=0;o<t.height;o++)if(e.nodeAt(t.map[n+o*t.width]).type!=r)return!1;return!0}var tt=class Es extends fe{constructor(e,n=e){const r=e.node(-1),o=bt.get(r),s=e.start(-1),i=o.rectBetween(e.pos-s,n.pos-s),a=e.node(0),l=o.cellsInRect(i).filter(u=>u!=n.pos-s);l.unshift(n.pos-s);const c=l.map(u=>{const d=r.nodeAt(u);if(!d)throw RangeError(`No cell with offset ${u} found`);const h=s+u+1;return new C4(a.resolve(h),a.resolve(h+d.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=e,this.$headCell=n}map(e,n){const r=e.resolve(n.map(this.$anchorCell.pos)),o=e.resolve(n.map(this.$headCell.pos));if(bw(r)&&bw(o)&&Qx(r,o)){const s=this.$anchorCell.node(-1)!=r.node(-1);return s&&this.isRowSelection()?Es.rowSelection(r,o):s&&this.isColSelection()?Es.colSelection(r,o):new Es(r,o)}return ee.between(r,o)}content(){const e=this.$anchorCell.node(-1),n=bt.get(e),r=this.$anchorCell.start(-1),o=n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),s={},i=[];for(let l=o.top;l<o.bottom;l++){const c=[];for(let u=l*n.width+o.left,d=o.left;d<o.right;d++,u++){const h=n.map[u];if(s[h])continue;s[h]=!0;const f=n.findCell(h);let p=e.nodeAt(h);if(!p)throw RangeError(`No cell with offset ${h} found`);const y=o.left-f.left,b=f.right-o.right;if(y>0||b>0){let w=p.attrs;if(y>0&&(w=wl(w,0,y)),b>0&&(w=wl(w,w.colspan-b,b)),f.left<o.left){if(p=p.type.createAndFill(w),!p)throw RangeError(`Could not create cell with attrs ${JSON.stringify(w)}`)}else p=p.type.create(w,p.content)}if(f.top<o.top||f.bottom>o.bottom){const w={...p.attrs,rowspan:Math.min(f.bottom,o.bottom)-Math.max(f.top,o.top)};f.top<o.top?p=p.type.createAndFill(w):p=p.type.create(w,p.content)}c.push(p)}i.push(e.child(l).copy(B.from(c)))}const a=this.isColSelection()&&this.isRowSelection()?e:i;return new G(B.from(a),1,1)}replace(e,n=G.empty){const r=e.steps.length,o=this.ranges;for(let i=0;i<o.length;i++){const{$from:a,$to:l}=o[i],c=e.mapping.slice(r);e.replace(c.map(a.pos),c.map(l.pos),i?G.empty:n)}const s=fe.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);s&&e.setSelection(s)}replaceWith(e,n){this.replace(e,new G(B.from(n),0,0))}forEachCell(e){const n=this.$anchorCell.node(-1),r=bt.get(n),o=this.$anchorCell.start(-1),s=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-o,this.$headCell.pos-o));for(let i=0;i<s.length;i++)e(n.nodeAt(s[i]),o+s[i])}isColSelection(){const e=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(e,n)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,o=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,o)==this.$headCell.node(-1).childCount}static colSelection(e,n=e){const r=e.node(-1),o=bt.get(r),s=e.start(-1),i=o.findCell(e.pos-s),a=o.findCell(n.pos-s),l=e.node(0);return i.top<=a.top?(i.top>0&&(e=l.resolve(s+o.map[i.left])),a.bottom<o.height&&(n=l.resolve(s+o.map[o.width*(o.height-1)+a.right-1]))):(a.top>0&&(n=l.resolve(s+o.map[a.left])),i.bottom<o.height&&(e=l.resolve(s+o.map[o.width*(o.height-1)+i.right-1]))),new Es(e,n)}isRowSelection(){const e=this.$anchorCell.node(-1),n=bt.get(e),r=this.$anchorCell.start(-1),o=n.colCount(this.$anchorCell.pos-r),s=n.colCount(this.$headCell.pos-r);if(Math.min(o,s)>0)return!1;const i=o+this.$anchorCell.nodeAfter.attrs.colspan,a=s+this.$headCell.nodeAfter.attrs.colspan;return Math.max(i,a)==n.width}eq(e){return e instanceof Es&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,n=e){const r=e.node(-1),o=bt.get(r),s=e.start(-1),i=o.findCell(e.pos-s),a=o.findCell(n.pos-s),l=e.node(0);return i.left<=a.left?(i.left>0&&(e=l.resolve(s+o.map[i.top*o.width])),a.right<o.width&&(n=l.resolve(s+o.map[o.width*(a.top+1)-1]))):(a.left>0&&(n=l.resolve(s+o.map[a.top*o.width])),i.right<o.width&&(e=l.resolve(s+o.map[o.width*(i.top+1)-1]))),new Es(e,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,n){return new Es(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){return new Es(e.resolve(n),e.resolve(r))}getBookmark(){return new dX(this.$anchorCell.pos,this.$headCell.pos)}};tt.prototype.visible=!1;fe.jsonID("cell",tt);var dX=class HO{constructor(e,n){this.anchor=e,this.head=n}map(e){return new HO(e.map(this.anchor),e.map(this.head))}resolve(e){const n=e.resolve(this.anchor),r=e.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&r.index()<r.parent.childCount&&Qx(n,r)?new tt(n,r):fe.near(r,1)}};function hX(t){if(!(t.selection instanceof tt))return null;const e=[];return t.selection.forEachCell((n,r)=>{e.push(et.node(r,r+n.nodeSize,{class:"selectedCell"}))}),Oe.create(t.doc,e)}function fX({$from:t,$to:e}){if(t.pos==e.pos||t.pos<e.pos-6)return!1;let n=t.pos,r=e.pos,o=t.depth;for(;o>=0&&!(t.after(o+1)<t.end(o));o--,n++);for(let s=e.depth;s>=0&&!(e.before(s+1)>e.start(s));s--,r--);return n==r&&/row|table/.test(t.node(o).type.spec.tableRole)}function pX({$from:t,$to:e}){let n,r;for(let o=t.depth;o>0;o--){const s=t.node(o);if(s.type.spec.tableRole==="cell"||s.type.spec.tableRole==="header_cell"){n=s;break}}for(let o=e.depth;o>0;o--){const s=e.node(o);if(s.type.spec.tableRole==="cell"||s.type.spec.tableRole==="header_cell"){r=s;break}}return n!==r&&e.parentOffset===0}function mX(t,e,n){const r=(e||t).selection,o=(e||t).doc;let s,i;if(r instanceof se&&(i=r.node.type.spec.tableRole)){if(i=="cell"||i=="header_cell")s=tt.create(o,r.from);else if(i=="row"){const a=o.resolve(r.from+1);s=tt.rowSelection(a,a)}else if(!n){const a=bt.get(r.node),l=r.from+1,c=l+a.map[a.width*a.height-1];s=tt.create(o,l+1,c)}}else r instanceof ee&&fX(r)?s=ee.create(o,r.from):r instanceof ee&&pX(r)&&(s=ee.create(o,r.$from.start(),r.$from.end()));return s&&(e||(e=t.tr)).setSelection(s),e}var gX=new We("fix-tables");function zO(t,e,n,r){const o=t.childCount,s=e.childCount;e:for(let i=0,a=0;i<s;i++){const l=e.child(i);for(let c=a,u=Math.min(o,i+3);c<u;c++)if(t.child(c)==l){a=c+1,n+=l.nodeSize;continue e}r(l,n),a<o&&t.child(a).sameMarkup(l)?zO(t.child(a),l,n+1,r):l.nodesBetween(0,l.content.size,r,n+1),n+=l.nodeSize}}function yX(t,e){let n;const r=(o,s)=>{o.type.spec.tableRole=="table"&&(n=bX(t,o,s,n))};return e?e.doc!=t.doc&&zO(e.doc,t.doc,0,r):t.doc.descendants(r),n}function bX(t,e,n,r){const o=bt.get(e);if(!o.problems)return r;r||(r=t.tr);const s=[];for(let l=0;l<o.height;l++)s.push(0);for(let l=0;l<o.problems.length;l++){const c=o.problems[l];if(c.type=="collision"){const u=e.nodeAt(c.pos);if(!u)continue;const d=u.attrs;for(let h=0;h<d.rowspan;h++)s[c.row+h]+=c.n;r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,wl(d,d.colspan-c.n,c.n))}else if(c.type=="missing")s[c.row]+=c.n;else if(c.type=="overlong_rowspan"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,{...u.attrs,rowspan:u.attrs.rowspan-c.n})}else if(c.type=="colwidth mismatch"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,{...u.attrs,colwidth:c.colwidth})}else if(c.type=="zero_sized"){const u=r.mapping.map(n);r.delete(u,u+e.nodeSize)}}let i,a;for(let l=0;l<s.length;l++)s[l]&&(i==null&&(i=l),a=l);for(let l=0,c=n+1;l<o.height;l++){const u=e.child(l),d=c+u.nodeSize,h=s[l];if(h>0){let f="cell";u.firstChild&&(f=u.firstChild.type.spec.tableRole);const p=[];for(let b=0;b<h;b++){const w=Bn(t.schema)[f].createAndFill();w&&p.push(w)}const y=(l==0||i==l-1)&&a==l?c+1:d-1;r.insert(r.mapping.map(y),p)}c=d}return r.setMeta(gX,{fixTables:!0})}function ds(t){const e=t.selection,n=Jx(t),r=n.node(-1),o=n.start(-1),s=bt.get(r);return{...e instanceof tt?s.rectBetween(e.$anchorCell.pos-o,e.$headCell.pos-o):s.findCell(n.pos-o),tableStart:o,map:s,table:r}}function UO(t,{map:e,tableStart:n,table:r},o){let s=o>0?-1:0;uX(e,r,o+s)&&(s=o==0||o==e.width?null:0);for(let i=0;i<e.height;i++){const a=i*e.width+o;if(o>0&&o<e.width&&e.map[a-1]==e.map[a]){const l=e.map[a],c=r.nodeAt(l);t.setNodeMarkup(t.mapping.map(n+l),null,FO(c.attrs,o-e.colCount(l))),i+=c.attrs.rowspan-1}else{const l=s==null?Bn(r.type.schema).cell:r.nodeAt(e.map[a+s]).type,c=e.positionAt(i,o,r);t.insert(t.mapping.map(n+c),l.createAndFill())}}return t}function vX(t,e){if(!us(t))return!1;if(e){const n=ds(t);e(UO(t.tr,n,n.left))}return!0}function wX(t,e){if(!us(t))return!1;if(e){const n=ds(t);e(UO(t.tr,n,n.right))}return!0}function CX(t,{map:e,table:n,tableStart:r},o){const s=t.mapping.maps.length;for(let i=0;i<e.height;){const a=i*e.width+o,l=e.map[a],c=n.nodeAt(l),u=c.attrs;if(o>0&&e.map[a-1]==l||o<e.width-1&&e.map[a+1]==l)t.setNodeMarkup(t.mapping.slice(s).map(r+l),null,wl(u,o-e.colCount(l)));else{const d=t.mapping.slice(s).map(r+l);t.delete(d,d+c.nodeSize)}i+=u.rowspan}}function xX(t,e){if(!us(t))return!1;if(e){const n=ds(t),r=t.tr;if(n.left==0&&n.right==n.map.width)return!1;for(let o=n.right-1;CX(r,n,o),o!=n.left;o--){const s=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!s)throw RangeError("No table found");n.table=s,n.map=bt.get(s)}e(r)}return!0}function kX(t,e,n){var r;const o=Bn(e.type.schema).header_cell;for(let s=0;s<t.width;s++)if(((r=e.nodeAt(t.map[s+n*t.width]))==null?void 0:r.type)!=o)return!1;return!0}function WO(t,{map:e,tableStart:n,table:r},o){var s;let i=n;for(let c=0;c<o;c++)i+=r.child(c).nodeSize;const a=[];let l=o>0?-1:0;kX(e,r,o+l)&&(l=o==0||o==e.height?null:0);for(let c=0,u=e.width*o;c<e.width;c++,u++)if(o>0&&o<e.height&&e.map[u]==e.map[u-e.width]){const d=e.map[u],h=r.nodeAt(d).attrs;t.setNodeMarkup(n+d,null,{...h,rowspan:h.rowspan+1}),c+=h.colspan-1}else{const d=l==null?Bn(r.type.schema).cell:(s=r.nodeAt(e.map[u+l*e.width]))==null?void 0:s.type,h=d==null?void 0:d.createAndFill();h&&a.push(h)}return t.insert(i,Bn(r.type.schema).row.create(null,a)),t}function SX(t,e){if(!us(t))return!1;if(e){const n=ds(t);e(WO(t.tr,n,n.top))}return!0}function EX(t,e){if(!us(t))return!1;if(e){const n=ds(t);e(WO(t.tr,n,n.bottom))}return!0}function TX(t,{map:e,table:n,tableStart:r},o){let s=0;for(let c=0;c<o;c++)s+=n.child(c).nodeSize;const i=s+n.child(o).nodeSize,a=t.mapping.maps.length;t.delete(s+r,i+r);const l=new Set;for(let c=0,u=o*e.width;c<e.width;c++,u++){const d=e.map[u];if(!l.has(d)){if(l.add(d),o>0&&d==e.map[u-e.width]){const h=n.nodeAt(d).attrs;t.setNodeMarkup(t.mapping.slice(a).map(d+r),null,{...h,rowspan:h.rowspan-1}),c+=h.colspan-1}else if(o<e.height&&d==e.map[u+e.width]){const h=n.nodeAt(d),f=h.attrs,p=h.type.create({...f,rowspan:h.attrs.rowspan-1},h.content),y=e.positionAt(o+1,c,n);t.insert(t.mapping.slice(a).map(r+y),p),c+=f.colspan-1}}}}function _X(t,e){if(!us(t))return!1;if(e){const n=ds(t),r=t.tr;if(n.top==0&&n.bottom==n.map.height)return!1;for(let o=n.bottom-1;TX(r,n,o),o!=n.top;o--){const s=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!s)throw RangeError("No table found");n.table=s,n.map=bt.get(n.table)}e(r)}return!0}function cA(t){const e=t.content;return e.childCount==1&&e.child(0).isTextblock&&e.child(0).childCount==0}function AX({width:t,height:e,map:n},r){let o=r.top*t+r.left,s=o,i=(r.bottom-1)*t+r.left,a=o+(r.right-r.left-1);for(let l=r.top;l<r.bottom;l++){if(r.left>0&&n[s]==n[s-1]||r.right<t&&n[a]==n[a+1])return!0;s+=t,a+=t}for(let l=r.left;l<r.right;l++){if(r.top>0&&n[o]==n[o-t]||r.bottom<e&&n[i]==n[i+t])return!0;o++,i++}return!1}function IX(t,e){const n=t.selection;if(!(n instanceof tt)||n.$anchorCell.pos==n.$headCell.pos)return!1;const r=ds(t),{map:o}=r;if(AX(o,r))return!1;if(e){const s=t.tr,i={};let a=B.empty,l,c;for(let u=r.top;u<r.bottom;u++)for(let d=r.left;d<r.right;d++){const h=o.map[u*o.width+d],f=r.table.nodeAt(h);if(!(i[h]||!f))if(i[h]=!0,l==null)l=h,c=f;else{cA(f)||(a=a.append(f.content));const p=s.mapping.map(h+r.tableStart);s.delete(p,p+f.nodeSize)}}if(l==null||c==null)return!0;if(s.setNodeMarkup(l+r.tableStart,null,{...FO(c.attrs,c.attrs.colspan,r.right-r.left-c.attrs.colspan),rowspan:r.bottom-r.top}),a.size){const u=l+1+c.content.size,d=cA(c)?l+1:u;s.replaceWith(d+r.tableStart,u+r.tableStart,a)}s.setSelection(new tt(s.doc.resolve(l+r.tableStart))),e(s)}return!0}function MX(t,e){const n=Bn(t.schema);return RX(({node:r})=>n[r.type.spec.tableRole])(t,e)}function RX(t){return(e,n)=>{var r;const o=e.selection;let s,i;if(o instanceof tt){if(o.$anchorCell.pos!=o.$headCell.pos)return!1;s=o.$anchorCell.nodeAfter,i=o.$anchorCell.pos}else{if(s=aX(o.$from),!s)return!1;i=(r=iu(o.$from))==null?void 0:r.pos}if(s==null||i==null||s.attrs.colspan==1&&s.attrs.rowspan==1)return!1;if(n){let a=s.attrs;const l=[],c=a.colwidth;a.rowspan>1&&(a={...a,rowspan:1}),a.colspan>1&&(a={...a,colspan:1});const u=ds(e),d=e.tr;for(let f=0;f<u.right-u.left;f++)l.push(c?{...a,colwidth:c&&c[f]?[c[f]]:null}:a);let h;for(let f=u.top;f<u.bottom;f++){let p=u.map.positionAt(f,u.left,u.table);f==u.top&&(p+=s.nodeSize);for(let y=u.left,b=0;y<u.right;y++,b++)y==u.left&&f==u.top||d.insert(h=d.mapping.map(p+u.tableStart,1),t({node:s,row:f,col:y}).createAndFill(l[b]))}d.setNodeMarkup(i,t({node:s,row:u.top,col:u.left}),l[0]),o instanceof tt&&d.setSelection(new tt(d.doc.resolve(o.$anchorCell.pos),h?d.doc.resolve(h):void 0)),n(d)}return!0}}function PX(t){return function(e,n){if(!us(e))return!1;if(n){const r=Bn(e.schema),o=ds(e),s=e.tr,i=o.map.cellsInRect(t=="column"?{left:o.left,top:0,right:o.right,bottom:o.map.height}:t=="row"?{left:0,top:o.top,right:o.map.width,bottom:o.bottom}:o),a=i.map(l=>o.table.nodeAt(l));for(let l=0;l<i.length;l++)a[l].type==r.header_cell&&s.setNodeMarkup(o.tableStart+i[l],r.cell,a[l].attrs);if(s.steps.length==0)for(let l=0;l<i.length;l++)s.setNodeMarkup(o.tableStart+i[l],r.header_cell,a[l].attrs);n(s)}return!0}}function uA(t,e,n){const r=e.map.cellsInRect({left:0,top:0,right:t=="row"?e.map.width:1,bottom:t=="column"?e.map.height:1});for(let o=0;o<r.length;o++){const s=e.table.nodeAt(r[o]);if(s&&s.type!==n.header_cell)return!1}return!0}function Zx(t,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?PX(t):function(n,r){if(!us(n))return!1;if(r){const o=Bn(n.schema),s=ds(n),i=n.tr,a=uA("row",s,o),l=uA("column",s,o),u=(t==="column"?a:t==="row"?l:!1)?1:0,d=t=="column"?{left:0,top:u,right:1,bottom:s.map.height}:t=="row"?{left:u,top:0,right:s.map.width,bottom:1}:s,h=t=="column"?l?o.cell:o.header_cell:t=="row"?a?o.cell:o.header_cell:o.cell;s.map.cellsInRect(d).forEach(f=>{const p=f+s.tableStart,y=i.doc.nodeAt(p);y&&i.setNodeMarkup(p,h,y.attrs)}),r(i)}return!0}}Zx("row",{useDeprecatedLogic:!0});Zx("column",{useDeprecatedLogic:!0});Zx("cell",{useDeprecatedLogic:!0});function DX(t,e){if(e<0){const n=t.nodeBefore;if(n)return t.pos-n.nodeSize;for(let r=t.index(-1)-1,o=t.before();r>=0;r--){const s=t.node(-1).child(r),i=s.lastChild;if(i)return o-1-i.nodeSize;o-=s.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;const n=t.node(-1);for(let r=t.indexAfter(-1),o=t.after();r<n.childCount;r++){const s=n.child(r);if(s.childCount)return o+1;o+=s.nodeSize}}return null}function dA(t){return function(e,n){if(!us(e))return!1;const r=DX(Jx(e),t);if(r==null)return!1;if(n){const o=e.doc.resolve(r);n(e.tr.setSelection(ee.between(o,cX(o))).scrollIntoView())}return!0}}function Rp(t,e){const n=t.selection;if(!(n instanceof tt))return!1;if(e){const r=t.tr,o=Bn(t.schema).cell.createAndFill().content;n.forEachCell((s,i)=>{s.content.eq(o)||r.replace(r.mapping.map(i+1),r.mapping.map(i+s.nodeSize-1),new G(o,0,0))}),r.docChanged&&e(r)}return!0}function NX(t){if(!t.size)return null;let{content:e,openStart:n,openEnd:r}=t;for(;e.childCount==1&&(n>0&&r>0||e.child(0).type.spec.tableRole=="table");)n--,r--,e=e.child(0).content;const o=e.child(0),s=o.type.spec.tableRole,i=o.type.schema,a=[];if(s=="row")for(let l=0;l<e.childCount;l++){let c=e.child(l).content;const u=l?0:Math.max(0,n-1),d=l<e.childCount-1?0:Math.max(0,r-1);(u||d)&&(c=vw(Bn(i).row,new G(c,u,d)).content),a.push(c)}else if(s=="cell"||s=="header_cell")a.push(n||r?vw(Bn(i).row,new G(e,n,r)).content:e);else return null;return OX(i,a)}function OX(t,e){const n=[];for(let o=0;o<e.length;o++){const s=e[o];for(let i=s.childCount-1;i>=0;i--){const{rowspan:a,colspan:l}=s.child(i).attrs;for(let c=o;c<o+a;c++)n[c]=(n[c]||0)+l}}let r=0;for(let o=0;o<n.length;o++)r=Math.max(r,n[o]);for(let o=0;o<n.length;o++)if(o>=e.length&&e.push(B.empty),n[o]<r){const s=Bn(t).cell.createAndFill(),i=[];for(let a=n[o];a<r;a++)i.push(s);e[o]=e[o].append(B.from(i))}return{height:e.length,width:r,rows:e}}function vw(t,e){const n=t.createAndFill();return new Ax(n).replace(0,n.content.size,e).doc}function LX({width:t,height:e,rows:n},r,o){if(t!=r){const s=[],i=[];for(let a=0;a<n.length;a++){const l=n[a],c=[];for(let u=s[a]||0,d=0;u<r;d++){let h=l.child(d%l.childCount);u+h.attrs.colspan>r&&(h=h.type.createChecked(wl(h.attrs,h.attrs.colspan,u+h.attrs.colspan-r),h.content)),c.push(h),u+=h.attrs.colspan;for(let f=1;f<h.attrs.rowspan;f++)s[a+f]=(s[a+f]||0)+h.attrs.colspan}i.push(B.from(c))}n=i,t=r}if(e!=o){const s=[];for(let i=0,a=0;i<o;i++,a++){const l=[],c=n[a%e];for(let u=0;u<c.childCount;u++){let d=c.child(u);i+d.attrs.rowspan>o&&(d=d.type.create({...d.attrs,rowspan:Math.max(1,o-d.attrs.rowspan)},d.content)),l.push(d)}s.push(B.from(l))}n=s,e=o}return{width:t,height:e,rows:n}}function VX(t,e,n,r,o,s,i){const a=t.doc.type.schema,l=Bn(a);let c,u;if(o>e.width)for(let d=0,h=0;d<e.height;d++){const f=n.child(d);h+=f.nodeSize;const p=[];let y;f.lastChild==null||f.lastChild.type==l.cell?y=c||(c=l.cell.createAndFill()):y=u||(u=l.header_cell.createAndFill());for(let b=e.width;b<o;b++)p.push(y);t.insert(t.mapping.slice(i).map(h-1+r),p)}if(s>e.height){const d=[];for(let p=0,y=(e.height-1)*e.width;p<Math.max(e.width,o);p++){const b=p>=e.width?!1:n.nodeAt(e.map[y+p]).type==l.header_cell;d.push(b?u||(u=l.header_cell.createAndFill()):c||(c=l.cell.createAndFill()))}const h=l.row.create(null,B.from(d)),f=[];for(let p=e.height;p<s;p++)f.push(h);t.insert(t.mapping.slice(i).map(r+n.nodeSize-2),f)}return!!(c||u)}function hA(t,e,n,r,o,s,i,a){if(i==0||i==e.height)return!1;let l=!1;for(let c=o;c<s;c++){const u=i*e.width+c,d=e.map[u];if(e.map[u-e.width]==d){l=!0;const h=n.nodeAt(d),{top:f,left:p}=e.findCell(d);t.setNodeMarkup(t.mapping.slice(a).map(d+r),null,{...h.attrs,rowspan:i-f}),t.insert(t.mapping.slice(a).map(e.positionAt(i,p,n)),h.type.createAndFill({...h.attrs,rowspan:f+h.attrs.rowspan-i})),c+=h.attrs.colspan-1}}return l}function fA(t,e,n,r,o,s,i,a){if(i==0||i==e.width)return!1;let l=!1;for(let c=o;c<s;c++){const u=c*e.width+i,d=e.map[u];if(e.map[u-1]==d){l=!0;const h=n.nodeAt(d),f=e.colCount(d),p=t.mapping.slice(a).map(d+r);t.setNodeMarkup(p,null,wl(h.attrs,i-f,h.attrs.colspan-(i-f))),t.insert(p+h.nodeSize,h.type.createAndFill(wl(h.attrs,0,i-f))),c+=h.attrs.rowspan-1}}return l}function pA(t,e,n,r,o){let s=n?t.doc.nodeAt(n-1):t.doc;if(!s)throw new Error("No table found");let i=bt.get(s);const{top:a,left:l}=r,c=l+o.width,u=a+o.height,d=t.tr;let h=0;function f(){if(s=n?d.doc.nodeAt(n-1):d.doc,!s)throw new Error("No table found");i=bt.get(s),h=d.mapping.maps.length}VX(d,i,s,n,c,u,h)&&f(),hA(d,i,s,n,l,c,a,h)&&f(),hA(d,i,s,n,l,c,u,h)&&f(),fA(d,i,s,n,a,u,l,h)&&f(),fA(d,i,s,n,a,u,c,h)&&f();for(let p=a;p<u;p++){const y=i.positionAt(p,l,s),b=i.positionAt(p,c,s);d.replace(d.mapping.slice(h).map(y+n),d.mapping.slice(h).map(b+n),new G(o.rows[p-a],0,0))}f(),d.setSelection(new tt(d.doc.resolve(n+i.positionAt(a,l,s)),d.doc.resolve(n+i.positionAt(u-1,c-1,s)))),e(d)}var jX=Bx({ArrowLeft:Pp("horiz",-1),ArrowRight:Pp("horiz",1),ArrowUp:Pp("vert",-1),ArrowDown:Pp("vert",1),"Shift-ArrowLeft":Dp("horiz",-1),"Shift-ArrowRight":Dp("horiz",1),"Shift-ArrowUp":Dp("vert",-1),"Shift-ArrowDown":Dp("vert",1),Backspace:Rp,"Mod-Backspace":Rp,Delete:Rp,"Mod-Delete":Rp});function wm(t,e,n){return n.eq(t.selection)?!1:(e&&e(t.tr.setSelection(n).scrollIntoView()),!0)}function Pp(t,e){return(n,r,o)=>{if(!o)return!1;const s=n.selection;if(s instanceof tt)return wm(n,r,fe.near(s.$headCell,e));if(t!="horiz"&&!s.empty)return!1;const i=qO(o,t,e);if(i==null)return!1;if(t=="horiz")return wm(n,r,fe.near(n.doc.resolve(s.head+e),e));{const a=n.doc.resolve(i),l=$O(a,t,e);let c;return l?c=fe.near(l,1):e<0?c=fe.near(n.doc.resolve(a.before(-1)),-1):c=fe.near(n.doc.resolve(a.after(-1)),1),wm(n,r,c)}}}function Dp(t,e){return(n,r,o)=>{if(!o)return!1;const s=n.selection;let i;if(s instanceof tt)i=s;else{const l=qO(o,t,e);if(l==null)return!1;i=new tt(n.doc.resolve(l))}const a=$O(i.$headCell,t,e);return a?wm(n,r,new tt(i.$anchorCell,a)):!1}}function BX(t,e){const n=t.state.doc,r=iu(n.resolve(e));return r?(t.dispatch(t.state.tr.setSelection(new tt(r))),!0):!1}function $X(t,e,n){if(!us(t.state))return!1;let r=NX(n);const o=t.state.selection;if(o instanceof tt){r||(r={width:1,height:1,rows:[B.from(vw(Bn(t.state.schema).cell,n))]});const s=o.$anchorCell.node(-1),i=o.$anchorCell.start(-1),a=bt.get(s).rectBetween(o.$anchorCell.pos-i,o.$headCell.pos-i);return r=LX(r,a.right-a.left,a.bottom-a.top),pA(t.state,t.dispatch,i,a,r),!0}else if(r){const s=Jx(t.state),i=s.start(-1);return pA(t.state,t.dispatch,i,bt.get(s.node(-1)).findCell(s.pos-i),r),!0}else return!1}function FX(t,e){var n;if(e.ctrlKey||e.metaKey)return;const r=mA(t,e.target);let o;if(e.shiftKey&&t.state.selection instanceof tt)s(t.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(o=iu(t.state.selection.$anchor))!=null&&((n=pv(t,e))==null?void 0:n.pos)!=o.pos)s(o,e),e.preventDefault();else if(!r)return;function s(l,c){let u=pv(t,c);const d=Mi.getState(t.state)==null;if(!u||!Qx(l,u))if(d)u=l;else return;const h=new tt(l,u);if(d||!t.state.selection.eq(h)){const f=t.state.tr.setSelection(h);d&&f.setMeta(Mi,l.pos),t.dispatch(f)}}function i(){t.root.removeEventListener("mouseup",i),t.root.removeEventListener("dragstart",i),t.root.removeEventListener("mousemove",a),Mi.getState(t.state)!=null&&t.dispatch(t.state.tr.setMeta(Mi,-1))}function a(l){const c=l,u=Mi.getState(t.state);let d;if(u!=null)d=t.state.doc.resolve(u);else if(mA(t,c.target)!=r&&(d=pv(t,e),!d))return i();d&&s(d,c)}t.root.addEventListener("mouseup",i),t.root.addEventListener("dragstart",i),t.root.addEventListener("mousemove",a)}function qO(t,e,n){if(!(t.state.selection instanceof ee))return null;const{$head:r}=t.state.selection;for(let o=r.depth-1;o>=0;o--){const s=r.node(o);if((n<0?r.index(o):r.indexAfter(o))!=(n<0?0:s.childCount))return null;if(s.type.spec.tableRole=="cell"||s.type.spec.tableRole=="header_cell"){const a=r.before(o),l=e=="vert"?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(l)?a:null}}return null}function mA(t,e){for(;e&&e!=t.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function pv(t,e){const n=t.posAtCoords({left:e.clientX,top:e.clientY});return n&&n?iu(t.state.doc.resolve(n.pos)):null}var GO=class{constructor(t,e){this.node=t,this.defaultCellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${e}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),ww(t,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!=this.node.type?!1:(this.node=t,ww(t,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(t){return t.type=="attributes"&&(t.target==this.table||this.colgroup.contains(t.target))}};function ww(t,e,n,r,o,s){var i;let a=0,l=!0,c=e.firstChild;const u=t.firstChild;if(u){for(let d=0,h=0;d<u.childCount;d++){const{colspan:f,colwidth:p}=u.child(d).attrs;for(let y=0;y<f;y++,h++){const b=o==h?s:p&&p[y],w=b?b+"px":"";if(a+=b||r,b||(l=!1),c)c.style.width!=w&&(c.style.width=w),c=c.nextSibling;else{const k=document.createElement("col");k.style.width=w,e.appendChild(k)}}}for(;c;){const d=c.nextSibling;(i=c.parentNode)==null||i.removeChild(c),c=d}l?(n.style.width=a+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=a+"px")}}var xr=new We("tableColumnResizing");function HX({handleWidth:t=5,cellMinWidth:e=25,defaultCellMinWidth:n=100,View:r=GO,lastColumnResizable:o=!0}={}){const s=new Re({key:xr,state:{init(i,a){var l,c;const u=(c=(l=s.spec)==null?void 0:l.props)==null?void 0:c.nodeViews,d=Bn(a.schema).table.name;return r&&u&&(u[d]=(h,f)=>new r(h,n,f)),new zX(-1,!1)},apply(i,a){return a.apply(i)}},props:{attributes:i=>{const a=xr.getState(i);return a&&a.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(i,a)=>{UX(i,a,t,o)},mouseleave:i=>{WX(i)},mousedown:(i,a)=>{qX(i,a,e,n)}},decorations:i=>{const a=xr.getState(i);if(a&&a.activeHandle>-1)return JX(i,a.activeHandle)},nodeViews:{}}});return s}var zX=class Cm{constructor(e,n){this.activeHandle=e,this.dragging=n}apply(e){const n=this,r=e.getMeta(xr);if(r&&r.setHandle!=null)return new Cm(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new Cm(n.activeHandle,r.setDragging);if(n.activeHandle>-1&&e.docChanged){let o=e.mapping.map(n.activeHandle,-1);return bw(e.doc.resolve(o))||(o=-1),new Cm(o,n.dragging)}return n}};function UX(t,e,n,r){if(!t.editable)return;const o=xr.getState(t.state);if(o&&!o.dragging){const s=KX(e.target);let i=-1;if(s){const{left:a,right:l}=s.getBoundingClientRect();e.clientX-a<=n?i=gA(t,e,"left",n):l-e.clientX<=n&&(i=gA(t,e,"right",n))}if(i!=o.activeHandle){if(!r&&i!==-1){const a=t.state.doc.resolve(i),l=a.node(-1),c=bt.get(l),u=a.start(-1);if(c.colCount(a.pos-u)+a.nodeAfter.attrs.colspan-1==c.width-1)return}KO(t,i)}}}function WX(t){if(!t.editable)return;const e=xr.getState(t.state);e&&e.activeHandle>-1&&!e.dragging&&KO(t,-1)}function qX(t,e,n,r){var o;if(!t.editable)return!1;const s=(o=t.dom.ownerDocument.defaultView)!=null?o:window,i=xr.getState(t.state);if(!i||i.activeHandle==-1||i.dragging)return!1;const a=t.state.doc.nodeAt(i.activeHandle),l=GX(t,i.activeHandle,a.attrs);t.dispatch(t.state.tr.setMeta(xr,{setDragging:{startX:e.clientX,startWidth:l}}));function c(d){s.removeEventListener("mouseup",c),s.removeEventListener("mousemove",u);const h=xr.getState(t.state);h!=null&&h.dragging&&(YX(t,h.activeHandle,yA(h.dragging,d,n)),t.dispatch(t.state.tr.setMeta(xr,{setDragging:null})))}function u(d){if(!d.which)return c(d);const h=xr.getState(t.state);if(h&&h.dragging){const f=yA(h.dragging,d,n);bA(t,h.activeHandle,f,r)}}return bA(t,i.activeHandle,l,r),s.addEventListener("mouseup",c),s.addEventListener("mousemove",u),e.preventDefault(),!0}function GX(t,e,{colspan:n,colwidth:r}){const o=r&&r[r.length-1];if(o)return o;const s=t.domAtPos(e);let a=s.node.childNodes[s.offset].offsetWidth,l=n;if(r)for(let c=0;c<n;c++)r[c]&&(a-=r[c],l--);return a/l}function KX(t){for(;t&&t.nodeName!="TD"&&t.nodeName!="TH";)t=t.classList&&t.classList.contains("ProseMirror")?null:t.parentNode;return t}function gA(t,e,n,r){const o=n=="right"?-r:r,s=t.posAtCoords({left:e.clientX+o,top:e.clientY});if(!s)return-1;const{pos:i}=s,a=iu(t.state.doc.resolve(i));if(!a)return-1;if(n=="right")return a.pos;const l=bt.get(a.node(-1)),c=a.start(-1),u=l.map.indexOf(a.pos-c);return u%l.width==0?-1:c+l.map[u-1]}function yA(t,e,n){const r=e.clientX-t.startX;return Math.max(n,t.startWidth+r)}function KO(t,e){t.dispatch(t.state.tr.setMeta(xr,{setHandle:e}))}function YX(t,e,n){const r=t.state.doc.resolve(e),o=r.node(-1),s=bt.get(o),i=r.start(-1),a=s.colCount(r.pos-i)+r.nodeAfter.attrs.colspan-1,l=t.state.tr;for(let c=0;c<s.height;c++){const u=c*s.width+a;if(c&&s.map[u]==s.map[u-s.width])continue;const d=s.map[u],h=o.nodeAt(d).attrs,f=h.colspan==1?0:a-s.colCount(d);if(h.colwidth&&h.colwidth[f]==n)continue;const p=h.colwidth?h.colwidth.slice():XX(h.colspan);p[f]=n,l.setNodeMarkup(i+d,null,{...h,colwidth:p})}l.docChanged&&t.dispatch(l)}function bA(t,e,n,r){const o=t.state.doc.resolve(e),s=o.node(-1),i=o.start(-1),a=bt.get(s).colCount(o.pos-i)+o.nodeAfter.attrs.colspan-1;let l=t.domAtPos(o.start(-1)).node;for(;l&&l.nodeName!="TABLE";)l=l.parentNode;l&&ww(s,l.firstChild,l,r,a,n)}function XX(t){return Array(t).fill(0)}function JX(t,e){var n;const r=[],o=t.doc.resolve(e),s=o.node(-1);if(!s)return Oe.empty;const i=bt.get(s),a=o.start(-1),l=i.colCount(o.pos-a)+o.nodeAfter.attrs.colspan-1;for(let c=0;c<i.height;c++){const u=l+c*i.width;if((l==i.width-1||i.map[u]!=i.map[u+1])&&(c==0||i.map[u]!=i.map[u-i.width])){const d=i.map[u],h=a+d+s.nodeAt(d).nodeSize-1,f=document.createElement("div");f.className="column-resize-handle",(n=xr.getState(t))!=null&&n.dragging&&r.push(et.node(a+d,a+d+s.nodeAt(d).nodeSize,{class:"column-resize-dragging"})),r.push(et.widget(h,f))}}return Oe.create(t.doc,r)}function QX({allowTableNodeSelection:t=!1}={}){return new Re({key:Mi,state:{init(){return null},apply(e,n){const r=e.getMeta(Mi);if(r!=null)return r==-1?null:r;if(n==null||!e.docChanged)return n;const{deleted:o,pos:s}=e.mapping.mapResult(n);return o?null:s}},props:{decorations:hX,handleDOMEvents:{mousedown:FX},createSelectionBetween(e){return Mi.getState(e.state)!=null?e.state.selection:null},handleTripleClick:BX,handleKeyDown:jX,handlePaste:$X},appendTransaction(e,n,r){return mX(r,yX(r,n),t)}})}class _t extends fe{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return _t.valid(r)?new _t(r):fe.near(r)}content(){return G.empty}eq(e){return e instanceof _t&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new _t(e.resolve(n.pos))}getBookmark(){return new ek(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!ZX(e)||!eJ(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let o=n.contentMatchAt(e.index()).defaultType;return o&&o.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&_t.valid(e))return e;let o=e.pos,s=null;for(let i=e.depth;;i--){let a=e.node(i);if(n>0?e.indexAfter(i)<a.childCount:e.index(i)>0){s=a.child(n>0?e.indexAfter(i):e.index(i)-1);break}else if(i==0)return null;o+=n;let l=e.doc.resolve(o);if(_t.valid(l))return l}for(;;){let i=n>0?s.firstChild:s.lastChild;if(!i){if(s.isAtom&&!s.isText&&!se.isSelectable(s)){e=e.doc.resolve(o+s.nodeSize*n),r=!1;continue e}break}s=i,o+=n;let a=e.doc.resolve(o);if(_t.valid(a))return a}return null}}}_t.prototype.visible=!1;_t.findFrom=_t.findGapCursorFrom;fe.jsonID("gapcursor",_t);class ek{constructor(e){this.pos=e}map(e){return new ek(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return _t.valid(n)?new _t(n):fe.near(n)}}function ZX(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let o=r.child(n-1);;o=o.lastChild){if(o.childCount==0&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}function eJ(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let o=r.child(n);;o=o.firstChild){if(o.childCount==0&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}function tJ(){return new Re({props:{decorations:sJ,createSelectionBetween(t,e,n){return e.pos==n.pos&&_t.valid(n)?new _t(n):null},handleClick:rJ,handleKeyDown:nJ,handleDOMEvents:{beforeinput:oJ}}})}const nJ=Bx({ArrowLeft:Np("horiz",-1),ArrowRight:Np("horiz",1),ArrowUp:Np("vert",-1),ArrowDown:Np("vert",1)});function Np(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,o,s){let i=r.selection,a=e>0?i.$to:i.$from,l=i.empty;if(i instanceof ee){if(!s.endOfTextblock(n)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=_t.findGapCursorFrom(a,e,l);return c?(o&&o(r.tr.setSelection(new _t(c))),!0):!1}}function rJ(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!_t.valid(r))return!1;let o=t.posAtCoords({left:n.clientX,top:n.clientY});return o&&o.inside>-1&&se.isSelectable(t.state.doc.nodeAt(o.inside))?!1:(t.dispatch(t.state.tr.setSelection(new _t(r))),!0)}function oJ(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof _t))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let o=B.empty;for(let i=r.length-1;i>=0;i--)o=B.from(r[i].createAndFill(null,o));let s=t.state.tr.replace(n.pos,n.pos,new G(o,0,0));return s.setSelection(ee.near(s.doc.resolve(n.pos+1))),t.dispatch(s),!1}function sJ(t){if(!(t.selection instanceof _t))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Oe.create(t.doc,[et.widget(t.selection.head,e,{key:"gapcursor"})])}const iJ=at.create({name:"gapCursor",addProseMirrorPlugins(){return[tJ()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=Ne(ne(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}});var ug=200,en=function(){};en.prototype.append=function(e){return e.length?(e=en.from(e),!this.length&&e||e.length<ug&&this.leafAppend(e)||this.length<ug&&e.leafPrepend(this)||this.appendInner(e)):this};en.prototype.prepend=function(e){return e.length?en.from(e).append(this):this};en.prototype.appendInner=function(e){return new aJ(this,e)};en.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?en.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};en.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};en.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};en.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var o=[];return this.forEach(function(s,i){return o.push(e(s,i))},n,r),o};en.from=function(e){return e instanceof en?e:e&&e.length?new YO(e):en.empty};var YO=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(o,s){return o==0&&s==this.length?this:new e(this.values.slice(o,s))},e.prototype.getInner=function(o){return this.values[o]},e.prototype.forEachInner=function(o,s,i,a){for(var l=s;l<i;l++)if(o(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(o,s,i,a){for(var l=s-1;l>=i;l--)if(o(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(o){if(this.length+o.length<=ug)return new e(this.values.concat(o.flatten()))},e.prototype.leafPrepend=function(o){if(this.length+o.length<=ug)return new e(o.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(en);en.empty=new YO([]);var aJ=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,o,s,i){var a=this.left.length;if(o<a&&this.left.forEachInner(r,o,Math.min(s,a),i)===!1||s>a&&this.right.forEachInner(r,Math.max(o-a,0),Math.min(this.length,s)-a,i+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,o,s,i){var a=this.left.length;if(o>a&&this.right.forEachInvertedInner(r,o-a,Math.max(s,a)-a,i+a)===!1||s<a&&this.left.forEachInvertedInner(r,Math.min(o,a),s,i)===!1)return!1},e.prototype.sliceInner=function(r,o){if(r==0&&o==this.length)return this;var s=this.left.length;return o<=s?this.left.slice(r,o):r>=s?this.right.slice(r-s,o-s):this.left.slice(r,s).append(this.right.slice(0,o-s))},e.prototype.leafAppend=function(r){var o=this.right.leafAppend(r);if(o)return new e(this.left,o)},e.prototype.leafPrepend=function(r){var o=this.left.leafPrepend(r);if(o)return new e(o,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(en);const lJ=500;class fo{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let o,s;n&&(o=this.remapping(r,this.items.length),s=o.maps.length);let i=e.tr,a,l,c=[],u=[];return this.items.forEach((d,h)=>{if(!d.step){o||(o=this.remapping(r,h+1),s=o.maps.length),s--,u.push(d);return}if(o){u.push(new yi(d.map));let f=d.step.map(o.slice(s)),p;f&&i.maybeStep(f).doc&&(p=i.mapping.maps[i.mapping.maps.length-1],c.push(new yi(p,void 0,void 0,c.length+u.length))),s--,p&&o.appendMap(p,s)}else i.maybeStep(d.step);if(d.selection)return a=o?d.selection.map(o.slice(s)):d.selection,l=new fo(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:i,selection:a}}addTransform(e,n,r,o){let s=[],i=this.eventCount,a=this.items,l=!o&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),h=new yi(e.mapping.maps[u],d,n),f;(f=l&&l.merge(h))&&(h=f,u?s.pop():a=a.slice(0,a.length-1)),s.push(h),n&&(i++,n=void 0),o||(l=h)}let c=i-r.depth;return c>uJ&&(a=cJ(a,c),i-=c),new fo(a.append(s),i)}remapping(e,n){let r=new Pc;return this.items.forEach((o,s)=>{let i=o.mirrorOffset!=null&&s-o.mirrorOffset>=e?r.maps.length-o.mirrorOffset:void 0;r.appendMap(o.map,i)},e,n),r}addMaps(e){return this.eventCount==0?this:new fo(this.items.append(e.map(n=>new yi(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],o=Math.max(0,this.items.length-n),s=e.mapping,i=e.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},o);let l=n;this.items.forEach(h=>{let f=s.getMirror(--l);if(f==null)return;i=Math.min(i,f);let p=s.maps[f];if(h.step){let y=e.steps[f].invert(e.docs[f]),b=h.selection&&h.selection.map(s.slice(l+1,f));b&&a++,r.push(new yi(p,y,b))}else r.push(new yi(p))},o);let c=[];for(let h=n;h<i;h++)c.push(new yi(s.maps[h]));let u=this.items.slice(0,o).append(c).append(r),d=new fo(u,a);return d.emptyItemCount()>lJ&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,o=[],s=0;return this.items.forEach((i,a)=>{if(a>=e)o.push(i),i.selection&&s++;else if(i.step){let l=i.step.map(n.slice(r)),c=l&&l.getMap();if(r--,c&&n.appendMap(c,r),l){let u=i.selection&&i.selection.map(n.slice(r));u&&s++;let d=new yi(c.invert(),l,u),h,f=o.length-1;(h=o.length&&o[f].merge(d))?o[f]=h:o.push(d)}}else i.map&&r--},this.items.length,0),new fo(en.from(o.reverse()),s)}}fo.empty=new fo(en.empty,0);function cJ(t,e){let n;return t.forEach((r,o)=>{if(r.selection&&e--==0)return n=o,!1}),t.slice(n)}let yi=class XO{constructor(e,n,r,o){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=o}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new XO(n.getMap().invert(),n,this.selection)}}};class Ei{constructor(e,n,r,o,s){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=o,this.prevComposition=s}}const uJ=20;function dJ(t,e,n,r){let o=n.getMeta(ll),s;if(o)return o.historyState;n.getMeta(pJ)&&(t=new Ei(t.done,t.undone,null,0,-1));let i=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(i&&i.getMeta(ll))return i.getMeta(ll).redo?new Ei(t.done.addTransform(n,void 0,r,xm(e)),t.undone,vA(n.mapping.maps),t.prevTime,t.prevComposition):new Ei(t.done,t.undone.addTransform(n,void 0,r,xm(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(i&&i.getMeta("addToHistory")===!1)){let a=n.getMeta("composition"),l=t.prevTime==0||!i&&t.prevComposition!=a&&(t.prevTime<(n.time||0)-r.newGroupDelay||!hJ(n,t.prevRanges)),c=i?mv(t.prevRanges,n.mapping):vA(n.mapping.maps);return new Ei(t.done.addTransform(n,l?e.selection.getBookmark():void 0,r,xm(e)),fo.empty,c,n.time,a??t.prevComposition)}else return(s=n.getMeta("rebased"))?new Ei(t.done.rebased(n,s),t.undone.rebased(n,s),mv(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new Ei(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),mv(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function hJ(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,o)=>{for(let s=0;s<e.length;s+=2)r<=e[s+1]&&o>=e[s]&&(n=!0)}),n}function vA(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,o,s,i)=>e.push(s,i));return e}function mv(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let o=e.map(t[r],1),s=e.map(t[r+1],-1);o<=s&&n.push(o,s)}return n}function fJ(t,e,n){let r=xm(e),o=ll.get(e).spec.config,s=(n?t.undone:t.done).popEvent(e,r);if(!s)return null;let i=s.selection.resolve(s.transform.doc),a=(n?t.done:t.undone).addTransform(s.transform,e.selection.getBookmark(),o,r),l=new Ei(n?a:s.remaining,n?s.remaining:a,null,0,-1);return s.transform.setSelection(i).setMeta(ll,{redo:n,historyState:l})}let gv=!1,wA=null;function xm(t){let e=t.plugins;if(wA!=e){gv=!1,wA=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){gv=!0;break}}return gv}const ll=new We("history"),pJ=new We("closeHistory");function mJ(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Re({key:ll,state:{init(){return new Ei(fo.empty,fo.empty,null,0,-1)},apply(e,n,r){return dJ(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,o=r=="historyUndo"?tk:r=="historyRedo"?nk:null;return o?(n.preventDefault(),o(e.state,e.dispatch)):!1}}}})}function JO(t,e){return(n,r)=>{let o=ll.getState(n);if(!o||(t?o.undone:o.done).eventCount==0)return!1;if(r){let s=fJ(o,n,t);s&&r(e?s.scrollIntoView():s)}return!0}}const tk=JO(!1,!0),nk=JO(!0,!0),gJ=at.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>tk(t,e),redo:()=>({state:t,dispatch:e})=>nk(t,e)}},addProseMirrorPlugins(){return[mJ(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-Ñ":()=>this.editor.commands.undo(),"Shift-Mod-Ñ":()=>this.editor.commands.redo()}}}),yJ="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mÃ¶gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",bJ="ÎµÎ»1Ï…2Ð±Ð³1ÐµÐ»3Ð´ÐµÑ‚Ð¸4ÐµÑŽ2ÐºÐ°Ñ‚Ð¾Ð»Ð¸Ðº6Ð¾Ð¼3Ð¼ÐºÐ´2Ð¾Ð½1ÑÐºÐ²Ð°6Ð¾Ð½Ð»Ð°Ð¹Ð½5Ñ€Ð³3Ñ€ÑƒÑ2Ñ„2ÑÐ°Ð¹Ñ‚3Ñ€Ð±3ÑƒÐºÑ€3Ò›Ð°Ð·3Õ°Õ¡Õµ3×™×©×¨××œ5×§×•×3Ø§Ø¨ÙˆØ¸Ø¨ÙŠ5Ø±Ø§Ù…ÙƒÙˆ5Ù„Ø§Ø±Ø¯Ù†4Ø¨Ø­Ø±ÙŠÙ†5Ø¬Ø²Ø§Ø¦Ø±5Ø³Ø¹ÙˆØ¯ÙŠØ©6Ø¹Ù„ÙŠØ§Ù†5Ù…ØºØ±Ø¨5Ù…Ø§Ø±Ø§Øª5ÛŒØ±Ø§Ù†5Ø¨Ø§Ø±Øª2Ø²Ø§Ø±4ÙŠØªÙƒ3Ú¾Ø§Ø±Øª5ØªÙˆÙ†Ø³4Ø³ÙˆØ¯Ø§Ù†3Ø±ÙŠØ©5Ø´Ø¨ÙƒØ©4Ø¹Ø±Ø§Ù‚2Ø¨2Ù…Ø§Ù†4ÙÙ„Ø³Ø·ÙŠÙ†6Ù‚Ø·Ø±3ÙƒØ§Ø«ÙˆÙ„ÙŠÙƒ6ÙˆÙ…3Ù…ØµØ±2Ù„ÙŠØ³ÙŠØ§5ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§7Ù‚Ø¹4Ù‡Ù…Ø±Ø§Ù‡5Ù¾Ø§Ú©Ø³ØªØ§Ù†7Ú€Ø§Ø±Øª4à¤•à¥‰à¤®3à¤¨à¥‡à¤Ÿ3à¤­à¤¾à¤°à¤¤0à¤®à¥3à¥‹à¤¤5à¤¸à¤‚à¤—à¤ à¤¨5à¦¬à¦¾à¦‚à¦²à¦¾5à¦­à¦¾à¦°à¦¤2à§°à¦¤4à¨­à¨¾à¨°à¨¤4àª­àª¾àª°àª¤4à¬­à¬¾à¬°à¬¤4à®‡à®¨à¯à®¤à®¿à®¯à®¾6à®²à®™à¯à®•à¯ˆ6à®šà®¿à®™à¯à®•à®ªà¯à®ªà¯‚à®°à¯11à°­à°¾à°°à°¤à±5à²­à²¾à²°à²¤4à´­à´¾à´°à´¤à´‚5à¶½à¶‚à¶šà·4à¸„à¸­à¸¡3à¹„à¸—à¸¢3àº¥àº²àº§3áƒ’áƒ”2ã¿ã‚“ãª3ã‚¢ãƒžã‚¾ãƒ³4ã‚¯ãƒ©ã‚¦ãƒ‰4ã‚°ãƒ¼ã‚°ãƒ«4ã‚³ãƒ 2ã‚¹ãƒˆã‚¢3ã‚»ãƒ¼ãƒ«3ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³6ãƒã‚¤ãƒ³ãƒˆ4ä¸–ç•Œ2ä¸­ä¿¡1å›½1åœ‹1æ–‡ç½‘3äºšé©¬é€Š3ä¼ä¸š2ä½›å±±2ä¿¡æ¯2å¥åº·2å…«å¦2å…¬å¸1ç›Š2å°æ¹¾1ç£2å•†åŸŽ1åº—1æ ‡2å˜‰é‡Œ0å¤§é…’åº—5åœ¨çº¿2å¤§æ‹¿2å¤©ä¸»æ•™3å¨±ä¹2å®¶é›»2å¹¿ä¸œ2å¾®åš2æ…ˆå–„2æˆ‘çˆ±ä½ 3æ‰‹æœº2æ‹›è˜2æ”¿åŠ¡1åºœ2æ–°åŠ å¡2é—»2æ—¶å°š2æ›¸ç±2æœºæž„2æ·¡é©¬é”¡3æ¸¸æˆ2æ¾³é–€2ç‚¹çœ‹2ç§»åŠ¨2ç»„ç»‡æœºæž„4ç½‘å€1åº—1ç«™1ç»œ2è”é€š2è°·æ­Œ2è´­ç‰©2é€šè²©2é›†å›¢2é›»è¨Šç›ˆç§‘4é£žåˆ©æµ¦3é£Ÿå“2é¤åŽ…2é¦™æ ¼é‡Œæ‹‰3æ¸¯2ë‹·ë„·1ì»´2ì‚¼ì„±2í•œêµ­2",jc=(t,e)=>{for(const n in e)t[n]=e[n];return t},Cw="numeric",xw="ascii",kw="alpha",Rd="asciinumeric",gd="alphanumeric",Sw="domain",QO="emoji",vJ="scheme",wJ="slashscheme",yv="whitespace";function CJ(t,e){return t in e||(e[t]=[]),e[t]}function Za(t,e,n){e[Cw]&&(e[Rd]=!0,e[gd]=!0),e[xw]&&(e[Rd]=!0,e[kw]=!0),e[Rd]&&(e[gd]=!0),e[kw]&&(e[gd]=!0),e[gd]&&(e[Sw]=!0),e[QO]&&(e[Sw]=!0);for(const r in e){const o=CJ(r,n);o.indexOf(t)<0&&o.push(t)}}function xJ(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}function lr(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}lr.groups={};lr.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let r=0;r<e.jr.length;r++){const o=e.jr[r][0],s=e.jr[r][1];if(s&&o.test(t))return s}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let o=0;o<t.length;o++)this.tt(t[o],e,n,r)},tr(t,e,n,r){r=r||lr.groups;let o;return e&&e.j?o=e:(o=new lr(e),n&&r&&Za(e,n,r)),this.jr.push([t,o]),o},ts(t,e,n,r){let o=this;const s=t.length;if(!s)return o;for(let i=0;i<s-1;i++)o=o.tt(t[i]);return o.tt(t[s-1],e,n,r)},tt(t,e,n,r){r=r||lr.groups;const o=this;if(e&&e.j)return o.j[t]=e,e;const s=e;let i,a=o.go(t);if(a?(i=new lr,jc(i.j,a.j),i.jr.push.apply(i.jr,a.jr),i.jd=a.jd,i.t=a.t):i=new lr,s){if(r)if(i.t&&typeof i.t=="string"){const l=jc(xJ(i.t,r),n);Za(s,l,r)}else n&&Za(s,n,r);i.t=s}return o.j[t]=i,i}};const Ie=(t,e,n,r,o)=>t.ta(e,n,r,o),Et=(t,e,n,r,o)=>t.tr(e,n,r,o),CA=(t,e,n,r,o)=>t.ts(e,n,r,o),q=(t,e,n,r,o)=>t.tt(e,n,r,o),Ts="WORD",Ew="UWORD",ZO="ASCIINUMERICAL",e3="ALPHANUMERICAL",gh="LOCALHOST",Tw="TLD",_w="UTLD",km="SCHEME",oc="SLASH_SCHEME",rk="NUM",Aw="WS",ok="NL",Pd="OPENBRACE",Dd="CLOSEBRACE",dg="OPENBRACKET",hg="CLOSEBRACKET",fg="OPENPAREN",pg="CLOSEPAREN",mg="OPENANGLEBRACKET",gg="CLOSEANGLEBRACKET",yg="FULLWIDTHLEFTPAREN",bg="FULLWIDTHRIGHTPAREN",vg="LEFTCORNERBRACKET",wg="RIGHTCORNERBRACKET",Cg="LEFTWHITECORNERBRACKET",xg="RIGHTWHITECORNERBRACKET",kg="FULLWIDTHLESSTHAN",Sg="FULLWIDTHGREATERTHAN",Eg="AMPERSAND",Tg="APOSTROPHE",_g="ASTERISK",Ti="AT",Ag="BACKSLASH",Ig="BACKTICK",Mg="CARET",Ri="COLON",sk="COMMA",Rg="DOLLAR",Do="DOT",Pg="EQUALS",ik="EXCLAMATION",Lr="HYPHEN",Nd="PERCENT",Dg="PIPE",Ng="PLUS",Og="POUND",Od="QUERY",ak="QUOTE",t3="FULLWIDTHMIDDLEDOT",lk="SEMI",No="SLASH",Ld="TILDE",Lg="UNDERSCORE",n3="EMOJI",Vg="SYM";var r3=Object.freeze({__proto__:null,ALPHANUMERICAL:e3,AMPERSAND:Eg,APOSTROPHE:Tg,ASCIINUMERICAL:ZO,ASTERISK:_g,AT:Ti,BACKSLASH:Ag,BACKTICK:Ig,CARET:Mg,CLOSEANGLEBRACKET:gg,CLOSEBRACE:Dd,CLOSEBRACKET:hg,CLOSEPAREN:pg,COLON:Ri,COMMA:sk,DOLLAR:Rg,DOT:Do,EMOJI:n3,EQUALS:Pg,EXCLAMATION:ik,FULLWIDTHGREATERTHAN:Sg,FULLWIDTHLEFTPAREN:yg,FULLWIDTHLESSTHAN:kg,FULLWIDTHMIDDLEDOT:t3,FULLWIDTHRIGHTPAREN:bg,HYPHEN:Lr,LEFTCORNERBRACKET:vg,LEFTWHITECORNERBRACKET:Cg,LOCALHOST:gh,NL:ok,NUM:rk,OPENANGLEBRACKET:mg,OPENBRACE:Pd,OPENBRACKET:dg,OPENPAREN:fg,PERCENT:Nd,PIPE:Dg,PLUS:Ng,POUND:Og,QUERY:Od,QUOTE:ak,RIGHTCORNERBRACKET:wg,RIGHTWHITECORNERBRACKET:xg,SCHEME:km,SEMI:lk,SLASH:No,SLASH_SCHEME:oc,SYM:Vg,TILDE:Ld,TLD:Tw,UNDERSCORE:Lg,UTLD:_w,UWORD:Ew,WORD:Ts,WS:Aw});const vs=/[a-z]/,Zu=new RegExp("\\p{L}","u"),bv=new RegExp("\\p{Emoji}","u"),ws=/\d/,vv=/\s/,xA="\r",wv=`
`,kJ="ï¸",SJ="â€",Cv="ï¿¼";let Op=null,Lp=null;function EJ(t=[]){const e={};lr.groups=e;const n=new lr;Op==null&&(Op=kA(yJ)),Lp==null&&(Lp=kA(bJ)),q(n,"'",Tg),q(n,"{",Pd),q(n,"}",Dd),q(n,"[",dg),q(n,"]",hg),q(n,"(",fg),q(n,")",pg),q(n,"<",mg),q(n,">",gg),q(n,"ï¼ˆ",yg),q(n,"ï¼‰",bg),q(n,"ã€Œ",vg),q(n,"ã€",wg),q(n,"ã€Ž",Cg),q(n,"ã€",xg),q(n,"ï¼œ",kg),q(n,"ï¼ž",Sg),q(n,"&",Eg),q(n,"*",_g),q(n,"@",Ti),q(n,"`",Ig),q(n,"^",Mg),q(n,":",Ri),q(n,",",sk),q(n,"$",Rg),q(n,".",Do),q(n,"=",Pg),q(n,"!",ik),q(n,"-",Lr),q(n,"%",Nd),q(n,"|",Dg),q(n,"+",Ng),q(n,"#",Og),q(n,"?",Od),q(n,'"',ak),q(n,"/",No),q(n,";",lk),q(n,"~",Ld),q(n,"_",Lg),q(n,"\\",Ag),q(n,"ãƒ»",t3);const r=Et(n,ws,rk,{[Cw]:!0});Et(r,ws,r);const o=Et(r,vs,ZO,{[Rd]:!0}),s=Et(r,Zu,e3,{[gd]:!0}),i=Et(n,vs,Ts,{[xw]:!0});Et(i,ws,o),Et(i,vs,i),Et(o,ws,o),Et(o,vs,o);const a=Et(n,Zu,Ew,{[kw]:!0});Et(a,vs),Et(a,ws,s),Et(a,Zu,a),Et(s,ws,s),Et(s,vs),Et(s,Zu,s);const l=q(n,wv,ok,{[yv]:!0}),c=q(n,xA,Aw,{[yv]:!0}),u=Et(n,vv,Aw,{[yv]:!0});q(n,Cv,u),q(c,wv,l),q(c,Cv,u),Et(c,vv,u),q(u,xA),q(u,wv),Et(u,vv,u),q(u,Cv,u);const d=Et(n,bv,n3,{[QO]:!0});q(d,"#"),Et(d,bv,d),q(d,kJ,d);const h=q(d,SJ);q(h,"#"),Et(h,bv,d);const f=[[vs,i],[ws,o]],p=[[vs,null],[Zu,a],[ws,s]];for(let y=0;y<Op.length;y++)bi(n,Op[y],Tw,Ts,f);for(let y=0;y<Lp.length;y++)bi(n,Lp[y],_w,Ew,p);Za(Tw,{tld:!0,ascii:!0},e),Za(_w,{utld:!0,alpha:!0},e),bi(n,"file",km,Ts,f),bi(n,"mailto",km,Ts,f),bi(n,"http",oc,Ts,f),bi(n,"https",oc,Ts,f),bi(n,"ftp",oc,Ts,f),bi(n,"ftps",oc,Ts,f),Za(km,{scheme:!0,ascii:!0},e),Za(oc,{slashscheme:!0,ascii:!0},e),t=t.sort((y,b)=>y[0]>b[0]?1:-1);for(let y=0;y<t.length;y++){const b=t[y][0],k=t[y][1]?{[vJ]:!0}:{[wJ]:!0};b.indexOf("-")>=0?k[Sw]=!0:vs.test(b)?ws.test(b)?k[Rd]=!0:k[xw]=!0:k[Cw]=!0,CA(n,b,b,k)}return CA(n,"localhost",gh,{ascii:!0}),n.jd=new lr(Vg),{start:n,tokens:jc({groups:e},r3)}}function o3(t,e){const n=TJ(e.replace(/[A-Z]/g,a=>a.toLowerCase())),r=n.length,o=[];let s=0,i=0;for(;i<r;){let a=t,l=null,c=0,u=null,d=-1,h=-1;for(;i<r&&(l=a.go(n[i]));)a=l,a.accepts()?(d=0,h=0,u=a):d>=0&&(d+=n[i].length,h++),c+=n[i].length,s+=n[i].length,i++;s-=d,i-=h,c-=d,o.push({t:u.t,v:e.slice(s-c,s),s:s-c,e:s})}return o}function TJ(t){const e=[],n=t.length;let r=0;for(;r<n;){let o=t.charCodeAt(r),s,i=o<55296||o>56319||r+1===n||(s=t.charCodeAt(r+1))<56320||s>57343?t[r]:t.slice(r,r+2);e.push(i),r+=i.length}return e}function bi(t,e,n,r,o){let s;const i=e.length;for(let a=0;a<i-1;a++){const l=e[a];t.j[l]?s=t.j[l]:(s=new lr(r),s.jr=o.slice(),t.j[l]=s),t=s}return s=new lr(n),s.jr=o.slice(),t.j[e[i-1]]=s,s}function kA(t){const e=[],n=[];let r=0,o="0123456789";for(;r<t.length;){let s=0;for(;o.indexOf(t[r+s])>=0;)s++;if(s>0){e.push(n.join(""));for(let i=parseInt(t.substring(r,r+s),10);i>0;i--)n.pop();r+=s}else n.push(t[r]),r++}return e}const yh={defaultProtocol:"http",events:null,format:SA,formatHref:SA,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function ck(t,e=null){let n=jc({},yh);t&&(n=jc(n,t instanceof ck?t.o:t));const r=n.ignoreTags,o=[];for(let s=0;s<r.length;s++)o.push(r[s].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=o}ck.prototype={o:yh,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=e!=null;let o=this.o[t];return o&&(typeof o=="object"?(o=n.t in o?o[n.t]:yh[t],typeof o=="function"&&r&&(o=o(e,n))):typeof o=="function"&&r&&(o=o(e,n.t,n)),o)},getObj(t,e,n){let r=this.o[t];return typeof r=="function"&&e!=null&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function SA(t){return t}function s3(t,e){this.t="token",this.v=t,this.tk=e}s3.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"â€¦":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=yh.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),o=t.get("tagName",n,e),s=this.toFormattedString(t),i={},a=t.get("className",n,e),l=t.get("target",n,e),c=t.get("rel",n,e),u=t.getObj("attributes",n,e),d=t.getObj("events",n,e);return i.href=r,a&&(i.class=a),l&&(i.target=l),c&&(i.rel=c),u&&jc(i,u),{tagName:o,attributes:i,content:s,eventListeners:d}}};function ib(t,e){class n extends s3{constructor(o,s){super(o,s),this.t=t}}for(const r in e)n.prototype[r]=e[r];return n.t=t,n}const EA=ib("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),TA=ib("text"),_J=ib("nl"),Vp=ib("url",{isLink:!0,toHref(t=yh.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==gh&&t[1].t===Ri}}),Pr=t=>new lr(t);function AJ({groups:t}){const e=t.domain.concat([Eg,_g,Ti,Ag,Ig,Mg,Rg,Pg,Lr,rk,Nd,Dg,Ng,Og,No,Vg,Ld,Lg]),n=[Tg,Ri,sk,Do,ik,Nd,Od,ak,lk,mg,gg,Pd,Dd,hg,dg,fg,pg,yg,bg,vg,wg,Cg,xg,kg,Sg],r=[Eg,Tg,_g,Ag,Ig,Mg,Rg,Pg,Lr,Pd,Dd,Nd,Dg,Ng,Og,Od,No,Vg,Ld,Lg],o=Pr(),s=q(o,Ld);Ie(s,r,s),Ie(s,t.domain,s);const i=Pr(),a=Pr(),l=Pr();Ie(o,t.domain,i),Ie(o,t.scheme,a),Ie(o,t.slashscheme,l),Ie(i,r,s),Ie(i,t.domain,i);const c=q(i,Ti);q(s,Ti,c),q(a,Ti,c),q(l,Ti,c);const u=q(s,Do);Ie(u,r,s),Ie(u,t.domain,s);const d=Pr();Ie(c,t.domain,d),Ie(d,t.domain,d);const h=q(d,Do);Ie(h,t.domain,d);const f=Pr(EA);Ie(h,t.tld,f),Ie(h,t.utld,f),q(c,gh,f);const p=q(d,Lr);q(p,Lr,p),Ie(p,t.domain,d),Ie(f,t.domain,d),q(f,Do,h),q(f,Lr,p);const y=q(f,Ri);Ie(y,t.numeric,EA);const b=q(i,Lr),w=q(i,Do);q(b,Lr,b),Ie(b,t.domain,i),Ie(w,r,s),Ie(w,t.domain,i);const k=Pr(Vp);Ie(w,t.tld,k),Ie(w,t.utld,k),Ie(k,t.domain,i),Ie(k,r,s),q(k,Do,w),q(k,Lr,b),q(k,Ti,c);const x=q(k,Ri),A=Pr(Vp);Ie(x,t.numeric,A);const I=Pr(Vp),M=Pr();Ie(I,e,I),Ie(I,n,M),Ie(M,e,I),Ie(M,n,M),q(k,No,I),q(A,No,I);const T=q(a,Ri),S=q(l,Ri),_=q(S,No),R=q(_,No);Ie(a,t.domain,i),q(a,Do,w),q(a,Lr,b),Ie(l,t.domain,i),q(l,Do,w),q(l,Lr,b),Ie(T,t.domain,I),q(T,No,I),q(T,Od,I),Ie(R,t.domain,I),Ie(R,e,I),q(R,No,I);const D=[[Pd,Dd],[dg,hg],[fg,pg],[mg,gg],[yg,bg],[vg,wg],[Cg,xg],[kg,Sg]];for(let O=0;O<D.length;O++){const[N,K]=D[O],Q=q(I,N);q(M,N,Q),q(Q,K,I);const ce=Pr(Vp);Ie(Q,e,ce);const z=Pr();Ie(Q,n),Ie(ce,e,ce),Ie(ce,n,z),Ie(z,e,ce),Ie(z,n,z),q(ce,K,I),q(z,K,I)}return q(o,gh,k),q(o,ok,_J),{start:o,tokens:r3}}function IJ(t,e,n){let r=n.length,o=0,s=[],i=[];for(;o<r;){let a=t,l=null,c=null,u=0,d=null,h=-1;for(;o<r&&!(l=a.go(n[o].t));)i.push(n[o++]);for(;o<r&&(c=l||a.go(n[o].t));)l=null,a=c,a.accepts()?(h=0,d=a):h>=0&&h++,o++,u++;if(h<0)o-=u,o<r&&(i.push(n[o]),o++);else{i.length>0&&(s.push(xv(TA,e,i)),i=[]),o-=h,u-=h;const f=d.t,p=n.slice(o-u,o);s.push(xv(f,e,p))}}return i.length>0&&s.push(xv(TA,e,i)),s}function xv(t,e,n){const r=n[0].s,o=n[n.length-1].e,s=e.slice(r,o);return new t(s,n)}const MJ=typeof console<"u"&&console&&console.warn||(()=>{}),RJ="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",pt={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function PJ(){return lr.groups={},pt.scanner=null,pt.parser=null,pt.tokenQueue=[],pt.pluginQueue=[],pt.customSchemes=[],pt.initialized=!1,pt}function _A(t,e=!1){if(pt.initialized&&MJ(`linkifyjs: already initialized - will not register custom scheme "${t}" ${RJ}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);pt.customSchemes.push([t,e])}function DJ(){pt.scanner=EJ(pt.customSchemes);for(let t=0;t<pt.tokenQueue.length;t++)pt.tokenQueue[t][1]({scanner:pt.scanner});pt.parser=AJ(pt.scanner.tokens);for(let t=0;t<pt.pluginQueue.length;t++)pt.pluginQueue[t][1]({scanner:pt.scanner,parser:pt.parser});return pt.initialized=!0,pt}function uk(t){return pt.initialized||DJ(),IJ(pt.parser.start,t,o3(pt.scanner.start,t))}uk.scan=o3;function i3(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new ck(n),o=uk(t),s=[];for(let i=0;i<o.length;i++){const a=o[i];a.isLink&&(!e||a.t===e)&&r.check(a)&&s.push(a.toFormattedObject(r))}return s}function NJ(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function OJ(t){return new Re({key:new We("autolink"),appendTransaction:(e,n,r)=>{const o=e.some(c=>c.docChanged)&&!n.doc.eq(r.doc),s=e.some(c=>c.getMeta("preventAutolink"));if(!o||s)return;const{tr:i}=r,a=Gx(n.doc,[...e]);if(Kx(a).forEach(({newRange:c})=>{const u=lg(r.doc,c,f=>f.isTextblock);let d,h;if(u.length>1?(d=u[0],h=r.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ")):u.length&&r.doc.textBetween(c.from,c.to," "," ").endsWith(" ")&&(d=u[0],h=r.doc.textBetween(d.pos,c.to,void 0," ")),d&&h){const f=h.split(" ").filter(w=>w!=="");if(f.length<=0)return!1;const p=f[f.length-1],y=d.pos+h.lastIndexOf(p);if(!p)return!1;const b=uk(p).map(w=>w.toObject(t.defaultProtocol));if(!NJ(b))return!1;b.filter(w=>w.isLink).map(w=>({...w,from:y+w.start+1,to:y+w.end+1})).filter(w=>r.schema.marks.code?!r.doc.rangeHasMark(w.from,w.to,r.schema.marks.code):!0).filter(w=>t.validate(w.value)).filter(w=>t.shouldAutoLink(w.value)).forEach(w=>{Yx(w.from,w.to,r.doc).some(k=>k.mark.type===t.type)||i.addMark(w.from,w.to,t.type.create({href:w.href}))})}}),!!i.steps.length)return i}})}function LJ(t){return new Re({key:new We("handleClickLink"),props:{handleClick:(e,n,r)=>{var o,s;if(r.button!==0||!e.editable)return!1;let i=r.target;const a=[];for(;i.nodeName!=="DIV";)a.push(i),i=i.parentNode;if(!a.find(h=>h.nodeName==="A"))return!1;const l=IO(e.state,t.type.name),c=r.target,u=(o=c==null?void 0:c.href)!==null&&o!==void 0?o:l.href,d=(s=c==null?void 0:c.target)!==null&&s!==void 0?s:l.target;return c&&u?(window.open(u,d),!0):!1}}})}function VJ(t){return new Re({key:new We("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{state:o}=e,{selection:s}=o,{empty:i}=s;if(i)return!1;let a="";r.content.forEach(c=>{a+=c.textContent});const l=i3(a,{defaultProtocol:t.defaultProtocol}).find(c=>c.isLink&&c.value===a);return!a||!l?!1:t.editor.commands.setMark(t.type,{href:l.href})}}})}const jJ=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g;function La(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const o=typeof r=="string"?r:r.scheme;o&&n.push(o)}),!t||t.replace(jJ,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}const BJ=vn.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){_A(t);return}_A(t.scheme,t.optionalSlashes)})},onDestroy(){PJ()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!La(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>!!t}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!La(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!La(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",_r(this.options.HTMLAttributes,t),0]:["a",_r(this.options.HTMLAttributes,{...t,href:""}),0]},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!La(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!La(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run():!1},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[vl({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,o=i3(t).filter(s=>s.isLink&&this.options.isAllowedUri(s.value,{defaultValidate:i=>!!La(i,n),protocols:n,defaultProtocol:r}));o.length&&o.forEach(s=>e.push({text:s.value,data:{href:s.href},index:s.start}))}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)===null||e===void 0?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(OJ({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:o=>!!La(o,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&t.push(LJ({type:this.type})),this.options.linkOnPaste&&t.push(VJ({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),t}}),$J=cs.create({name:"text",group:"inline"}),Gr=()=>new Map,Iw=t=>{const e=Gr();return t.forEach((n,r)=>{e.set(r,n)}),e},hs=(t,e,n)=>{let r=t.get(e);return r===void 0&&t.set(e,r=n()),r},FJ=(t,e)=>{const n=[];for(const[r,o]of t)n.push(e(o,r));return n},HJ=(t,e)=>{for(const[n,r]of t)if(e(r,n))return!0;return!1},Cl=()=>new Set,kv=t=>t[t.length-1],zJ=(t,e)=>{for(let n=0;n<e.length;n++)t.push(e[n])},xl=Array.from,UJ=(t,e)=>{for(let n=0;n<t.length;n++)if(e(t[n],n,t))return!0;return!1},Mw=Array.isArray;class a3{constructor(){this._observers=Gr()}on(e,n){return hs(this._observers,e,Cl).add(n),n}once(e,n){const r=(...o)=>{this.off(e,r),n(...o)};this.on(e,r)}off(e,n){const r=this._observers.get(e);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(e))}emit(e,n){return xl((this._observers.get(e)||Gr()).values()).forEach(r=>r(...n))}destroy(){this._observers=Gr()}}const Hs=Math.floor,Sm=Math.abs,Bs=(t,e)=>t<e?t:e,Co=(t,e)=>t>e?t:e,l3=t=>t!==0?t<0:1/t<0,AA=1,IA=2,Sv=4,Ev=8,bh=32,$s=64,Xn=128,WJ=1<<29,ab=31,Rw=63,cl=127,qJ=2147483647,c3=Number.MAX_SAFE_INTEGER,GJ=Number.isInteger||(t=>typeof t=="number"&&isFinite(t)&&Hs(t)===t),KJ=String.fromCharCode,YJ=t=>t.toLowerCase(),XJ=/^\s*/g,JJ=t=>t.replace(XJ,""),QJ=/([A-Z])/g,MA=(t,e)=>JJ(t.replace(QJ,n=>`${e}${YJ(n)}`)),ZJ=t=>{const e=unescape(encodeURIComponent(t)),n=e.length,r=new Uint8Array(n);for(let o=0;o<n;o++)r[o]=e.codePointAt(o);return r},vh=typeof TextEncoder<"u"?new TextEncoder:null,eQ=t=>vh.encode(t),tQ=vh?eQ:ZJ;let Vd=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Vd&&Vd.decode(new Uint8Array).length===1&&(Vd=null);class bf{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const vf=()=>new bf,nQ=t=>{const e=vf();return t(e),po(e)},rQ=t=>{let e=t.cpos;for(let n=0;n<t.bufs.length;n++)e+=t.bufs[n].length;return e},po=t=>{const e=new Uint8Array(rQ(t));let n=0;for(let r=0;r<t.bufs.length;r++){const o=t.bufs[r];e.set(o,n),n+=o.length}return e.set(new Uint8Array(t.cbuf.buffer,0,t.cpos),n),e},oQ=(t,e)=>{const n=t.cbuf.length;n-t.cpos<e&&(t.bufs.push(new Uint8Array(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(Co(n,e)*2),t.cpos=0)},Jt=(t,e)=>{const n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(n*2),t.cpos=0),t.cbuf[t.cpos++]=e},Pw=Jt,Ue=(t,e)=>{for(;e>cl;)Jt(t,Xn|cl&e),e=Hs(e/128);Jt(t,cl&e)},dk=(t,e)=>{const n=l3(e);for(n&&(e=-e),Jt(t,(e>Rw?Xn:0)|(n?$s:0)|Rw&e),e=Hs(e/64);e>0;)Jt(t,(e>cl?Xn:0)|cl&e),e=Hs(e/128)},Dw=new Uint8Array(3e4),sQ=Dw.length/3,iQ=(t,e)=>{if(e.length<sQ){const n=vh.encodeInto(e,Dw).written||0;Ue(t,n);for(let r=0;r<n;r++)Jt(t,Dw[r])}else vr(t,tQ(e))},aQ=(t,e)=>{const n=unescape(encodeURIComponent(e)),r=n.length;Ue(t,r);for(let o=0;o<r;o++)Jt(t,n.codePointAt(o))},wc=vh&&vh.encodeInto?iQ:aQ,lb=(t,e)=>{const n=t.cbuf.length,r=t.cpos,o=Bs(n-r,e.length),s=e.length-o;t.cbuf.set(e.subarray(0,o),r),t.cpos+=o,s>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(Co(n*2,s)),t.cbuf.set(e.subarray(o)),t.cpos=s)},vr=(t,e)=>{Ue(t,e.byteLength),lb(t,e)},hk=(t,e)=>{oQ(t,e);const n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},lQ=(t,e)=>hk(t,4).setFloat32(0,e,!1),cQ=(t,e)=>hk(t,8).setFloat64(0,e,!1),uQ=(t,e)=>hk(t,8).setBigInt64(0,e,!1),RA=new DataView(new ArrayBuffer(4)),dQ=t=>(RA.setFloat32(0,t),RA.getFloat32(0)===t),Bc=(t,e)=>{switch(typeof e){case"string":Jt(t,119),wc(t,e);break;case"number":GJ(e)&&Sm(e)<=qJ?(Jt(t,125),dk(t,e)):dQ(e)?(Jt(t,124),lQ(t,e)):(Jt(t,123),cQ(t,e));break;case"bigint":Jt(t,122),uQ(t,e);break;case"object":if(e===null)Jt(t,126);else if(Mw(e)){Jt(t,117),Ue(t,e.length);for(let n=0;n<e.length;n++)Bc(t,e[n])}else if(e instanceof Uint8Array)Jt(t,116),vr(t,e);else{Jt(t,118);const n=Object.keys(e);Ue(t,n.length);for(let r=0;r<n.length;r++){const o=n[r];wc(t,o),Bc(t,e[o])}}break;case"boolean":Jt(t,e?120:121);break;default:Jt(t,127)}};class PA extends bf{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&Ue(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const DA=t=>{t.count>0&&(dk(t.encoder,t.count===1?t.s:-t.s),t.count>1&&Ue(t.encoder,t.count-2))};class Em{constructor(){this.encoder=new bf,this.s=0,this.count=0}write(e){this.s===e?this.count++:(DA(this),this.count=1,this.s=e)}toUint8Array(){return DA(this),po(this.encoder)}}const NA=t=>{if(t.count>0){const e=t.diff*2+(t.count===1?0:1);dk(t.encoder,e),t.count>1&&Ue(t.encoder,t.count-2)}};class Tv{constructor(){this.encoder=new bf,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(NA(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return NA(this),po(this.encoder)}}class hQ{constructor(){this.sarr=[],this.s="",this.lensE=new Em}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new bf;return this.sarr.push(this.s),this.s="",wc(e,this.sarr.join("")),lb(e,this.lensE.toUint8Array()),po(e)}}const Qi=t=>new Error(t),yo=()=>{throw Qi("Method unimplemented")},Ar=()=>{throw Qi("Unexpected case")},u3=Qi("Unexpected end of array"),d3=Qi("Integer out of Range");class cb{constructor(e){this.arr=e,this.pos=0}}const au=t=>new cb(t),fQ=t=>t.pos!==t.arr.length,pQ=(t,e)=>{const n=new Uint8Array(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n},wr=t=>pQ(t,Pe(t)),$c=t=>t.arr[t.pos++],Pe=t=>{let e=0,n=1;const r=t.arr.length;for(;t.pos<r;){const o=t.arr[t.pos++];if(e=e+(o&cl)*n,n*=128,o<Xn)return e;if(e>c3)throw d3}throw u3},fk=t=>{let e=t.arr[t.pos++],n=e&Rw,r=64;const o=(e&$s)>0?-1:1;if((e&Xn)===0)return o*n;const s=t.arr.length;for(;t.pos<s;){if(e=t.arr[t.pos++],n=n+(e&cl)*r,r*=128,e<Xn)return o*n;if(n>c3)throw d3}throw u3},mQ=t=>{let e=Pe(t);if(e===0)return"";{let n=String.fromCodePoint($c(t));if(--e<100)for(;e--;)n+=String.fromCodePoint($c(t));else for(;e>0;){const r=e<1e4?e:1e4,o=t.arr.subarray(t.pos,t.pos+r);t.pos+=r,n+=String.fromCodePoint.apply(null,o),e-=r}return decodeURIComponent(escape(n))}},gQ=t=>Vd.decode(wr(t)),Cc=Vd?gQ:mQ,pk=(t,e)=>{const n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},yQ=t=>pk(t,4).getFloat32(0,!1),bQ=t=>pk(t,8).getFloat64(0,!1),vQ=t=>pk(t,8).getBigInt64(0,!1),wQ=[t=>{},t=>null,fk,yQ,bQ,vQ,t=>!1,t=>!0,Cc,t=>{const e=Pe(t),n={};for(let r=0;r<e;r++){const o=Cc(t);n[o]=wh(t)}return n},t=>{const e=Pe(t),n=[];for(let r=0;r<e;r++)n.push(wh(t));return n},wr],wh=t=>wQ[127-$c(t)](t);class OA extends cb{constructor(e,n){super(e),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),fQ(this)?this.count=Pe(this)+1:this.count=-1),this.count--,this.s}}class Tm extends cb{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=fk(this);const e=l3(this.s);this.count=1,e&&(this.s=-this.s,this.count=Pe(this)+2)}return this.count--,this.s}}class _v extends cb{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=fk(this),n=e&1;this.diff=Hs(e/2),this.count=1,n&&(this.count=Pe(this)+2)}return this.s+=this.diff,this.count--,this.s}}class CQ{constructor(e){this.decoder=new Tm(e),this.str=Cc(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),n=this.str.slice(this.spos,e);return this.spos=e,n}}const xQ=crypto.getRandomValues.bind(crypto),kQ=Math.random,h3=()=>xQ(new Uint32Array(1))[0],SQ=t=>t[Hs(kQ()*t.length)],EQ="10000000-1000-4000-8000"+-1e11,TQ=()=>EQ.replace(/[018]/g,t=>(t^h3()&15>>t/4).toString(16)),_Q=Date.now,LA=t=>new Promise(t);Promise.all.bind(Promise);const VA=t=>t===void 0?null:t;class AQ{constructor(){this.map=new Map}setItem(e,n){this.map.set(e,n)}getItem(e){return this.map.get(e)}}let f3=new AQ,IQ=!0;try{typeof localStorage<"u"&&localStorage&&(f3=localStorage,IQ=!1)}catch{}const MQ=f3,RQ=Object.assign,p3=Object.keys,PQ=(t,e)=>{for(const n in t)e(t[n],n)},jA=t=>p3(t).length,DQ=t=>{for(const e in t)return!1;return!0},m3=(t,e)=>{for(const n in t)if(!e(t[n],n))return!1;return!0},NQ=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),OQ=(t,e)=>t===e||jA(t)===jA(e)&&m3(t,(n,r)=>(n!==void 0||NQ(e,r))&&e[r]===n),LQ=Object.freeze,g3=t=>{for(const e in t){const n=t[e];(typeof n=="object"||typeof n=="function")&&g3(t[e])}return LQ(t)},mk=(t,e,n=0)=>{try{for(;n<t.length;n++)t[n](...e)}finally{n<t.length&&mk(t,e,n+1)}},VQ=t=>t,jQ=(t,e)=>e.includes(t);var y3={};const Fc=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",b3=typeof window<"u"&&typeof document<"u"&&!Fc;let Ro;const BQ=()=>{if(Ro===void 0)if(Fc){Ro=Gr();const t=process.argv;let e=null;for(let n=0;n<t.length;n++){const r=t[n];r[0]==="-"?(e!==null&&Ro.set(e,""),e=r):e!==null&&(Ro.set(e,r),e=null)}e!==null&&Ro.set(e,"")}else typeof location=="object"?(Ro=Gr(),(location.search||"?").slice(1).split("&").forEach(t=>{if(t.length!==0){const[e,n]=t.split("=");Ro.set(`--${MA(e,"-")}`,n),Ro.set(`-${MA(e,"-")}`,n)}})):Ro=Gr();return Ro},Nw=t=>BQ().has(t),jg=t=>VA(Fc?y3[t.toUpperCase().replaceAll("-","_")]:MQ.getItem(t)),v3=t=>Nw("--"+t)||jg(t)!==null;v3("production");const $Q=Fc&&jQ(y3.FORCE_COLOR,["true","1","2"]),FQ=$Q||!Nw("--no-colors")&&!v3("no-color")&&(!Fc||process.stdout.isTTY)&&(!Fc||Nw("--color")||jg("COLORTERM")!==null||(jg("TERM")||"").includes("color")),HQ=t=>new Uint8Array(t),zQ=t=>{let e="";for(let n=0;n<t.byteLength;n++)e+=KJ(t[n]);return btoa(e)},UQ=t=>Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("base64"),WQ=b3?zQ:UQ,qQ=t=>{const e=HQ(t.byteLength);return e.set(t),e},GQ=t=>nQ(e=>Bc(e,t));class KQ{constructor(e,n){this.left=e,this.right=n}}const Cs=(t,e)=>new KQ(t,e),YQ=typeof document<"u"?document:{};typeof DOMParser<"u"&&new DOMParser;const XQ=t=>FJ(t,(e,n)=>`${n}:${e};`).join(""),JQ=t=>class{constructor(n){this._=n}destroy(){t(this._)}},QQ=JQ(clearTimeout),gk=(t,e)=>new QQ(setTimeout(e,t)),Qs=Symbol,w3=Qs(),C3=Qs(),ZQ=Qs(),eZ=Qs(),tZ=Qs(),x3=Qs(),nZ=Qs(),yk=Qs(),rZ=Qs(),oZ=t=>{var o;t.length===1&&((o=t[0])==null?void 0:o.constructor)===Function&&(t=t[0]());const e=[],n=[];let r=0;for(;r<t.length;r++){const s=t[r];if(s===void 0)break;if(s.constructor===String||s.constructor===Number)e.push(s);else if(s.constructor===Object)break}for(r>0&&n.push(e.join(""));r<t.length;r++){const s=t[r];s instanceof Symbol||n.push(s)}return n},sZ={[w3]:Cs("font-weight","bold"),[C3]:Cs("font-weight","normal"),[ZQ]:Cs("color","blue"),[tZ]:Cs("color","green"),[eZ]:Cs("color","grey"),[x3]:Cs("color","red"),[nZ]:Cs("color","purple"),[yk]:Cs("color","orange"),[rZ]:Cs("color","black")},iZ=t=>{var i;t.length===1&&((i=t[0])==null?void 0:i.constructor)===Function&&(t=t[0]());const e=[],n=[],r=Gr();let o=[],s=0;for(;s<t.length;s++){const a=t[s],l=sZ[a];if(l!==void 0)r.set(l.left,l.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){const c=XQ(r);s>0||c.length>0?(e.push("%c"+a),n.push(c)):e.push(a)}else break}}for(s>0&&(o=n,o.unshift(e.join("")));s<t.length;s++){const a=t[s];a instanceof Symbol||o.push(a)}return o},k3=FQ?iZ:oZ,aZ=(...t)=>{console.log(...k3(t)),E3.forEach(e=>e.print(t))},S3=(...t)=>{console.warn(...k3(t)),t.unshift(yk),E3.forEach(e=>e.print(t))},E3=Cl(),T3=t=>({[Symbol.iterator](){return this},next:t}),lZ=(t,e)=>T3(()=>{let n;do n=t.next();while(!n.done&&!e(n.value));return n}),Av=(t,e)=>T3(()=>{const{done:n,value:r}=t.next();return{done:n,value:n?void 0:e(r)}});class bk{constructor(e,n){this.clock=e,this.len=n}}class lu{constructor(){this.clients=new Map}}const Zi=(t,e,n)=>e.clients.forEach((r,o)=>{const s=t.doc.store.clients.get(o);if(s!=null){const i=s[s.length-1],a=i.id.clock+i.length;for(let l=0,c=r[l];l<r.length&&c.clock<a;c=r[++l])V3(t,s,c.clock,c.len,n)}}),cZ=(t,e)=>{let n=0,r=t.length-1;for(;n<=r;){const o=Hs((n+r)/2),s=t[o],i=s.clock;if(i<=e){if(e<i+s.len)return o;n=o+1}else r=o-1}return null},cu=(t,e)=>{const n=t.clients.get(e.client);return n!==void 0&&cZ(n,e.clock)!==null},vk=t=>{t.clients.forEach(e=>{e.sort((o,s)=>o.clock-s.clock);let n,r;for(n=1,r=1;n<e.length;n++){const o=e[r-1],s=e[n];o.clock+o.len>=s.clock?o.len=Co(o.len,s.clock+s.len-o.clock):(r<n&&(e[r]=s),r++)}e.length=r})},Ow=t=>{const e=new lu;for(let n=0;n<t.length;n++)t[n].clients.forEach((r,o)=>{if(!e.clients.has(o)){const s=r.slice();for(let i=n+1;i<t.length;i++)zJ(s,t[i].clients.get(o)||[]);e.clients.set(o,s)}});return vk(e),e},Ch=(t,e,n,r)=>{hs(t.clients,e,()=>[]).push(new bk(n,r))},_3=()=>new lu,A3=t=>{const e=_3();return t.clients.forEach((n,r)=>{const o=[];for(let s=0;s<n.length;s++){const i=n[s];if(i.deleted){const a=i.id.clock;let l=i.length;if(s+1<n.length)for(let c=n[s+1];s+1<n.length&&c.deleted;c=n[++s+1])l+=c.length;o.push(new bk(a,l))}}o.length>0&&e.clients.set(r,o)}),e},uu=(t,e)=>{Ue(t.restEncoder,e.clients.size),xl(e.clients.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{t.resetDsCurVal(),Ue(t.restEncoder,n);const o=r.length;Ue(t.restEncoder,o);for(let s=0;s<o;s++){const i=r[s];t.writeDsClock(i.clock),t.writeDsLen(i.len)}})},wk=t=>{const e=new lu,n=Pe(t.restDecoder);for(let r=0;r<n;r++){t.resetDsCurVal();const o=Pe(t.restDecoder),s=Pe(t.restDecoder);if(s>0){const i=hs(e.clients,o,()=>[]);for(let a=0;a<s;a++)i.push(new bk(t.readDsClock(),t.readDsLen()))}}return e},BA=(t,e,n)=>{const r=new lu,o=Pe(t.restDecoder);for(let s=0;s<o;s++){t.resetDsCurVal();const i=Pe(t.restDecoder),a=Pe(t.restDecoder),l=n.clients.get(i)||[],c=Dt(n,i);for(let u=0;u<a;u++){const d=t.readDsClock(),h=d+t.readDsLen();if(d<c){c<h&&Ch(r,i,c,h-c);let f=Jr(l,d),p=l[f];for(!p.deleted&&p.id.clock<d&&(l.splice(f+1,0,Wg(e,p,d-p.id.clock)),f++);f<l.length&&(p=l[f++],p.id.clock<h);)p.deleted||(h<p.id.clock+p.length&&l.splice(f,0,Wg(e,p,h-p.id.clock)),p.delete(e))}else Ch(r,i,d,h-d)}}if(r.clients.size>0){const s=new kl;return Ue(s.restEncoder,0),uu(s,r),s.toUint8Array()}return null},I3=h3;class ga extends a3{constructor({guid:e=TQ(),collectionid:n=null,gc:r=!0,gcFilter:o=()=>!0,meta:s=null,autoLoad:i=!1,shouldLoad:a=!0}={}){super(),this.gc=r,this.gcFilter=o,this.clientID=I3(),this.guid=e,this.collectionid=n,this.share=new Map,this.store=new O3,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=a,this.autoLoad=i,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=LA(c=>{this.on("load",()=>{this.isLoaded=!0,c(this)})});const l=()=>LA(c=>{const u=d=>{(d===void 0||d===!0)&&(this.off("sync",u),c())};this.on("sync",u)});this.on("sync",c=>{c===!1&&this.isSynced&&(this.whenSynced=l()),this.isSynced=c===void 0||c===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=l()}load(){const e=this._item;e!==null&&!this.shouldLoad&&st(e.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(xl(this.subdocs).map(e=>e.guid))}transact(e,n=null){return st(this,e,n)}get(e,n=tn){const r=hs(this.share,e,()=>{const s=new n;return s._integrate(this,null),s}),o=r.constructor;if(n!==tn&&o!==n)if(o===tn){const s=new n;s._map=r._map,r._map.forEach(i=>{for(;i!==null;i=i.left)i.parent=s}),s._start=r._start;for(let i=s._start;i!==null;i=i.right)i.parent=s;return s._length=r._length,this.share.set(e,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return r}getArray(e=""){return this.get(e,Sc)}getText(e=""){return this.get(e,ea)}getMap(e=""){return this.get(e,zc)}getXmlElement(e=""){return this.get(e,Kn)}getXmlFragment(e=""){return this.get(e,Sl)}toJSON(){const e={};return this.share.forEach((n,r)=>{e[r]=n.toJSON()}),e}destroy(){this.isDestroyed=!0,xl(this.subdocs).forEach(n=>n.destroy());const e=this._item;if(e!==null){this._item=null;const n=e.content;n.doc=new ga({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=e,st(e.parent.doc,r=>{const o=n.doc;e.deleted||r.subdocsAdded.add(o),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class M3{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return Pe(this.restDecoder)}readDsLen(){return Pe(this.restDecoder)}}class R3 extends M3{readLeftID(){return Te(Pe(this.restDecoder),Pe(this.restDecoder))}readRightID(){return Te(Pe(this.restDecoder),Pe(this.restDecoder))}readClient(){return Pe(this.restDecoder)}readInfo(){return $c(this.restDecoder)}readString(){return Cc(this.restDecoder)}readParentInfo(){return Pe(this.restDecoder)===1}readTypeRef(){return Pe(this.restDecoder)}readLen(){return Pe(this.restDecoder)}readAny(){return wh(this.restDecoder)}readBuf(){return qQ(wr(this.restDecoder))}readJSON(){return JSON.parse(Cc(this.restDecoder))}readKey(){return Cc(this.restDecoder)}}class uZ{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Pe(this.restDecoder),this.dsCurrVal}readDsLen(){const e=Pe(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class Hc extends uZ{constructor(e){super(e),this.keys=[],Pe(e),this.keyClockDecoder=new _v(wr(e)),this.clientDecoder=new Tm(wr(e)),this.leftClockDecoder=new _v(wr(e)),this.rightClockDecoder=new _v(wr(e)),this.infoDecoder=new OA(wr(e),$c),this.stringDecoder=new CQ(wr(e)),this.parentInfoDecoder=new OA(wr(e),$c),this.typeRefDecoder=new Tm(wr(e)),this.lenDecoder=new Tm(wr(e))}readLeftID(){return new xc(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new xc(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return wh(this.restDecoder)}readBuf(){return wr(this.restDecoder)}readJSON(){return wh(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class dZ{constructor(){this.restEncoder=vf()}toUint8Array(){return po(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){Ue(this.restEncoder,e)}writeDsLen(e){Ue(this.restEncoder,e)}}class wf extends dZ{writeLeftID(e){Ue(this.restEncoder,e.client),Ue(this.restEncoder,e.clock)}writeRightID(e){Ue(this.restEncoder,e.client),Ue(this.restEncoder,e.clock)}writeClient(e){Ue(this.restEncoder,e)}writeInfo(e){Pw(this.restEncoder,e)}writeString(e){wc(this.restEncoder,e)}writeParentInfo(e){Ue(this.restEncoder,e?1:0)}writeTypeRef(e){Ue(this.restEncoder,e)}writeLen(e){Ue(this.restEncoder,e)}writeAny(e){Bc(this.restEncoder,e)}writeBuf(e){vr(this.restEncoder,e)}writeJSON(e){wc(this.restEncoder,JSON.stringify(e))}writeKey(e){wc(this.restEncoder,e)}}class hZ{constructor(){this.restEncoder=vf(),this.dsCurrVal=0}toUint8Array(){return po(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const n=e-this.dsCurrVal;this.dsCurrVal=e,Ue(this.restEncoder,n)}writeDsLen(e){e===0&&Ar(),Ue(this.restEncoder,e-1),this.dsCurrVal+=e}}class kl extends hZ{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Tv,this.clientEncoder=new Em,this.leftClockEncoder=new Tv,this.rightClockEncoder=new Tv,this.infoEncoder=new PA(Pw),this.stringEncoder=new hQ,this.parentInfoEncoder=new PA(Pw),this.typeRefEncoder=new Em,this.lenEncoder=new Em}toUint8Array(){const e=vf();return Ue(e,0),vr(e,this.keyClockEncoder.toUint8Array()),vr(e,this.clientEncoder.toUint8Array()),vr(e,this.leftClockEncoder.toUint8Array()),vr(e,this.rightClockEncoder.toUint8Array()),vr(e,po(this.infoEncoder)),vr(e,this.stringEncoder.toUint8Array()),vr(e,po(this.parentInfoEncoder)),vr(e,this.typeRefEncoder.toUint8Array()),vr(e,this.lenEncoder.toUint8Array()),lb(e,po(this.restEncoder)),po(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){Bc(this.restEncoder,e)}writeBuf(e){vr(this.restEncoder,e)}writeJSON(e){Bc(this.restEncoder,e)}writeKey(e){const n=this.keyMap.get(e);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(n)}}const fZ=(t,e,n,r)=>{r=Co(r,e[0].id.clock);const o=Jr(e,r);Ue(t.restEncoder,e.length-o),t.writeClient(n),Ue(t.restEncoder,r);const s=e[o];s.write(t,r-s.id.clock);for(let i=o+1;i<e.length;i++)e[i].write(t,0)},Ck=(t,e,n)=>{const r=new Map;n.forEach((o,s)=>{Dt(e,s)>o&&r.set(s,o)}),ub(e).forEach((o,s)=>{n.has(s)||r.set(s,0)}),Ue(t.restEncoder,r.size),xl(r.entries()).sort((o,s)=>s[0]-o[0]).forEach(([o,s])=>{fZ(t,e.clients.get(o),o,s)})},pZ=(t,e)=>{const n=Gr(),r=Pe(t.restDecoder);for(let o=0;o<r;o++){const s=Pe(t.restDecoder),i=new Array(s),a=t.readClient();let l=Pe(t.restDecoder);n.set(a,{i:0,refs:i});for(let c=0;c<s;c++){const u=t.readInfo();switch(ab&u){case 0:{const d=t.readLen();i[c]=new zr(Te(a,l),d),l+=d;break}case 10:{const d=Pe(t.restDecoder);i[c]=new Ur(Te(a,l),d),l+=d;break}default:{const d=(u&($s|Xn))===0,h=new Qe(Te(a,l),null,(u&Xn)===Xn?t.readLeftID():null,null,(u&$s)===$s?t.readRightID():null,d?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,d&&(u&bh)===bh?t.readString():null,sL(t,u));i[c]=h,l+=h.length}}}}return n},mZ=(t,e,n)=>{const r=[];let o=xl(n.keys()).sort((f,p)=>f-p);if(o.length===0)return null;const s=()=>{if(o.length===0)return null;let f=n.get(o[o.length-1]);for(;f.refs.length===f.i;)if(o.pop(),o.length>0)f=n.get(o[o.length-1]);else return null;return f};let i=s();if(i===null)return null;const a=new O3,l=new Map,c=(f,p)=>{const y=l.get(f);(y==null||y>p)&&l.set(f,p)};let u=i.refs[i.i++];const d=new Map,h=()=>{for(const f of r){const p=f.id.client,y=n.get(p);y?(y.i--,a.clients.set(p,y.refs.slice(y.i)),n.delete(p),y.i=0,y.refs=[]):a.clients.set(p,[f]),o=o.filter(b=>b!==p)}r.length=0};for(;;){if(u.constructor!==Ur){const p=hs(d,u.id.client,()=>Dt(e,u.id.client))-u.id.clock;if(p<0)r.push(u),c(u.id.client,u.id.clock-1),h();else{const y=u.getMissing(t,e);if(y!==null){r.push(u);const b=n.get(y)||{refs:[],i:0};if(b.refs.length===b.i)c(y,Dt(e,y)),h();else{u=b.refs[b.i++];continue}}else(p===0||p<u.length)&&(u.integrate(t,p),d.set(u.id.client,u.id.clock+u.length))}}if(r.length>0)u=r.pop();else if(i!==null&&i.i<i.refs.length)u=i.refs[i.i++];else{if(i=s(),i===null)break;u=i.refs[i.i++]}}if(a.clients.size>0){const f=new kl;return Ck(f,a,new Map),Ue(f.restEncoder,0),{missing:l,update:f.toUint8Array()}}return null},gZ=(t,e)=>Ck(t,e.doc.store,e.beforeState),yZ=(t,e,n,r=new Hc(t))=>st(e,o=>{o.local=!1;let s=!1;const i=o.doc,a=i.store,l=pZ(r,i),c=mZ(o,a,l),u=a.pendingStructs;if(u){for(const[h,f]of u.missing)if(f<Dt(a,h)){s=!0;break}if(c){for(const[h,f]of c.missing){const p=u.missing.get(h);(p==null||p>f)&&u.missing.set(h,f)}u.update=$g([u.update,c.update])}}else a.pendingStructs=c;const d=BA(r,o,a);if(a.pendingDs){const h=new Hc(au(a.pendingDs));Pe(h.restDecoder);const f=BA(h,o,a);d&&f?a.pendingDs=$g([d,f]):a.pendingDs=d||f}else a.pendingDs=d;if(s){const h=a.pendingStructs.update;a.pendingStructs=null,Bg(o.doc,h)}},n,!1),Bg=(t,e,n,r=Hc)=>{const o=au(e);yZ(o,t,n,new r(o))},$A=(t,e,n)=>Bg(t,e,n,R3),bZ=(t,e,n=new Map)=>{Ck(t,e.store,n),uu(t,A3(e.store))},vZ=(t,e=new Uint8Array([0]),n=new kl)=>{const r=P3(e);bZ(n,t,r);const o=[n.toUint8Array()];if(t.store.pendingDs&&o.push(t.store.pendingDs),t.store.pendingStructs&&o.push(OZ(t.store.pendingStructs.update,e)),o.length>1){if(n.constructor===wf)return DZ(o.map((s,i)=>i===0?s:VZ(s)));if(n.constructor===kl)return $g(o)}return o[0]},FA=(t,e)=>vZ(t,e,new wf),wZ=t=>{const e=new Map,n=Pe(t.restDecoder);for(let r=0;r<n;r++){const o=Pe(t.restDecoder),s=Pe(t.restDecoder);e.set(o,s)}return e},P3=t=>wZ(new M3(au(t)));class CZ{constructor(){this.l=[]}}const HA=()=>new CZ,zA=(t,e)=>t.l.push(e),UA=(t,e)=>{const n=t.l,r=n.length;t.l=n.filter(o=>e!==o),r===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},D3=(t,e,n)=>mk(t.l,[e,n]);class xc{constructor(e,n){this.client=e,this.clock=n}}const uc=(t,e)=>t===e||t!==null&&e!==null&&t.client===e.client&&t.clock===e.clock,Te=(t,e)=>new xc(t,e),xh=t=>{for(const[e,n]of t.doc.share.entries())if(n===t)return e;throw Ar()},kh=(t,e)=>{for(;e!==null;){if(e.parent===t)return!0;e=e.parent._item}return!1};class Sh{constructor(e,n,r,o=0){this.type=e,this.tname=n,this.item=r,this.assoc=o}}const jd=t=>new Sh(t.type==null?null:Te(t.type.client,t.type.clock),t.tname??null,t.item==null?null:Te(t.item.client,t.item.clock),t.assoc==null?0:t.assoc);class xZ{constructor(e,n,r=0){this.type=e,this.index=n,this.assoc=r}}const kZ=(t,e,n=0)=>new xZ(t,e,n),jp=(t,e,n)=>{let r=null,o=null;return t._item===null?o=xh(t):r=Te(t._item.id.client,t._item.id.clock),new Sh(r,o,e,n)},Iv=(t,e,n=0)=>{let r=t._start;if(n<0){if(e===0)return jp(t,null,n);e--}for(;r!==null;){if(!r.deleted&&r.countable){if(r.length>e)return jp(t,Te(r.id.client,r.id.clock+e),n);e-=r.length}if(r.right===null&&n<0)return jp(t,r.lastId,n);r=r.right}return jp(t,null,n)},SZ=(t,e)=>{const n=kc(t,e),r=e.clock-n.id.clock;return{item:n,diff:r}},EZ=(t,e,n=!0)=>{const r=e.store,o=t.item,s=t.type,i=t.tname,a=t.assoc;let l=null,c=0;if(o!==null){if(Dt(r,o.client)<=o.clock)return null;const u=n?Bw(r,o):SZ(r,o),d=u.item;if(!(d instanceof Qe))return null;if(l=d.parent,l._item===null||!l._item.deleted){c=d.deleted||!d.countable?0:u.diff+(a>=0?0:1);let h=d.left;for(;h!==null;)!h.deleted&&h.countable&&(c+=h.length),h=h.left}}else{if(i!==null)l=e.get(i);else if(s!==null){if(Dt(r,s.client)<=s.clock)return null;const{item:u}=n?Bw(r,s):{item:kc(r,s)};if(u instanceof Qe&&u.content instanceof Io)l=u.content.type;else return null}else throw Ar();a>=0?c=l._length:c=0}return kZ(l,c,t.assoc)},WA=(t,e)=>t===e||t!==null&&e!==null&&t.tname===e.tname&&uc(t.item,e.item)&&uc(t.type,e.type)&&t.assoc===e.assoc;class xk{constructor(e,n){this.ds=e,this.sv=n}}const N3=(t,e)=>new xk(t,e),Mv=t=>N3(A3(t.store),ub(t.store)),qa=(t,e)=>e===void 0?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!cu(e.ds,t.id),Lw=(t,e)=>{const n=hs(t.meta,Lw,Cl),r=t.doc.store;n.has(e)||(e.sv.forEach((o,s)=>{o<Dt(r,s)&&cr(t,Te(s,o))}),Zi(t,e.ds,o=>{}),n.add(e))};class O3{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const ub=t=>{const e=new Map;return t.clients.forEach((n,r)=>{const o=n[n.length-1];e.set(r,o.id.clock+o.length)}),e},Dt=(t,e)=>{const n=t.clients.get(e);if(n===void 0)return 0;const r=n[n.length-1];return r.id.clock+r.length},L3=(t,e)=>{let n=t.clients.get(e.id.client);if(n===void 0)n=[],t.clients.set(e.id.client,n);else{const r=n[n.length-1];if(r.id.clock+r.length!==e.id.clock)throw Ar()}n.push(e)},Jr=(t,e)=>{let n=0,r=t.length-1,o=t[r],s=o.id.clock;if(s===e)return r;let i=Hs(e/(s+o.length-1)*r);for(;n<=r;){if(o=t[i],s=o.id.clock,s<=e){if(e<s+o.length)return i;n=i+1}else r=i-1;i=Hs((n+r)/2)}throw Ar()},TZ=(t,e)=>{const n=t.clients.get(e.client);return n[Jr(n,e.clock)]},kc=TZ,Vw=(t,e,n)=>{const r=Jr(e,n),o=e[r];return o.id.clock<n&&o instanceof Qe?(e.splice(r+1,0,Wg(t,o,n-o.id.clock)),r+1):r},cr=(t,e)=>{const n=t.doc.store.clients.get(e.client);return n[Vw(t,n,e.clock)]},qA=(t,e,n)=>{const r=e.clients.get(n.client),o=Jr(r,n.clock),s=r[o];return n.clock!==s.id.clock+s.length-1&&s.constructor!==zr&&r.splice(o+1,0,Wg(t,s,n.clock-s.id.clock+1)),s},_Z=(t,e,n)=>{const r=t.clients.get(e.id.client);r[Jr(r,e.id.clock)]=n},V3=(t,e,n,r,o)=>{if(r===0)return;const s=n+r;let i=Vw(t,e,n),a;do a=e[i++],s<a.id.clock+a.length&&Vw(t,e,s),o(a);while(i<e.length&&e[i].id.clock<s)};class AZ{constructor(e,n,r){this.doc=e,this.deleteSet=new lu,this.beforeState=ub(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const GA=(t,e)=>e.deleteSet.clients.size===0&&!HJ(e.afterState,(n,r)=>e.beforeState.get(r)!==n)?!1:(vk(e.deleteSet),gZ(t,e),uu(t,e.deleteSet),!0),KA=(t,e,n)=>{const r=e._item;(r===null||r.id.clock<(t.beforeState.get(r.id.client)||0)&&!r.deleted)&&hs(t.changed,e,Cl).add(n)},_m=(t,e)=>{let n=t[e],r=t[e-1],o=e;for(;o>0;n=r,r=t[--o-1]){if(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)){n instanceof Qe&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);continue}break}const s=e-o;return s&&t.splice(e+1-s,s),s},IZ=(t,e,n)=>{for(const[r,o]of t.clients.entries()){const s=e.clients.get(r);for(let i=o.length-1;i>=0;i--){const a=o[i],l=a.clock+a.len;for(let c=Jr(s,a.clock),u=s[c];c<s.length&&u.id.clock<l;u=s[++c]){const d=s[c];if(a.clock+a.len<=d.id.clock)break;d instanceof Qe&&d.deleted&&!d.keep&&n(d)&&d.gc(e,!1)}}}},MZ=(t,e)=>{t.clients.forEach((n,r)=>{const o=e.clients.get(r);for(let s=n.length-1;s>=0;s--){const i=n[s],a=Bs(o.length-1,1+Jr(o,i.clock+i.len-1));for(let l=a,c=o[l];l>0&&c.id.clock>=i.clock;c=o[l])l-=1+_m(o,l)}})},j3=(t,e)=>{if(e<t.length){const n=t[e],r=n.doc,o=r.store,s=n.deleteSet,i=n._mergeStructs;try{vk(s),n.afterState=ub(n.doc.store),r.emit("beforeObserverCalls",[n,r]);const a=[];n.changed.forEach((l,c)=>a.push(()=>{(c._item===null||!c._item.deleted)&&c._callObserver(n,l)})),a.push(()=>{n.changedParentTypes.forEach((l,c)=>{c._dEH.l.length>0&&(c._item===null||!c._item.deleted)&&(l=l.filter(u=>u.target._item===null||!u.target._item.deleted),l.forEach(u=>{u.currentTarget=c,u._path=null}),l.sort((u,d)=>u.path.length-d.path.length),D3(c._dEH,l,n))})}),a.push(()=>r.emit("afterTransaction",[n,r])),mk(a,[]),n._needFormattingCleanup&&JZ(n)}finally{r.gc&&IZ(s,o,r.gcFilter),MZ(s,o),n.afterState.forEach((u,d)=>{const h=n.beforeState.get(d)||0;if(h!==u){const f=o.clients.get(d),p=Co(Jr(f,h),1);for(let y=f.length-1;y>=p;)y-=1+_m(f,y)}});for(let u=i.length-1;u>=0;u--){const{client:d,clock:h}=i[u].id,f=o.clients.get(d),p=Jr(f,h);p+1<f.length&&_m(f,p+1)>1||p>0&&_m(f,p)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(aZ(yk,w3,"[yjs] ",C3,x3,"Changed the client-id because another client seems to be using it."),r.clientID=I3()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const u=new wf;GA(u,n)&&r.emit("update",[u.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const u=new kl;GA(u,n)&&r.emit("updateV2",[u.toUint8Array(),n.origin,r,n])}const{subdocsAdded:a,subdocsLoaded:l,subdocsRemoved:c}=n;(a.size>0||c.size>0||l.size>0)&&(a.forEach(u=>{u.clientID=r.clientID,u.collectionid==null&&(u.collectionid=r.collectionid),r.subdocs.add(u)}),c.forEach(u=>r.subdocs.delete(u)),r.emit("subdocs",[{loaded:l,added:a,removed:c},r,n]),c.forEach(u=>u.destroy())),t.length<=e+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,t])):j3(t,e+1)}}},st=(t,e,n=null,r=!0)=>{const o=t._transactionCleanups;let s=!1,i=null;t._transaction===null&&(s=!0,t._transaction=new AZ(t,n,r),o.push(t._transaction),o.length===1&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{i=e(t._transaction)}finally{if(s){const a=t._transaction===o[0];t._transaction=null,a&&j3(o,0)}}return i};class RZ{constructor(e,n){this.insertions=n,this.deletions=e,this.meta=new Map}}const YA=(t,e,n)=>{Zi(t,n.deletions,r=>{r instanceof Qe&&e.scope.some(o=>o===t.doc||kh(o,r))&&Mk(r,!1)})},XA=(t,e,n)=>{let r=null;const o=t.doc,s=t.scope;st(o,a=>{for(;e.length>0&&t.currStackItem===null;){const l=o.store,c=e.pop(),u=new Set,d=[];let h=!1;Zi(a,c.insertions,f=>{if(f instanceof Qe){if(f.redone!==null){let{item:p,diff:y}=Bw(l,f.id);y>0&&(p=cr(a,Te(p.id.client,p.id.clock+y))),f=p}!f.deleted&&s.some(p=>p===a.doc||kh(p,f))&&d.push(f)}}),Zi(a,c.deletions,f=>{f instanceof Qe&&s.some(p=>p===a.doc||kh(p,f))&&!cu(c.insertions,f.id)&&u.add(f)}),u.forEach(f=>{h=oL(a,f,u,c.insertions,t.ignoreRemoteMapChanges,t)!==null||h});for(let f=d.length-1;f>=0;f--){const p=d[f];t.deleteFilter(p)&&(p.delete(a),h=!0)}t.currStackItem=h?c:null}a.changed.forEach((l,c)=>{l.has(null)&&c._searchMarker&&(c._searchMarker.length=0)}),r=a},t);const i=t.currStackItem;if(i!=null){const a=r.changedParentTypes;t.emit("stack-item-popped",[{stackItem:i,type:n,changedParentTypes:a,origin:t},t]),t.currStackItem=null}return i};class B3 extends a3{constructor(e,{captureTimeout:n=500,captureTransaction:r=l=>!0,deleteFilter:o=()=>!0,trackedOrigins:s=new Set([null]),ignoreRemoteMapChanges:i=!1,doc:a=Mw(e)?e[0].doc:e instanceof ga?e:e.doc}={}){super(),this.scope=[],this.doc=a,this.addToScope(e),this.deleteFilter=o,s.add(this),this.trackedOrigins=s,this.captureTransaction=r,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=i,this.captureTimeout=n,this.afterTransactionHandler=l=>{if(!this.captureTransaction(l)||!this.scope.some(b=>l.changedParentTypes.has(b)||b===this.doc)||!this.trackedOrigins.has(l.origin)&&(!l.origin||!this.trackedOrigins.has(l.origin.constructor)))return;const c=this.undoing,u=this.redoing,d=c?this.redoStack:this.undoStack;c?this.stopCapturing():u||this.clear(!1,!0);const h=new lu;l.afterState.forEach((b,w)=>{const k=l.beforeState.get(w)||0,x=b-k;x>0&&Ch(h,w,k,x)});const f=_Q();let p=!1;if(this.lastChange>0&&f-this.lastChange<this.captureTimeout&&d.length>0&&!c&&!u){const b=d[d.length-1];b.deletions=Ow([b.deletions,l.deleteSet]),b.insertions=Ow([b.insertions,h])}else d.push(new RZ(l.deleteSet,h)),p=!0;!c&&!u&&(this.lastChange=f),Zi(l,l.deleteSet,b=>{b instanceof Qe&&this.scope.some(w=>w===l.doc||kh(w,b))&&Mk(b,!0)});const y=[{stackItem:d[d.length-1],origin:l.origin,type:c?"redo":"undo",changedParentTypes:l.changedParentTypes},this];p?this.emit("stack-item-added",y):this.emit("stack-item-updated",y)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){const n=new Set(this.scope);e=Mw(e)?e:[e],e.forEach(r=>{n.has(r)||(n.add(r),(r instanceof tn?r.doc!==this.doc:r!==this.doc)&&S3("[yjs#509] Not same Y.Doc"),this.scope.push(r))})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,n=!0){(e&&this.canUndo()||n&&this.canRedo())&&this.doc.transact(r=>{e&&(this.undoStack.forEach(o=>YA(r,this,o)),this.undoStack=[]),n&&(this.redoStack.forEach(o=>YA(r,this,o)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:n}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let e;try{e=XA(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){this.redoing=!0;let e;try{e=XA(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*PZ(t){const e=Pe(t.restDecoder);for(let n=0;n<e;n++){const r=Pe(t.restDecoder),o=t.readClient();let s=Pe(t.restDecoder);for(let i=0;i<r;i++){const a=t.readInfo();if(a===10){const l=Pe(t.restDecoder);yield new Ur(Te(o,s),l),s+=l}else if((ab&a)!==0){const l=(a&($s|Xn))===0,c=new Qe(Te(o,s),null,(a&Xn)===Xn?t.readLeftID():null,null,(a&$s)===$s?t.readRightID():null,l?t.readParentInfo()?t.readString():t.readLeftID():null,l&&(a&bh)===bh?t.readString():null,sL(t,a));yield c,s+=c.length}else{const l=t.readLen();yield new zr(Te(o,s),l),s+=l}}}}class kk{constructor(e,n){this.gen=PZ(e),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Ur);return this.curr}}class Sk{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const DZ=t=>$g(t,R3,wf),NZ=(t,e)=>{if(t.constructor===zr){const{client:n,clock:r}=t.id;return new zr(Te(n,r+e),t.length-e)}else if(t.constructor===Ur){const{client:n,clock:r}=t.id;return new Ur(Te(n,r+e),t.length-e)}else{const n=t,{client:r,clock:o}=n.id;return new Qe(Te(r,o+e),null,Te(r,o+e-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(e))}},$g=(t,e=Hc,n=kl)=>{if(t.length===1)return t[0];const r=t.map(u=>new e(au(u)));let o=r.map(u=>new kk(u,!0)),s=null;const i=new n,a=new Sk(i);for(;o=o.filter(h=>h.curr!==null),o.sort((h,f)=>{if(h.curr.id.client===f.curr.id.client){const p=h.curr.id.clock-f.curr.id.clock;return p===0?h.curr.constructor===f.curr.constructor?0:h.curr.constructor===Ur?1:-1:p}else return f.curr.id.client-h.curr.id.client}),o.length!==0;){const u=o[0],d=u.curr.id.client;if(s!==null){let h=u.curr,f=!1;for(;h!==null&&h.id.clock+h.length<=s.struct.id.clock+s.struct.length&&h.id.client>=s.struct.id.client;)h=u.next(),f=!0;if(h===null||h.id.client!==d||f&&h.id.clock>s.struct.id.clock+s.struct.length)continue;if(d!==s.struct.id.client)Pi(a,s.struct,s.offset),s={struct:h,offset:0},u.next();else if(s.struct.id.clock+s.struct.length<h.id.clock)if(s.struct.constructor===Ur)s.struct.length=h.id.clock+h.length-s.struct.id.clock;else{Pi(a,s.struct,s.offset);const p=h.id.clock-s.struct.id.clock-s.struct.length;s={struct:new Ur(Te(d,s.struct.id.clock+s.struct.length),p),offset:0}}else{const p=s.struct.id.clock+s.struct.length-h.id.clock;p>0&&(s.struct.constructor===Ur?s.struct.length-=p:h=NZ(h,p)),s.struct.mergeWith(h)||(Pi(a,s.struct,s.offset),s={struct:h,offset:0},u.next())}}else s={struct:u.curr,offset:0},u.next();for(let h=u.curr;h!==null&&h.id.client===d&&h.id.clock===s.struct.id.clock+s.struct.length&&h.constructor!==Ur;h=u.next())Pi(a,s.struct,s.offset),s={struct:h,offset:0}}s!==null&&(Pi(a,s.struct,s.offset),s=null),Ek(a);const l=r.map(u=>wk(u)),c=Ow(l);return uu(i,c),i.toUint8Array()},OZ=(t,e,n=Hc,r=kl)=>{const o=P3(e),s=new r,i=new Sk(s),a=new n(au(t)),l=new kk(a,!1);for(;l.curr;){const u=l.curr,d=u.id.client,h=o.get(d)||0;if(l.curr.constructor===Ur){l.next();continue}if(u.id.clock+u.length>h)for(Pi(i,u,Co(h-u.id.clock,0)),l.next();l.curr&&l.curr.id.client===d;)Pi(i,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===d&&l.curr.id.clock+l.curr.length<=h;)l.next()}Ek(i);const c=wk(a);return uu(s,c),s.toUint8Array()},$3=t=>{t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:po(t.encoder.restEncoder)}),t.encoder.restEncoder=vf(),t.written=0)},Pi=(t,e,n)=>{t.written>0&&t.currClient!==e.id.client&&$3(t),t.written===0&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),Ue(t.encoder.restEncoder,e.id.clock+n)),e.write(t.encoder,n),t.written++},Ek=t=>{$3(t);const e=t.encoder.restEncoder;Ue(e,t.clientStructs.length);for(let n=0;n<t.clientStructs.length;n++){const r=t.clientStructs[n];Ue(e,r.written),lb(e,r.restEncoder)}},LZ=(t,e,n,r)=>{const o=new n(au(t)),s=new kk(o,!1),i=new r,a=new Sk(i);for(let c=s.curr;c!==null;c=s.next())Pi(a,e(c),0);Ek(a);const l=wk(o);return uu(i,l),i.toUint8Array()},VZ=t=>LZ(t,VQ,Hc,wf),JA="You must not compute changes after the event-handler fired.";class db{constructor(e,n){this.target=e,this.currentTarget=e,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=jZ(this.currentTarget,this.target))}deletes(e){return cu(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw Qi(JA);const e=new Map,n=this.target;this.transaction.changed.get(n).forEach(o=>{if(o!==null){const s=n._map.get(o);let i,a;if(this.adds(s)){let l=s.left;for(;l!==null&&this.adds(l);)l=l.left;if(this.deletes(s))if(l!==null&&this.deletes(l))i="delete",a=kv(l.content.getContent());else return;else l!==null&&this.deletes(l)?(i="update",a=kv(l.content.getContent())):(i="add",a=void 0)}else if(this.deletes(s))i="delete",a=kv(s.content.getContent());else return;e.set(o,{action:i,oldValue:a})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw Qi(JA);const n=this.target,r=Cl(),o=Cl(),s=[];if(e={added:r,deleted:o,delta:s,keys:this.keys},this.transaction.changed.get(n).has(null)){let a=null;const l=()=>{a&&s.push(a)};for(let c=n._start;c!==null;c=c.right)c.deleted?this.deletes(c)&&!this.adds(c)&&((a===null||a.delete===void 0)&&(l(),a={delete:0}),a.delete+=c.length,o.add(c)):this.adds(c)?((a===null||a.insert===void 0)&&(l(),a={insert:[]}),a.insert=a.insert.concat(c.content.getContent()),r.add(c)):((a===null||a.retain===void 0)&&(l(),a={retain:0}),a.retain+=c.length);a!==null&&a.retain===void 0&&l()}this._changes=e}return e}}const jZ=(t,e)=>{const n=[];for(;e._item!==null&&e!==t;){if(e._item.parentSub!==null)n.unshift(e._item.parentSub);else{let r=0,o=e._item.parent._start;for(;o!==e._item&&o!==null;)!o.deleted&&o.countable&&(r+=o.length),o=o.right;n.unshift(r)}e=e._item.parent}return n},Vn=()=>{S3("Invalid access: Add Yjs type to a document before reading data.")},F3=80;let Tk=0;class BZ{constructor(e,n){e.marker=!0,this.p=e,this.index=n,this.timestamp=Tk++}}const $Z=t=>{t.timestamp=Tk++},H3=(t,e,n)=>{t.p.marker=!1,t.p=e,e.marker=!0,t.index=n,t.timestamp=Tk++},FZ=(t,e,n)=>{if(t.length>=F3){const r=t.reduce((o,s)=>o.timestamp<s.timestamp?o:s);return H3(r,e,n),r}else{const r=new BZ(e,n);return t.push(r),r}},hb=(t,e)=>{if(t._start===null||e===0||t._searchMarker===null)return null;const n=t._searchMarker.length===0?null:t._searchMarker.reduce((s,i)=>Sm(e-s.index)<Sm(e-i.index)?s:i);let r=t._start,o=0;for(n!==null&&(r=n.p,o=n.index,$Z(n));r.right!==null&&o<e;){if(!r.deleted&&r.countable){if(e<o+r.length)break;o+=r.length}r=r.right}for(;r.left!==null&&o>e;)r=r.left,!r.deleted&&r.countable&&(o-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(o-=r.length);return n!==null&&Sm(n.index-o)<r.parent.length/F3?(H3(n,r,o),n):FZ(t._searchMarker,r,o)},Eh=(t,e,n)=>{for(let r=t.length-1;r>=0;r--){const o=t[r];if(n>0){let s=o.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(o.index-=s.length);if(s===null||s.marker===!0){t.splice(r,1);continue}o.p=s,s.marker=!0}(e<o.index||n>0&&e===o.index)&&(o.index=Co(e,o.index+n))}},fb=(t,e,n)=>{const r=t,o=e.changedParentTypes;for(;hs(o,t,()=>[]).push(n),t._item!==null;)t=t._item.parent;D3(r._eH,n,e)};class tn{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=HA(),this._dEH=HA(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,n){this.doc=e,this._item=n}_copy(){throw yo()}clone(){throw yo()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,n){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){zA(this._eH,e)}observeDeep(e){zA(this._dEH,e)}unobserve(e){UA(this._eH,e)}unobserveDeep(e){UA(this._dEH,e)}toJSON(){}}const z3=(t,e,n)=>{t.doc??Vn(),e<0&&(e=t._length+e),n<0&&(n=t._length+n);let r=n-e;const o=[];let s=t._start;for(;s!==null&&r>0;){if(s.countable&&!s.deleted){const i=s.content.getContent();if(i.length<=e)e-=i.length;else{for(let a=e;a<i.length&&r>0;a++)o.push(i[a]),r--;e=0}}s=s.right}return o},U3=t=>{t.doc??Vn();const e=[];let n=t._start;for(;n!==null;){if(n.countable&&!n.deleted){const r=n.content.getContent();for(let o=0;o<r.length;o++)e.push(r[o])}n=n.right}return e},W3=(t,e)=>{const n=[];let r=t._start;for(;r!==null;){if(r.countable&&qa(r,e)){const o=r.content.getContent();for(let s=0;s<o.length;s++)n.push(o[s])}r=r.right}return n},Th=(t,e)=>{let n=0,r=t._start;for(t.doc??Vn();r!==null;){if(r.countable&&!r.deleted){const o=r.content.getContent();for(let s=0;s<o.length;s++)e(o[s],n++,t)}r=r.right}},q3=(t,e)=>{const n=[];return Th(t,(r,o)=>{n.push(e(r,o,t))}),n},HZ=t=>{let e=t._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};n=e.content.getContent(),r=0,e=e.right}const o=n[r++];return n.length<=r&&(n=null),{done:!1,value:o}}}},G3=(t,e)=>{t.doc??Vn();const n=hb(t,e);let r=t._start;for(n!==null&&(r=n.p,e-=n.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},Fg=(t,e,n,r)=>{let o=n;const s=t.doc,i=s.clientID,a=s.store,l=n===null?e._start:n.right;let c=[];const u=()=>{c.length>0&&(o=new Qe(Te(i,Dt(a,i)),o,o&&o.lastId,l,l&&l.id,e,null,new El(c)),o.integrate(t,0),c=[])};r.forEach(d=>{if(d===null)c.push(d);else switch(d.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(d);break;default:switch(u(),d.constructor){case Uint8Array:case ArrayBuffer:o=new Qe(Te(i,Dt(a,i)),o,o&&o.lastId,l,l&&l.id,e,null,new Cf(new Uint8Array(d))),o.integrate(t,0);break;case ga:o=new Qe(Te(i,Dt(a,i)),o,o&&o.lastId,l,l&&l.id,e,null,new xf(d)),o.integrate(t,0);break;default:if(d instanceof tn)o=new Qe(Te(i,Dt(a,i)),o,o&&o.lastId,l,l&&l.id,e,null,new Io(d)),o.integrate(t,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},K3=()=>Qi("Length exceeded!"),Y3=(t,e,n,r)=>{if(n>e._length)throw K3();if(n===0)return e._searchMarker&&Eh(e._searchMarker,n,r.length),Fg(t,e,null,r);const o=n,s=hb(e,n);let i=e._start;for(s!==null&&(i=s.p,n-=s.index,n===0&&(i=i.prev,n+=i&&i.countable&&!i.deleted?i.length:0));i!==null;i=i.right)if(!i.deleted&&i.countable){if(n<=i.length){n<i.length&&cr(t,Te(i.id.client,i.id.clock+n));break}n-=i.length}return e._searchMarker&&Eh(e._searchMarker,o,r.length),Fg(t,e,i,r)},zZ=(t,e,n)=>{let o=(e._searchMarker||[]).reduce((s,i)=>i.index>s.index?i:s,{index:0,p:e._start}).p;if(o)for(;o.right;)o=o.right;return Fg(t,e,o,n)},X3=(t,e,n,r)=>{if(r===0)return;const o=n,s=r,i=hb(e,n);let a=e._start;for(i!==null&&(a=i.p,n-=i.index);a!==null&&n>0;a=a.right)!a.deleted&&a.countable&&(n<a.length&&cr(t,Te(a.id.client,a.id.clock+n)),n-=a.length);for(;r>0&&a!==null;)a.deleted||(r<a.length&&cr(t,Te(a.id.client,a.id.clock+r)),a.delete(t),r-=a.length),a=a.right;if(r>0)throw K3();e._searchMarker&&Eh(e._searchMarker,o,-s+r)},Hg=(t,e,n)=>{const r=e._map.get(n);r!==void 0&&r.delete(t)},_k=(t,e,n,r)=>{const o=e._map.get(n)||null,s=t.doc,i=s.clientID;let a;if(r==null)a=new El([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:a=new El([r]);break;case Uint8Array:a=new Cf(r);break;case ga:a=new xf(r);break;default:if(r instanceof tn)a=new Io(r);else throw new Error("Unexpected content type")}new Qe(Te(i,Dt(s.store,i)),o,o&&o.lastId,null,null,e,n,a).integrate(t,0)},Ak=(t,e)=>{t.doc??Vn();const n=t._map.get(e);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},J3=t=>{const e={};return t.doc??Vn(),t._map.forEach((n,r)=>{n.deleted||(e[r]=n.content.getContent()[n.length-1])}),e},Q3=(t,e)=>{t.doc??Vn();const n=t._map.get(e);return n!==void 0&&!n.deleted},UZ=(t,e)=>{const n={};return t._map.forEach((r,o)=>{let s=r;for(;s!==null&&(!e.sv.has(s.id.client)||s.id.clock>=(e.sv.get(s.id.client)||0));)s=s.left;s!==null&&qa(s,e)&&(n[o]=s.content.getContent()[s.length-1])}),n},Bp=t=>(t.doc??Vn(),lZ(t._map.entries(),e=>!e[1].deleted));class WZ extends db{}class Sc extends tn{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const n=new Sc;return n.push(e),n}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Sc}clone(){const e=new Sc;return e.insert(0,this.toArray().map(n=>n instanceof tn?n.clone():n)),e}get length(){return this.doc??Vn(),this._length}_callObserver(e,n){super._callObserver(e,n),fb(this,e,new WZ(this,e))}insert(e,n){this.doc!==null?st(this.doc,r=>{Y3(r,this,e,n)}):this._prelimContent.splice(e,0,...n)}push(e){this.doc!==null?st(this.doc,n=>{zZ(n,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,n=1){this.doc!==null?st(this.doc,r=>{X3(r,this,e,n)}):this._prelimContent.splice(e,n)}get(e){return G3(this,e)}toArray(){return U3(this)}slice(e=0,n=this.length){return z3(this,e,n)}toJSON(){return this.map(e=>e instanceof tn?e.toJSON():e)}map(e){return q3(this,e)}forEach(e){Th(this,e)}[Symbol.iterator](){return HZ(this)}_write(e){e.writeTypeRef(gee)}}const qZ=t=>new Sc;class GZ extends db{constructor(e,n,r){super(e,n),this.keysChanged=r}}class zc extends tn{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,n){super._integrate(e,n),this._prelimContent.forEach((r,o)=>{this.set(o,r)}),this._prelimContent=null}_copy(){return new zc}clone(){const e=new zc;return this.forEach((n,r)=>{e.set(r,n instanceof tn?n.clone():n)}),e}_callObserver(e,n){fb(this,e,new GZ(this,e,n))}toJSON(){this.doc??Vn();const e={};return this._map.forEach((n,r)=>{if(!n.deleted){const o=n.content.getContent()[n.length-1];e[r]=o instanceof tn?o.toJSON():o}}),e}get size(){return[...Bp(this)].length}keys(){return Av(Bp(this),e=>e[0])}values(){return Av(Bp(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return Av(Bp(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??Vn(),this._map.forEach((n,r)=>{n.deleted||e(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?st(this.doc,n=>{Hg(n,this,e)}):this._prelimContent.delete(e)}set(e,n){return this.doc!==null?st(this.doc,r=>{_k(r,this,e,n)}):this._prelimContent.set(e,n),n}get(e){return Ak(this,e)}has(e){return Q3(this,e)}clear(){this.doc!==null?st(this.doc,e=>{this.forEach(function(n,r,o){Hg(e,o,r)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(yee)}}const KZ=t=>new zc,Li=(t,e)=>t===e||typeof t=="object"&&typeof e=="object"&&t&&e&&OQ(t,e);class jw{constructor(e,n,r,o){this.left=e,this.right=n,this.index=r,this.currentAttributes=o}forward(){switch(this.right===null&&Ar(),this.right.content.constructor){case Ut:this.right.deleted||du(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const QA=(t,e,n)=>{for(;e.right!==null&&n>0;){switch(e.right.content.constructor){case Ut:e.right.deleted||du(e.currentAttributes,e.right.content);break;default:e.right.deleted||(n<e.right.length&&cr(t,Te(e.right.id.client,e.right.id.clock+n)),e.index+=e.right.length,n-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},$p=(t,e,n,r)=>{const o=new Map,s=r?hb(e,n):null;if(s){const i=new jw(s.p.left,s.p,s.index,o);return QA(t,i,n-s.index)}else{const i=new jw(null,e._start,0,o);return QA(t,i,n)}},Z3=(t,e,n,r)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===Ut&&Li(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const o=t.doc,s=o.clientID;r.forEach((i,a)=>{const l=n.left,c=n.right,u=new Qe(Te(s,Dt(o.store,s)),l,l&&l.lastId,c,c&&c.id,e,null,new Ut(a,i));u.integrate(t,0),n.right=u,n.forward()})},du=(t,e)=>{const{key:n,value:r}=e;r===null?t.delete(n):t.set(n,r)},eL=(t,e)=>{for(;t.right!==null;){if(!(t.right.deleted||t.right.content.constructor===Ut&&Li(e[t.right.content.key]??null,t.right.content.value)))break;t.forward()}},tL=(t,e,n,r)=>{const o=t.doc,s=o.clientID,i=new Map;for(const a in r){const l=r[a],c=n.currentAttributes.get(a)??null;if(!Li(c,l)){i.set(a,c);const{left:u,right:d}=n;n.right=new Qe(Te(s,Dt(o.store,s)),u,u&&u.lastId,d,d&&d.id,e,null,new Ut(a,l)),n.right.integrate(t,0),n.forward()}}return i},Rv=(t,e,n,r,o)=>{n.currentAttributes.forEach((h,f)=>{o[f]===void 0&&(o[f]=null)});const s=t.doc,i=s.clientID;eL(n,o);const a=tL(t,e,n,o),l=r.constructor===String?new xo(r):r instanceof tn?new Io(r):new Nl(r);let{left:c,right:u,index:d}=n;e._searchMarker&&Eh(e._searchMarker,n.index,l.getLength()),u=new Qe(Te(i,Dt(s.store,i)),c,c&&c.lastId,u,u&&u.id,e,null,l),u.integrate(t,0),n.right=u,n.index=d,n.forward(),Z3(t,e,n,a)},ZA=(t,e,n,r,o)=>{const s=t.doc,i=s.clientID;eL(n,o);const a=tL(t,e,n,o);e:for(;n.right!==null&&(r>0||a.size>0&&(n.right.deleted||n.right.content.constructor===Ut));){if(!n.right.deleted)switch(n.right.content.constructor){case Ut:{const{key:l,value:c}=n.right.content,u=o[l];if(u!==void 0){if(Li(u,c))a.delete(l);else{if(r===0)break e;a.set(l,c)}n.right.delete(t)}else n.currentAttributes.set(l,c);break}default:r<n.right.length&&cr(t,Te(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let l="";for(;r>0;r--)l+=`
`;n.right=new Qe(Te(i,Dt(s.store,i)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,e,null,new xo(l)),n.right.integrate(t,0),n.forward()}Z3(t,e,n,a)},nL=(t,e,n,r,o)=>{let s=e;const i=Gr();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===Ut){const c=s.content;i.set(c.key,c)}s=s.right}let a=0,l=!1;for(;e!==s;){if(n===e&&(l=!0),!e.deleted){const c=e.content;switch(c.constructor){case Ut:{const{key:u,value:d}=c,h=r.get(u)??null;(i.get(u)!==c||h===d)&&(e.delete(t),a++,!l&&(o.get(u)??null)===d&&h!==d&&(h===null?o.delete(u):o.set(u,h))),!l&&!e.deleted&&du(o,c);break}}}e=e.right}return a},YZ=(t,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const n=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===Ut){const r=e.content.key;n.has(r)?e.delete(t):n.add(r)}e=e.left}},XZ=t=>{let e=0;return st(t.doc,n=>{let r=t._start,o=t._start,s=Gr();const i=Iw(s);for(;o;){if(o.deleted===!1)switch(o.content.constructor){case Ut:du(i,o.content);break;default:e+=nL(n,r,o,s,i),s=Iw(i),r=o;break}o=o.right}}),e},JZ=t=>{const e=new Set,n=t.doc;for(const[r,o]of t.afterState.entries()){const s=t.beforeState.get(r)||0;o!==s&&V3(t,n.store.clients.get(r),s,o,i=>{!i.deleted&&i.content.constructor===Ut&&i.constructor!==zr&&e.add(i.parent)})}st(n,r=>{Zi(t,t.deleteSet,o=>{if(o instanceof zr||!o.parent._hasFormatting||e.has(o.parent))return;const s=o.parent;o.content.constructor===Ut?e.add(s):YZ(r,o)});for(const o of e)XZ(o)})},eI=(t,e,n)=>{const r=n,o=Iw(e.currentAttributes),s=e.right;for(;n>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case Io:case Nl:case xo:n<e.right.length&&cr(t,Te(e.right.id.client,e.right.id.clock+n)),n-=e.right.length,e.right.delete(t);break}e.forward()}s&&nL(t,s,e.right,o,e.currentAttributes);const i=(e.left||e.right).parent;return i._searchMarker&&Eh(i._searchMarker,e.index,-r+n),e};class QZ extends db{constructor(e,n,r){super(e,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(o=>{o===null?this.childListChanged=!0:this.keysChanged.add(o)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,n=[];st(e,r=>{const o=new Map,s=new Map;let i=this.target._start,a=null;const l={};let c="",u=0,d=0;const h=()=>{if(a!==null){let f=null;switch(a){case"delete":d>0&&(f={delete:d}),d=0;break;case"insert":(typeof c=="object"||c.length>0)&&(f={insert:c},o.size>0&&(f.attributes={},o.forEach((p,y)=>{p!==null&&(f.attributes[y]=p)}))),c="";break;case"retain":u>0&&(f={retain:u},DQ(l)||(f.attributes=RQ({},l))),u=0;break}f&&n.push(f),a=null}};for(;i!==null;){switch(i.content.constructor){case Io:case Nl:this.adds(i)?this.deletes(i)||(h(),a="insert",c=i.content.getContent()[0],h()):this.deletes(i)?(a!=="delete"&&(h(),a="delete"),d+=1):i.deleted||(a!=="retain"&&(h(),a="retain"),u+=1);break;case xo:this.adds(i)?this.deletes(i)||(a!=="insert"&&(h(),a="insert"),c+=i.content.str):this.deletes(i)?(a!=="delete"&&(h(),a="delete"),d+=i.length):i.deleted||(a!=="retain"&&(h(),a="retain"),u+=i.length);break;case Ut:{const{key:f,value:p}=i.content;if(this.adds(i)){if(!this.deletes(i)){const y=o.get(f)??null;Li(y,p)?p!==null&&i.delete(r):(a==="retain"&&h(),Li(p,s.get(f)??null)?delete l[f]:l[f]=p)}}else if(this.deletes(i)){s.set(f,p);const y=o.get(f)??null;Li(y,p)||(a==="retain"&&h(),l[f]=y)}else if(!i.deleted){s.set(f,p);const y=l[f];y!==void 0&&(Li(y,p)?y!==null&&i.delete(r):(a==="retain"&&h(),p===null?delete l[f]:l[f]=p))}i.deleted||(a==="insert"&&h(),du(o,i.content));break}}i=i.right}for(h();n.length>0;){const f=n[n.length-1];if(f.retain!==void 0&&f.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class ea extends tn{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??Vn(),this._length}_integrate(e,n){super._integrate(e,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new ea}clone(){const e=new ea;return e.applyDelta(this.toDelta()),e}_callObserver(e,n){super._callObserver(e,n);const r=new QZ(this,e,n);fb(this,e,r),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??Vn();let e="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===xo&&(e+=n.content.str),n=n.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:n=!0}={}){this.doc!==null?st(this.doc,r=>{const o=new jw(null,this._start,0,new Map);for(let s=0;s<e.length;s++){const i=e[s];if(i.insert!==void 0){const a=!n&&typeof i.insert=="string"&&s===e.length-1&&o.right===null&&i.insert.slice(-1)===`
`?i.insert.slice(0,-1):i.insert;(typeof a!="string"||a.length>0)&&Rv(r,this,o,a,i.attributes||{})}else i.retain!==void 0?ZA(r,this,o,i.retain,i.attributes||{}):i.delete!==void 0&&eI(r,o,i.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,n,r){this.doc??Vn();const o=[],s=new Map,i=this.doc;let a="",l=this._start;function c(){if(a.length>0){const d={};let h=!1;s.forEach((p,y)=>{h=!0,d[y]=p});const f={insert:a};h&&(f.attributes=d),o.push(f),a=""}}const u=()=>{for(;l!==null;){if(qa(l,e)||n!==void 0&&qa(l,n))switch(l.content.constructor){case xo:{const d=s.get("ychange");e!==void 0&&!qa(l,e)?(d===void 0||d.user!==l.id.client||d.type!=="removed")&&(c(),s.set("ychange",r?r("removed",l.id):{type:"removed"})):n!==void 0&&!qa(l,n)?(d===void 0||d.user!==l.id.client||d.type!=="added")&&(c(),s.set("ychange",r?r("added",l.id):{type:"added"})):d!==void 0&&(c(),s.delete("ychange")),a+=l.content.str;break}case Io:case Nl:{c();const d={insert:l.content.getContent()[0]};if(s.size>0){const h={};d.attributes=h,s.forEach((f,p)=>{h[p]=f})}o.push(d);break}case Ut:qa(l,e)&&(c(),du(s,l.content));break}l=l.right}c()};return e||n?st(i,d=>{e&&Lw(d,e),n&&Lw(d,n),u()},"cleanup"):u(),o}insert(e,n,r){if(n.length<=0)return;const o=this.doc;o!==null?st(o,s=>{const i=$p(s,this,e,!r);r||(r={},i.currentAttributes.forEach((a,l)=>{r[l]=a})),Rv(s,this,i,n,r)}):this._pending.push(()=>this.insert(e,n,r))}insertEmbed(e,n,r){const o=this.doc;o!==null?st(o,s=>{const i=$p(s,this,e,!r);Rv(s,this,i,n,r||{})}):this._pending.push(()=>this.insertEmbed(e,n,r||{}))}delete(e,n){if(n===0)return;const r=this.doc;r!==null?st(r,o=>{eI(o,$p(o,this,e,!0),n)}):this._pending.push(()=>this.delete(e,n))}format(e,n,r){if(n===0)return;const o=this.doc;o!==null?st(o,s=>{const i=$p(s,this,e,!1);i.right!==null&&ZA(s,this,i,n,r)}):this._pending.push(()=>this.format(e,n,r))}removeAttribute(e){this.doc!==null?st(this.doc,n=>{Hg(n,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,n){this.doc!==null?st(this.doc,r=>{_k(r,this,e,n)}):this._pending.push(()=>this.setAttribute(e,n))}getAttribute(e){return Ak(this,e)}getAttributes(){return J3(this)}_write(e){e.writeTypeRef(bee)}}const ZZ=t=>new ea;class Pv{constructor(e,n=()=>!0){this._filter=n,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??Vn()}[Symbol.iterator](){return this}next(){let e=this._currentNode,n=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(n)))do if(n=e.content.type,!e.deleted&&(n.constructor===Kn||n.constructor===Sl)&&n._start!==null)e=n._start;else for(;e!==null;){const r=e.next;if(r!==null){e=r;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class Sl extends tn{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Sl}clone(){const e=new Sl;return e.insert(0,this.toArray().map(n=>n instanceof tn?n.clone():n)),e}get length(){return this.doc??Vn(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new Pv(this,e)}querySelector(e){e=e.toUpperCase();const r=new Pv(this,o=>o.nodeName&&o.nodeName.toUpperCase()===e).next();return r.done?null:r.value}querySelectorAll(e){return e=e.toUpperCase(),xl(new Pv(this,n=>n.nodeName&&n.nodeName.toUpperCase()===e))}_callObserver(e,n){fb(this,e,new nee(this,n,e))}toString(){return q3(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,n={},r){const o=e.createDocumentFragment();return r!==void 0&&r._createAssociation(o,this),Th(this,s=>{o.insertBefore(s.toDOM(e,n,r),null)}),o}insert(e,n){this.doc!==null?st(this.doc,r=>{Y3(r,this,e,n)}):this._prelimContent.splice(e,0,...n)}insertAfter(e,n){if(this.doc!==null)st(this.doc,r=>{const o=e&&e instanceof tn?e._item:e;Fg(r,this,o,n)});else{const r=this._prelimContent,o=e===null?0:r.findIndex(s=>s===e)+1;if(o===0&&e!==null)throw Qi("Reference item not found");r.splice(o,0,...n)}}delete(e,n=1){this.doc!==null?st(this.doc,r=>{X3(r,this,e,n)}):this._prelimContent.splice(e,n)}toArray(){return U3(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return G3(this,e)}slice(e=0,n=this.length){return z3(this,e,n)}forEach(e){Th(this,e)}_write(e){e.writeTypeRef(wee)}}const eee=t=>new Sl;class Kn extends Sl{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,n){super._integrate(e,n),this._prelimAttrs.forEach((r,o)=>{this.setAttribute(o,r)}),this._prelimAttrs=null}_copy(){return new Kn(this.nodeName)}clone(){const e=new Kn(this.nodeName),n=this.getAttributes();return PQ(n,(r,o)=>{typeof r=="string"&&e.setAttribute(o,r)}),e.insert(0,this.toArray().map(r=>r instanceof tn?r.clone():r)),e}toString(){const e=this.getAttributes(),n=[],r=[];for(const a in e)r.push(a);r.sort();const o=r.length;for(let a=0;a<o;a++){const l=r[a];n.push(l+'="'+e[l]+'"')}const s=this.nodeName.toLocaleLowerCase(),i=n.length>0?" "+n.join(" "):"";return`<${s}${i}>${super.toString()}</${s}>`}removeAttribute(e){this.doc!==null?st(this.doc,n=>{Hg(n,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,n){this.doc!==null?st(this.doc,r=>{_k(r,this,e,n)}):this._prelimAttrs.set(e,n)}getAttribute(e){return Ak(this,e)}hasAttribute(e){return Q3(this,e)}getAttributes(e){return e?UZ(this,e):J3(this)}toDOM(e=document,n={},r){const o=e.createElement(this.nodeName),s=this.getAttributes();for(const i in s){const a=s[i];typeof a=="string"&&o.setAttribute(i,a)}return Th(this,i=>{o.appendChild(i.toDOM(e,n,r))}),r!==void 0&&r._createAssociation(o,this),o}_write(e){e.writeTypeRef(vee),e.writeKey(this.nodeName)}}const tee=t=>new Kn(t.readKey());class nee extends db{constructor(e,n,r){super(e,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(o=>{o===null?this.childListChanged=!0:this.attributesChanged.add(o)})}}class zg extends zc{constructor(e){super(),this.hookName=e}_copy(){return new zg(this.hookName)}clone(){const e=new zg(this.hookName);return this.forEach((n,r)=>{e.set(r,n)}),e}toDOM(e=document,n={},r){const o=n[this.hookName];let s;return o!==void 0?s=o.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(s,this),s}_write(e){e.writeTypeRef(Cee),e.writeKey(this.hookName)}}const ree=t=>new zg(t.readKey());class Er extends ea{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new Er}clone(){const e=new Er;return e.applyDelta(this.toDelta()),e}toDOM(e=document,n,r){const o=e.createTextNode(this.toString());return r!==void 0&&r._createAssociation(o,this),o}toString(){return this.toDelta().map(e=>{const n=[];for(const o in e.attributes){const s=[];for(const i in e.attributes[o])s.push({key:i,value:e.attributes[o][i]});s.sort((i,a)=>i.key<a.key?-1:1),n.push({nodeName:o,attrs:s})}n.sort((o,s)=>o.nodeName<s.nodeName?-1:1);let r="";for(let o=0;o<n.length;o++){const s=n[o];r+=`<${s.nodeName}`;for(let i=0;i<s.attrs.length;i++){const a=s.attrs[i];r+=` ${a.key}="${a.value}"`}r+=">"}r+=e.insert;for(let o=n.length-1;o>=0;o--)r+=`</${n[o].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(xee)}}const oee=t=>new Er;class Ik{constructor(e,n){this.id=e,this.length=n}get deleted(){throw yo()}mergeWith(e){return!1}write(e,n,r){throw yo()}integrate(e,n){throw yo()}}const see=0;class zr extends Ik{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,n){n>0&&(this.id.clock+=n,this.length-=n),L3(e.doc.store,this)}write(e,n){e.writeInfo(see),e.writeLen(this.length-n)}getMissing(e,n){return null}}class Cf{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Cf(this.content)}splice(e){throw yo()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeBuf(this.content)}getRef(){return 3}}const iee=t=>new Cf(t.readBuf());class _h{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new _h(this.len)}splice(e){const n=new _h(this.len-e);return this.len=e,n}mergeWith(e){return this.len+=e.len,!0}integrate(e,n){Ch(e.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(e){}gc(e){}write(e,n){e.writeLen(this.len-n)}getRef(){return 1}}const aee=t=>new _h(t.readLen()),rL=(t,e)=>new ga({guid:t,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class xf{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const n={};this.opts=n,e.gc||(n.gc=!1),e.autoLoad&&(n.autoLoad=!0),e.meta!==null&&(n.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new xf(rL(this.doc.guid,this.opts))}splice(e){throw yo()}mergeWith(e){return!1}integrate(e,n){this.doc._item=n,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,n){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const lee=t=>new xf(rL(t.readString(),t.readAny()));class Nl{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Nl(this.embed)}splice(e){throw yo()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeJSON(this.embed)}getRef(){return 5}}const cee=t=>new Nl(t.readJSON());class Ut{constructor(e,n){this.key=e,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Ut(this.key,this.value)}splice(e){throw yo()}mergeWith(e){return!1}integrate(e,n){const r=n.parent;r._searchMarker=null,r._hasFormatting=!0}delete(e){}gc(e){}write(e,n){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const uee=t=>new Ut(t.readKey(),t.readJSON());class Ug{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Ug(this.arr)}splice(e){const n=new Ug(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const r=this.arr.length;e.writeLen(r-n);for(let o=n;o<r;o++){const s=this.arr[o];e.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}}const dee=t=>{const e=t.readLen(),n=[];for(let r=0;r<e;r++){const o=t.readString();o==="undefined"?n.push(void 0):n.push(JSON.parse(o))}return new Ug(n)},hee=jg("node_env")==="development";class El{constructor(e){this.arr=e,hee&&g3(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new El(this.arr)}splice(e){const n=new El(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const r=this.arr.length;e.writeLen(r-n);for(let o=n;o<r;o++){const s=this.arr[o];e.writeAny(s)}}getRef(){return 8}}const fee=t=>{const e=t.readLen(),n=[];for(let r=0;r<e;r++)n.push(t.readAny());return new El(n)};class xo{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new xo(this.str)}splice(e){const n=new xo(this.str.slice(e));this.str=this.str.slice(0,e);const r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"ï¿½",n.str="ï¿½"+n.str.slice(1)),n}mergeWith(e){return this.str+=e.str,!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const pee=t=>new xo(t.readString()),mee=[qZ,KZ,ZZ,tee,eee,ree,oee],gee=0,yee=1,bee=2,vee=3,wee=4,Cee=5,xee=6;class Io{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new Io(this.type._copy())}splice(e){throw yo()}mergeWith(e){return!1}integrate(e,n){this.type._integrate(e.doc,n)}delete(e){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(e.beforeState.get(n.id.client)||0)&&e._mergeStructs.push(n):n.delete(e),n=n.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(e.beforeState.get(r.id.client)||0)&&e._mergeStructs.push(r):r.delete(e)}),e.changed.delete(this.type)}gc(e){let n=this.type._start;for(;n!==null;)n.gc(e,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(e,!0),r=r.left}),this.type._map=new Map}write(e,n){this.type._write(e)}getRef(){return 7}}const kee=t=>new Io(mee[t.readTypeRef()](t)),Bw=(t,e)=>{let n=e,r=0,o;do r>0&&(n=Te(n.client,n.clock+r)),o=kc(t,n),r=n.clock-o.id.clock,n=o.redone;while(n!==null&&o instanceof Qe);return{item:o,diff:r}},Mk=(t,e)=>{for(;t!==null&&t.keep!==e;)t.keep=e,t=t.parent._item},Wg=(t,e,n)=>{const{client:r,clock:o}=e.id,s=new Qe(Te(r,o+n),e,Te(r,o+n-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(n));return e.deleted&&s.markDeleted(),e.keep&&(s.keep=!0),e.redone!==null&&(s.redone=Te(e.redone.client,e.redone.clock+n)),e.right=s,s.right!==null&&(s.right.left=s),t._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),e.length=n,s},tI=(t,e)=>UJ(t,n=>cu(n.deletions,e)),oL=(t,e,n,r,o,s)=>{const i=t.doc,a=i.store,l=i.clientID,c=e.redone;if(c!==null)return cr(t,c);let u=e.parent._item,d=null,h;if(u!==null&&u.deleted===!0){if(u.redone===null&&(!n.has(u)||oL(t,u,n,r,o,s)===null))return null;for(;u.redone!==null;)u=cr(t,u.redone)}const f=u===null?e.parent:u.content.type;if(e.parentSub===null){for(d=e.left,h=e;d!==null;){let w=d;for(;w!==null&&w.parent._item!==u;)w=w.redone===null?null:cr(t,w.redone);if(w!==null&&w.parent._item===u){d=w;break}d=d.left}for(;h!==null;){let w=h;for(;w!==null&&w.parent._item!==u;)w=w.redone===null?null:cr(t,w.redone);if(w!==null&&w.parent._item===u){h=w;break}h=h.right}}else if(h=null,e.right&&!o){for(d=e;d!==null&&d.right!==null&&(d.right.redone||cu(r,d.right.id)||tI(s.undoStack,d.right.id)||tI(s.redoStack,d.right.id));)for(d=d.right;d.redone;)d=cr(t,d.redone);if(d&&d.right!==null)return null}else d=f._map.get(e.parentSub)||null;const p=Dt(a,l),y=Te(l,p),b=new Qe(y,d,d&&d.lastId,h,h&&h.id,f,e.parentSub,e.content.copy());return e.redone=y,Mk(b,!0),b.integrate(t,0),b};class Qe extends Ik{constructor(e,n,r,o,s,i,a,l){super(e,l.getLength()),this.origin=r,this.left=n,this.right=o,this.rightOrigin=s,this.parent=i,this.parentSub=a,this.redone=null,this.content=l,this.info=this.content.isCountable()?IA:0}set marker(e){(this.info&Ev)>0!==e&&(this.info^=Ev)}get marker(){return(this.info&Ev)>0}get keep(){return(this.info&AA)>0}set keep(e){this.keep!==e&&(this.info^=AA)}get countable(){return(this.info&IA)>0}get deleted(){return(this.info&Sv)>0}set deleted(e){this.deleted!==e&&(this.info^=Sv)}markDeleted(){this.info|=Sv}getMissing(e,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Dt(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Dt(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===xc&&this.id.client!==this.parent.client&&this.parent.clock>=Dt(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=qA(e,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=cr(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===zr||this.right&&this.right.constructor===zr)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Qe?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===Qe&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===xc){const r=kc(n,this.parent);r.constructor===zr?this.parent=null:this.parent=r.content.type}return null}integrate(e,n){if(n>0&&(this.id.clock+=n,this.left=qA(e,e.doc.store,Te(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,o;if(r!==null)o=r.right;else if(this.parentSub!==null)for(o=this.parent._map.get(this.parentSub)||null;o!==null&&o.left!==null;)o=o.left;else o=this.parent._start;const s=new Set,i=new Set;for(;o!==null&&o!==this.right;){if(i.add(o),s.add(o),uc(this.origin,o.origin)){if(o.id.client<this.id.client)r=o,s.clear();else if(uc(this.rightOrigin,o.rightOrigin))break}else if(o.origin!==null&&i.has(kc(e.doc.store,o.origin)))s.has(kc(e.doc.store,o.origin))||(r=o,s.clear());else break;o=o.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),L3(e.doc.store,this),this.content.integrate(e,this),KA(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new zr(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Te(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&uc(e.origin,this.lastId)&&this.right===e&&uc(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===e&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),Ch(e.deleteSet,this.id.client,this.id.clock,this.length),KA(e,n,this.parentSub),this.content.delete(e)}}gc(e,n){if(!this.deleted)throw Ar();this.content.gc(e),n?_Z(e,this,new zr(this.id,this.length)):this.content=new _h(this.length)}write(e,n){const r=n>0?Te(this.id.client,this.id.clock+n-1):this.origin,o=this.rightOrigin,s=this.parentSub,i=this.content.getRef()&ab|(r===null?0:Xn)|(o===null?0:$s)|(s===null?0:bh);if(e.writeInfo(i),r!==null&&e.writeLeftID(r),o!==null&&e.writeRightID(o),r===null&&o===null){const a=this.parent;if(a._item!==void 0){const l=a._item;if(l===null){const c=xh(a);e.writeParentInfo(!0),e.writeString(c)}else e.writeParentInfo(!1),e.writeLeftID(l.id)}else a.constructor===String?(e.writeParentInfo(!0),e.writeString(a)):a.constructor===xc?(e.writeParentInfo(!1),e.writeLeftID(a)):Ar();s!==null&&e.writeString(s)}this.content.write(e,n)}}const sL=(t,e)=>See[e&ab](t),See=[()=>{Ar()},aee,dee,iee,pee,cee,uee,kee,fee,lee,()=>{Ar()}],Eee=10;class Ur extends Ik{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,n){Ar()}write(e,n){e.writeInfo(Eee),Ue(e.restEncoder,this.length-n)}getMissing(e,n){return null}}const iL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},aL="__ $YJS$ __";iL[aL]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");iL[aL]=!0;const Tee=()=>{let t=!0;return(e,n)=>{if(t){t=!1;try{e()}finally{t=!0}}else n!==void 0&&n()}},_ee=/[\uD800-\uDBFF]/,Aee=/[\uDC00-\uDFFF]/,Iee=(t,e)=>{let n=0,r=0;for(;n<t.length&&n<e.length&&t[n]===e[n];)n++;for(n>0&&_ee.test(t[n-1])&&n--;r+n<t.length&&r+n<e.length&&t[t.length-r-1]===e[e.length-r-1];)r++;return r>0&&Aee.test(t[t.length-r])&&r--,{index:n,remove:t.length-n-r,insert:e.slice(n,e.length-r)}},Mee=Iee,Ke=new We("y-sync"),Fo=new We("y-undo"),yd=new We("yjs-cursor"),Ho=(t,e)=>t>>>e|t<<32-e,Ree=t=>Ho(t,2)^Ho(t,13)^Ho(t,22),Pee=t=>Ho(t,6)^Ho(t,11)^Ho(t,25),Dee=t=>Ho(t,7)^Ho(t,18)^t>>>3,Nee=t=>Ho(t,17)^Ho(t,19)^t>>>10,Oee=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Lee=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);class Vee{constructor(){const e=new ArrayBuffer(320);this._H=new Uint32Array(e,0,8),this._H.set(Lee),this._W=new Uint32Array(e,64,64)}_updateHash(){const e=this._H,n=this._W;for(let d=16;d<64;d++)n[d]=Nee(n[d-2])+n[d-7]+Dee(n[d-15])+n[d-16];let r=e[0],o=e[1],s=e[2],i=e[3],a=e[4],l=e[5],c=e[6],u=e[7];for(let d=0,h,f;d<64;d++)h=u+Pee(a)+(a&l^~a&c)+Oee[d]+n[d]>>>0,f=Ree(r)+(r&o^r&s^o&s)>>>0,u=c,c=l,l=a,a=i+h>>>0,i=s,s=o,o=r,r=h+f>>>0;e[0]+=r,e[1]+=o,e[2]+=s,e[3]+=i,e[4]+=a,e[5]+=l,e[6]+=c,e[7]+=u}digest(e){let n=0;for(;n+56<=e.length;){let i=0;for(;i<16&&n+3<e.length;i++)this._W[i]=e[n++]<<24|e[n++]<<16|e[n++]<<8|e[n++];if(n%64!==0){for(this._W.fill(0,i,16);n<e.length;)this._W[i]|=e[n]<<(3-n%4)*8,n++;this._W[i]|=Xn<<(3-n%4)*8}this._updateHash()}const r=n%64!==0;this._W.fill(0,0,16);let o=0;for(;n<e.length;o++)for(let i=3;i>=0&&n<e.length;i--)this._W[o]|=e[n++]<<i*8;r||(this._W[o-(n%4===0?0:1)]|=Xn<<(3-n%4)*8),this._W[14]=e.byteLength/WJ,this._W[15]=e.byteLength*8,this._updateHash();const s=new Uint8Array(32);for(let i=0;i<this._H.length;i++)for(let a=0;a<4;a++)s[i*4+a]=this._H[i]>>>(3-a)*8;return s}}const jee=t=>new Vee().digest(t),Bee=t=>{for(let n=6;n<t.length;n++)t[n%6]=t[n%6]^t[n];return t.slice(0,6)},$ee=t=>WQ(Bee(jee(GQ(t)))),qg=(t,e)=>e===void 0?!t.deleted:e.sv.has(t.id.client)&&e.sv.get(t.id.client)>t.id.clock&&!cu(e.ds,t.id),Fee=[{light:"#ecd44433",dark:"#ecd444"}],Hee=(t,e,n)=>{if(!t.has(n)){if(t.size<e.length){const r=Cl();t.forEach(o=>r.add(o)),e=e.filter(o=>!r.has(o))}t.set(n,SQ(e))}return t.get(n)},zee=(t,{colors:e=Fee,colorMapping:n=new Map,permanentUserData:r=null,onFirstRender:o=()=>{},mapping:s}={})=>{let i=!1;const a=new Wee(t,s),l=new Re({props:{editable:c=>{const u=Ke.getState(c);return u.snapshot==null&&u.prevSnapshot==null}},key:Ke,state:{init:(c,u)=>({type:t,doc:t.doc,binding:a,snapshot:null,prevSnapshot:null,isChangeOrigin:!1,isUndoRedoOperation:!1,addToHistory:!0,colors:e,colorMapping:n,permanentUserData:r}),apply:(c,u)=>{const d=c.getMeta(Ke);if(d!==void 0){u=Object.assign({},u);for(const h in d)u[h]=d[h]}return u.addToHistory=c.getMeta("addToHistory")!==!1,u.isChangeOrigin=d!==void 0&&!!d.isChangeOrigin,u.isUndoRedoOperation=d!==void 0&&!!d.isChangeOrigin&&!!d.isUndoRedoOperation,a.prosemirrorView!==null&&d!==void 0&&(d.snapshot!=null||d.prevSnapshot!=null)&&gk(0,()=>{a.prosemirrorView!=null&&(d.restore==null?a._renderSnapshot(d.snapshot,d.prevSnapshot,u):(a._renderSnapshot(d.snapshot,d.snapshot,u),delete u.restore,delete u.snapshot,delete u.prevSnapshot,a.mux(()=>{a._prosemirrorChanged(a.prosemirrorView.state.doc)})))}),u}},view:c=>(a.initView(c),s==null&&a._forceRerender(),o(),{update:()=>{const u=l.getState(c.state);if(u.snapshot==null&&u.prevSnapshot==null&&(i||c.state.doc.content.findDiffStart(c.state.doc.type.createAndFill().content)!==null)){if(i=!0,u.addToHistory===!1&&!u.isChangeOrigin){const d=Fo.getState(c.state),h=d&&d.undoManager;h&&h.stopCapturing()}a.mux(()=>{u.doc.transact(d=>{d.meta.set("addToHistory",u.addToHistory),a._prosemirrorChanged(c.state.doc)},Ke)})}},destroy:()=>{a.destroy()}})});return l},Uee=(t,e,n)=>{if(e!==null&&e.anchor!==null&&e.head!==null)if(e.type==="all")t.setSelection(new hr(t.doc));else if(e.type==="node"){const r=ul(n.doc,n.type,e.anchor,n.mapping);t.setSelection(se.create(t.doc,r))}else{const r=ul(n.doc,n.type,e.anchor,n.mapping),o=ul(n.doc,n.type,e.head,n.mapping);r!==null&&o!==null&&t.setSelection(ee.between(t.doc.resolve(r),t.doc.resolve(o)))}},Gg=(t,e)=>({type:e.selection.jsonID,anchor:Ih(e.selection.anchor,t.type,t.mapping),head:Ih(e.selection.head,t.type,t.mapping)});class Wee{constructor(e,n=new Map){this.type=e,this.prosemirrorView=null,this.mux=Tee(),this.mapping=n,this.isOMark=new Map,this._observeFunction=this._typeChanged.bind(this),this.doc=e.doc,this.beforeTransactionSelection=null,this.beforeAllTransactions=()=>{this.beforeTransactionSelection===null&&this.prosemirrorView!=null&&(this.beforeTransactionSelection=Gg(this,this.prosemirrorView.state))},this.afterAllTransactions=()=>{this.beforeTransactionSelection=null},this._domSelectionInView=null}get _tr(){return this.prosemirrorView.state.tr.setMeta("addToHistory",!1)}_isLocalCursorInView(){return this.prosemirrorView.hasFocus()?(b3&&this._domSelectionInView===null&&(gk(0,()=>{this._domSelectionInView=null}),this._domSelectionInView=this._isDomSelectionInView()),this._domSelectionInView):!1}_isDomSelectionInView(){const e=this.prosemirrorView._root.getSelection();if(e==null||e.anchorNode==null)return!1;const n=this.prosemirrorView._root.createRange();n.setStart(e.anchorNode,e.anchorOffset),n.setEnd(e.focusNode,e.focusOffset),n.getClientRects().length===0&&n.startContainer&&n.collapsed&&n.selectNodeContents(n.startContainer);const o=n.getBoundingClientRect(),s=YQ.documentElement;return o.bottom>=0&&o.right>=0&&o.left<=(window.innerWidth||s.clientWidth||0)&&o.top<=(window.innerHeight||s.clientHeight||0)}renderSnapshot(e,n){n||(n=N3(_3(),new Map)),this.prosemirrorView.dispatch(this._tr.setMeta(Ke,{snapshot:e,prevSnapshot:n}))}unrenderSnapshot(){this.mapping.clear(),this.mux(()=>{const e=this.type.toArray().map(r=>Am(r,this.prosemirrorView.state.schema,this)).filter(r=>r!==null),n=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new G(B.from(e),0,0));n.setMeta(Ke,{snapshot:null,prevSnapshot:null}),this.prosemirrorView.dispatch(n)})}_forceRerender(){this.mapping.clear(),this.mux(()=>{const e=this.beforeTransactionSelection!==null?null:this.prosemirrorView.state.selection,n=this.type.toArray().map(o=>Am(o,this.prosemirrorView.state.schema,this)).filter(o=>o!==null),r=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new G(B.from(n),0,0));if(e){const o=Bs(Co(e.anchor,0),r.doc.content.size),s=Bs(Co(e.head,0),r.doc.content.size);r.setSelection(ee.create(r.doc,o,s))}this.prosemirrorView.dispatch(r.setMeta(Ke,{isChangeOrigin:!0,binding:this}))})}_renderSnapshot(e,n,r){let o=this.doc,s=this.type;if(e||(e=Mv(this.doc)),e instanceof Uint8Array||n instanceof Uint8Array)if((!(e instanceof Uint8Array)||!(n instanceof Uint8Array))&&Ar(),o=new ga({gc:!1}),Bg(o,n),n=Mv(o),Bg(o,e),e=Mv(o),s._item===null){const i=Array.from(this.doc.share.keys()).find(a=>this.doc.share.get(a)===this.type);s=o.getXmlFragment(i)}else{const i=o.store.clients.get(s._item.id.client)??[],a=Jr(i,s._item.id.clock);s=i[a].content.type}this.mapping.clear(),this.mux(()=>{o.transact(i=>{const a=r.permanentUserData;a&&a.dss.forEach(d=>{Zi(i,d,h=>{})});const l=(d,h)=>{const f=d==="added"?a.getUserByClientId(h.client):a.getUserByDeletedId(h);return{user:f,type:d,color:Hee(r.colorMapping,r.colors,f)}},c=W3(s,new xk(n.ds,e.sv)).map(d=>!d._item.deleted||qg(d._item,e)||qg(d._item,n)?Am(d,this.prosemirrorView.state.schema,{mapping:new Map,isOMark:new Map},e,n,l):null).filter(d=>d!==null),u=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new G(B.from(c),0,0));this.prosemirrorView.dispatch(u.setMeta(Ke,{isChangeOrigin:!0}))},Ke)})}_typeChanged(e,n){if(this.prosemirrorView==null)return;const r=Ke.getState(this.prosemirrorView.state);if(e.length===0||r.snapshot!=null||r.prevSnapshot!=null){this.renderSnapshot(r.snapshot,r.prevSnapshot);return}this.mux(()=>{const o=(a,l)=>this.mapping.delete(l);Zi(n,n.deleteSet,a=>{if(a.constructor===Qe){const l=a.content.type;l&&this.mapping.delete(l)}}),n.changed.forEach(o),n.changedParentTypes.forEach(o);const s=this.type.toArray().map(a=>lL(a,this.prosemirrorView.state.schema,this)).filter(a=>a!==null);let i=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new G(B.from(s),0,0));Uee(i,this.beforeTransactionSelection,this),i=i.setMeta(Ke,{isChangeOrigin:!0,isUndoRedoOperation:n.origin instanceof B3}),this.beforeTransactionSelection!==null&&this._isLocalCursorInView()&&i.scrollIntoView(),this.prosemirrorView.dispatch(i)})}_prosemirrorChanged(e){this.doc.transact(()=>{Fw(this.doc,this.type,e,this),this.beforeTransactionSelection=Gg(this,this.prosemirrorView.state)},Ke)}initView(e){this.prosemirrorView!=null&&this.destroy(),this.prosemirrorView=e,this.doc.on("beforeAllTransactions",this.beforeAllTransactions),this.doc.on("afterAllTransactions",this.afterAllTransactions),this.type.observeDeep(this._observeFunction)}destroy(){this.prosemirrorView!=null&&(this.prosemirrorView=null,this.type.unobserveDeep(this._observeFunction),this.doc.off("beforeAllTransactions",this.beforeAllTransactions),this.doc.off("afterAllTransactions",this.afterAllTransactions))}}const lL=(t,e,n,r,o,s)=>{const i=n.mapping.get(t);if(i===void 0){if(t instanceof Kn)return Am(t,e,n,r,o,s);throw yo()}return i},Am=(t,e,n,r,o,s)=>{const i=[],a=l=>{var c,u;if(l instanceof Kn){const d=lL(l,e,n,r,o,s);d!==null&&i.push(d)}else{const d=(u=(c=l._item.right)==null?void 0:c.content)==null?void 0:u.type;d instanceof ea&&!d._item.deleted&&d._item.id.client===d.doc.clientID&&(l.applyDelta([{retain:l.length},...d.toDelta()]),d.doc.transact(f=>{d._item.delete(f)}));const h=qee(l,e,n,r,o,s);h!==null&&h.forEach(f=>{f!==null&&i.push(f)})}};r===void 0||o===void 0?t.toArray().forEach(a):W3(t,new xk(o.ds,r.sv)).forEach(a);try{const l=t.getAttributes(r);r!==void 0&&(qg(t._item,r)?qg(t._item,o)||(l.ychange=s?s("added",t._item.id):{type:"added"}):l.ychange=s?s("removed",t._item.id):{type:"removed"});const c=e.node(t.nodeName,l,i);return n.mapping.set(t,c),c}catch{return t.doc.transact(c=>{t._item.delete(c)},Ke),n.mapping.delete(t),null}},qee=(t,e,n,r,o,s)=>{const i=[],a=t.toDelta(r,o,s);try{for(let l=0;l<a.length;l++){const c=a[l];i.push(e.text(c.insert,Qee(c.attributes,e)))}}catch{return t.doc.transact(c=>{t._item.delete(c)},Ke),null}return i},Gee=(t,e)=>{const n=new Er,r=t.map(o=>({insert:o.text,attributes:dL(o.marks,e)}));return n.applyDelta(r),e.mapping.set(n,t),n},Kee=(t,e)=>{const n=new Kn(t.type.name);for(const r in t.attrs){const o=t.attrs[r];o!==null&&r!=="ychange"&&n.setAttribute(r,o)}return n.insert(0,pb(t).map(r=>$w(r,e))),e.mapping.set(n,t),n},$w=(t,e)=>t instanceof Array?Gee(t,e):Kee(t,e),nI=t=>typeof t=="object"&&t!==null,Rk=(t,e)=>{const n=Object.keys(t).filter(o=>t[o]!==null);let r=n.length===(e==null?0:Object.keys(e).filter(o=>e[o]!==null).length);for(let o=0;o<n.length&&r;o++){const s=n[o],i=t[s],a=e[s];r=s==="ychange"||i===a||nI(i)&&nI(a)&&Rk(i,a)}return r},pb=t=>{const e=t.content.content,n=[];for(let r=0;r<e.length;r++){const o=e[r];if(o.isText){const s=[];for(let i=e[r];r<e.length&&i.isText;i=e[++r])s.push(i);r--,n.push(s)}else n.push(o)}return n},cL=(t,e)=>{const n=t.toDelta();return n.length===e.length&&n.every((r,o)=>r.insert===e[o].text&&p3(r.attributes||{}).length===e[o].marks.length&&m3(r.attributes,(s,i)=>{var c;const a=uL(i),l=e[o].marks;return Rk(s,(c=l.find(u=>u.type.name===a))==null?void 0:c.attrs)}))},Ah=(t,e)=>{if(t instanceof Kn&&!(e instanceof Array)&&Hw(t,e)){const n=pb(e);return t._length===n.length&&Rk(t.getAttributes(),e.attrs)&&t.toArray().every((r,o)=>Ah(r,n[o]))}return t instanceof Er&&e instanceof Array&&cL(t,e)},Kg=(t,e)=>t===e||t instanceof Array&&e instanceof Array&&t.length===e.length&&t.every((n,r)=>e[r]===n),rI=(t,e,n)=>{const r=t.toArray(),o=pb(e),s=o.length,i=r.length,a=Bs(i,s);let l=0,c=0,u=!1;for(;l<a;l++){const d=r[l],h=o[l];if(Kg(n.mapping.get(d),h))u=!0;else if(!Ah(d,h))break}for(;l+c<a;c++){const d=r[i-c-1],h=o[s-c-1];if(Kg(n.mapping.get(d),h))u=!0;else if(!Ah(d,h))break}return{equalityFactor:l+c,foundMappedChild:u}},Yee=t=>{let e="",n=t._start;const r={};for(;n!==null;)n.deleted||(n.countable&&n.content instanceof xo?e+=n.content.str:n.content instanceof Ut&&(r[n.content.key]=null)),n=n.right;return{str:e,nAttrs:r}},Xee=(t,e,n)=>{n.mapping.set(t,e);const{nAttrs:r,str:o}=Yee(t),s=e.map(c=>({insert:c.text,attributes:Object.assign({},r,dL(c.marks,n))})),{insert:i,remove:a,index:l}=Mee(o,s.map(c=>c.insert).join(""));t.delete(l,a),t.insert(l,i),t.applyDelta(s.map(c=>({retain:c.insert.length,attributes:c.attributes})))},Jee=/(.*)(--[a-zA-Z0-9+/=]{8})$/,uL=t=>{var e;return((e=Jee.exec(t))==null?void 0:e[1])??t},Qee=(t,e)=>{const n=[];for(const r in t)n.push(e.mark(uL(r),t[r]));return n},dL=(t,e)=>{const n={};return t.forEach(r=>{if(r.type.name!=="ychange"){const o=hs(e.isOMark,r.type,()=>!r.type.excludes(r.type));n[o?`${r.type.name}--${$ee(r.toJSON())}`:r.type.name]=r.attrs}}),n},Fw=(t,e,n,r)=>{if(e instanceof Kn&&e.nodeName!==n.type.name)throw new Error("node name mismatch!");if(r.mapping.set(e,n),e instanceof Kn){const d=e.getAttributes(),h=n.attrs;for(const f in h)h[f]!==null?d[f]!==h[f]&&f!=="ychange"&&e.setAttribute(f,h[f]):e.removeAttribute(f);for(const f in d)h[f]===void 0&&e.removeAttribute(f)}const o=pb(n),s=o.length,i=e.toArray(),a=i.length,l=Bs(s,a);let c=0,u=0;for(;c<l;c++){const d=i[c],h=o[c];if(!Kg(r.mapping.get(d),h))if(Ah(d,h))r.mapping.set(d,h);else break}for(;u+c+1<l;u++){const d=i[a-u-1],h=o[s-u-1];if(!Kg(r.mapping.get(d),h))if(Ah(d,h))r.mapping.set(d,h);else break}t.transact(()=>{for(;a-c-u>0&&s-c-u>0;){const h=i[c],f=o[c],p=i[a-u-1],y=o[s-u-1];if(h instanceof Er&&f instanceof Array)cL(h,f)||Xee(h,f,r),c+=1;else{let b=h instanceof Kn&&Hw(h,f),w=p instanceof Kn&&Hw(p,y);if(b&&w){const k=rI(h,f,r),x=rI(p,y,r);k.foundMappedChild&&!x.foundMappedChild?w=!1:!k.foundMappedChild&&x.foundMappedChild||k.equalityFactor<x.equalityFactor?b=!1:w=!1}b?(Fw(t,h,f,r),c+=1):w?(Fw(t,p,y,r),u+=1):(r.mapping.delete(e.get(c)),e.delete(c,1),e.insert(c,[$w(f,r)]),c+=1)}}const d=a-c-u;if(a===1&&s===0&&i[0]instanceof Er?(r.mapping.delete(i[0]),i[0].delete(0,i[0].length)):d>0&&(e.slice(c,c+d).forEach(h=>r.mapping.delete(h)),e.delete(c,d)),c+u<s){const h=[];for(let f=c;f<s-u;f++)h.push($w(o[f],r));e.insert(c,h)}},Ke)},Hw=(t,e)=>!(e instanceof Array)&&t.nodeName===e.type.name;let Bd=null;const Zee=()=>{const t=Bd;Bd=null,t.forEach((e,n)=>{const r=n.state.tr,o=Ke.getState(n.state);o&&o.binding&&!o.binding.isDestroyed&&(e.forEach((s,i)=>{r.setMeta(i,s)}),n.dispatch(r))})},ete=(t,e,n)=>{Bd||(Bd=new Map,gk(0,Zee)),hs(Bd,t,Gr).set(e,n)},Ih=(t,e,n)=>{if(t===0)return Iv(e,0,-1);let r=e._first===null?null:e._first.content.type;for(;r!==null&&e!==r;){if(r instanceof Er){if(r._length>=t)return Iv(r,t,-1);if(t-=r._length,r._item!==null&&r._item.next!==null)r=r._item.next.content.type;else{do r=r._item===null?null:r._item.parent,t--;while(r!==e&&r!==null&&r._item!==null&&r._item.next===null);r!==null&&r!==e&&(r=r._item===null?null:r._item.next.content.type)}}else{const o=(n.get(r)||{nodeSize:0}).nodeSize;if(r._first!==null&&t<o)r=r._first.content.type,t--;else{if(t===1&&r._length===0&&o>1)return new Sh(r._item===null?null:r._item.id,r._item===null?xh(r):null,null);if(t-=o,r._item!==null&&r._item.next!==null)r=r._item.next.content.type;else{if(t===0)return r=r._item===null?r:r._item.parent,new Sh(r._item===null?null:r._item.id,r._item===null?xh(r):null,null);do r=r._item.parent,t--;while(r!==e&&r._item.next===null);r!==e&&(r=r._item.next.content.type)}}}if(r===null)throw Ar();if(t===0&&r.constructor!==Er&&r!==e)return tte(r._item.parent,r._item)}return Iv(e,e._length,-1)},tte=(t,e)=>{let n=null,r=null;return t._item===null?r=xh(t):n=Te(t._item.id.client,t._item.id.clock),new Sh(n,r,e.id)},ul=(t,e,n,r)=>{const o=EZ(n,t);if(o===null||o.type!==e&&!kh(e,o.type._item))return null;let s=o.type,i=0;if(s.constructor===Er)i=o.index;else if(s._item===null||!s._item.deleted){let a=s._first,l=0;for(;l<s._length&&l<o.index&&a!==null;){if(!a.deleted){const c=a.content.type;l++,c instanceof Er?i+=c._length:i+=r.get(c).nodeSize}a=a.right}i+=1}for(;s!==e&&s._item!==null;){const a=s._item.parent;if(a._item===null||!a._item.deleted){i+=1;let l=a._first;for(;l!==null;){const c=l.content.type;if(c===s)break;l.deleted||(c instanceof Er?i+=c._length:i+=r.get(c).nodeSize),l=l.right}}s=a}return i-1},nte=(t,e,n)=>t!==e,rte=t=>{const e=document.createElement("span");e.classList.add("ProseMirror-yjs-cursor"),e.setAttribute("style",`border-color: ${t.color}`);const n=document.createElement("div");n.setAttribute("style",`background-color: ${t.color}`),n.insertBefore(document.createTextNode(t.name),null);const r=document.createTextNode("â "),o=document.createTextNode("â ");return e.insertBefore(r,null),e.insertBefore(n,null),e.insertBefore(o,null),e},hL=t=>({style:`background-color: ${t.color}70`,class:"ProseMirror-yjs-selection"}),ote=/^#[0-9a-fA-F]{6}$/,oI=(t,e,n,r,o)=>{const s=Ke.getState(t),i=s.doc,a=[];return s.snapshot!=null||s.prevSnapshot!=null||s.binding.mapping.size===0?Oe.create(t.doc,[]):(e.getStates().forEach((l,c)=>{if(n(i.clientID,c,l)&&l.cursor!=null){const u=l.user||{};u.color==null?u.color="#ffa500":ote.test(u.color)||console.warn("A user uses an unsupported color format",u),u.name==null&&(u.name=`User: ${c}`);let d=ul(i,s.type,jd(l.cursor.anchor),s.binding.mapping),h=ul(i,s.type,jd(l.cursor.head),s.binding.mapping);if(d!==null&&h!==null){const f=Co(t.doc.content.size-1,0);d=Bs(d,f),h=Bs(h,f),a.push(et.widget(h,()=>r(u,c),{key:c+"",side:10}));const p=Bs(d,h),y=Co(d,h);a.push(et.inline(p,y,o(u,c),{inclusiveEnd:!0,inclusiveStart:!1}))}}}),Oe.create(t.doc,a))},ste=(t,{awarenessStateFilter:e=nte,cursorBuilder:n=rte,selectionBuilder:r=hL,getSelection:o=i=>i.selection}={},s="cursor")=>new Re({key:yd,state:{init(i,a){return oI(a,t,e,n,r)},apply(i,a,l,c){const u=Ke.getState(c),d=i.getMeta(yd);return u&&u.isChangeOrigin||d&&d.awarenessUpdated?oI(c,t,e,n,r):a.map(i.mapping,i.doc)}},props:{decorations:i=>yd.getState(i)},view:i=>{const a=()=>{i.docView&&ete(i,yd,{awarenessUpdated:!0})},l=()=>{const c=Ke.getState(i.state),u=t.getLocalState()||{};if(i.hasFocus()){const d=o(i.state),h=Ih(d.anchor,c.type,c.binding.mapping),f=Ih(d.head,c.type,c.binding.mapping);(u.cursor==null||!WA(jd(u.cursor.anchor),h)||!WA(jd(u.cursor.head),f))&&t.setLocalStateField(s,{anchor:h,head:f})}else u.cursor!=null&&ul(c.doc,c.type,jd(u.cursor.anchor),c.binding.mapping)!==null&&t.setLocalStateField(s,null)};return t.on("change",a),i.dom.addEventListener("focusin",l),i.dom.addEventListener("focusout",l),{update:l,destroy:()=>{i.dom.removeEventListener("focusin",l),i.dom.removeEventListener("focusout",l),t.off("change",a),t.setLocalStateField(s,null)}}}}),ite=t=>{var e,n;return((n=(e=Fo.getState(t))==null?void 0:e.undoManager)==null?void 0:n.undo())!=null},ate=t=>{var e,n;return((n=(e=Fo.getState(t))==null?void 0:e.undoManager)==null?void 0:n.redo())!=null},lte=(t,e)=>{var n,r;return e==null?(r=(n=Fo.getState(t))==null?void 0:n.undoManager)==null?void 0:r.canUndo():ite(t)},cte=(t,e)=>{var n,r;return e==null?(r=(n=Fo.getState(t))==null?void 0:n.undoManager)==null?void 0:r.canRedo():ate(t)},ute=new Set(["paragraph"]),dte=(t,e)=>!(t instanceof Qe)||!(t.content instanceof Io)||!(t.content.type instanceof ea||t.content.type instanceof Kn&&e.has(t.content.type.nodeName))||t.content.type._length===0,hte=({protectedNodes:t=ute,trackedOrigins:e=[],undoManager:n=null}={})=>new Re({key:Fo,state:{init:(r,o)=>{const s=Ke.getState(o),i=n||new B3(s.type,{trackedOrigins:new Set([Ke].concat(e)),deleteFilter:a=>dte(a,t),captureTransaction:a=>a.meta.get("addToHistory")!==!1});return{undoManager:i,prevSel:null,hasUndoOps:i.undoStack.length>0,hasRedoOps:i.redoStack.length>0}},apply:(r,o,s,i)=>{const a=Ke.getState(i).binding,l=o.undoManager,c=l.undoStack.length>0,u=l.redoStack.length>0;return a?{undoManager:l,prevSel:Gg(a,s),hasUndoOps:c,hasRedoOps:u}:c!==o.hasUndoOps||u!==o.hasRedoOps?Object.assign({},o,{hasUndoOps:l.undoStack.length>0,hasRedoOps:l.redoStack.length>0}):o}},view:r=>{const o=Ke.getState(r.state),s=Fo.getState(r.state).undoManager;return s.on("stack-item-added",({stackItem:i})=>{const a=o.binding;a&&i.meta.set(a,Fo.getState(r.state).prevSel)}),s.on("stack-item-popped",({stackItem:i})=>{const a=o.binding;a&&(a.beforeTransactionSelection=i.meta.get(a)||a.beforeTransactionSelection)}),{destroy:()=>{s.destroy()}}}});function fte(t={}){return new Re({view(e){return new pte(e,t)}})}class pte{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(o=>{let s=i=>{this[o](i)};return e.dom.addEventListener(o,s),{name:o,handler:s}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,o=this.editorView.dom,s=o.getBoundingClientRect(),i=s.width/o.offsetWidth,a=s.height/o.offsetHeight;if(n){let d=e.nodeBefore,h=e.nodeAfter;if(d||h){let f=this.editorView.nodeDOM(this.cursorPos-(d?d.nodeSize:0));if(f){let p=f.getBoundingClientRect(),y=d?p.bottom:p.top;d&&h&&(y=(y+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let b=this.width/2*a;r={left:p.left,right:p.right,top:y-b,bottom:y+b}}}}if(!r){let d=this.editorView.coordsAtPos(this.cursorPos),h=this.width/2*i;r={left:d.left-h,right:d.left+h,top:d.top,bottom:d.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let c,u;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,u=-pageYOffset;else{let d=l.getBoundingClientRect(),h=d.width/l.offsetWidth,f=d.height/l.offsetHeight;c=d.left-l.scrollLeft*h,u=d.top-l.scrollTop*f}this.element.style.left=(r.left-c)/i+"px",this.element.style.top=(r.top-u)/a+"px",this.element.style.width=(r.right-r.left)/i+"px",this.element.style.height=(r.bottom-r.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),o=r&&r.type.spec.disableDropCursor,s=typeof o=="function"?o(this.editorView,n,e):o;if(n&&!s){let i=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=g4(this.editorView.state.doc,i,this.editorView.dragging.slice);a!=null&&(i=a)}this.setCursor(i),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const mte={slash_menu:{heading:{title:"Heading 1",subtext:"Top-level heading",aliases:["h","heading1","h1"],group:"Headings"},heading_2:{title:"Heading 2",subtext:"Key section heading",aliases:["h2","heading2","subheading"],group:"Headings"},heading_3:{title:"Heading 3",subtext:"Subsection and group heading",aliases:["h3","heading3","subheading"],group:"Headings"},quote:{title:"Quote",subtext:"Quote or excerpt",aliases:["quotation","blockquote","bq"],group:"Basic blocks"},numbered_list:{title:"Numbered List",subtext:"List with ordered items",aliases:["ol","li","list","numberedlist","numbered list"],group:"Basic blocks"},bullet_list:{title:"Bullet List",subtext:"List with unordered items",aliases:["ul","li","list","bulletlist","bullet list"],group:"Basic blocks"},check_list:{title:"Check List",subtext:"List with checkboxes",aliases:["ul","li","list","checklist","check list","checked list","checkbox"],group:"Basic blocks"},paragraph:{title:"Paragraph",subtext:"The body of your document",aliases:["p","paragraph"],group:"Basic blocks"},code_block:{title:"Code Block",subtext:"Code block with syntax highlighting",aliases:["code","pre"],group:"Basic blocks"},page_break:{title:"Page Break",subtext:"Page separator",aliases:["page","break","separator"],group:"Basic blocks"},table:{title:"Table",subtext:"Table with editable cells",aliases:["table"],group:"Advanced"},image:{title:"Image",subtext:"Resizable image with caption",aliases:["image","imageUpload","upload","img","picture","media","url"],group:"Media"},video:{title:"Video",subtext:"Resizable video with caption",aliases:["video","videoUpload","upload","mp4","film","media","url"],group:"Media"},audio:{title:"Audio",subtext:"Embedded audio with caption",aliases:["audio","audioUpload","upload","mp3","sound","media","url"],group:"Media"},file:{title:"File",subtext:"Embedded file",aliases:["file","upload","embed","media","url"],group:"Media"},emoji:{title:"Emoji",subtext:"Search for and insert an emoji",aliases:["emoji","emote","emotion","face"],group:"Others"}},placeholders:{default:"Enter text or type '/' for commands",heading:"Heading",bulletListItem:"List",numberedListItem:"List",checkListItem:"List",emptyDocument:void 0,new_comment:"Write a comment...",edit_comment:"Edit comment...",comment_reply:"Add comment..."},file_blocks:{image:{add_button_text:"Add image"},video:{add_button_text:"Add video"},audio:{add_button_text:"Add audio"},file:{add_button_text:"Add file"}},side_menu:{add_block_label:"Add block",drag_handle_label:"Open block menu"},drag_handle:{delete_menuitem:"Delete",colors_menuitem:"Colors",header_row_menuitem:"Header row",header_column_menuitem:"Header column"},table_handle:{delete_column_menuitem:"Delete column",delete_row_menuitem:"Delete row",add_left_menuitem:"Add column left",add_right_menuitem:"Add column right",add_above_menuitem:"Add row above",add_below_menuitem:"Add row below",split_cell_menuitem:"Split cell",merge_cells_menuitem:"Merge cells",background_color_menuitem:"Background color"},suggestion_menu:{no_items_title:"No items found"},color_picker:{text_title:"Text",background_title:"Background",colors:{default:"Default",gray:"Gray",brown:"Brown",red:"Red",orange:"Orange",yellow:"Yellow",green:"Green",blue:"Blue",purple:"Purple",pink:"Pink"}},formatting_toolbar:{bold:{tooltip:"Bold",secondary_tooltip:"Mod+B"},italic:{tooltip:"Italic",secondary_tooltip:"Mod+I"},underline:{tooltip:"Underline",secondary_tooltip:"Mod+U"},strike:{tooltip:"Strike",secondary_tooltip:"Mod+Shift+S"},code:{tooltip:"Code",secondary_tooltip:""},colors:{tooltip:"Colors"},link:{tooltip:"Create link",secondary_tooltip:"Mod+K"},file_caption:{tooltip:"Edit caption",input_placeholder:"Edit caption"},file_replace:{tooltip:{image:"Replace image",video:"Replace video",audio:"Replace audio",file:"Replace file"}},file_rename:{tooltip:{image:"Rename image",video:"Rename video",audio:"Rename audio",file:"Rename file"},input_placeholder:{image:"Rename image",video:"Rename video",audio:"Rename audio",file:"Rename file"}},file_download:{tooltip:{image:"Download image",video:"Download video",audio:"Download audio",file:"Download file"}},file_delete:{tooltip:{image:"Delete image",video:"Delete video",audio:"Delete audio",file:"Delete file"}},file_preview_toggle:{tooltip:"Toggle preview"},nest:{tooltip:"Nest block",secondary_tooltip:"Tab"},unnest:{tooltip:"Unnest block",secondary_tooltip:"Shift+Tab"},align_left:{tooltip:"Align text left"},align_center:{tooltip:"Align text center"},align_right:{tooltip:"Align text right"},align_justify:{tooltip:"Justify text"},table_cell_merge:{tooltip:"Merge cells"},comment:{tooltip:"Add comment"}},file_panel:{upload:{title:"Upload",file_placeholder:{image:"Upload image",video:"Upload video",audio:"Upload audio",file:"Upload file"},upload_error:"Error: Upload failed"},embed:{title:"Embed",embed_button:{image:"Embed image",video:"Embed video",audio:"Embed audio",file:"Embed file"},url_placeholder:"Enter URL"}},link_toolbar:{delete:{tooltip:"Remove link"},edit:{text:"Edit link",tooltip:"Edit"},open:{tooltip:"Open in new tab"},form:{title_placeholder:"Edit title",url_placeholder:"Edit URL"}},comments:{actions:{add_reaction:"Add reaction",resolve:"Resolve",edit_comment:"Edit comment",delete_comment:"Delete comment",more_actions:"More actions"},reactions:{reacted_by:"Reacted by"},sidebar:{marked_as_resolved:"Marked as resolved",more_replies:t=>`${t} more replies`}},generic:{ctrl_shortcut:"Ctrl"}};var gte=Object.defineProperty,yte=(t,e,n)=>e in t?gte(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,L=(t,e,n)=>yte(t,typeof e!="symbol"?e+"":e,n);function bte(t,e=JSON.stringify){const n={};return t.filter(r=>{const o=e(r);return Object.prototype.hasOwnProperty.call(n,o)?!1:n[o]=!0})}function vte(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return bte(e)}const mb=at.create({name:"uniqueID",priority:1e4,addOptions(){return{attributeName:"id",types:[],setIdAttribute:!1,generateID:()=>{if(typeof window<"u"&&window.__TEST_OPTIONS){const t=window.__TEST_OPTIONS;return t.mockID===void 0?t.mockID=0:t.mockID++,t.mockID.toString()}return jO()},filterTransaction:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{[this.options.attributeName]:{default:null,parseHTML:t=>t.getAttribute(`data-${this.options.attributeName}`),renderHTML:t=>{const e={[`data-${this.options.attributeName}`]:t[this.options.attributeName]};return this.options.setIdAttribute?{...e,id:t[this.options.attributeName]}:e}}}}]},addProseMirrorPlugins(){let t=null,e=!1;return[new Re({key:new We("uniqueID"),appendTransaction:(n,r,o)=>{const s=n.some(f=>f.docChanged)&&!r.doc.eq(o.doc),i=this.options.filterTransaction&&n.some(f=>{let p,y;return!(!((y=(p=this.options).filterTransaction)===null||y===void 0)&&y.call(p,f))});if(!s||i)return;const{tr:a}=o,{types:l,attributeName:c,generateID:u}=this.options,d=Gx(r.doc,n),{mapping:h}=d;if(Kx(d).forEach(({newRange:f})=>{const p=lg(o.doc,f,w=>l.includes(w.type.name)),y=p.map(({node:w})=>w.attrs[c]).filter(w=>w!==null),b=vte(y);p.forEach(({node:w,pos:k})=>{let x;const A=(x=a.doc.nodeAt(k))===null||x===void 0?void 0:x.attrs[c];if(A===null){const M=r.doc.type.createAndFill().content;if(r.doc.content.findDiffStart(M)===null){const T=JSON.parse(JSON.stringify(o.doc.toJSON()));if(T.content[0].content[0].attrs.id="initialBlockId",JSON.stringify(T.content)===JSON.stringify(M.toJSON())){a.setNodeMarkup(k,void 0,{...w.attrs,[c]:"initialBlockId"});return}}a.setNodeMarkup(k,void 0,{...w.attrs,[c]:u()});return}const{deleted:I}=h.invert().mapResult(k);I&&b.includes(A)&&a.setNodeMarkup(k,void 0,{...w.attrs,[c]:u()})})}),!!a.steps.length)return a},view(n){const r=o=>{let s;t=!((s=n.dom.parentElement)===null||s===void 0)&&s.contains(o.target)?n.dom.parentElement:null};return window.addEventListener("dragstart",r),{destroy(){window.removeEventListener("dragstart",r)}}},props:{handleDOMEvents:{drop:(n,r)=>{let o;return t!==n.dom.parentElement||((o=r.dataTransfer)===null||o===void 0?void 0:o.effectAllowed)==="copy"?e=!0:e=!1,t=null,!1},paste:()=>(e=!0,!1)},transformPasted:n=>{if(!e)return n;const{types:r,attributeName:o}=this.options,s=i=>{const a=[];return i.forEach(l=>{if(l.isText){a.push(l);return}if(!r.includes(l.type.name)){a.push(l.copy(s(l.content)));return}const c=l.type.create({...l.attrs,[o]:null},s(l.content),l.marks);a.push(c)}),B.from(a)};return e=!1,new G(s(n.content),n.openStart,n.openEnd)}}})]}});function sI(t){return t.type==="link"}function fL(t){return typeof t!="string"&&t.type==="link"}function Tl(t){return typeof t!="string"&&t.type==="text"}function ta(t){var e,n,r,o,s;return na(t)?{...t}:Mh(t)?{type:"tableCell",content:[].concat(t.content),props:{backgroundColor:((e=t.props)==null?void 0:e.backgroundColor)??"default",textColor:((n=t.props)==null?void 0:n.textColor)??"default",textAlignment:((r=t.props)==null?void 0:r.textAlignment)??"left",colspan:((o=t.props)==null?void 0:o.colspan)??1,rowspan:((s=t.props)==null?void 0:s.rowspan)??1}}:{type:"tableCell",content:[].concat(t),props:{backgroundColor:"default",textColor:"default",textAlignment:"left",colspan:1,rowspan:1}}}function Mh(t){return t!=null&&typeof t!="string"&&!Array.isArray(t)&&t.type==="tableCell"}function na(t){return Mh(t)&&t.props!==void 0&&t.content!==void 0}function _l(t){return na(t)?t.props.colspan??1:1}function Rh(t){return na(t)?t.props.rowspan??1:1}class Zo extends Error{constructor(e){super(`Unreachable case: ${e}`)}}function Ae(t,e=!0){const{"data-test":n,...r}=t;if(Object.keys(r).length>0&&e)throw new Error("Object must be empty "+JSON.stringify(t))}const wte=()=>typeof navigator<"u"&&(/Mac/.test(navigator.platform)||/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent));function jr(t,e="Ctrl"){return wte()?t.replace("Mod","âŒ˜"):t.replace("Mod",e)}function dt(...t){return t.filter(e=>e).join(" ")}const zw=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent);function es(t,e,n,r){const o=document.createElement("div");o.className=dt("bn-block-content",n.class),o.setAttribute("data-content-type",t);for(const[i,a]of Object.entries(n))i!=="class"&&o.setAttribute(i,a);const s=document.createElement(e);s.className=dt("bn-inline-content",r.class);for(const[i,a]of Object.entries(r))i!=="class"&&s.setAttribute(i,a);return o.appendChild(s),{dom:o,contentDOM:s}}const iI=(t,e)=>{let n=Ol(t,e.pmSchema);n.type.name==="blockContainer"&&(n=n.firstChild);const r=e.pmSchema.nodes[n.type.name].spec.toDOM;if(r===void 0)throw new Error("This block has no default HTML serialization as its corresponding TipTap node doesn't implement `renderHTML`.");const o=r(n);if(typeof o!="object"||!("dom"in o))throw new Error("Cannot use this block's default HTML serialization as its corresponding TipTap node's `renderHTML` function does not return an object with the `dom` property.");return o},zt={backgroundColor:{default:"default"},textColor:{default:"default"},textAlignment:{default:"left",values:["left","center","right","justify"]}},Pk=["backgroundColor","textColor"];function Yg(t){return"data-"+t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function aI(t){const e=t.split("/");return!e.length||e[e.length-1]===""?t:e[e.length-1]}function kf(t){const e={};return Object.entries(t).filter(([n,r])=>!Pk.includes(n)).forEach(([n,r])=>{e[n]={default:r.default,keepOnSplit:!0,parseHTML:o=>{const s=o.getAttribute(Yg(n));if(s===null)return null;if(r.default===void 0&&r.type==="boolean"||r.default!==void 0&&typeof r.default=="boolean")return s==="true"?!0:s==="false"?!1:null;if(r.default===void 0&&r.type==="number"||r.default!==void 0&&typeof r.default=="number"){const i=parseFloat(s);return!Number.isNaN(i)&&Number.isFinite(i)?i:null}return s},renderHTML:o=>o[n]!==r.default?{[Yg(n)]:o[n]}:{}}}),e}function pL(t,e,n,r){if(typeof t=="boolean")throw new Error("Cannot find node position as getPos is a boolean, not a function.");const o=t(),s=n.state.doc.resolve(o).node().attrs.id;if(!s)throw new Error("Block doesn't have id");const i=e.getBlock(s);if(i.type!==r)throw new Error("Block type does not match");return i}function bd(t,e,n,r,o=!1,s){const i=document.createElement("div");if(s!==void 0)for(const[a,l]of Object.entries(s))a!=="class"&&i.setAttribute(a,l);i.className=dt("bn-block-content",(s==null?void 0:s.class)||""),i.setAttribute("data-content-type",e);for(const[a,l]of Object.entries(n)){const c=r[a].default;!Pk.includes(a)&&l!==c&&i.setAttribute(Yg(a),l)}return o&&i.setAttribute("data-file-block",""),i.appendChild(t.dom),t.contentDOM!==void 0&&(t.contentDOM.className=dt("bn-inline-content",t.contentDOM.className)),{...t,dom:i}}function Qr(t){return cs.create(t)}function Dk(t,e){return{config:t,implementation:e}}function Zs(t,e,n){return Dk({type:t.name,content:t.config.content==="inline*"?"inline":t.config.content==="tableRow+"?"table":"none",propSchema:e},{node:t,requiredExtensions:n,toInternalHTML:iI,toExternalHTML:iI})}function mL(t){return Object.fromEntries(Object.entries(t).map(([e,n])=>[e,n.config]))}function gL(t,e){t.stopEvent=n=>(n.type==="mousedown"&&setTimeout(()=>{e.view.dom.blur()},10),!0)}function yL(t,e){const n=[{tag:"[data-content-type="+t.type+"]",contentElement:".bn-inline-content"}];return e&&n.push({tag:"*",getAttrs(r){if(typeof r=="string")return!1;const o=e==null?void 0:e(r);return o===void 0?!1:o}}),n}function Sf(t,e){const n=Qr({name:t.type,content:t.content==="inline"?"inline*":"",group:"blockContent",selectable:t.isSelectable??!0,isolating:!0,addAttributes(){return kf(t.propSchema)},parseHTML(){return yL(t,e.parse)},renderHTML({HTMLAttributes:r}){const o=document.createElement("div");return bd({dom:o,contentDOM:t.content==="inline"?o:void 0},t.type,{},t.propSchema,t.isFileBlock,r)},addNodeView(){return({getPos:r})=>{var o;const s=this.options.editor,i=pL(r,s,this.editor,t.type),a=((o=this.options.domAttributes)==null?void 0:o.blockContent)||{},l=e.render(i,s),c=bd(l,i.type,i.props,t.propSchema,a);return t.isSelectable===!1&&gL(c,this.editor),c}}});if(n.name!==t.type)throw new Error("Node name does not match block type. This is a bug in BlockNote.");return Dk(t,{node:n,toInternalHTML:(r,o)=>{var s;const i=((s=n.options.domAttributes)==null?void 0:s.blockContent)||{},a=e.render(r,o);return bd(a,r.type,r.props,t.propSchema,t.isFileBlock,i)},toExternalHTML:(r,o)=>{var s,i;const a=((s=n.options.domAttributes)==null?void 0:s.blockContent)||{};let l=(i=e.toExternalHTML)==null?void 0:i.call(e,r,o);return l===void 0&&(l=e.render(r,o)),bd(l,r.type,r.props,t.propSchema,a)}})}function zs(t,e){const n=t.resolve(e);if(n.nodeAfter&&n.nodeAfter.type.isInGroup("bnBlock"))return{posBeforeNode:n.pos,node:n.nodeAfter};let r=n.depth,o=n.node(r);for(;r>0;){if(o.type.isInGroup("bnBlock"))return{posBeforeNode:n.before(r),node:o};r--,o=n.node(r)}const s=[];t.descendants((a,l)=>{a.type.isInGroup("bnBlock")&&s.push(l)}),console.warn(`Position ${e} is not within a blockContainer node.`);const i=t.resolve(s.find(a=>a>=e)||s[s.length-1]);return{posBeforeNode:i.pos,node:i.nodeAfter}}function Nk(t,e){if(!t.type.isInGroup("bnBlock"))throw new Error(`Attempted to get bnBlock node at position but found node of different type ${t.type.name}`);const n=t,r=e,o=r+n.nodeSize,s={node:n,beforePos:r,afterPos:o};if(n.type.name==="blockContainer"){let i,a;if(n.forEach((l,c)=>{if(l.type.spec.group==="blockContent"){const u=l,d=r+c+1,h=d+l.nodeSize;i={node:u,beforePos:d,afterPos:h}}else if(l.type.name==="blockGroup"){const u=l,d=r+c+1,h=d+l.nodeSize;a={node:u,beforePos:d,afterPos:h}}}),!i)throw new Error(`blockContainer node does not contain a blockContent node in its children: ${n}`);return{isBlockContainer:!0,bnBlock:s,blockContent:i,childContainer:a,blockNoteType:i.node.type.name}}else{if(!s.node.type.isInGroup("childContainer"))throw new Error(`bnBlock node is not in the childContainer group: ${s.node}`);return{isBlockContainer:!1,bnBlock:s,childContainer:s,blockNoteType:s.node.type.name}}}function ra(t){return Nk(t.node,t.posBeforeNode)}function Ef(t){if(!t.nodeAfter)throw new Error(`Attempted to get blockContainer node at position ${t.pos} but a node at this position does not exist`);return Nk(t.nodeAfter,t.pos)}function ct(t){const e=zs(t.doc,t.selection.anchor);return ra(e)}function gb(t){const e=zs(t.doc,t.selection.anchor);return ra(e)}function rn(t){return"doc"in t?t.doc.type.schema:t.type.schema}function bL(t){return t.cached.blockNoteEditor}function Tf(t){return bL(t).schema}function Ok(t){return Tf(t).blockSchema}function Lk(t){return Tf(t).inlineContentSchema}function hu(t){return Tf(t).styleSchema}function Vk(t){return bL(t).blockCache}function vL(t,e,n){var r,o;const s={type:"tableContent",columnWidths:[],headerRows:void 0,headerCols:void 0,rows:[]},i=[];t.content.forEach((a,l,c)=>{const u={cells:[]};c===0&&a.content.forEach(d=>{let h=d.attrs.colwidth;h==null&&(h=new Array(d.attrs.colspan??1).fill(void 0)),s.columnWidths.push(...h)}),u.cells=a.content.content.map((d,h)=>(i[c]||(i[c]=[]),i[c][h]=d.type.name==="tableHeader",{type:"tableCell",content:d.content.content.map(f=>yb(f,e,n)).reduce((f,p)=>{if(!f.length)return p;const y=f[f.length-1],b=p[0];return b&&Tl(y)&&Tl(b)&&JSON.stringify(y.styles)===JSON.stringify(b.styles)?(y.text+=`
`+b.text,f.push(...p.slice(1)),f):(f.push(...p),f)},[]),props:{colspan:d.attrs.colspan,rowspan:d.attrs.rowspan,backgroundColor:d.attrs.backgroundColor,textColor:d.attrs.textColor,textAlignment:d.attrs.textAlignment}})),s.rows.push(u)});for(let a=0;a<i.length;a++)(r=i[a])!=null&&r.every(l=>l)&&(s.headerRows=(s.headerRows??0)+1);for(let a=0;a<((o=i[0])==null?void 0:o.length);a++)i!=null&&i.every(l=>l[a])&&(s.headerCols=(s.headerCols??0)+1);return s}function yb(t,e,n){const r=[];let o;return t.content.forEach(s=>{if(s.type.name==="hardBreak"){if(o)if(Tl(o))o.text+=`
`;else if(sI(o))o.content[o.content.length-1].text+=`
`;else throw new Error("unexpected");else o={type:"text",text:`
`,styles:{}};return}if(s.type.name!=="link"&&s.type.name!=="text"){if(!e[s.type.name]){console.warn("unrecognized inline content type",s.type.name);return}o&&(r.push(o),o=void 0),r.push(Cte(s,e,n));return}const i={};let a;for(const l of s.marks)if(l.type.name==="link")a=l;else{const c=n[l.type.name];if(!c){if(l.type.spec.blocknoteIgnore)continue;throw new Error(`style ${l.type.name} not found in styleSchema`)}if(c.propSchema==="boolean")i[c.type]=!0;else if(c.propSchema==="string")i[c.type]=l.attrs.stringValue;else throw new Zo(c.propSchema)}o?Tl(o)?a?(r.push(o),o={type:"link",href:a.attrs.href,content:[{type:"text",text:s.textContent,styles:i}]}):JSON.stringify(o.styles)===JSON.stringify(i)?o.text+=s.textContent:(r.push(o),o={type:"text",text:s.textContent,styles:i}):sI(o)&&(a?o.href===a.attrs.href?JSON.stringify(o.content[o.content.length-1].styles)===JSON.stringify(i)?o.content[o.content.length-1].text+=s.textContent:o.content.push({type:"text",text:s.textContent,styles:i}):(r.push(o),o={type:"link",href:a.attrs.href,content:[{type:"text",text:s.textContent,styles:i}]}):(r.push(o),o={type:"text",text:s.textContent,styles:i})):a?o={type:"link",href:a.attrs.href,content:[{type:"text",text:s.textContent,styles:i}]}:o={type:"text",text:s.textContent,styles:i}}),o&&r.push(o),r}function Cte(t,e,n){if(t.type.name==="text"||t.type.name==="link")throw new Error("unexpected");const r={},o=e[t.type.name];for(const[i,a]of Object.entries(t.attrs)){if(!o)throw Error("ic node is of an unrecognized type: "+t.type.name);const l=o.propSchema;i in l&&(r[i]=a)}let s;return o.content==="styled"?s=yb(t,e,n):s=void 0,{type:t.type.name,props:r,content:s}}function vt(t,e,n=Ok(e),r=Lk(e),o=hu(e),s=Vk(e)){var i;if(!t.type.isInGroup("bnBlock"))throw Error("Node should be a bnBlock, but is instead: "+t.type.name);const a=s==null?void 0:s.get(t);if(a)return a;const l=Nk(t,0);let c=l.bnBlock.node.attrs.id;c===null&&(c=mb.options.generateID());const u=n[l.blockNoteType];if(!u)throw Error("Block is of an unrecognized type: "+l.blockNoteType);const d={};for(const[b,w]of Object.entries({...t.attrs,...l.isBlockContainer?l.blockContent.node.attrs:{}})){const k=u.propSchema;b in k&&!(k[b].default===void 0&&w===void 0)&&(d[b]=w)}const h=n[l.blockNoteType],f=[];(i=l.childContainer)==null||i.node.forEach(b=>{f.push(vt(b,e,n,r,o,s))});let p;if(h.content==="inline"){if(!l.isBlockContainer)throw new Error("impossible");p=yb(l.blockContent.node,r,o)}else if(h.content==="table"){if(!l.isBlockContainer)throw new Error("impossible");p=vL(l.blockContent.node,r,o)}else if(h.content==="none")p=void 0;else throw new Zo(h.content);const y={id:c,type:h.type,props:d,content:p,children:f};return s==null||s.set(t,y),y}function xte(t,e,n=Ok(e),r=Lk(e),o=hu(e),s=Vk(e)){const i=[];return t.firstChild.descendants(a=>(i.push(vt(a,e,n,r,o,s)),!1)),i}function kte(t,e,n=Ok(e),r=Lk(e),o=hu(e),s=Vk(e)){function i(a,l,c){if(a.type.name!=="blockGroup")throw new Error("unexpected");const u=[];let d,h;return a.forEach((f,p,y)=>{if(f.type.name!=="blockContainer")throw new Error("unexpected");if(f.childCount===0)return;if(f.childCount===0||f.childCount>2)throw new Error("unexpected, blockContainer.childCount: "+f.childCount);const b=y===0,w=y===a.childCount-1;if(f.firstChild.type.name==="blockGroup"){if(!b)throw new Error("unexpected");const I=i(f.firstChild,Math.max(0,l-1),w?Math.max(0,c-1):0);d=I.blockCutAtStart,w&&(h=I.blockCutAtEnd),u.push(...I.blocks);return}const k=vt(f,e,n,r,o,s),x=f.childCount>1?f.child(1):void 0;let A=[];if(x){const I=i(x,0,w?Math.max(0,c-1):0);A=I.blocks,w&&(h=I.blockCutAtEnd)}w&&!x&&c>1&&(h=k.id),b&&l>1&&(d=k.id),u.push({...k,children:A})}),{blocks:u,blockCutAtStart:d,blockCutAtEnd:h}}if(t.content.childCount===0)return{blocks:[],blockCutAtStart:void 0,blockCutAtEnd:void 0};if(t.content.childCount!==1)throw new Error("slice must be a single block, did you forget includeParents=true?");return i(t.content.firstChild,Math.max(t.openStart-1,0),Math.max(t.openEnd-1,0))}function wL(t){return Object.fromEntries(Object.entries(t).map(([e,n])=>[e,n.config]))}function Ste(t,e){return{config:t,implementation:e}}function Ga(t,e){return Ste({type:t.name,propSchema:e},{mark:t})}function CL(t){return Object.fromEntries(Object.entries(t).map(([e,n])=>[e,n.config]))}function ya(t){const{height:e,width:n}=jk(t),r=new Array(e).fill(!1).map(()=>new Array(n).fill(null)),o=(s,i)=>{for(let a=s;a<e;a++)for(let l=i;l<n;l++)if(!r[a][l])return{row:a,col:l};throw new Error("Unable to create occupancy grid for table, no more available cells")};for(let s=0;s<t.content.rows.length;s++)for(let i=0;i<t.content.rows[s].cells.length;i++){const a=ta(t.content.rows[s].cells[i]),l=Rh(a),c=_l(a),{row:u,col:d}=o(s,i);for(let h=u;h<u+l;h++)for(let f=d;f<d+c;f++){if(r[h][f])throw new Error(`Unable to create occupancy grid for table, cell at ${h},${f} is already occupied`);r[h][f]={row:s,col:i,rowspan:l,colspan:c,cell:a}}}return r}function Ph(t){const e=new Set;return t.map(n=>({cells:n.map(r=>e.has(r.row+":"+r.col)?!1:(e.add(r.row+":"+r.col),r.cell)).filter(r=>r!==!1)}))}function Al(t,e,n=ya(e)){for(let r=0;r<n.length;r++)for(let o=0;o<n[r].length;o++){const s=n[r][o];if(s.row===t.row&&s.col===t.col)return{row:r,col:o,cell:s.cell}}throw new Error(`Unable to resolve relative table cell indices for table, cell at ${t.row},${t.col} is not occupied`)}function jk(t){const e=t.content.rows.length;let n=0;return t.content.rows.forEach(r=>{let o=0;r.cells.forEach(s=>{o+=_l(s)}),n=Math.max(n,o)}),{height:e,width:n}}function xL(t,e,n=ya(e)){var r;const o=(r=n[t.row])==null?void 0:r[t.col];if(o)return{row:o.row,col:o.col,cell:o.cell}}function Uw(t,e){var n;const r=ya(t);if(e<0||e>=r.length)return[];let o=0;for(let i=0;i<e;i++){const a=(n=r[o])==null?void 0:n[0];if(!a)return[];o+=a.rowspan}const s=new Array(r[0].length).fill(!1).map((i,a)=>xL({row:o,col:a},t,r)).filter(i=>i!==void 0);return s.filter((i,a)=>s.findIndex(l=>l.row===i.row&&l.col===i.col)===a)}function Ww(t,e){var n;const r=ya(t);if(e<0||e>=r[0].length)return[];let o=0;for(let i=0;i<e;i++){const a=(n=r[0])==null?void 0:n[o];if(!a)return[];o+=a.colspan}const s=new Array(r.length).fill(!1).map((i,a)=>xL({row:a,col:o},t,r)).filter(i=>i!==void 0);return s.filter((i,a)=>s.findIndex(l=>l.row===i.row&&l.col===i.col)===a)}function Ete(t,e,n,r=ya(t)){const{col:o}=Al({row:0,col:e},t,r),{col:s}=Al({row:0,col:n},t,r);return r.forEach(i=>{const[a]=i.splice(o,1);i.splice(s,0,a)}),Ph(r)}function Tte(t,e,n,r=ya(t)){const{row:o}=Al({row:e,col:0},t,r),{row:s}=Al({row:n,col:0},t,r),[i]=r.splice(o,1);return r.splice(s,0,i),Ph(r)}function qw(t){return t?Mh(t)?qw(t.content):typeof t=="string"?t.length===0:Array.isArray(t)?t.every(e=>typeof e=="string"?e.length===0:Tl(e)?e.text.length===0:fL(e)?typeof e.content=="string"?e.content.length===0:e.content.every(n=>n.text.length===0):!1):!1:!0}function _te(t,e,n=ya(t)){if(e==="columns"){let s=0;for(let i=n[0].length-1;i>=0&&n.every(a=>qw(a[i].cell)&&a[i].colspan===1);i--)s++;for(let i=n.length-1;i>=0;i--){const a=Math.max(n[i].length-s,1);n[i]=n[i].slice(0,a)}return Ph(n)}let r=0;for(let s=n.length-1;s>=0&&n[s].every(i=>qw(i.cell)&&i.rowspan===1);s--)r++;const o=Math.min(r,n.length-1);return n.splice(n.length-o,o),Ph(n)}function Ate(t,e,n,r=ya(t)){const{width:o,height:s}=jk(t);if(e==="columns")r.forEach((i,a)=>{if(n>=0)for(let l=0;l<n;l++)i.push({row:a,col:Math.max(...i.map(c=>c.col))+1,rowspan:1,colspan:1,cell:ta("")});else i.splice(o+n,-1*n)});else if(n>0)for(let i=0;i<n;i++){const a=new Array(o).fill(null).map((l,c)=>({row:s+i,col:c,rowspan:1,colspan:1,cell:ta("")}));r.push(a)}else n<0&&r.splice(s+n,-1*n);return Ph(r)}function kL(t,e,n){const r=Uw(t,n);if(!r.some(i=>Rh(i.cell)>1))return!0;let o=n,s=n;return r.forEach(i=>{const a=Rh(i.cell);o=Math.max(o,i.row+a-1),s=Math.min(s,i.row)}),e<n?n===o:n===s}function SL(t,e,n){const r=Ww(t,n);if(!r.some(i=>_l(i.cell)>1))return!0;let o=n,s=n;return r.forEach(i=>{const a=_l(i.cell);o=Math.max(o,i.col+a-1),s=Math.min(s,i.col)}),e<n?n===o:n===s}function Ite(t,e,n){const r=Al(t,n),o=Al(e,n);return r.col===o.col}function lI(t,e,n,r){const o=[];for(const[s,i]of Object.entries(t.styles||{})){const a=n[s];if(!a)throw new Error(`style ${s} not found in styleSchema`);if(a.propSchema==="boolean")o.push(e.mark(s));else if(a.propSchema==="string")o.push(e.mark(s,{stringValue:i}));else throw new Zo(a.propSchema)}return!r||!e.nodes[r].spec.code?t.text.split(/(\n)/g).filter(s=>s.length>0).map(s=>s===`
`?e.nodes.hardBreak.createChecked():e.text(s,o)):t.text.length>0?[e.text(t.text,o)]:[]}function Mte(t,e,n){const r=e.marks.link.create({href:t.href});return Gw(t.content,e,n).map(o=>{if(o.type.name==="text")return o.mark([...o.marks,r]);if(o.type.name==="hardBreak")return o;throw new Error("unexpected node type")})}function Gw(t,e,n,r){const o=[];if(typeof t=="string")return o.push(...lI({text:t,styles:{}},e,n,r)),o;for(const s of t)o.push(...lI(s,e,n,r));return o}function ko(t,e,n,r=hu(e)){const o=[];for(const s of t)typeof s=="string"?o.push(...Gw(s,e,r,n)):fL(s)?o.push(...Mte(s,e,r)):Tl(s)?o.push(...Gw([s],e,r,n)):o.push(EL(s,e,r));return o}function bb(t,e,n=hu(e)){const r=[],o=new Array(t.headerRows??0).fill(!0),s=new Array(t.headerCols??0).fill(!0),i=t.columnWidths??[];for(let a=0;a<t.rows.length;a++){const l=t.rows[a],c=[],u=o[a];for(let h=0;h<l.cells.length;h++){const f=l.cells[h],p=s[h],y=void 0;let b=null;const w=Al({row:a,col:h},{content:t});let k=i[w.col]?[i[w.col]]:null;if(f)if(typeof f=="string")b=e.text(f);else if(Mh(f)){f.content&&(b=ko(f.content,e,"tableParagraph",n));const A=_l(f);A>1&&(k=new Array(A).fill(!1).map((I,M)=>i[w.col+M]??void 0))}else b=ko(f,e,"tableParagraph",n);const x=e.nodes[p||u?"tableHeader":"tableCell"].createChecked({...Mh(f)?f.props:{},colwidth:k},e.nodes.tableParagraph.createChecked(y,b));c.push(x)}const d=e.nodes.tableRow.createChecked({},c);r.push(d)}return r}function EL(t,e,n){let r,o=t.type;if(o===void 0&&(o="paragraph"),!e.nodes[o])throw new Error(`node type ${o} not found in schema`);if(!t.content)r=e.nodes[o].createChecked(t.props);else if(typeof t.content=="string"){const s=ko([t.content],e,o,n);r=e.nodes[o].createChecked(t.props,s)}else if(Array.isArray(t.content)){const s=ko(t.content,e,o,n);r=e.nodes[o].createChecked(t.props,s)}else if(t.content.type==="tableContent"){const s=bb(t.content,e,n);r=e.nodes[o].createChecked(t.props,s)}else throw new Zo(t.content.type);return r}function Ol(t,e,n=hu(e)){let r=t.id;r===void 0&&(r=mb.options.generateID());const o=[];if(t.children)for(const s of t.children)o.push(Ol(s,e,n));if(!t.type||e.nodes[t.type].isInGroup("blockContent")){const s=EL(t,e,n),i=o.length>0?e.nodes.blockGroup.createChecked({},o):void 0;return e.nodes.blockContainer.createChecked({id:r,...t.props},i?[s,i]:s)}else{if(e.nodes[t.type].isInGroup("bnBlock"))return e.nodes[t.type].createChecked({id:r,...t.props},o);throw new Error(`block type ${t.type} doesn't match blockContent or bnBlock group`)}}function Ir(t,e){let n,r;if(e.firstChild.descendants((o,s)=>n?!1:!Kw(o)||o.attrs.id!==t?!0:(n=o,r=s+1,!1)),!(n===void 0||r===void 0))return{node:n,posBeforeNode:r}}function Kw(t){return t.type.isInGroup("bnBlock")}function Rte(t,e){return t.id!==e.id||t.type!==e.type||JSON.stringify(t.props)!==JSON.stringify(e.props)||JSON.stringify(t.content)!==JSON.stringify(e.content)}function Pte(t,e=[]){let n={type:"local"};t.getMeta("paste")?n={type:"paste"}:t.getMeta("uiEvent")==="drop"?n={type:"drop"}:t.getMeta("history$")?n={type:t.getMeta("history$").redo?"redo":"undo"}:t.getMeta("y-sync$")&&(t.getMeta("y-sync$").isUndoRedoOperation?n={type:"undo-redo"}:n={type:"yjs-remote"});const r=rn(t),o=Gx(t.before,[t,...e]),s=Kx(o),i=s.flatMap(d=>lg(o.before,d.oldRange,Kw)).map(({node:d})=>vt(d,r)),a=s.flatMap(d=>lg(o.doc,d.newRange,Kw)).map(({node:d})=>vt(d,r)),l=new Map(a.map(d=>[d.id,d])),c=new Map(i.map(d=>[d.id,d])),u=[];for(const[d,h]of l)c.has(d)||u.push({type:"insert",block:h,source:n,prevBlock:void 0});for(const[d,h]of c)l.has(d)||u.push({type:"delete",block:h,source:n,prevBlock:void 0});for(const[d,h]of l)if(c.has(d)){const f=c.get(d);Rte(f,h)&&u.push({type:"update",block:h,prevBlock:f,source:n})}return u}function Dte(t,e,n,r="before"){const o=typeof n=="string"?n:n.id,s=rn(t),i=e.map(c=>Ol(c,s)),a=Ir(o,t.doc);if(!a)throw new Error(`Block with ID ${o} not found`);let l=a.posBeforeNode;return r==="after"&&(l+=a.node.nodeSize),t.step(new Bt(l,l,new G(B.from(i),0,0))),i.map(c=>vt(c,s))}function cI(t,e,n){const r=rn(t),o=n.map(c=>Ol(c,r)),s=new Set(e.map(c=>typeof c=="string"?c:c.id)),i=[],a=typeof e[0]=="string"?e[0]:e[0].id;let l=0;if(t.doc.descendants((c,u)=>{if(s.size===0)return!1;if(!c.type.isInGroup("bnBlock")||!s.has(c.attrs.id))return!0;if(i.push(vt(c,r)),s.delete(c.attrs.id),n.length>0&&c.attrs.id===a){const p=t.doc.nodeSize;t.insert(u,o);const y=t.doc.nodeSize;l+=p-y}const d=t.doc.nodeSize,h=t.doc.resolve(u-l);h.node().type.name==="blockGroup"&&h.node(h.depth-1).type.name!=="doc"&&h.node().childCount===1?t.delete(h.before(),h.after()):t.delete(u-l,u-l+c.nodeSize);const f=t.doc.nodeSize;return l+=d-f,!1}),s.size>0){const c=[...s].join(`
`);throw Error("Blocks with the following IDs could not be found in the editor: "+c)}return{insertedBlocks:o.map(c=>vt(c,r)),removedBlocks:i}}const yn=(t,e)=>({tr:n,dispatch:r})=>(r&&TL(n,t,e),!0);function TL(t,e,n,r,o){const s=Ef(t.doc.resolve(e)),i=rn(t),a=i.nodes[s.blockNoteType],l=i.nodes[n.type||s.blockNoteType],c=l.isInGroup("bnBlock")?l:i.nodes.blockContainer;if(s.isBlockContainer&&l.isInGroup("blockContent"))uI(n,t,s),Nte(n,t,a,l,s);else if(!s.isBlockContainer&&l.isInGroup("bnBlock"))uI(n,t,s);else{const u=vt(s.bnBlock.node,i);t.replaceWith(s.bnBlock.beforePos,s.bnBlock.afterPos,Ol({children:u.children,...n},i));return}t.setNodeMarkup(s.bnBlock.beforePos,c,{...s.bnBlock.node.attrs,...n.props})}function Nte(t,e,n,r,o,s,i){const a=rn(e);let l="keep";if(t.content)if(typeof t.content=="string")l=ko([t.content],a,r.name);else if(Array.isArray(t.content))l=ko(t.content,a,r.name);else if(t.content.type==="tableContent")l=bb(t.content,a);else throw new Zo(t.content.type);else n.spec.content===""||r.spec.content!==n.spec.content&&(l=[]);l==="keep"?e.setNodeMarkup(o.blockContent.beforePos,r,{...o.blockContent.node.attrs,...t.props}):e.replaceWith(o.blockContent.beforePos,o.blockContent.afterPos,r.createChecked({...o.blockContent.node.attrs,...t.props},l))}function uI(t,e,n){const r=rn(e);if(t.children!==void 0&&t.children.length>0){const o=t.children.map(s=>Ol(s,r));if(n.childContainer)e.step(new Bt(n.childContainer.beforePos+1,n.childContainer.afterPos-1,new G(B.from(o),0,0)));else{if(!n.isBlockContainer)throw new Error("impossible");e.insert(n.blockContent.afterPos,r.nodes.blockGroup.createChecked({},o))}}}function Ote(t,e,n,r,o){const s=typeof e=="string"?e:e.id,i=Ir(s,t.doc);if(!i)throw new Error(`Block with ID ${s} not found`);TL(t,i.posBeforeNode,n);const a=t.doc.resolve(i.posBeforeNode+1).node(),l=rn(t);return vt(a,l)}function _L(t){const e=Array.from(t.classList).filter(n=>!n.startsWith("bn-"))||[];e.length>0?t.className=e.join(" "):t.removeAttribute("class")}function AL(t,e,n,r){let o;if(e)if(typeof e=="string")o=ko([e],t.pmSchema);else if(Array.isArray(e))o=ko(e,t.pmSchema);else if(e.type==="tableContent")o=bb(e,t.pmSchema);else throw new Zo(e.type);else throw new Error("blockContent is required");const s=n.serializeFragment(B.from(o),r);return s.nodeType===1&&_L(s),s}function Lte(t,e,n,r,o,s,i){var a,l,c,u,d,h,f,p;const y=(i==null?void 0:i.document)??document,b=e.pmSchema.nodes.blockContainer;let w=n.props;if(!n.props){w={};for(const[T,S]of Object.entries(e.schema.blockSchema[n.type].propSchema))S.default!==void 0&&(w[T]=S.default)}const k=(l=(a=b.spec)==null?void 0:a.toDOM)==null?void 0:l.call(a,b.create({id:n.id,...w})),x=Array.from(k.dom.attributes),A=e.blockImplementations[n.type].implementation.toExternalHTML({...n,props:w},e),I=y.createDocumentFragment();if(A.dom.classList.contains("bn-block-content")){const T=[...x,...Array.from(A.dom.attributes)].filter(S=>S.name.startsWith("data")&&S.name!=="data-content-type"&&S.name!=="data-file-block"&&S.name!=="data-node-view-wrapper"&&S.name!=="data-node-type"&&S.name!=="data-id"&&S.name!=="data-index"&&S.name!=="data-editable");for(const S of T)A.dom.firstChild.setAttribute(S.name,S.value);_L(A.dom.firstChild),I.append(...Array.from(A.dom.childNodes))}else I.append(A.dom);if(A.contentDOM&&n.content){const T=AL(e,n.content,r,i);A.contentDOM.appendChild(T)}let M;if(o.has(n.type)?M="OL":s.has(n.type)&&(M="UL"),M){if(((c=t.lastChild)==null?void 0:c.nodeName)!==M){const S=y.createElement(M);M==="OL"&&w!=null&&w.start&&(w==null?void 0:w.start)!==1&&S.setAttribute("start",w.start+""),t.append(S)}const T=y.createElement("li");T.append(I),t.lastChild.appendChild(T)}else t.append(I);if(n.children&&n.children.length>0){const T=y.createDocumentFragment();if(IL(T,e,n.children,r,o,s,i),((u=t.lastChild)==null?void 0:u.nodeName)==="UL"||((d=t.lastChild)==null?void 0:d.nodeName)==="OL")for(;((h=T.firstChild)==null?void 0:h.nodeName)==="UL"||((f=T.firstChild)==null?void 0:f.nodeName)==="OL";)t.lastChild.lastChild.appendChild(T.firstChild);e.pmSchema.nodes[n.type].isInGroup("blockContent")?t.append(T):(p=A.contentDOM)==null||p.append(T)}}const IL=(t,e,n,r,o,s,i)=>{for(const a of n)Lte(t,e,a,r,o,s,i)},Vte=(t,e,n,r,o,s)=>{const i=((s==null?void 0:s.document)??document).createDocumentFragment();return IL(i,t,e,n,r,o,s),i},vb=(t,e)=>{const n=Js.fromSchema(t);return{exportBlocks:(r,o)=>{const s=Vte(e,r,n,new Set(["numberedListItem"]),new Set(["bulletListItem","checkListItem"]),o),i=document.createElement("div");return i.append(s),i.innerHTML},exportInlineContent:(r,o)=>{const s=AL(e,r,n,o),i=document.createElement("div");return i.append(s.cloneNode(!0)),i.innerHTML}}};function jte(t,e,n,r,o){let s;if(e)if(typeof e=="string")s=ko([e],t.pmSchema,r);else if(Array.isArray(e))s=ko(e,t.pmSchema,r);else if(e.type==="tableContent")s=bb(e,t.pmSchema);else throw new Zo(e.type);else throw new Error("blockContent is required");return n.serializeFragment(B.from(s),o)}function Bte(t,e,n,r,o){var s,i,a,l,c;const u=t.pmSchema.nodes.blockContainer;let d=e.props;if(!e.props){d={};for(const[p,y]of Object.entries(t.schema.blockSchema[e.type].propSchema))y.default!==void 0&&(d[p]=y.default)}const h=t.blockImplementations[e.type].implementation.toInternalHTML({...e,props:d},t);if(e.type==="numberedListItem"&&h.dom.setAttribute("data-index",r.toString()),h.contentDOM&&e.content){const p=jte(t,e.content,n,e.type,o);h.contentDOM.appendChild(p)}if(t.pmSchema.nodes[e.type].isInGroup("bnBlock")){if(e.children&&e.children.length>0){const p=ML(t,e.children,n,o);(s=h.contentDOM)==null||s.append(p)}return h.dom}const f=(a=(i=u.spec)==null?void 0:i.toDOM)==null?void 0:a.call(i,u.create({id:e.id,...d}));return(l=f.contentDOM)==null||l.appendChild(h.dom),e.children&&e.children.length>0&&((c=f.contentDOM)==null||c.appendChild(RL(t,e.children,n,o))),f.dom}function ML(t,e,n,r){const o=((r==null?void 0:r.document)??document).createDocumentFragment();let s=0;for(const i of e){i.type==="numberedListItem"?s++:s=0;const a=Bte(t,i,n,s,r);o.appendChild(a)}return o}const RL=(t,e,n,r)=>{var o;const s=t.pmSchema.nodes.blockGroup,i=s.spec.toDOM(s.create({})),a=ML(t,e,n,r);return(o=i.contentDOM)==null||o.appendChild(a),i.dom},$te=(t,e)=>{const n=Js.fromSchema(t);return{serializeBlocks:(r,o)=>RL(e,r,n,o).outerHTML}},wb=(t,e)=>{const n=t.querySelector(e);if(!n)return;const r=t.querySelector("figcaption"),o=(r==null?void 0:r.textContent)??void 0;return{targetElement:n,caption:o}},Fte=(t,e,n,r)=>{const o=document.createElement("div");o.className="bn-add-file-button";const s=document.createElement("div");s.className="bn-add-file-button-icon",r?s.appendChild(r):s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 8L9.00319 2H19.9978C20.5513 2 21 2.45531 21 2.9918V21.0082C21 21.556 20.5551 22 20.0066 22H3.9934C3.44476 22 3 21.5501 3 20.9932V8ZM10 4V9H5V20H19V4H10Z"></path></svg>',o.appendChild(s);const i=document.createElement("p");i.className="bn-add-file-button-text",i.innerHTML=n||e.dictionary.file_blocks.file.add_button_text,o.appendChild(i);const a=c=>{c.preventDefault()},l=()=>{e.transact(c=>c.setMeta(e.filePanel.plugins[0],{block:t}))};return o.addEventListener("mousedown",a,!0),o.addEventListener("click",l,!0),{dom:o,destroy:()=>{o.removeEventListener("mousedown",a,!0),o.removeEventListener("click",l,!0)}}},Hte='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 8L9.00319 2H19.9978C20.5513 2 21 2.45531 21 2.9918V21.0082C21 21.556 20.5551 22 20.0066 22H3.9934C3.44476 22 3 21.5501 3 20.9932V8ZM10 4V9H5V20H19V4H10Z"></path></svg>',zte=t=>{const e=document.createElement("div");e.className="bn-file-name-with-icon";const n=document.createElement("div");n.className="bn-file-icon",n.innerHTML=Hte,e.appendChild(n);const r=document.createElement("p");return r.className="bn-file-name",r.textContent=t.props.name,e.appendChild(r),{dom:e}},Bk=(t,e,n,r,o)=>{const s=document.createElement("div");if(s.className="bn-file-block-content-wrapper",t.props.url===""){const a=Fte(t,e,r,o);s.appendChild(a.dom);const l=e.onUploadStart(c=>{if(c===t.id){s.removeChild(a.dom);const u=document.createElement("div");u.className="bn-file-loading-preview",u.textContent="Loading...",s.appendChild(u)}});return{dom:s,destroy:()=>{l(),a.destroy()}}}const i={dom:s};if(t.props.showPreview===!1||!n){const a=zte(t);s.appendChild(a.dom),i.destroy=()=>{var l;(l=a.destroy)==null||l.call(a)}}else s.appendChild(n.dom);if(t.props.caption){const a=document.createElement("p");a.className="bn-file-caption",a.textContent=t.props.caption,s.appendChild(a)}return i},$k=(t,e)=>{const n=document.createElement("figure"),r=document.createElement("figcaption");return r.textContent=e,n.appendChild(t),n.appendChild(r),{dom:n}},Cb=(t,e)=>{const n=document.createElement("div"),r=document.createElement("p");return r.textContent=e,n.appendChild(t),n.appendChild(r),{dom:n}},dI=t=>({url:t.src||void 0}),Ute='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M2 16.0001H5.88889L11.1834 20.3319C11.2727 20.405 11.3846 20.4449 11.5 20.4449C11.7761 20.4449 12 20.2211 12 19.9449V4.05519C12 3.93977 11.9601 3.8279 11.887 3.73857C11.7121 3.52485 11.3971 3.49335 11.1834 3.66821L5.88889 8.00007H2C1.44772 8.00007 1 8.44778 1 9.00007V15.0001C1 15.5524 1.44772 16.0001 2 16.0001ZM23 12C23 15.292 21.5539 18.2463 19.2622 20.2622L17.8445 18.8444C19.7758 17.1937 21 14.7398 21 12C21 9.26016 19.7758 6.80629 17.8445 5.15557L19.2622 3.73779C21.5539 5.75368 23 8.70795 23 12ZM18 12C18 10.0883 17.106 8.38548 15.7133 7.28673L14.2842 8.71584C15.3213 9.43855 16 10.64 16 12C16 13.36 15.3213 14.5614 14.2842 15.2841L15.7133 16.7132C17.106 15.6145 18 13.9116 18 12Z"></path></svg>',Wte={backgroundColor:zt.backgroundColor,name:{default:""},url:{default:""},caption:{default:""},showPreview:{default:!0}},PL={type:"audio",propSchema:Wte,content:"none",isFileBlock:!0,fileBlockAccept:["audio/*"]},qte=(t,e)=>{const n=document.createElement("div");n.innerHTML=Ute;const r=document.createElement("audio");return r.className="bn-audio",e.resolveFileUrl?e.resolveFileUrl(t.props.url).then(o=>{r.src=o}):r.src=t.props.url,r.controls=!0,r.contentEditable="false",r.draggable=!1,Bk(t,e,{dom:r},e.dictionary.file_blocks.audio.add_button_text,n.firstElementChild)},DL=t=>{if(t.tagName==="AUDIO")return t.closest("figure")?void 0:dI(t);if(t.tagName==="FIGURE"){const e=wb(t,"audio");if(!e)return;const{targetElement:n,caption:r}=e;return{...dI(n),caption:r}}},Gte=t=>{if(!t.props.url){const n=document.createElement("p");return n.textContent="Add audio",{dom:n}}let e;return t.props.showPreview?(e=document.createElement("audio"),e.src=t.props.url):(e=document.createElement("a"),e.href=t.props.url,e.textContent=t.props.name||t.props.url),t.props.caption?t.props.showPreview?$k(e,t.props.caption):Cb(e,t.props.caption):{dom:e}},Kte=Sf(PL,{render:qte,parse:DL,toExternalHTML:Gte}),hI=Symbol.for("blocknote.shikiParser"),Dv=Symbol.for("blocknote.shikiHighlighterPromise"),Yte={language:{default:"text"}},Xte=Qr({name:"codeBlock",content:"inline*",group:"blockContent",marks:"insertion deletion modification",code:!0,defining:!0,addOptions(){return{defaultLanguage:"text",indentLineWithTab:!0,supportedLanguages:{}}},addAttributes(){const t=this.options;return{language:{default:t.editor.settings.codeBlock.defaultLanguage,parseHTML:e=>{let n=e,r=null;(n==null?void 0:n.tagName)==="DIV"&&(n==null?void 0:n.dataset.contentType)==="codeBlock"&&(n=n.children[0]),(n==null?void 0:n.tagName)==="PRE"&&(n=n==null?void 0:n.children[0]);const o=n==null?void 0:n.getAttribute("data-language");if(o)r=o.toLowerCase();else{const s=[...(n==null?void 0:n.className.split(" "))||[]].filter(i=>i.startsWith("language-")).map(i=>i.replace("language-",""));s.length>0&&(r=s[0].toLowerCase())}return r?Nv(t.editor.settings.codeBlock,r)??r:null},renderHTML:e=>e.language?{class:`language-${e.language}`,"data-language":e.language}:{}}}},parseHTML(){return[{tag:"div[data-content-type="+this.name+"]",contentElement:".bn-inline-content"},{tag:"pre",preserveWhitespace:"full"}]},renderHTML({HTMLAttributes:t}){var e,n;const r=document.createElement("pre"),{dom:o,contentDOM:s}=es(this.name,"code",((e=this.options.domAttributes)==null?void 0:e.blockContent)||{},{...((n=this.options.domAttributes)==null?void 0:n.inlineContent)||{},...t});return o.removeChild(s),o.appendChild(r),r.appendChild(s),{dom:o,contentDOM:s}},addNodeView(){const t=this.options;return({editor:e,node:n,getPos:r,HTMLAttributes:o})=>{var s,i;const a=document.createElement("pre"),l=document.createElement("select"),c=document.createElement("div"),{dom:u,contentDOM:d}=es(this.name,"code",{...((s=this.options.domAttributes)==null?void 0:s.blockContent)||{},...o},((i=this.options.domAttributes)==null?void 0:i.inlineContent)||{}),h=f=>{const p=f.target.value;e.commands.command(({tr:y})=>(y.setNodeAttribute(r(),"language",p),!0))};return Object.entries(t.editor.settings.codeBlock.supportedLanguages).forEach(([f,{name:p}])=>{const y=document.createElement("option");y.value=f,y.text=p,l.appendChild(y)}),c.contentEditable="false",l.value=n.attrs.language||t.editor.settings.codeBlock.defaultLanguage,u.removeChild(d),u.appendChild(c),u.appendChild(a),a.appendChild(d),c.appendChild(l),l.addEventListener("change",h),{dom:u,contentDOM:d,update:f=>f.type===this.type,destroy:()=>{l.removeEventListener("change",h)}}}},addProseMirrorPlugins(){const t=this.options,e=globalThis;let n,r;return[OY({parser:o=>{if(!t.editor.settings.codeBlock.createHighlighter)return[];if(!n)return e[Dv]=e[Dv]||t.editor.settings.codeBlock.createHighlighter(),e[Dv].then(i=>{n=i});const s=Nv(t.editor.settings.codeBlock,o.language);return!s||s==="text"||s==="none"||s==="plaintext"||s==="txt"?[]:n.getLoadedLanguages().includes(s)?(r||(r=e[hI]||LY(n),e[hI]=r),r(o)):n.loadLanguage(s)},languageExtractor:o=>o.attrs.language,nodeTypes:[this.name]})]},addInputRules(){const t=this.options;return[new Ji({find:/^```(.*?)\s$/,handler:({state:e,range:n,match:r})=>{const o=e.doc.resolve(n.from),s=r[1].trim(),i={language:Nv(t.editor.settings.codeBlock,s)??s};if(!o.node(-1).canReplaceWith(o.index(-1),o.indexAfter(-1),this.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,this.type,i).setSelection(ee.create(e.tr.doc,n.from))}})]},addKeyboardShortcuts(){return{Delete:({editor:t})=>{const{selection:e}=t.state,{$from:n}=e;if(t.isActive(this.name)&&!n.parent.textContent&&nb(e)){const r=n.pos-n.parentOffset-2;return t.chain().setNodeSelection(r).deleteSelection().run(),!0}return!1},Tab:({editor:t})=>this.options.indentLineWithTab&&t.isActive(this.name)?(t.commands.insertContent("  "),!0):!1,Enter:({editor:t})=>{const{$from:e}=t.state.selection;if(!t.isActive(this.name))return!1;const n=e.parentOffset===e.parent.nodeSize-2,r=e.parent.textContent.endsWith(`

`);return!n||!r?(t.commands.insertContent(`
`),!0):t.chain().command(({tr:o})=>(o.delete(e.pos-2,e.pos),!0)).exitCode().run()},"Shift-Enter":({editor:t})=>{const{$from:e}=t.state.selection;return t.isActive(this.name)?(t.chain().insertContentAt(e.pos-e.parentOffset+e.parent.nodeSize,{type:"paragraph"}).run(),!0):!1}}}}),Jte=Zs(Xte,Yte);function Nv(t,e){var n;return(n=Object.entries(t.supportedLanguages).find(([r,{aliases:o}])=>(o==null?void 0:o.includes(e))||r===e))==null?void 0:n[0]}const Qte=vn.create({name:"backgroundColor",addAttributes(){return{stringValue:{default:void 0,parseHTML:t=>t.getAttribute("data-background-color"),renderHTML:t=>({"data-background-color":t.stringValue})}}},parseHTML(){return[{tag:"span",getAttrs:t=>typeof t=="string"?!1:t.hasAttribute("data-background-color")?{stringValue:t.getAttribute("data-background-color")}:!1}]},renderHTML({HTMLAttributes:t}){return["span",t,0]}}),Zte=Ga(Qte,"string"),ene=vn.create({name:"textColor",addAttributes(){return{stringValue:{default:void 0,parseHTML:t=>t.getAttribute("data-text-color"),renderHTML:t=>({"data-text-color":t.stringValue})}}},parseHTML(){return[{tag:"span",getAttrs:t=>typeof t=="string"?!1:t.hasAttribute("data-text-color")?{stringValue:t.getAttribute("data-text-color")}:!1}]},renderHTML({HTMLAttributes:t}){return["span",t,0]}}),tne=Ga(ene,"string"),fI=t=>({url:t.src||void 0}),nne={backgroundColor:zt.backgroundColor,name:{default:""},url:{default:""},caption:{default:""}},NL={type:"file",propSchema:nne,content:"none",isFileBlock:!0},rne=(t,e)=>Bk(t,e),OL=t=>{if(t.tagName==="EMBED")return t.closest("figure")?void 0:fI(t);if(t.tagName==="FIGURE"){const e=wb(t,"embed");if(!e)return;const{targetElement:n,caption:r}=e;return{...fI(n),caption:r}}},one=t=>{if(!t.props.url){const n=document.createElement("p");return n.textContent="Add file",{dom:n}}const e=document.createElement("a");return e.href=t.props.url,e.textContent=t.props.name||t.props.url,t.props.caption?Cb(e,t.props.caption):{dom:e}},sne=Sf(NL,{render:rne,parse:OL,toExternalHTML:one}),LL={...zt,level:{default:1,values:[1,2,3]}},ine=Qr({name:"heading",content:"inline*",group:"blockContent",addAttributes(){return kf(LL)},addInputRules(){return[...[1,2,3].map(t=>new Ji({find:new RegExp(`^(#{${t}})\\s$`),handler:({state:e,chain:n,range:r})=>{const o=ct(e);!o.isBlockContainer||o.blockContent.node.type.spec.content!=="inline*"||n().command(yn(o.bnBlock.beforePos,{type:"heading",props:{level:t}})).deleteRange({from:r.from,to:r.to}).run()}}))]},addKeyboardShortcuts(){return{"Mod-Alt-1":()=>{const t=ct(this.editor.state);return!t.isBlockContainer||t.blockContent.node.type.spec.content!=="inline*"?!0:this.editor.commands.command(yn(t.bnBlock.beforePos,{type:"heading",props:{level:1}}))},"Mod-Alt-2":()=>{const t=ct(this.editor.state);return!t.isBlockContainer||t.blockContent.node.type.spec.content!=="inline*"?!0:this.editor.commands.command(yn(t.bnBlock.beforePos,{type:"heading",props:{level:2}}))},"Mod-Alt-3":()=>{const t=ct(this.editor.state);return!t.isBlockContainer||t.blockContent.node.type.spec.content!=="inline*"?!0:this.editor.commands.command(yn(t.bnBlock.beforePos,{type:"heading",props:{level:3}}))}}},parseHTML(){return[{tag:"div[data-content-type="+this.name+"]",contentElement:".bn-inline-content"},{tag:"h1",attrs:{level:1},node:"heading"},{tag:"h2",attrs:{level:2},node:"heading"},{tag:"h3",attrs:{level:3},node:"heading"}]},renderHTML({node:t,HTMLAttributes:e}){var n,r;return es(this.name,`h${t.attrs.level}`,{...((n=this.options.domAttributes)==null?void 0:n.blockContent)||{},...e},((r=this.options.domAttributes)==null?void 0:r.inlineContent)||{})}}),ane=Zs(ine,LL),VL=(t,e,n,r,o,s)=>{const{dom:i,destroy:a}=Bk(t,e,n,o,s),l=i;t.props.url&&t.props.showPreview&&(t.props.previewWidth?l.style.width=`${t.props.previewWidth}px`:l.style.width="fit-content");const c=document.createElement("div");c.className="bn-resize-handle",c.style.left="4px";const u=document.createElement("div");u.className="bn-resize-handle",u.style.right="4px";let d,h=t.props.previewWidth;const f=x=>{var A,I;if(!d){!e.isEditable&&r.contains(c)&&r.contains(u)&&(r.removeChild(c),r.removeChild(u));return}let M;t.props.textAlignment==="center"?d.handleUsed==="left"?M=d.initialWidth+(d.initialClientX-x.clientX)*2:M=d.initialWidth+(x.clientX-d.initialClientX)*2:d.handleUsed==="left"?M=d.initialWidth+d.initialClientX-x.clientX:M=d.initialWidth+x.clientX-d.initialClientX,h=Math.min(Math.max(M,64),((I=(A=e.domElement)==null?void 0:A.firstElementChild)==null?void 0:I.clientWidth)||Number.MAX_VALUE),l.style.width=`${h}px`},p=x=>{(!x.target||!l.contains(x.target)||!e.isEditable)&&r.contains(c)&&r.contains(u)&&(r.removeChild(c),r.removeChild(u)),d&&(d=void 0,e.updateBlock(t,{props:{previewWidth:h}}))},y=()=>{e.isEditable&&(r.appendChild(c),r.appendChild(u))},b=x=>{x.relatedTarget===c||x.relatedTarget===u||d||e.isEditable&&r.contains(c)&&r.contains(u)&&(r.removeChild(c),r.removeChild(u))},w=x=>{x.preventDefault(),d={handleUsed:"left",initialWidth:l.clientWidth,initialClientX:x.clientX}},k=x=>{x.preventDefault(),d={handleUsed:"right",initialWidth:l.clientWidth,initialClientX:x.clientX}};return window.addEventListener("mousemove",f),window.addEventListener("mouseup",p),l.addEventListener("mouseenter",y),l.addEventListener("mouseleave",b),c.addEventListener("mousedown",w),u.addEventListener("mousedown",k),{dom:l,destroy:()=>{a==null||a(),window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",p),l.removeEventListener("mouseenter",y),l.removeEventListener("mouseleave",b),c.removeEventListener("mousedown",w),u.removeEventListener("mousedown",k)}}},pI=t=>{const e=t.src||void 0,n=t.width||void 0;return{url:e,previewWidth:n}},lne='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M5 11.1005L7 9.1005L12.5 14.6005L16 11.1005L19 14.1005V5H5V11.1005ZM4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3ZM15.5 10C14.6716 10 14 9.32843 14 8.5C14 7.67157 14.6716 7 15.5 7C16.3284 7 17 7.67157 17 8.5C17 9.32843 16.3284 10 15.5 10Z"></path></svg>',cne={textAlignment:zt.textAlignment,backgroundColor:zt.backgroundColor,name:{default:""},url:{default:""},caption:{default:""},showPreview:{default:!0},previewWidth:{default:void 0,type:"number"}},jL={type:"image",propSchema:cne,content:"none",isFileBlock:!0,fileBlockAccept:["image/*"]},une=(t,e)=>{const n=document.createElement("div");n.innerHTML=lne;const r=document.createElement("div");r.className="bn-visual-media-wrapper";const o=document.createElement("img");return o.className="bn-visual-media",e.resolveFileUrl?e.resolveFileUrl(t.props.url).then(s=>{o.src=s}):o.src=t.props.url,o.alt=t.props.name||t.props.caption||"BlockNote image",o.contentEditable="false",o.draggable=!1,r.appendChild(o),VL(t,e,{dom:r},r,e.dictionary.file_blocks.image.add_button_text,n.firstElementChild)},BL=t=>{if(t.tagName==="IMG")return t.closest("figure")?void 0:pI(t);if(t.tagName==="FIGURE"){const e=wb(t,"img");if(!e)return;const{targetElement:n,caption:r}=e;return{...pI(n),caption:r}}},dne=t=>{if(!t.props.url){const n=document.createElement("p");return n.textContent="Add image",{dom:n}}let e;return t.props.showPreview?(e=document.createElement("img"),e.src=t.props.url,e.alt=t.props.name||t.props.caption||"BlockNote image",t.props.previewWidth&&(e.width=t.props.previewWidth)):(e=document.createElement("a"),e.href=t.props.url,e.textContent=t.props.name||t.props.url),t.props.caption?t.props.showPreview?$k(e,t.props.caption):Cb(e,t.props.caption):{dom:e}},hne=Sf(jL,{render:une,parse:BL,toExternalHTML:dne});function Fk(t,e,n){var r,o,s;const i=Ls.fromSchema(e),a=t,l=document.createElement("div");l.setAttribute("data-node-type","blockGroup");for(const f of Array.from(a.childNodes))l.appendChild(f.cloneNode(!0));let c=i.parse(l,{topNode:e.nodes.blockGroup.create()});((o=(r=c.firstChild)==null?void 0:r.firstChild)==null?void 0:o.type.name)==="checkListItem"&&(c=c.copy(c.content.cut(c.firstChild.firstChild.nodeSize+2)));const u=(s=c.firstChild)==null?void 0:s.firstChild;if(!(u!=null&&u.isTextblock))return B.from(c);const d=e.nodes[n].create({},u.content),h=c.content.cut(u.nodeSize+2);if(h.size>0){const f=c.copy(h);return d.content.addToEnd(f)}return d.content}const $L=(t,e,n)=>({state:r,dispatch:o})=>{const s=zs(r.doc,t),i=ra(s);if(!i.isBlockContainer)throw new Error(`BlockContainer expected when calling splitBlock, position ${t}`);const a=[{type:i.bnBlock.node.type,attrs:n?{...i.bnBlock.node.attrs,id:void 0}:{}},{type:e?i.blockContent.node.type:r.schema.nodes.paragraph,attrs:n?{...i.blockContent.node.attrs}:{}}];return o&&r.tr.split(t,2,a),!0},Hk=t=>{const{blockInfo:e,selectionEmpty:n}=t.transact(s=>({blockInfo:gb(s),selectionEmpty:s.selection.anchor===s.selection.head}));if(!e.isBlockContainer)return!1;const{bnBlock:r,blockContent:o}=e;return!(o.node.type.name==="bulletListItem"||o.node.type.name==="numberedListItem"||o.node.type.name==="checkListItem")||!n?!1:t._tiptapEditor.commands.first(({state:s,chain:i,commands:a})=>[()=>a.command(()=>o.node.childCount===0?a.command(yn(r.beforePos,{type:"paragraph",props:{}})):!1),()=>a.command(()=>o.node.childCount>0?(i().deleteSelection().command($L(s.selection.from,!0)).run(),!0):!1)])},fne={...zt},pne=Qr({name:"bulletListItem",content:"inline*",group:"blockContent",priority:90,addInputRules(){return[new Ji({find:new RegExp("^[-+*]\\s$"),handler:({state:t,chain:e,range:n})=>{const r=ct(t);!r.isBlockContainer||r.blockContent.node.type.spec.content!=="inline*"||e().command(yn(r.bnBlock.beforePos,{type:"bulletListItem",props:{}})).deleteRange({from:n.from,to:n.to})}})]},addKeyboardShortcuts(){return{Enter:()=>Hk(this.options.editor),"Mod-Shift-8":()=>{const t=ct(this.editor.state);return!t.isBlockContainer||t.blockContent.node.type.spec.content!=="inline*"?!0:this.editor.commands.command(yn(t.bnBlock.beforePos,{type:"bulletListItem",props:{}}))}}},parseHTML(){return[{tag:"div[data-content-type="+this.name+"]",contentElement:".bn-inline-content"},{tag:"li",getAttrs:t=>{var e;if(typeof t=="string")return!1;const n=t.parentElement;return n===null?!1:n.tagName==="UL"||n.tagName==="DIV"&&((e=n.parentElement)==null?void 0:e.tagName)==="UL"?{}:!1},getContent:(t,e)=>Fk(t,e,this.name),node:"bulletListItem"}]},renderHTML({HTMLAttributes:t}){var e,n;return es(this.name,"p",{...((e=this.options.domAttributes)==null?void 0:e.blockContent)||{},...t},((n=this.options.domAttributes)==null?void 0:n.inlineContent)||{})}}),mne=Zs(pne,fne),FL={...zt,checked:{default:!1}},gne=Qr({name:"checkListItem",content:"inline*",group:"blockContent",addAttributes(){return kf(FL)},addInputRules(){return[new Ji({find:new RegExp("\\[\\s*\\]\\s$"),handler:({state:t,chain:e,range:n})=>{const r=ct(t);!r.isBlockContainer||r.blockContent.node.type.spec.content!=="inline*"||e().command(yn(r.bnBlock.beforePos,{type:"checkListItem",props:{checked:!1}})).deleteRange({from:n.from,to:n.to})}}),new Ji({find:new RegExp("\\[[Xx]\\]\\s$"),handler:({state:t,chain:e,range:n})=>{const r=ct(t);!r.isBlockContainer||r.blockContent.node.type.spec.content!=="inline*"||e().command(yn(r.bnBlock.beforePos,{type:"checkListItem",props:{checked:!0}})).deleteRange({from:n.from,to:n.to})}})]},addKeyboardShortcuts(){return{Enter:()=>Hk(this.options.editor),"Mod-Shift-9":()=>{const t=ct(this.editor.state);return!t.isBlockContainer||t.blockContent.node.type.spec.content!=="inline*"?!0:this.editor.commands.command(yn(t.bnBlock.beforePos,{type:"checkListItem",props:{}}))}}},parseHTML(){return[{tag:"div[data-content-type="+this.name+"]",contentElement:".bn-inline-content"},{tag:"input",getAttrs:t=>typeof t=="string"||t.closest("[data-content-type]")||t.closest("li")?!1:t.type==="checkbox"?{checked:t.checked}:!1,node:"checkListItem"},{tag:"li",getAttrs:t=>{var e;if(typeof t=="string")return!1;const n=t.parentElement;if(n===null)return!1;if(n.tagName==="UL"||n.tagName==="DIV"&&((e=n.parentElement)==null?void 0:e.tagName)==="UL"){const r=t.querySelector("input[type=checkbox]")||null;return r===null?!1:{checked:r.checked}}return!1},getContent:(t,e)=>Fk(t,e,this.name),node:"checkListItem"}]},renderHTML({node:t,HTMLAttributes:e}){var n,r;const o=document.createElement("input");o.type="checkbox",o.checked=t.attrs.checked,t.attrs.checked&&o.setAttribute("checked","");const{dom:s,contentDOM:i}=es(this.name,"p",{...((n=this.options.domAttributes)==null?void 0:n.blockContent)||{},...e},((r=this.options.domAttributes)==null?void 0:r.inlineContent)||{});return s.insertBefore(o,i),{dom:s,contentDOM:i}},addNodeView(){return({node:t,getPos:e,editor:n,HTMLAttributes:r})=>{var o,s;const i=document.createElement("div"),a=document.createElement("div");a.contentEditable="false";const l=document.createElement("input");l.type="checkbox",l.checked=t.attrs.checked,t.attrs.checked&&l.setAttribute("checked","");const c=()=>{if(!n.isEditable){l.checked=!l.checked;return}if(typeof e!="boolean"){const h=zs(n.state.doc,e());if(h.node.type.name!=="blockContainer")throw new Error(`Expected blockContainer node, got ${h.node.type.name}`);this.editor.commands.command(yn(h.posBeforeNode,{type:"checkListItem",props:{checked:l.checked}}))}};l.addEventListener("change",c);const{dom:u,contentDOM:d}=es(this.name,"p",{...((o=this.options.domAttributes)==null?void 0:o.blockContent)||{},...r},((s=this.options.domAttributes)==null?void 0:s.inlineContent)||{});if(typeof e!="boolean"){const h="label-"+this.editor.state.doc.resolve(e()).node().attrs.id;l.setAttribute("aria-labelledby",h),d.id=h}return u.removeChild(d),u.appendChild(i),i.appendChild(a),i.appendChild(d),a.appendChild(l),{dom:u,contentDOM:d,destroy:()=>{l.removeEventListener("change",c)}}}}}),yne=Zs(gne,FL),bne=new We("numbered-list-indexing"),vne=()=>new Re({key:bne,appendTransaction:(t,e,n)=>{const r=n.tr;r.setMeta("numberedListIndexing",!0);let o=!1;return n.doc.descendants((s,i)=>{var a;if(s.type.name==="blockContainer"&&s.firstChild.type.name==="numberedListItem"){let l=`${s.firstChild.attrs.start||1}`;const c=ra({posBeforeNode:i,node:s});if(!c.isBlockContainer)throw new Error("impossible");const u=r.doc.resolve(c.bnBlock.beforePos).nodeBefore;if(u){const p=ra({posBeforeNode:c.bnBlock.beforePos-u.nodeSize,node:u});if(p.blockNoteType==="numberedListItem"){if(!p.isBlockContainer)throw new Error("impossible");const y=p.blockContent.node.attrs.index;l=(parseInt(y)+1).toString()}}const d=c.blockContent.node,h=d.attrs.index,f=((a=u==null?void 0:u.firstChild)==null?void 0:a.type.name)!=="numberedListItem";if(h!==l||d.attrs.start&&!f){o=!0;const{start:p,...y}=d.attrs;r.setNodeMarkup(c.blockContent.beforePos,void 0,{...y,index:l,...typeof p=="number"&&f&&{start:p}})}}}),o?r:null}}),HL={...zt,start:{default:void 0,type:"number"}},wne=Qr({name:"numberedListItem",content:"inline*",group:"blockContent",priority:90,addAttributes(){return{...kf(HL),index:{default:null,parseHTML:t=>t.getAttribute("data-index"),renderHTML:t=>({"data-index":t.index})}}},addInputRules(){return[new Ji({find:new RegExp("^(\\d+)\\.\\s$"),handler:({state:t,chain:e,range:n,match:r})=>{const o=ct(t);if(!o.isBlockContainer||o.blockContent.node.type.spec.content!=="inline*"||o.blockNoteType==="numberedListItem")return;const s=parseInt(r[1]);e().command(yn(o.bnBlock.beforePos,{type:"numberedListItem",props:s===1&&{}||{start:s}})).deleteRange({from:n.from,to:n.to})}})]},addKeyboardShortcuts(){return{Enter:()=>Hk(this.options.editor),"Mod-Shift-7":()=>{const t=ct(this.editor.state);return!t.isBlockContainer||t.blockContent.node.type.spec.content!=="inline*"?!0:this.editor.commands.command(yn(t.bnBlock.beforePos,{type:"numberedListItem",props:{}}))}}},addProseMirrorPlugins(){return[vne()]},parseHTML(){return[{tag:"div[data-content-type="+this.name+"]",contentElement:".bn-inline-content"},{tag:"li",getAttrs:t=>{var e;if(typeof t=="string")return!1;const n=t.parentElement;if(n===null)return!1;if(n.tagName==="OL"||n.tagName==="DIV"&&((e=n.parentElement)==null?void 0:e.tagName)==="OL"){const r=parseInt(n.getAttribute("start")||"1")||1;return t.previousSibling||r===1?{}:{start:r}}return!1},getContent:(t,e)=>Fk(t,e,this.name),priority:300,node:"numberedListItem"}]},renderHTML({HTMLAttributes:t}){var e,n;return es(this.name,"p",{...((e=this.options.domAttributes)==null?void 0:e.blockContent)||{},...t},((n=this.options.domAttributes)==null?void 0:n.inlineContent)||{})}}),Cne=Zs(wne,HL),xne={...zt},kne=Qr({name:"paragraph",content:"inline*",group:"blockContent",addKeyboardShortcuts(){return{"Mod-Alt-0":()=>{const t=ct(this.editor.state);return!t.isBlockContainer||t.blockContent.node.type.spec.content!=="inline*"?!0:this.editor.commands.command(yn(t.bnBlock.beforePos,{type:"paragraph",props:{}}))}}},parseHTML(){return[{tag:"div[data-content-type="+this.name+"]",contentElement:".bn-inline-content"},{tag:"p",getAttrs:t=>{var e;return typeof t=="string"||!((e=t.textContent)!=null&&e.trim())?!1:{}},node:"paragraph"}]},renderHTML({HTMLAttributes:t}){var e,n;return es(this.name,"p",{...((e=this.options.domAttributes)==null?void 0:e.blockContent)||{},...t},((n=this.options.domAttributes)==null?void 0:n.inlineContent)||{})}}),Sne=Zs(kne,xne),Ene={...zt},Tne=Qr({name:"quote",content:"inline*",group:"blockContent",addInputRules(){return[new Ji({find:new RegExp("^>\\s$"),handler:({state:t,chain:e,range:n})=>{const r=ct(t);!r.isBlockContainer||r.blockContent.node.type.spec.content!=="inline*"||e().command(yn(r.bnBlock.beforePos,{type:"quote",props:{}})).deleteRange({from:n.from,to:n.to})}})]},addKeyboardShortcuts(){return{"Mod-Alt-q":()=>{const t=ct(this.editor.state);return!t.isBlockContainer||t.blockContent.node.type.spec.content!=="inline*"?!0:this.editor.commands.command(yn(t.bnBlock.beforePos,{type:"quote"}))}}},parseHTML(){return[{tag:"div[data-content-type="+this.name+"]",contentElement:".bn-inline-content"},{tag:"blockquote",node:"quote"}]},renderHTML({HTMLAttributes:t}){var e,n;return es(this.name,"blockquote",{...((e=this.options.domAttributes)==null?void 0:e.blockContent)||{},...t},((n=this.options.domAttributes)==null?void 0:n.inlineContent)||{})}}),_ne=Zs(Tne,Ene),Ane=35,zk=120,Ine=31,Mne=at.create({name:"BlockNoteTableExtension",addProseMirrorPlugins:()=>[HX({cellMinWidth:Ane,defaultCellMinWidth:zk,View:null}),QX()],addKeyboardShortcuts(){return{Enter:()=>this.editor.state.selection.empty&&this.editor.state.selection.$head.parent.type.name==="tableParagraph"?(this.editor.commands.insertContent({type:"hardBreak"}),!0):!1,Backspace:()=>{const t=this.editor.state.selection,e=t.empty,n=t.$head.parentOffset===0,r=t.$head.node().type.name==="tableParagraph";return e&&n&&r},Tab:()=>this.editor.commands.command(({state:t,dispatch:e,view:n})=>dA(1)(t,e,n)),"Shift-Tab":()=>this.editor.commands.command(({state:t,dispatch:e,view:n})=>dA(-1)(t,e,n))}},extendNodeSchema(t){const e={name:t.name,options:t.options,storage:t.storage};return{tableRole:Ne(ne(t,"tableRole",e))}}}),Rne={textColor:zt.textColor},Pne=Qr({name:"table",content:"tableRow+",group:"blockContent",tableRole:"table",marks:"deletion insertion modification",isolating:!0,parseHTML(){return[{tag:"table"}]},renderHTML({HTMLAttributes:t}){var e,n;return es(this.name,"table",{...((e=this.options.domAttributes)==null?void 0:e.blockContent)||{},...t},((n=this.options.domAttributes)==null?void 0:n.inlineContent)||{})},addNodeView(){return({node:t,HTMLAttributes:e})=>{var n;class r extends GO{constructor(s,i,a){super(s,i),this.node=s,this.cellMinWidth=i,this.blockContentHTMLAttributes=a;const l=document.createElement("div");l.className=dt("bn-block-content",a.class),l.setAttribute("data-content-type","table");for(const[h,f]of Object.entries(a))h!=="class"&&l.setAttribute(h,f);const c=this.dom,u=document.createElement("div");u.className="tableWrapper-inner",u.appendChild(c.firstChild),c.appendChild(u),l.appendChild(c);const d=document.createElement("div");d.className="table-widgets-container",d.style.position="relative",c.appendChild(d),this.dom=l}ignoreMutation(s){return!s.target.closest(".tableWrapper-inner")||super.ignoreMutation(s)}}return new r(t,zk,{...((n=this.options.domAttributes)==null?void 0:n.blockContent)||{},...e})}}}),Dne=Qr({name:"tableParagraph",group:"tableContent",content:"inline*",parseHTML(){return[{tag:"p",getAttrs:t=>{if(typeof t=="string"||!t.textContent||!t.closest("[data-content-type]"))return!1;const e=t.parentElement;return e===null?!1:e.tagName==="TD"||e.tagName==="TH"?{}:!1},node:"tableParagraph"}]},renderHTML({HTMLAttributes:t}){return["p",t,0]}}),Nne=cs.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)+",tableRole:"row",marks:"deletion insertion modification",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:t}){return["tr",_r(this.options.HTMLAttributes,t),0]}});function mI(t,e){const n=Ls.fromSchema(e).parse(t,{topNode:e.nodes.blockGroup.create()}),r=[];return n.content.descendants(o=>{if(o.isInline)return r.push(o),!1}),B.fromArray(r)}const One=Zs(Pne,Rne,[Mne,Dne,nX.extend({content:"tableContent+",parseHTML(){return[{tag:"th",getContent:(t,e)=>mI(t,e)}]}}),tX.extend({content:"tableContent+",parseHTML(){return[{tag:"td",getContent:(t,e)=>mI(t,e)}]}}),Nne]),gI=t=>{const e=t.src||void 0,n=t.width||void 0;return{url:e,previewWidth:n}},Lne='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M2 3.9934C2 3.44476 2.45531 3 2.9918 3H21.0082C21.556 3 22 3.44495 22 3.9934V20.0066C22 20.5552 21.5447 21 21.0082 21H2.9918C2.44405 21 2 20.5551 2 20.0066V3.9934ZM8 5V19H16V5H8ZM4 5V7H6V5H4ZM18 5V7H20V5H18ZM4 9V11H6V9H4ZM18 9V11H20V9H18ZM4 13V15H6V13H4ZM18 13V15H20V13H18ZM4 17V19H6V17H4ZM18 17V19H20V17H18Z"></path></svg>',Vne={textAlignment:zt.textAlignment,backgroundColor:zt.backgroundColor,name:{default:""},url:{default:""},caption:{default:""},showPreview:{default:!0},previewWidth:{default:void 0,type:"number"}},zL={type:"video",propSchema:Vne,content:"none",isFileBlock:!0,fileBlockAccept:["video/*"]},jne=(t,e)=>{const n=document.createElement("div");n.innerHTML=Lne;const r=document.createElement("div");r.className="bn-visual-media-wrapper";const o=document.createElement("video");return o.className="bn-visual-media",e.resolveFileUrl?e.resolveFileUrl(t.props.url).then(s=>{o.src=s}):o.src=t.props.url,o.controls=!0,o.contentEditable="false",o.draggable=!1,o.width=t.props.previewWidth,r.appendChild(o),VL(t,e,{dom:r},r,e.dictionary.file_blocks.video.add_button_text,n.firstElementChild)},UL=t=>{if(t.tagName==="VIDEO")return t.closest("figure")?void 0:gI(t);if(t.tagName==="FIGURE"){const e=wb(t,"video");if(!e)return;const{targetElement:n,caption:r}=e;return{...gI(n),caption:r}}},Bne=t=>{if(!t.props.url){const n=document.createElement("p");return n.textContent="Add video",{dom:n}}let e;return t.props.showPreview?(e=document.createElement("video"),e.src=t.props.url,t.props.previewWidth&&(e.width=t.props.previewWidth)):(e=document.createElement("a"),e.href=t.props.url,e.textContent=t.props.name||t.props.url),t.props.caption?t.props.showPreview?$k(e,t.props.caption):Cb(e,t.props.caption):{dom:e}},$ne=Sf(zL,{render:jne,parse:UL,toExternalHTML:Bne}),Uk={paragraph:Sne,heading:ane,quote:_ne,codeBlock:Jte,bulletListItem:mne,numberedListItem:Cne,checkListItem:yne,table:One,file:sne,image:hne,video:$ne,audio:Kte},Fne=mL(Uk),Wk={bold:Ga(HY,"boolean"),italic:Ga(XY,"boolean"),underline:Ga(eX,"boolean"),strike:Ga(ZY,"boolean"),code:Ga(WY,"boolean"),textColor:tne,backgroundColor:Zte};CL(Wk);const WL={text:{config:"text",implementation:{}},link:{config:"link",implementation:{}}},Hne=wL(WL);function or(t,e){return t in e.schema.blockSchema&&e.schema.blockSchema[t]===Fne[t]}function zne(t,e){return t in e.schema.inlineContentSchema&&e.schema.inlineContentSchema[t]===Hne[t]}function Une(t,e,n){return e.type===t&&e.type in n.schema.blockSchema&&or(e.type,n)}function _f(t,e){return t.type in e.schema.blockSchema&&e.schema.blockSchema[t.type].isFileBlock||!1}function Wne(t,e){return t.type in e.schema.blockSchema&&e.schema.blockSchema[t.type].isFileBlock&&"showPreview"in e.schema.blockSchema[t.type].propSchema||!1}function Af(t,e){return e.schema.blockSchema[t.type].isFileBlock&&!t.props.url}function dc(t,e,n){return e in n.schema.blockSchema&&t in n.schema.blockSchema[e].propSchema&&n.schema.blockSchema[e].propSchema[t]===zt[t]}function Yw(t,e,n){return dc(t,e.type,n)}function Xw(t){return t instanceof tt}function qne(t){let e=t.getTextCursorPosition().block,n=t.schema.blockSchema[e.type].content;for(;n==="none";){if(e=t.getTextCursorPosition().nextBlock,e===void 0)return;n=t.schema.blockSchema[e.type].content,t.setTextCursorPosition(e,"end")}}function rr(t,e){const n=t.getTextCursorPosition().block;if(n.content===void 0)throw new Error("Slash Menu open in a block that doesn't contain content.");let r;return Array.isArray(n.content)&&(n.content.length===1&&Tl(n.content[0])&&n.content[0].type==="text"&&n.content[0].text==="/"||n.content.length===0)?(r=t.updateBlock(n,e),t.setTextCursorPosition(r)):(r=t.insertBlocks([e],n,"after")[0],t.setTextCursorPosition(t.getTextCursorPosition().nextBlock)),qne(t),r}function Gne(t){const e=[];return or("heading",t)&&e.push({onItemClick:()=>{rr(t,{type:"heading",props:{level:1}})},badge:jr("Mod-Alt-1"),key:"heading",...t.dictionary.slash_menu.heading},{onItemClick:()=>{rr(t,{type:"heading",props:{level:2}})},badge:jr("Mod-Alt-2"),key:"heading_2",...t.dictionary.slash_menu.heading_2},{onItemClick:()=>{rr(t,{type:"heading",props:{level:3}})},badge:jr("Mod-Alt-3"),key:"heading_3",...t.dictionary.slash_menu.heading_3}),or("quote",t)&&e.push({onItemClick:()=>{rr(t,{type:"quote"})},key:"quote",...t.dictionary.slash_menu.quote}),or("numberedListItem",t)&&e.push({onItemClick:()=>{rr(t,{type:"numberedListItem"})},badge:jr("Mod-Shift-7"),key:"numbered_list",...t.dictionary.slash_menu.numbered_list}),or("bulletListItem",t)&&e.push({onItemClick:()=>{rr(t,{type:"bulletListItem"})},badge:jr("Mod-Shift-8"),key:"bullet_list",...t.dictionary.slash_menu.bullet_list}),or("checkListItem",t)&&e.push({onItemClick:()=>{rr(t,{type:"checkListItem"})},badge:jr("Mod-Shift-9"),key:"check_list",...t.dictionary.slash_menu.check_list}),or("paragraph",t)&&e.push({onItemClick:()=>{rr(t,{type:"paragraph"})},badge:jr("Mod-Alt-0"),key:"paragraph",...t.dictionary.slash_menu.paragraph}),or("codeBlock",t)&&e.push({onItemClick:()=>{rr(t,{type:"codeBlock"})},badge:jr("Mod-Alt-c"),key:"code_block",...t.dictionary.slash_menu.code_block}),or("table",t)&&e.push({onItemClick:()=>{rr(t,{type:"table",content:{type:"tableContent",rows:[{cells:["","",""]},{cells:["","",""]}]}})},badge:void 0,key:"table",...t.dictionary.slash_menu.table}),or("image",t)&&e.push({onItemClick:()=>{const n=rr(t,{type:"image"});t.transact(r=>r.setMeta(t.filePanel.plugins[0],{block:n}))},key:"image",...t.dictionary.slash_menu.image}),or("video",t)&&e.push({onItemClick:()=>{const n=rr(t,{type:"video"});t.transact(r=>r.setMeta(t.filePanel.plugins[0],{block:n}))},key:"video",...t.dictionary.slash_menu.video}),or("audio",t)&&e.push({onItemClick:()=>{const n=rr(t,{type:"audio"});t.transact(r=>r.setMeta(t.filePanel.plugins[0],{block:n}))},key:"audio",...t.dictionary.slash_menu.audio}),or("file",t)&&e.push({onItemClick:()=>{const n=rr(t,{type:"file"});t.transact(r=>r.setMeta(t.filePanel.plugins[0],{block:n}))},key:"file",...t.dictionary.slash_menu.file}),e.push({onItemClick:()=>{t.openSuggestionMenu(":",{deleteTriggerCharacter:!0,ignoreQueryLength:!0})},key:"emoji",...t.dictionary.slash_menu.emoji}),e}function Kne(t,e){return t.filter(({title:n,aliases:r})=>n.toLowerCase().includes(e.toLowerCase())||r&&r.filter(o=>o.toLowerCase().includes(e.toLowerCase())).length!==0)}function Ov(t){return t&&Object.fromEntries(Object.entries(t).filter(([,e])=>e!==void 0))}let qk=class qL{constructor(e){L(this,"blockSpecs"),L(this,"inlineContentSpecs"),L(this,"styleSpecs"),L(this,"blockSchema"),L(this,"inlineContentSchema"),L(this,"styleSchema"),L(this,"BlockNoteEditor","only for types"),L(this,"Block","only for types"),L(this,"PartialBlock","only for types"),this.blockSpecs=Ov(e==null?void 0:e.blockSpecs)||Uk,this.inlineContentSpecs=Ov(e==null?void 0:e.inlineContentSpecs)||WL,this.styleSpecs=Ov(e==null?void 0:e.styleSpecs)||Wk,this.blockSchema=mL(this.blockSpecs),this.inlineContentSchema=wL(this.inlineContentSpecs),this.styleSchema=CL(this.styleSpecs)}static create(e){return new qL(e)}};const Yne={type:"pageBreak",propSchema:{},content:"none",isFileBlock:!1,isSelectable:!1},Xne=()=>{const t=document.createElement("div");return t.className="bn-page-break",t.setAttribute("data-page-break",""),{dom:t}},Jne=t=>{if(t.tagName==="DIV"&&t.hasAttribute("data-page-break"))return{type:"pageBreak"}},Qne=()=>{const t=document.createElement("div");return t.setAttribute("data-page-break",""),{dom:t}},Zne=Sf(Yne,{render:Xne,parse:Jne,toExternalHTML:Qne});qk.create({blockSpecs:{pageBreak:Zne}});function ere(t){return t.transact(e=>{const n=zs(e.doc,e.selection.anchor);if(e.selection instanceof tt)return{type:"cell",anchorBlockId:n.node.attrs.id,anchorCellOffset:e.selection.$anchorCell.pos-n.posBeforeNode,headCellOffset:e.selection.$headCell.pos-n.posBeforeNode};if(e.selection instanceof se)return{type:"node",anchorBlockId:n.node.attrs.id};{const r=zs(e.doc,e.selection.head);return{type:"text",anchorBlockId:n.node.attrs.id,headBlockId:r.node.attrs.id,anchorOffset:e.selection.anchor-n.posBeforeNode,headOffset:e.selection.head-r.posBeforeNode}}})}function tre(t,e){var n,r;const o=(n=Ir(e.anchorBlockId,t.doc))==null?void 0:n.posBeforeNode;if(o===void 0)throw new Error(`Could not find block with ID ${e.anchorBlockId} to update selection`);let s;if(e.type==="cell")s=tt.create(t.doc,o+e.anchorCellOffset,o+e.headCellOffset);else if(e.type==="node")s=se.create(t.doc,o+1);else{const i=(r=Ir(e.headBlockId,t.doc))==null?void 0:r.posBeforeNode;if(i===void 0)throw new Error(`Could not find block with ID ${e.headBlockId} to update selection`);s=ee.create(t.doc,o+e.anchorOffset,i+e.headOffset)}t.setSelection(s)}function Jw(t){return t.map(e=>e.type==="columnList"?e.children.map(n=>Jw(n.children)).flat():{...e,children:Jw(e.children)}).flat()}function GL(t,e,n){t.transact(r=>{var o;const s=((o=t.getSelection())==null?void 0:o.blocks)||[t.getTextCursorPosition().block],i=ere(t);t.removeBlocks(s),t.insertBlocks(Jw(s),e,n),tre(r,i)})}function KL(t){return!t||t.type!=="columnList"}function YL(t,e,n){let r,o;if(e?e.children.length>0?(r=e.children[e.children.length-1],o="after"):(r=e,o="before"):n&&(r=n,o="before"),!r||!o)return;const s=t.getParentBlock(r);return KL(s)?{referenceBlock:r,placement:o}:YL(t,o==="after"?r:t.getPrevBlock(r),s)}function XL(t,e,n){let r,o;if(e?e.children.length>0?(r=e.children[0],o="before"):(r=e,o="after"):n&&(r=n,o="after"),!r||!o)return;const s=t.getParentBlock(r);return KL(s)?{referenceBlock:r,placement:o}:XL(t,o==="before"?r:t.getNextBlock(r),s)}function nre(t){t.transact(()=>{const e=t.getSelection(),n=(e==null?void 0:e.blocks[0])||t.getTextCursorPosition().block,r=YL(t,t.getPrevBlock(n),t.getParentBlock(n));r&&GL(t,r.referenceBlock,r.placement)})}function rre(t){t.transact(()=>{const e=t.getSelection(),n=(e==null?void 0:e.blocks[(e==null?void 0:e.blocks.length)-1])||t.getTextCursorPosition().block,r=XL(t,t.getNextBlock(n),t.getParentBlock(n));r&&GL(t,r.referenceBlock,r.placement)})}function ore(t,e){return function(n,r){const{$from:o,$to:s}=n.selection,i=o.blockRange(s,c=>c.childCount>0&&(c.type.name==="blockGroup"||c.type.name==="column"));if(!i)return!1;const a=i.startIndex;if(a===0)return!1;const l=i.parent.child(a-1);if(l.type!==t)return!1;if(r){const c=l.lastChild&&l.lastChild.type===e,u=B.from(c?t.create():null),d=new G(B.from(t.create(null,B.from(e.create(null,u)))),c?3:1,0),h=i.start,f=i.end;r(n.tr.step(new Nt(h-(c?3:1),f,h,f,d,1,!0)).scrollIntoView())}return!0}}function JL(t){return t.exec((e,n)=>ore(e.schema.nodes.blockContainer,e.schema.nodes.blockGroup)(e,n))}function sre(t){t._tiptapEditor.commands.liftListItem("blockContainer")}function ire(t){return t.transact(e=>{const{bnBlock:n}=gb(e);return e.doc.resolve(n.beforePos).nodeBefore!==null})}function are(t){return t.transact(e=>{const{bnBlock:n}=gb(e);return e.doc.resolve(n.beforePos).depth>1})}function lre(t,e){const n=typeof e=="string"?e:e.id,r=rn(t),o=Ir(n,t);if(o)return vt(o.node,r)}function cre(t,e){const n=typeof e=="string"?e:e.id,r=Ir(n,t),o=rn(t);if(!r)return;const s=t.resolve(r.posBeforeNode).nodeBefore;if(s)return vt(s,o)}function ure(t,e){const n=typeof e=="string"?e:e.id,r=Ir(n,t),o=rn(t);if(!r)return;const s=t.resolve(r.posBeforeNode+r.node.nodeSize).nodeAfter;if(s)return vt(s,o)}function dre(t,e){const n=typeof e=="string"?e:e.id,r=rn(t),o=Ir(n,t);if(!o)return;const s=t.resolve(o.posBeforeNode),i=s.node(),a=s.node(-1),l=a.type.name!=="doc"?i.type.name==="blockGroup"?a:i:void 0;if(l)return vt(l,r)}function hre(t,e,n,r={updateSelection:!0}){let{from:o,to:s}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},i=!0,a=!0,l="";if(n.forEach(c=>{c.check(),i&&c.isText&&c.marks.length===0?l+=c.text:i=!1,a=a?c.isBlock:!1}),o===s&&a){const{parent:c}=t.doc.resolve(o);c.isTextblock&&!c.type.spec.code&&!c.childCount&&(o-=1,s+=1)}return i?t.insertText(l,o,s):t.replaceWith(o,s,n),r.updateSelection&&TO(t,t.steps.length-1,-1),!0}function fre(t){const e=rn(t);if(t.selection.empty||"node"in t.selection)return;const n=t.doc.resolve(zs(t.doc,t.selection.from).posBeforeNode),r=t.doc.resolve(zs(t.doc,t.selection.to).posBeforeNode),o=(c,u)=>{const d=n.posAtIndex(c,u),h=t.doc.resolve(d).nodeAfter;if(!h)throw new Error(`Error getting selection - node not found at position ${d}`);return vt(h,e)},s=[],i=n.sharedDepth(r.pos),a=n.index(i),l=r.index(i);if(n.depth>i){s.push(vt(n.nodeAfter,e));for(let c=n.depth;c>i;c--)if(n.node(c).type.isInGroup("childContainer")){const u=n.index(c)+1,d=n.node(c).childCount;for(let h=u;h<d;h++)s.push(o(h,c))}}else s.push(o(a,i));for(let c=a+1;c<=l;c++)s.push(o(c,i));if(s.length===0)throw new Error(`Error getting selection - selection doesn't span any blocks (${t.selection})`);return{blocks:s}}function pre(t,e,n){const r=typeof e=="string"?e:e.id,o=typeof n=="string"?n:n.id,s=rn(t),i=Tf(s);if(r===o)throw new Error(`Attempting to set selection with the same anchor and head blocks (id ${r})`);const a=Ir(r,t.doc);if(!a)throw new Error(`Block with ID ${r} not found`);const l=Ir(o,t.doc);if(!l)throw new Error(`Block with ID ${o} not found`);const c=ra(a),u=ra(l),d=i.blockSchema[c.blockNoteType],h=i.blockSchema[u.blockNoteType];if(!c.isBlockContainer||d.content==="none")throw new Error(`Attempting to set selection anchor in block without content (id ${r})`);if(!u.isBlockContainer||h.content==="none")throw new Error(`Attempting to set selection anchor in block without content (id ${o})`);let f,p;if(d.content==="table"){const y=bt.get(c.blockContent.node);f=c.blockContent.beforePos+y.positionAt(0,0,c.blockContent.node)+1+2}else f=c.blockContent.beforePos+1;if(h.content==="table"){const y=bt.get(u.blockContent.node),b=u.blockContent.beforePos+y.positionAt(y.height-1,y.width-1,u.blockContent.node)+1,w=t.doc.resolve(b).nodeAfter.nodeSize;p=b+w-2}else p=u.blockContent.afterPos-1;t.setSelection(ee.create(t.doc,f,p))}function mre(t){const e=rn(t);let n=t.selection.$from,r=t.selection.$to;for(;r.parentOffset>=r.parent.nodeSize-2&&r.depth>0;)r=t.doc.resolve(r.pos+1);for(;r.parentOffset===0&&r.depth>0;)r=t.doc.resolve(r.pos-1);for(;n.parentOffset===0&&n.depth>0;)n=t.doc.resolve(n.pos-1);for(;n.parentOffset>=n.parent.nodeSize-2&&n.depth>0;)n=t.doc.resolve(n.pos+1);const o=kte(t.doc.slice(n.pos,r.pos,!0),e);return{_meta:{startPos:n.pos,endPos:r.pos},...o}}function gre(t){const{bnBlock:e}=gb(t),n=rn(t.doc),r=t.doc.resolve(e.beforePos),o=r.nodeBefore,s=t.doc.resolve(e.afterPos).nodeAfter;let i;return r.depth>1&&(i=r.node(),i.type.isInGroup("bnBlock")||(i=r.node(r.depth-1))),{block:vt(e.node,n),prevBlock:o===null?void 0:vt(o,n),nextBlock:s===null?void 0:vt(s,n),parentBlock:i===void 0?void 0:vt(i,n)}}function QL(t,e,n="start"){const r=typeof e=="string"?e:e.id,o=rn(t.doc),s=Tf(o),i=Ir(r,t.doc);if(!i)throw new Error(`Block with ID ${r} not found`);const a=ra(i),l=s.blockSchema[a.blockNoteType].content;if(a.isBlockContainer){const c=a.blockContent;if(l==="none"){t.setSelection(se.create(t.doc,c.beforePos));return}if(l==="inline")n==="start"?t.setSelection(ee.create(t.doc,c.beforePos+1)):t.setSelection(ee.create(t.doc,c.afterPos-1));else if(l==="table")n==="start"?t.setSelection(ee.create(t.doc,c.beforePos+4)):t.setSelection(ee.create(t.doc,c.afterPos-4));else throw new Zo(l)}else{const c=n==="start"?a.childContainer.node.firstChild:a.childContainer.node.lastChild;QL(t,c.attrs.id,n)}}let hc;async function Gk(){if(hc)return hc;const t=await Promise.all([hn(()=>import("./index-rjhLG1eB.js"),__vite__mapDeps([0,1,2,3,4,5])),hn(()=>import("./index-uAn85tBp.js"),__vite__mapDeps([6,4,2,3,7])),hn(()=>import("./index-CWmy4eKR.js"),__vite__mapDeps([8,3,1,2])),hn(()=>import("./index-CfyObm-o.js"),__vite__mapDeps([9,5,4])),hn(()=>import("./index-yU9Yh-H5.js"),__vite__mapDeps([10,11,12,2,3,7])),hn(()=>import("./index-JH4Gotpn.js"),__vite__mapDeps([13,2,3])),hn(()=>import("./index-FrdabaJ1.js"),__vite__mapDeps([14,2,3])),hn(()=>import("./index-BgBG5lba.js"),__vite__mapDeps([15,2,3])),hn(()=>import("./index-BlSIl150.js"),__vite__mapDeps([16,11,2,3])),hn(()=>import("./index-BGm_t98o.js"),__vite__mapDeps([17,12,2,3,7]))]);return hc={rehypeParse:t[0],rehypeStringify:t[1],unified:t[2],hastUtilFromDom:t[3],rehypeRemark:t[4],remarkGfm:t[5],remarkStringify:t[6],remarkParse:t[7],remarkRehype:t[8],rehypeFormat:t[9]},hc}function yre(){const t=e=>{let n=e.children.length;for(let r=0;r<n;r++){const o=e.children[r];if(o.type==="element"&&(t(o),o.tagName==="u"))if(o.children.length>0){e.children.splice(r,1,...o.children);const s=o.children.length-1;n+=s,r+=s}else e.children.splice(r,1),n--,r--}};return t}function bre(){const t=hc;if(!t)throw new Error("addSpacesToCheckboxes requires ESM dependencies to be initialized");const e=n=>{var r;if(n.children&&"length"in n.children&&n.children.length)for(let o=n.children.length-1;o>=0;o--){const s=n.children[o],i=o+1<n.children.length?n.children[o+1]:void 0;s.type==="element"&&s.tagName==="input"&&((r=s.properties)==null?void 0:r.type)==="checkbox"&&(i==null?void 0:i.type)==="element"&&i.tagName==="p"?(i.tagName="span",i.children.splice(0,0,t.hastUtilFromDom.fromDom(document.createTextNode(" ")))):e(s)}};return e}function Kk(t){const e=hc;if(!e)throw new Error("cleanHTMLToMarkdown requires ESM dependencies to be initialized");return e.unified.unified().use(e.rehypeParse.default,{fragment:!0}).use(yre).use(bre).use(e.rehypeRemark.default).use(e.remarkGfm.default).use(e.remarkStringify.default,{handlers:{text:n=>n.value}}).processSync(t).value}async function vre(t,e,n,r){await Gk();const o=vb(e,n).exportBlocks(t,r);return Kk(o)}function wre(t){return Array.prototype.indexOf.call(t.parentElement.childNodes,t)}function Cre(t){return t.nodeType===3&&!/\S/.test(t.nodeValue||"")}function xre(t){t.querySelectorAll("li > ul, li > ol").forEach(e=>{const n=wre(e),r=e.parentElement,o=Array.from(r.childNodes).slice(n+1);e.remove(),o.forEach(s=>{s.remove()}),r.insertAdjacentElement("afterend",e),o.reverse().forEach(s=>{if(Cre(s))return;const i=document.createElement("li");i.append(s),e.insertAdjacentElement("afterend",i)}),r.childNodes.length===0&&r.remove()})}function kre(t){t.querySelectorAll("li + ul, li + ol").forEach(e=>{var n,r;const o=e.previousElementSibling,s=document.createElement("div");o.insertAdjacentElement("afterend",s),s.append(o);const i=document.createElement("div");for(i.setAttribute("data-node-type","blockGroup"),s.append(i);((n=s.nextElementSibling)==null?void 0:n.nodeName)==="UL"||((r=s.nextElementSibling)==null?void 0:r.nodeName)==="OL";)i.append(s.nextElementSibling)})}let yI=null;function Sre(){return yI||(yI=document.implementation.createHTMLDocument("title"))}function ZL(t){if(typeof t=="string"){const e=Sre().createElement("div");e.innerHTML=t,t=e}return xre(t),kre(t),t}async function e5(t,e){const n=ZL(t),r=Ls.fromSchema(e).parse(n,{topNode:e.nodes.blockGroup.create()}),o=[];for(let s=0;s<r.childCount;s++)o.push(vt(r.child(s),e));return o}function Ere(t,e){const n=e.value?e.value:"",r={};e.lang&&(r["data-language"]=e.lang);let o={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return e.meta&&(o.data={meta:e.meta}),t.patch(e,o),o=t.applyData(e,o),o={type:"element",tagName:"pre",properties:{},children:[o]},t.patch(e,o),o}async function t5(t){const e=await Gk();return e.unified.unified().use(e.remarkParse.default).use(e.remarkGfm.default).use(e.remarkRehype.default,{handlers:{...e.remarkRehype.defaultHandlers,code:Ere}}).use(e.rehypeStringify.default).processSync(t).value}async function Tre(t,e){const n=await t5(t);return e5(n,e)}const Yk=["vscode-editor-data","blocknote/html","text/markdown","text/html","text/plain","Files"];function _re(t,e){if(!t.startsWith(".")||!e.startsWith("."))throw new Error("The strings provided are not valid file extensions.");return t===e}function Are(t,e){const n=t.split("/"),r=e.split("/");if(n.length!==2)throw new Error(`The string ${t} is not a valid MIME type.`);if(r.length!==2)throw new Error(`The string ${e} is not a valid MIME type.`);return n[1]==="*"||r[1]==="*"?n[0]===r[0]:(n[0]==="*"||r[0]==="*"||n[0]===r[0])&&n[1]===r[1]}function bI(t,e,n){let r;return Array.isArray(e.content)&&e.content.length===0?r=t.updateBlock(e,n).id:r=t.insertBlocks([n],e,"after")[0].id,r}async function n5(t,e){var n;if(!e.uploadFile){console.warn("Attempted ot insert file, but uploadFile is not set in the BlockNote editor options");return}const r="dataTransfer"in t?t.dataTransfer:t.clipboardData;if(r===null)return;let o=null;for(const a of Yk)if(r.types.includes(a)){o=a;break}if(o!=="Files")return;const s=r.items;if(!s)return;t.preventDefault();const i=Object.values(e.schema.blockSchema).filter(a=>a.isFileBlock);for(let a=0;a<s.length;a++){let l="file";for(const u of i)for(const d of u.fileBlockAccept||[]){const h=d.startsWith("."),f=s[a].getAsFile();if(f&&(!h&&f.type&&Are(s[a].type,d)||h&&_re("."+f.name.split(".").pop(),d))){l=u.type;break}}const c=s[a].getAsFile();if(c){const u={type:l,props:{name:c.name}};let d;if(t.type==="paste"){const p=e.getTextCursorPosition().block;d=bI(e,p,u)}else if(t.type==="drop"){const p={left:t.clientX,top:t.clientY},y=(n=e.prosemirrorView)==null?void 0:n.posAtCoords(p);if(!y)return;d=e.transact(b=>{const w=zs(b.doc,y.pos);return bI(e,e.getBlock(w.node.attrs.id),u)})}else return;const h=await e.uploadFile(c,d),f=typeof h=="string"?{props:{url:h}}:{...h};e.updateBlock(d,f)}}}const Ire=t=>at.create({name:"dropFile",addProseMirrorPlugins(){return[new Re({props:{handleDOMEvents:{drop(e,n){if(!t.isEditable)return;let r=null;for(const o of Yk)if(n.dataTransfer.types.includes(o)){r=o;break}return r===null?!0:r==="Files"?(n5(n,t),!0):!1}}}})]}}),Mre=/(^|\n) {0,3}#{1,6} {1,8}[^\n]{1,64}\r?\n\r?\n\s{0,32}\S/,Rre=new RegExp("(?:\\s|^)(_|__|\\*|\\*\\*|~~|==|\\+\\+)(?!\\s).{1,64}(?<!\\s)(?=\\1)"),Pre=/\[[^\]]{1,128}\]\(https?:\/\/\S{1,999}\)/,Dre=new RegExp("(?:\\s|^)`(?!\\s)[^`]{1,48}(?<!\\s)`([^\\w]|$)"),Nre=/(?:^|\n)\s{0,5}-\s{1}[^\n]+\n\s{0,15}-\s/,Ore=/(?:^|\n)\s{0,5}\d+\.\s{1}[^\n]+\n\s{0,15}\d+\.\s/,Lre=/\n{2} {0,3}-{2,48}\n{2}/,Vre=/(?:\n|^)(```|~~~|\$\$)(?!`|~)[^\s]{0,64} {0,64}[^\n]{0,64}\n[\s\S]{0,9999}?\s*\1 {0,64}(?:\n+|$)/,jre=/(?:\n|^)(?!\s)\w[^\n]{0,64}\r?\n(-|=)\1{0,64}\n\n\s{0,64}(\w|$)/,Bre=/(?:^|(\r?\n\r?\n))( {0,3}>[^\n]{1,333}\n){1,999}($|(\r?\n))/,$re=/^\s*\|(.+\|)+\s*$/m,Fre=/^\s*\|(\s*[-:]+[-:]\s*\|)+\s*$/m,Hre=/^\s*\|(.+\|)+\s*$/m,zre=t=>Mre.test(t)||Rre.test(t)||Pre.test(t)||Dre.test(t)||Nre.test(t)||Ore.test(t)||Lre.test(t)||Vre.test(t)||jre.test(t)||Bre.test(t)||$re.test(t)||Fre.test(t)||Hre.test(t);async function Ure(t,e){const{schema:n}=e.state;if(!t.clipboardData)return!1;const r=t.clipboardData.getData("text/plain");if(!r)return!1;if(!n.nodes.codeBlock)return e.pasteText(r),!0;const o=t.clipboardData.getData("vscode-editor-data"),s=o?JSON.parse(o):void 0,i=s==null?void 0:s.mode;return i?(e.pasteHTML(`<pre><code class="language-${i}">${r.replace(/\r\n?/g,`
`)}</code></pre>`),!0):!1}function Wre({event:t,editor:e,prioritizeMarkdownOverHTML:n,plainTextAsMarkdown:r}){var o;if(e.transact(a=>a.selection.$from.parent.type.spec.code&&a.selection.$to.parent.type.spec.code)){const a=(o=t.clipboardData)==null?void 0:o.getData("text/plain");if(a)return e.pasteText(a),!0}let s;for(const a of Yk)if(t.clipboardData.types.includes(a)){s=a;break}if(!s)return!0;if(s==="vscode-editor-data")return Ure(t,e.prosemirrorView),!0;if(s==="Files")return n5(t,e),!0;const i=t.clipboardData.getData(s);if(s==="blocknote/html")return e.pasteHTML(i,!0),!0;if(s==="text/markdown")return e.pasteMarkdown(i),!0;if(n){const a=t.clipboardData.getData("text/plain");if(zre(a))return e.pasteMarkdown(a),!0}return s==="text/html"?(e.pasteHTML(i),!0):r?(e.pasteMarkdown(i),!0):(e.pasteText(i),!0)}const qre=(t,e)=>at.create({name:"pasteFromClipboard",addProseMirrorPlugins(){return[new Re({props:{handleDOMEvents:{paste(n,r){if(r.preventDefault(),!!t.isEditable)return e({event:r,editor:t,defaultPasteHandler:({prioritizeMarkdownOverHTML:o=!0,plainTextAsMarkdown:s=!0}={})=>Wre({event:r,editor:t,prioritizeMarkdownOverHTML:o,plainTextAsMarkdown:s})})}}}})]}});function r5(t){const e=[];return t.descendants(n=>{var r,o;const s=rn(n);return n.type.name==="blockContainer"&&((r=n.firstChild)==null?void 0:r.type.name)==="blockGroup"?!0:n.type.name==="columnList"&&n.childCount===1?((o=n.firstChild)==null||o.forEach(i=>{e.push(vt(i,s))}),!1):n.type.isInGroup("bnBlock")?(e.push(vt(n,s)),!1):!0}),e}function Gre(t,e,n){var r;let o=!1;const s=t.state.selection instanceof tt;if(!s){const l=t.state.doc.slice(t.state.selection.from,t.state.selection.to,!1).content,c=[];for(let u=0;u<l.childCount;u++)c.push(l.child(u));o=c.find(u=>u.type.isInGroup("bnBlock")||u.type.name==="blockGroup"||u.type.spec.group==="blockContent")===void 0,o&&(e=l)}let i;const a=vb(t.state.schema,n);if(s){((r=e.firstChild)==null?void 0:r.type.name)==="table"&&(e=e.firstChild.content);const l=vL(e,n.schema.inlineContentSchema,n.schema.styleSchema);i=`<table>${a.exportInlineContent(l,{})}</table>`}else if(o){const l=yb(e,n.schema.inlineContentSchema,n.schema.styleSchema);i=a.exportInlineContent(l,{})}else{const l=r5(e);i=a.exportBlocks(l,{})}return i}function o5(t,e){"node"in t.state.selection&&t.state.selection.node.type.spec.group==="blockContent"&&e.transact(i=>i.setSelection(new se(i.doc.resolve(t.state.selection.from-1))));const n=t.serializeForClipboard(t.state.selection.content()).dom.innerHTML,r=t.state.selection.content().content,o=Gre(t,r,e),s=Kk(o);return{clipboardHTML:n,externalHTML:o,markdown:s}}const vI=()=>{const t=window.getSelection();if(!t||t.isCollapsed)return!0;let e=t.focusNode;for(;e;){if(e instanceof HTMLElement&&e.getAttribute("contenteditable")==="false")return!0;e=e.parentElement}return!1},wI=(t,e,n)=>{n.preventDefault(),n.clipboardData.clearData();const{clipboardHTML:r,externalHTML:o,markdown:s}=o5(e,t);n.clipboardData.setData("blocknote/html",r),n.clipboardData.setData("text/html",o),n.clipboardData.setData("text/plain",s)},Kre=t=>at.create({name:"copyToClipboard",addProseMirrorPlugins(){return[new Re({props:{handleDOMEvents:{copy(e,n){return vI()||wI(t,e,n),!0},cut(e,n){return vI()||(wI(t,e,n),e.editable&&e.dispatch(e.state.tr.deleteSelection())),!0},dragstart(e,n){if(!("node"in e.state.selection)||e.state.selection.node.type.spec.group!=="blockContent")return;t.transact(i=>i.setSelection(new se(i.doc.resolve(e.state.selection.from-1)))),n.preventDefault(),n.dataTransfer.clearData();const{clipboardHTML:r,externalHTML:o,markdown:s}=o5(e,t);return n.dataTransfer.setData("blocknote/html",r),n.dataTransfer.setData("text/html",o),n.dataTransfer.setData("text/plain",s),!0}}}})]}}),Yre=at.create({name:"blockBackgroundColor",addGlobalAttributes(){return[{types:["blockContainer","tableCell","tableHeader"],attributes:{backgroundColor:{default:zt.backgroundColor.default,parseHTML:t=>t.hasAttribute("data-background-color")?t.getAttribute("data-background-color"):zt.backgroundColor.default,renderHTML:t=>t.backgroundColor===zt.backgroundColor.default?{}:{"data-background-color":t.backgroundColor}}}}]}});let Xk=class{constructor(){L(this,"callbacks",{})}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),()=>this.off(e,n)}emit(e,...n){const r=this.callbacks[e];r&&r.forEach(o=>o.apply(this,n))}off(e,n){const r=this.callbacks[e];r&&(n?this.callbacks[e]=r.filter(o=>o!==n):delete this.callbacks[e])}removeAllListeners(){this.callbacks={}}},wn=class extends Xk{constructor(...e){super(),L(this,"plugins",[])}static key(){throw new Error("You must implement the key method in your extension")}addProsemirrorPlugin(e){this.plugins.push(e)}get priority(){}};const s5=class i5 extends wn{constructor(e){super(),L(this,"provider"),L(this,"recentlyUpdatedCursors"),L(this,"renderCursor",(n,r)=>{let o=this.recentlyUpdatedCursors.get(r);if(!o){const s=(this.collaboration.renderCursor??i5.defaultCursorRender)(n);this.collaboration.showCursorLabels!=="always"&&(s.addEventListener("mouseenter",()=>{const i=this.recentlyUpdatedCursors.get(r);i.element.setAttribute("data-active",""),i.hideTimeout&&(clearTimeout(i.hideTimeout),this.recentlyUpdatedCursors.set(r,{element:i.element,hideTimeout:void 0}))}),s.addEventListener("mouseleave",()=>{const i=this.recentlyUpdatedCursors.get(r);this.recentlyUpdatedCursors.set(r,{element:i.element,hideTimeout:setTimeout(()=>{i.element.removeAttribute("data-active")},2e3)})})),o={element:s,hideTimeout:void 0},this.recentlyUpdatedCursors.set(r,o)}return o.element}),L(this,"updateUser",n=>{this.provider.awareness.setLocalStateField("user",n)}),this.collaboration=e,this.provider=e.provider,this.recentlyUpdatedCursors=new Map,this.provider.awareness.setLocalStateField("user",e.user),e.showCursorLabels!=="always"&&this.provider.awareness.on("change",({updated:n})=>{for(const r of n){const o=this.recentlyUpdatedCursors.get(r);o&&(o.element.setAttribute("data-active",""),o.hideTimeout&&clearTimeout(o.hideTimeout),this.recentlyUpdatedCursors.set(r,{element:o.element,hideTimeout:setTimeout(()=>{o.element.removeAttribute("data-active")},2e3)}))}}),this.addProsemirrorPlugin(ste(this.provider.awareness,{selectionBuilder:hL,cursorBuilder:this.renderCursor}))}static key(){return"yCursorPlugin"}get priority(){return 999}};L(s5,"defaultCursorRender",t=>{const e=document.createElement("span");e.classList.add("bn-collaboration-cursor__base");const n=document.createElement("span");n.setAttribute("contentedEditable","false"),n.classList.add("bn-collaboration-cursor__caret"),n.setAttribute("style",`background-color: ${t.color}`);const r=document.createElement("span");return r.classList.add("bn-collaboration-cursor__label"),r.setAttribute("style",`background-color: ${t.color}`),r.insertBefore(document.createTextNode(t.name),null),n.insertBefore(r,null),e.insertBefore(document.createTextNode("â "),null),e.insertBefore(n,null),e.insertBefore(document.createTextNode("â "),null),e});let a5=s5,Qw=class extends wn{static key(){return"ySyncPlugin"}constructor(e){super(),this.addProsemirrorPlugin(zee(e))}get priority(){return 1001}},Zw=class extends wn{static key(){return"yUndoPlugin"}constructor(){super(),this.addProsemirrorPlugin(hte())}get priority(){return 1e3}};const l5=vn.create({name:"comment",excludes:"",inclusive:!1,keepOnSplit:!0,addAttributes(){return{orphan:{parseHTML:t=>!!t.getAttribute("data-orphan"),renderHTML:t=>t.orphan?{"data-orphan":"true"}:{},default:!1},threadId:{parseHTML:t=>t.getAttribute("data-bn-thread-id"),renderHTML:t=>({"data-bn-thread-id":t.threadId}),default:""}}},renderHTML({HTMLAttributes:t}){return["span",_r(t,{class:"bn-thread-mark"})]},parseHTML(){return[{tag:"span.bn-thread-mark"}]},extendMarkSchema(t){return t.name==="comment"?{blocknoteIgnore:!0}:{}}});class Xre extends Xk{constructor(e){super(),L(this,"userCache",new Map),L(this,"loadingUsers",new Set),this.resolveUsers=e}async loadUsers(e){const n=e.filter(r=>!this.userCache.has(r)&&!this.loadingUsers.has(r));if(n.length!==0){for(const r of n)this.loadingUsers.add(r);try{const r=await this.resolveUsers(n);for(const o of r)this.userCache.set(o.id,o);this.emit("update",this.userCache)}finally{for(const r of n)this.loadingUsers.delete(r)}}}getUser(e){return this.userCache.get(e)}subscribe(e){return this.on("update",e)}}const Fp=new We("blocknote-comments"),Jre="SET_SELECTED_THREAD_ID";function Qre(t,e){const n=new Map;return t.descendants((r,o)=>{r.marks.forEach(s=>{if(s.type.name===e){const i=s.attrs.threadId;if(!i)return;const a=o,l=a+r.nodeSize,c=n.get(i)??{from:1/0,to:0};n.set(i,{from:Math.min(a,c.from),to:Math.max(l,c.to)})}})}),n}class Zre extends wn{constructor(e,n,r){if(super(),L(this,"userStore"),L(this,"pendingComment",!1),L(this,"selectedThreadId"),L(this,"threadPositions",new Map),L(this,"updateMarksFromThreads",s=>{this.editor.transact(i=>{i.doc.descendants((a,l)=>{a.marks.forEach(c=>{if(c.type.name===this.markType){const u=c.type,d=c.attrs.threadId,h=s.get(d),f=!!(!h||h.resolved||h.deletedAt);if(f!==c.attrs.orphan){const p=Math.max(l,0),y=Math.min(l+a.nodeSize,i.doc.content.size-1,i.doc.content.size-1);i.removeMark(p,y,c),i.addMark(p,y,u.create({...c.attrs,orphan:f})),f&&this.selectedThreadId===d&&(this.selectedThreadId=void 0,this.emitStateUpdate())}}})})})}),this.editor=e,this.threadStore=n,this.markType=r,!e.resolveUsers)throw new Error("resolveUsers is required for comments");this.userStore=new Xre(e.resolveUsers),this.threadStore.subscribe(this.updateMarksFromThreads),e.onCreate(()=>{this.updateMarksFromThreads(this.threadStore.getThreads()),e.onSelectionChange(()=>{this.pendingComment&&(this.pendingComment=!1,this.emitStateUpdate())})});const o=this;this.addProsemirrorPlugin(new Re({key:Fp,state:{init(){return{decorations:Oe.empty}},apply(s,i){const a=s.getMeta(Fp);if(!s.docChanged&&!a)return i;const l=s.docChanged?Qre(s.doc,o.markType):o.threadPositions;(l.size>0||o.threadPositions.size>0)&&(o.threadPositions=l,o.emitStateUpdate());const c=[];if(o.selectedThreadId){const u=l.get(o.selectedThreadId);u&&c.push(et.inline(u.from,u.to,{class:"bn-thread-mark-selected"}))}return{decorations:Oe.create(s.doc,c)}}},props:{decorations(s){var i;return((i=Fp.getState(s))==null?void 0:i.decorations)??Oe.empty},handleClick:(s,i,a)=>{if(a.button!==0)return;const l=s.state.doc.nodeAt(i);if(!l){o.selectThread(void 0);return}const c=l.marks.find(d=>d.type.name===r&&d.attrs.orphan!==!0),u=c==null?void 0:c.attrs.threadId;o.selectThread(u,!1)}}}))}static key(){return"comments"}emitStateUpdate(){this.emit("update",{selectedThreadId:this.selectedThreadId,pendingComment:this.pendingComment,threadPositions:this.threadPositions})}onUpdate(e){return this.on("update",e)}selectThread(e,n=!0){var r,o;if(this.selectedThreadId!==e&&(this.selectedThreadId=e,this.emitStateUpdate(),this.editor.transact(s=>s.setMeta(Fp,{name:Jre})),e&&n)){const s=this.threadPositions.get(e);if(!s)return;(o=(r=this.editor.prosemirrorView)==null?void 0:r.domAtPos(s.from).node)==null||o.scrollIntoView({behavior:"smooth",block:"center"})}}startPendingComment(){this.pendingComment=!0,this.emitStateUpdate()}stopPendingComment(){this.pendingComment=!1,this.emitStateUpdate()}async createThread(e){const n=await this.threadStore.createThread(e);if(this.threadStore.addThreadToDocument){const r=this.editor.prosemirrorView,o=r.state.selection,s=Ke.getState(r.state),i={prosemirror:{head:o.head,anchor:o.anchor},yjs:s?Gg(s.binding,r.state):void 0};await this.threadStore.addThreadToDocument({threadId:n.id,selection:i})}else this.editor._tiptapEditor.commands.setMark(this.markType,{orphan:!1,threadId:n.id})}}class eoe{constructor(e,n,r,o){L(this,"state"),L(this,"emitUpdate"),L(this,"mouseDownHandler",()=>{var s;(s=this.state)!=null&&s.show&&(this.state.show=!1,this.emitUpdate())}),L(this,"dragstartHandler",()=>{var s;(s=this.state)!=null&&s.show&&(this.state.show=!1,this.emitUpdate())}),L(this,"scrollHandler",()=>{var s;if((s=this.state)!=null&&s.show){const i=this.pmView.root.querySelector(`[data-node-type="blockContainer"][data-id="${this.state.block.id}"]`);if(!i)return;this.state.referencePos=i.getBoundingClientRect(),this.emitUpdate()}}),L(this,"closeMenu",()=>{var s;(s=this.state)!=null&&s.show&&(this.state.show=!1,this.emitUpdate())}),this.editor=e,this.pluginKey=n,this.pmView=r,this.emitUpdate=()=>{if(!this.state)throw new Error("Attempting to update uninitialized file panel");o(this.state)},r.dom.addEventListener("mousedown",this.mouseDownHandler),r.dom.addEventListener("dragstart",this.dragstartHandler),r.root.addEventListener("scroll",this.scrollHandler,!0)}update(e,n){var r,o;const s=this.pluginKey.getState(e.state),i=this.pluginKey.getState(n);if(!((r=this.state)!=null&&r.show)&&s!=null&&s.block&&this.editor.isEditable){const c=this.pmView.root.querySelector(`[data-node-type="blockContainer"][data-id="${s.block.id}"]`);if(!c)return;this.state={show:!0,referencePos:c.getBoundingClientRect(),block:s.block},this.emitUpdate();return}const a=(s==null?void 0:s.block)&&!(i!=null&&i.block),l=!(s!=null&&s.block)&&(i==null?void 0:i.block);a&&this.state&&!this.state.show&&(this.state.show=!0,this.emitUpdate()),l&&(o=this.state)!=null&&o.show&&(this.state.show=!1,this.emitUpdate())}destroy(){this.pmView.dom.removeEventListener("mousedown",this.mouseDownHandler),this.pmView.dom.removeEventListener("dragstart",this.dragstartHandler),this.pmView.root.removeEventListener("scroll",this.scrollHandler,!0)}}const Lv=new We("FilePanelPlugin");class toe extends wn{constructor(e){super(),L(this,"view"),L(this,"closeMenu",()=>{var n;return(n=this.view)==null?void 0:n.closeMenu()}),this.addProsemirrorPlugin(new Re({key:Lv,view:n=>(this.view=new eoe(e,Lv,n,r=>{this.emit("update",r)}),this.view),props:{handleKeyDown:(n,r)=>{var o;return r.key==="Escape"&&this.shown?((o=this.view)==null||o.closeMenu(),!0):!1}},state:{init:()=>({block:void 0}),apply:(n,r)=>n.getMeta(Lv)||(!n.getMeta(Ke)&&(n.selectionSet||n.docChanged)?{block:void 0}:r)}}))}static key(){return"filePanel"}get shown(){var e,n;return((n=(e=this.view)==null?void 0:e.state)==null?void 0:n.show)||!1}onUpdate(e){return this.on("update",e)}}class noe{constructor(e,n,r){L(this,"state"),L(this,"emitUpdate"),L(this,"preventHide",!1),L(this,"preventShow",!1),L(this,"shouldShow",({view:o,state:s,from:i,to:a})=>{const{doc:l,selection:c}=s,{empty:u}=c,d=!l.textBetween(i,a).length&&nb(s.selection);if(c.$from.parent.type.spec.code||pw(c)&&c.node.type.spec.code||u||d)return!1;const h=document.activeElement;return!(!this.isElementWithinEditorWrapper(h)&&o.editable)}),L(this,"blurHandler",o=>{var s;if(this.preventHide){this.preventHide=!1;return}const i=this.pmView.dom.parentElement;o&&o.relatedTarget&&(i===o.relatedTarget||i.contains(o.relatedTarget)||o.relatedTarget.matches(".bn-ui-container, .bn-ui-container *"))||(s=this.state)!=null&&s.show&&(this.state.show=!1,this.emitUpdate())}),L(this,"isElementWithinEditorWrapper",o=>{if(!o)return!1;const s=this.pmView.dom.parentElement;return s?s.contains(o):!1}),L(this,"viewMousedownHandler",o=>{this.isElementWithinEditorWrapper(o.target)||(this.preventShow=!0)}),L(this,"mouseupHandler",()=>{this.preventShow&&(this.preventShow=!1,setTimeout(()=>this.update(this.pmView)))}),L(this,"dragHandler",()=>{var o;(o=this.state)!=null&&o.show&&(this.state.show=!1,this.emitUpdate())}),L(this,"scrollHandler",()=>{var o;(o=this.state)!=null&&o.show&&(this.state.referencePos=this.getSelectionBoundingBox(),this.emitUpdate())}),L(this,"closeMenu",()=>{var o;(o=this.state)!=null&&o.show&&(this.state.show=!1,this.emitUpdate())}),this.editor=e,this.pmView=n,this.emitUpdate=()=>{if(!this.state)throw new Error("Attempting to update uninitialized formatting toolbar");r(this.state)},n.dom.addEventListener("mousedown",this.viewMousedownHandler),n.root.addEventListener("mouseup",this.mouseupHandler),n.dom.addEventListener("dragstart",this.dragHandler),n.dom.addEventListener("dragover",this.dragHandler),n.dom.addEventListener("blur",this.blurHandler),n.root.addEventListener("scroll",this.scrollHandler,!0)}update(e,n){var r,o,s;const{state:i,composing:a}=e,{doc:l,selection:c}=i,u=n&&n.doc.eq(l)&&n.selection.eq(c);if(a||u)return;const{ranges:d}=c,h=Math.min(...d.map(b=>b.$from.pos)),f=Math.max(...d.map(b=>b.$to.pos)),p=this.shouldShow({view:e,state:i,from:h,to:f}),y=typeof Range.prototype.getClientRects>"u";if(!this.preventShow&&(p||this.preventHide)&&!y){const b={show:!0,referencePos:this.getSelectionBoundingBox()};(b.show!==((r=this.state)==null?void 0:r.show)||b.referencePos.toJSON()!==((o=this.state)==null?void 0:o.referencePos.toJSON()))&&(this.state=b,this.emitUpdate());return}if((s=this.state)!=null&&s.show&&!this.preventHide&&(!p||this.preventShow||!this.editor.isEditable)){this.state.show=!1,this.emitUpdate();return}}destroy(){this.pmView.dom.removeEventListener("mousedown",this.viewMousedownHandler),this.pmView.root.removeEventListener("mouseup",this.mouseupHandler),this.pmView.dom.removeEventListener("dragstart",this.dragHandler),this.pmView.dom.removeEventListener("dragover",this.dragHandler),this.pmView.dom.removeEventListener("blur",this.blurHandler),this.pmView.root.removeEventListener("scroll",this.scrollHandler,!0)}getSelectionBoundingBox(){const{state:e}=this.pmView,{selection:n}=e,{ranges:r}=n,o=Math.min(...r.map(i=>i.$from.pos)),s=Math.max(...r.map(i=>i.$to.pos));if(pw(n)){const i=this.pmView.nodeDOM(o);if(i)return i.getBoundingClientRect()}return cg(this.pmView,o,s)}}const roe=new We("FormattingToolbarPlugin");class ooe extends wn{constructor(e){super(),L(this,"view"),L(this,"closeMenu",()=>this.view.closeMenu()),this.addProsemirrorPlugin(new Re({key:roe,view:n=>(this.view=new noe(e,n,r=>{this.emit("update",r)}),this.view),props:{handleKeyDown:(n,r)=>r.key==="Escape"&&this.shown?(this.view.closeMenu(),!0):!1}}))}static key(){return"formattingToolbar"}get shown(){var e,n;return((n=(e=this.view)==null?void 0:e.state)==null?void 0:n.show)||!1}onUpdate(e){return this.on("update",e)}}const soe=cs.create({name:"hardBreak",inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,priority:10,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",_r(this.options.HTMLAttributes,t)]},renderText(){return`
`}}),CI=(t,e)=>{const n=t.resolve(e);if(n.depth<=1)return;const r=n.posAtIndex(n.index(n.depth-1),n.depth-1);return Ef(t.resolve(r))},Im=(t,e)=>{const n=t.resolve(e),r=n.index();if(r===0)return;const o=n.posAtIndex(r-1);return Ef(t.resolve(o))},c5=(t,e)=>{for(;e.childContainer;){const n=e.childContainer.node,r=t.resolve(e.childContainer.beforePos+1).posAtIndex(n.childCount-1);e=Ef(t.resolve(r))}return e},ioe=(t,e)=>t.isBlockContainer&&t.blockContent.node.type.spec.content==="inline*"&&t.blockContent.node.childCount>0&&e.isBlockContainer&&e.blockContent.node.type.spec.content==="inline*",aoe=(t,e,n,r)=>{if(!r.isBlockContainer)throw new Error(`Attempted to merge block at position ${r.bnBlock.beforePos} into previous block at position ${n.bnBlock.beforePos}, but next block is not a block container`);if(r.childContainer){const o=t.doc.resolve(r.childContainer.beforePos+1),s=t.doc.resolve(r.childContainer.afterPos-1),i=o.blockRange(s);if(e){const a=t.doc.resolve(r.bnBlock.beforePos);t.tr.lift(i,a.depth)}}if(e){if(!n.isBlockContainer)throw new Error(`Attempted to merge block at position ${r.bnBlock.beforePos} into previous block at position ${n.bnBlock.beforePos}, but previous block is not a block container`);e(t.tr.delete(n.blockContent.afterPos-1,r.blockContent.beforePos+1))}return!0},xI=t=>({state:e,dispatch:n})=>{const r=e.doc.resolve(t),o=Ef(r),s=Im(e.doc,o.bnBlock.beforePos);if(!s)return!1;const i=c5(e.doc,s);return ioe(i,o)?aoe(e,n,i,o):!1},loe=at.create({priority:50,addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({chain:r,commands:o})=>[()=>o.deleteSelection(),()=>o.undoInputRule(),()=>o.command(({state:s})=>{const i=ct(s);if(!i.isBlockContainer)return!1;const a=s.selection.from===i.blockContent.beforePos+1,l=i.blockContent.node.type.name==="paragraph";return a&&!l?o.command(yn(i.bnBlock.beforePos,{type:"paragraph",props:{}})):!1}),()=>o.command(({state:s})=>{const i=ct(s);if(!i.isBlockContainer)return!1;const{blockContent:a}=i;return s.selection.from===a.beforePos+1?o.liftListItem("blockContainer"):!1}),()=>o.command(({state:s})=>{const i=ct(s);if(!i.isBlockContainer)return!1;const{bnBlock:a,blockContent:l}=i,c=s.selection.from===l.beforePos+1,u=s.selection.empty,d=a.beforePos;return c&&u?r().command(xI(d)).scrollIntoView().run():!1}),()=>o.command(({state:s,dispatch:i})=>{const a=ct(s);if(!a.isBlockContainer||s.selection.from!==a.blockContent.beforePos+1||Im(s.doc,a.bnBlock.beforePos))return!1;const l=CI(s.doc,a.bnBlock.beforePos);if((l==null?void 0:l.blockNoteType)!=="column")return!1;const c=l,u=CI(s.doc,c.bnBlock.beforePos);if((u==null?void 0:u.blockNoteType)!=="columnList")throw new Error("parent of column is not a column list");const d=c.childContainer.node.childCount===1,h=d&&u.childContainer.node.childCount===2,f=u.childContainer.node.firstChild===c.bnBlock.node;if(i){const p=s.doc.slice(a.bnBlock.beforePos,a.bnBlock.afterPos,!1);if(h)if(f){s.tr.step(new Nt(u.bnBlock.beforePos,u.bnBlock.afterPos,c.bnBlock.afterPos+1,u.bnBlock.afterPos-2,p,p.size,!1));const y=s.tr.doc.resolve(c.bnBlock.beforePos);s.tr.setSelection(ee.between(y,y))}else{s.tr.step(new Nt(u.bnBlock.beforePos,u.bnBlock.afterPos,u.bnBlock.beforePos+2,c.bnBlock.beforePos-1,p,0,!1));const y=s.tr.doc.resolve(s.tr.mapping.map(c.bnBlock.beforePos-1));s.tr.setSelection(ee.between(y,y))}else if(d)if(f){s.tr.delete(c.bnBlock.beforePos,c.bnBlock.afterPos),s.tr.insert(u.bnBlock.beforePos,p.content);const y=s.tr.doc.resolve(u.bnBlock.beforePos);s.tr.setSelection(ee.between(y,y))}else s.tr.delete(c.bnBlock.beforePos-1,c.bnBlock.beforePos+1);else{s.tr.delete(a.bnBlock.beforePos,a.bnBlock.afterPos),f?s.tr.insert(u.bnBlock.beforePos-1,p.content):s.tr.insert(c.bnBlock.beforePos-1,p.content);const y=s.tr.doc.resolve(c.bnBlock.beforePos-1);s.tr.setSelection(ee.between(y,y))}}return!0}),()=>o.command(({state:s})=>{const i=ct(s);if(!i.isBlockContainer)return!1;if(i.blockContent.node.childCount===0&&i.blockContent.node.type.spec.content==="inline*"){const a=Im(s.doc,i.bnBlock.beforePos);if(!a||!a.isBlockContainer)return!1;let l=r();if(a.blockContent.node.type.spec.content==="tableRow+"){const c=i.bnBlock.beforePos-1-1-1-1-1;l=l.setTextSelection(c)}else if(a.blockContent.node.type.spec.content===""){const c=a.blockContent.afterPos-a.blockContent.node.nodeSize;l=l.setNodeSelection(c)}else{const c=a.blockContent.afterPos-a.blockContent.node.nodeSize;l=l.setTextSelection(c)}return l.deleteRange({from:i.bnBlock.beforePos,to:i.bnBlock.afterPos}).scrollIntoView().run()}return!1}),()=>o.command(({state:s})=>{const i=ct(s);if(!i.isBlockContainer)throw new Error("todo");const a=s.selection.from===i.blockContent.beforePos+1,l=s.selection.empty,c=Im(s.doc,i.bnBlock.beforePos);if(c&&a&&l){const u=c5(s.doc,c);if(!u.isBlockContainer)throw new Error("todo");if(u.blockContent.node.type.spec.content===""||u.blockContent.node.type.spec.content==="inline*"&&u.blockContent.node.childCount===0)return r().cut({from:i.bnBlock.beforePos,to:i.bnBlock.afterPos},u.bnBlock.afterPos).deleteRange({from:u.bnBlock.beforePos,to:u.bnBlock.afterPos}).run()}return!1})]),e=()=>this.editor.commands.first(({commands:r})=>[()=>r.deleteSelection(),()=>r.command(({state:o})=>{const s=ct(o);if(!s.isBlockContainer)return!1;const{bnBlock:i,blockContent:a,childContainer:l}=s,{depth:c}=o.doc.resolve(i.beforePos),u=i.afterPos===o.doc.nodeSize-3,d=o.selection.from===a.afterPos-1,h=o.selection.empty;if(!u&&d&&h&&l===void 0){let f=c,p=i.afterPos+1,y=o.doc.resolve(p).depth;for(;y<f;)f=y,p+=2,y=o.doc.resolve(p).depth;return r.command(xI(p-1))}return!1})]),n=(r=!1)=>this.editor.commands.first(({commands:o})=>[()=>o.command(({state:s})=>{const i=ct(s);if(!i.isBlockContainer)return!1;const{bnBlock:a,blockContent:l}=i,{depth:c}=s.doc.resolve(a.beforePos),u=s.selection.$anchor.parentOffset===0,d=s.selection.anchor===s.selection.head,h=l.node.childCount===0,f=c>1;return u&&d&&h&&f?o.liftListItem("blockContainer"):!1}),()=>o.command(({state:s})=>{const i=ct(s),a=this.options.editor.schema.blockSchema[i.blockNoteType].hardBreakShortcut??"shift+enter";return a==="none"?!1:a==="shift+enter"&&r||a==="enter"?o.insertContent({type:"hardBreak"}):!1}),()=>o.command(({state:s,dispatch:i})=>{const a=ct(s);if(!a.isBlockContainer)return!1;const{bnBlock:l,blockContent:c}=a,u=s.selection.$anchor.parentOffset===0,d=s.selection.anchor===s.selection.head,h=c.node.childCount===0;if(u&&d&&h){const f=l.afterPos,p=f+2;if(i){const y=s.schema.nodes.blockContainer.createAndFill();s.tr.insert(f,y).scrollIntoView(),s.tr.setSelection(new ee(s.doc.resolve(p)))}return!0}return!1}),()=>o.command(({state:s,chain:i})=>{const a=ct(s);if(!a.isBlockContainer)return!1;const{blockContent:l}=a,c=s.selection.$anchor.parentOffset===0;return l.node.childCount===0?!1:(i().deleteSelection().command($L(s.selection.from,c,c)).run(),!0)})]);return{Backspace:t,Delete:e,Enter:()=>n(),"Shift-Enter":()=>n(!0),Tab:()=>{var r,o,s;return this.options.tabBehavior!=="prefer-indent"&&((r=this.options.editor.formattingToolbar)!=null&&r.shown||(o=this.options.editor.linkToolbar)!=null&&o.shown||(s=this.options.editor.filePanel)!=null&&s.shown)?!1:JL(this.options.editor)},"Shift-Tab":()=>{var r,o,s;return this.options.tabBehavior!=="prefer-indent"&&((r=this.options.editor.formattingToolbar)!=null&&r.shown||(o=this.options.editor.linkToolbar)!=null&&o.shown||(s=this.options.editor.filePanel)!=null&&s.shown)?!1:(this.editor.commands.liftListItem("blockContainer"),!0)},"Shift-Mod-ArrowUp":()=>(this.options.editor.moveBlocksUp(),!0),"Shift-Mod-ArrowDown":()=>(this.options.editor.moveBlocksDown(),!0),"Mod-z":()=>this.options.editor.undo(),"Mod-y":()=>this.options.editor.redo(),"Shift-Mod-z":()=>this.options.editor.redo()}}});class coe{constructor(e,n,r){L(this,"state"),L(this,"emitUpdate"),L(this,"menuUpdateTimer"),L(this,"startMenuUpdateTimer"),L(this,"stopMenuUpdateTimer"),L(this,"mouseHoveredLinkMark"),L(this,"mouseHoveredLinkMarkRange"),L(this,"keyboardHoveredLinkMark"),L(this,"keyboardHoveredLinkMarkRange"),L(this,"linkMark"),L(this,"linkMarkRange"),L(this,"mouseOverHandler",o=>{if(this.mouseHoveredLinkMark=void 0,this.mouseHoveredLinkMarkRange=void 0,this.stopMenuUpdateTimer(),o.target instanceof HTMLAnchorElement&&o.target.nodeName==="A"){const s=o.target,i=this.pmView.posAtDOM(s,0)+1,a=this.pmView.state.doc.resolve(i),l=a.marks();for(const c of l)if(c.type.name===this.pmView.state.schema.mark("link").type.name){this.mouseHoveredLinkMark=c,this.mouseHoveredLinkMarkRange=ph(a,c.type,c.attrs)||void 0;break}}return this.startMenuUpdateTimer(),!1}),L(this,"clickHandler",o=>{var s;const i=this.pmView.dom.parentElement;this.linkMark&&o&&o.target&&!(i===o.target||i.contains(o.target))&&(s=this.state)!=null&&s.show&&(this.state.show=!1,this.emitUpdate())}),L(this,"scrollHandler",()=>{var o;this.linkMark!==void 0&&(o=this.state)!=null&&o.show&&(this.state.referencePos=cg(this.pmView,this.linkMarkRange.from,this.linkMarkRange.to),this.emitUpdate())}),L(this,"closeMenu",()=>{var o;(o=this.state)!=null&&o.show&&(this.state.show=!1,this.emitUpdate())}),this.editor=e,this.pmView=n,this.emitUpdate=()=>{if(!this.state)throw new Error("Attempting to update uninitialized link toolbar");r(this.state)},this.startMenuUpdateTimer=()=>{this.menuUpdateTimer=setTimeout(()=>{this.update(this.pmView,void 0,!0)},250)},this.stopMenuUpdateTimer=()=>(this.menuUpdateTimer&&(clearTimeout(this.menuUpdateTimer),this.menuUpdateTimer=void 0),!1),this.pmView.dom.addEventListener("mouseover",this.mouseOverHandler),this.pmView.root.addEventListener("click",this.clickHandler,!0),this.pmView.root.addEventListener("scroll",this.scrollHandler,!0)}editLink(e,n){var r;this.editor.transact(o=>{const s=rn(o);o.insertText(n,this.linkMarkRange.from,this.linkMarkRange.to),o.addMark(this.linkMarkRange.from,this.linkMarkRange.from+n.length,s.mark("link",{href:e}))}),this.pmView.focus(),(r=this.state)!=null&&r.show&&(this.state.show=!1,this.emitUpdate())}deleteLink(){var e;this.editor.transact(n=>n.removeMark(this.linkMarkRange.from,this.linkMarkRange.to,this.linkMark.type).setMeta("preventAutolink",!0)),this.pmView.focus(),(e=this.state)!=null&&e.show&&(this.state.show=!1,this.emitUpdate())}update(e,n,r=!1){var o;const{state:s}=e;if(n&&n.selection.from===s.selection.from&&n.selection.to===s.selection.to||!this.pmView.hasFocus())return;const i=this.linkMark;if(this.linkMark=void 0,this.linkMarkRange=void 0,this.keyboardHoveredLinkMark=void 0,this.keyboardHoveredLinkMarkRange=void 0,this.pmView.state.selection.empty){const a=this.pmView.state.selection.$from.marks();for(const l of a)if(l.type.name===this.pmView.state.schema.mark("link").type.name){this.keyboardHoveredLinkMark=l,this.keyboardHoveredLinkMarkRange=ph(this.pmView.state.selection.$from,l.type,l.attrs)||void 0;break}}if(this.mouseHoveredLinkMark&&r&&(this.linkMark=this.mouseHoveredLinkMark,this.linkMarkRange=this.mouseHoveredLinkMarkRange),this.keyboardHoveredLinkMark&&(this.linkMark=this.keyboardHoveredLinkMark,this.linkMarkRange=this.keyboardHoveredLinkMarkRange),this.linkMark&&this.editor.isEditable){this.state={show:!0,referencePos:cg(this.pmView,this.linkMarkRange.from,this.linkMarkRange.to),url:this.linkMark.attrs.href,text:this.pmView.state.doc.textBetween(this.linkMarkRange.from,this.linkMarkRange.to)},this.emitUpdate();return}if((o=this.state)!=null&&o.show&&i&&(!this.linkMark||!this.editor.isEditable)){this.state.show=!1,this.emitUpdate();return}}destroy(){this.pmView.dom.removeEventListener("mouseover",this.mouseOverHandler),this.pmView.root.removeEventListener("scroll",this.scrollHandler,!0),this.pmView.root.removeEventListener("click",this.clickHandler,!0)}}const uoe=new We("LinkToolbarPlugin");class doe extends wn{constructor(e){super(),L(this,"view"),L(this,"editLink",(n,r)=>{this.view.editLink(n,r)}),L(this,"deleteLink",()=>{this.view.deleteLink()}),L(this,"startHideTimer",()=>{this.view.startMenuUpdateTimer()}),L(this,"stopHideTimer",()=>{this.view.stopMenuUpdateTimer()}),L(this,"closeMenu",()=>this.view.closeMenu()),this.addProsemirrorPlugin(new Re({key:uoe,view:n=>(this.view=new coe(e,n,r=>{this.emit("update",r)}),this.view),props:{handleKeyDown:(n,r)=>r.key==="Escape"&&this.shown?(this.view.closeMenu(),!0):!1}}))}static key(){return"linkToolbar"}onUpdate(e){return this.on("update",e)}get shown(){var e,n;return((n=(e=this.view)==null?void 0:e.state)==null?void 0:n.show)||!1}}const u5=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"],d5="https",hoe=new We("node-selection-keyboard");class foe extends wn{static key(){return"nodeSelectionKeyboard"}constructor(){super(),this.addProsemirrorPlugin(new Re({key:hoe,props:{handleKeyDown:(e,n)=>{if("node"in e.state.selection){if(n.ctrlKey||n.metaKey)return!1;if(n.key.length===1)return n.preventDefault(),!0;if(n.key==="Enter"&&!n.shiftKey&&!n.altKey&&!n.ctrlKey&&!n.metaKey){const r=e.state.tr;return e.dispatch(r.insert(e.state.tr.selection.$to.after(),e.state.schema.nodes.paragraph.createChecked()).setSelection(new ee(r.doc.resolve(e.state.tr.selection.$to.after()+1)))),!0}}return!1}}}))}}const poe=new We("blocknote-placeholder");class moe extends wn{static key(){return"placeholder"}constructor(e,n){super(),this.addProsemirrorPlugin(new Re({key:poe,view:r=>{var o,s;const i=`placeholder-selector-${jO()}`;r.dom.classList.add(i);const a=document.createElement("style"),l=e._tiptapEditor.options.injectNonce;l&&a.setAttribute("nonce",l),((o=e.prosemirrorView)==null?void 0:o.root)instanceof ShadowRoot?e.prosemirrorView.root.append(a):(s=e.prosemirrorView)==null||s.root.head.appendChild(a);const c=a.sheet,u=(d="")=>`.${i} .bn-block-content${d} .bn-inline-content:has(> .ProseMirror-trailingBreak:only-child):before`;try{const{default:d,emptyDocument:h,...f}=n;for(const[b,w]of Object.entries(f)){const k=`[data-content-type="${b}"]`;c.insertRule(`${u(k)} { content: ${JSON.stringify(w)}; }`)}c.insertRule(`${u("[data-is-only-empty-block]")} { content: ${JSON.stringify(h)}; }`),c.insertRule(`${u("[data-is-empty-and-focused]")} { content: ${JSON.stringify(d)}; }`)}catch(d){console.warn("Failed to insert placeholder CSS rule - this is likely due to the browser not supporting certain CSS pseudo-element selectors (:has, :only-child:, or :before)",d)}return{destroy:()=>{var d,h;((d=e.prosemirrorView)==null?void 0:d.root)instanceof ShadowRoot?e.prosemirrorView.root.removeChild(a):(h=e.prosemirrorView)==null||h.root.head.removeChild(a)}}},props:{decorations:r=>{const{doc:o,selection:s}=r;if(!e.isEditable||!s.empty||s.$from.parent.type.spec.code)return;const i=[];r.doc.content.size===6&&i.push(et.node(2,4,{"data-is-only-empty-block":"true"}));const a=s.$anchor,l=a.parent;if(l.content.size===0){const c=a.before();i.push(et.node(c,c+l.nodeSize,{"data-is-empty-and-focused":"true"}))}return Oe.create(o,i)}}}))}}const kI=new We("previous-blocks"),goe={index:"index",level:"level",type:"type",depth:"depth","depth-change":"depth-change"};class yoe extends wn{static key(){return"previousBlockType"}constructor(){super();let e;this.addProsemirrorPlugin(new Re({key:kI,view(n){return{update:async(r,o)=>{var s;((s=this.key)==null?void 0:s.getState(r.state).updatedBlocks.size)>0&&(e=setTimeout(()=>{r.dispatch(r.state.tr.setMeta(kI,{clearUpdate:!0}))},0))},destroy:()=>{e&&clearTimeout(e)}}},state:{init(){return{prevTransactionOldBlockAttrs:{},currentTransactionOldBlockAttrs:{},updatedBlocks:new Set}},apply(n,r,o,s){if(r.currentTransactionOldBlockAttrs={},r.updatedBlocks.clear(),!n.docChanged||o.doc.eq(s.doc))return r;const i={},a=sA(o.doc,u=>u.attrs.id),l=new Map(a.map(u=>[u.node.attrs.id,u])),c=sA(s.doc,u=>u.attrs.id);for(const u of c){const d=l.get(u.node.attrs.id),h=d==null?void 0:d.node.firstChild,f=u.node.firstChild;if(d&&h&&f){const p={index:f.attrs.index,level:f.attrs.level,type:f.type.name,depth:s.doc.resolve(u.pos).depth};let y={index:h.attrs.index,level:h.attrs.level,type:h.type.name,depth:o.doc.resolve(d.pos).depth};i[u.node.attrs.id]=y,n.getMeta("numberedListIndexing")&&(u.node.attrs.id in r.prevTransactionOldBlockAttrs&&(y=r.prevTransactionOldBlockAttrs[u.node.attrs.id]),p.type==="numberedListItem"&&(y.index=p.index)),r.currentTransactionOldBlockAttrs[u.node.attrs.id]=y,JSON.stringify(y)!==JSON.stringify(p)&&(y["depth-change"]=y.depth-p.depth,r.updatedBlocks.add(u.node.attrs.id))}}return r.prevTransactionOldBlockAttrs=i,r}},props:{decorations(n){const r=this.getState(n);if(r.updatedBlocks.size===0)return;const o=[];return n.doc.descendants((s,i)=>{if(!s.attrs.id||!r.updatedBlocks.has(s.attrs.id))return;const a=r.currentTransactionOldBlockAttrs[s.attrs.id],l={};for(const[u,d]of Object.entries(a))l["data-prev-"+goe[u]]=d||"none";const c=et.node(i,i+s.nodeSize,{...l});o.push(c)}),Oe.create(n.doc,o)}}}))}}const SI=new We("blocknote-show-selection");class boe extends wn{constructor(e){super(),L(this,"enabled",!1),this.editor=e,this.addProsemirrorPlugin(new Re({key:SI,props:{decorations:n=>{const{doc:r,selection:o}=n;if(!this.enabled)return Oe.empty;const s=et.inline(o.from,o.to,{"data-show-selection":"true"});return Oe.create(r,[s])}}}))}static key(){return"showSelection"}setEnabled(e){this.enabled!==e&&(this.enabled=e,this.editor.transact(n=>n.setMeta(SI,{})))}getEnabled(){return this.enabled}}function h5(t,e){for(var n,r;t&&t.parentElement&&t.parentElement!==e.dom&&((n=t.getAttribute)==null?void 0:n.call(t,"data-node-type"))!=="blockContainer";)t=t.parentElement;if(((r=t.getAttribute)==null?void 0:r.call(t,"data-node-type"))==="blockContainer")return{node:t,id:t.getAttribute("data-id")}}class dl extends fe{constructor(e,n){super(e,n),L(this,"nodes");const r=e.node();this.nodes=[],e.doc.nodesBetween(e.pos,n.pos,(o,s,i)=>{if(i!==null&&i.eq(r))return this.nodes.push(o),!1})}static create(e,n,r=n){return new dl(e.resolve(n),e.resolve(r))}content(){return new G(B.from(this.nodes),0,0)}eq(e){if(!(e instanceof dl)||this.nodes.length!==e.nodes.length||this.from!==e.from||this.to!==e.to)return!1;for(let n=0;n<this.nodes.length;n++)if(!this.nodes[n].eq(e.nodes[n]))return!1;return!0}map(e,n){const r=n.mapResult(this.from),o=n.mapResult(this.to);return o.deleted?fe.near(e.resolve(r.pos)):r.deleted?fe.near(e.resolve(o.pos)):new dl(e.resolve(r.pos),e.resolve(o.pos))}toJSON(){return{type:"multiple-node",anchor:this.anchor,head:this.head}}}fe.jsonID("multiple-node",dl);let uo;function voe(t,e){let n,r;const o=e.resolve(t.from).node().type.spec.group==="blockContent",s=e.resolve(t.to).node().type.spec.group==="blockContent",i=Math.min(t.$anchor.depth,t.$head.depth);if(o&&s){const a=t.$from.start(i-1),l=t.$to.end(i-1);n=e.resolve(a-1).pos,r=e.resolve(l+1).pos}else n=t.from,r=t.to;return{from:n,to:r}}function EI(t,e,n=e){e===n&&(n+=t.state.doc.resolve(e+1).node().nodeSize);const r=t.domAtPos(e).node.cloneNode(!0),o=t.domAtPos(e).node,s=(u,d)=>Array.prototype.indexOf.call(u.children,d),i=s(o,t.domAtPos(e+1).node.parentElement),a=s(o,t.domAtPos(n-1).node.parentElement);for(let u=o.childElementCount-1;u>=0;u--)(u>a||u<i)&&r.removeChild(r.children[u]);f5(t.root),uo=r;const l=uo.getElementsByTagName("iframe");for(let u=0;u<l.length;u++){const d=l[u],h=d.parentElement;h&&h.removeChild(d)}const c=t.dom.className.split(" ").filter(u=>u!=="ProseMirror"&&u!=="bn-root"&&u!=="bn-editor").join(" ");uo.className=uo.className+" bn-drag-preview "+c,t.root instanceof ShadowRoot?t.root.appendChild(uo):t.root.body.appendChild(uo)}function f5(t){uo!==void 0&&(t instanceof ShadowRoot?t.removeChild(uo):t.body.removeChild(uo),uo=void 0)}function woe(t,e,n){if(!t.dataTransfer)return;const r=n.prosemirrorView;if(!r)return;const o=Ir(e.id,r.state.doc);if(!o)throw new Error(`Block with ID ${e.id} not found`);const s=o.posBeforeNode;if(s!=null){const i=r.state.selection,a=r.state.doc,{from:l,to:c}=voe(i,a),u=l<=s&&s<c,d=i.$anchor.node()!==i.$head.node()||i instanceof dl;u&&d?(r.dispatch(r.state.tr.setSelection(dl.create(a,l,c))),EI(r,l,c)):(r.dispatch(r.state.tr.setSelection(se.create(r.state.doc,s))),EI(r,s));const h=r.state.selection.content(),f=n.pmSchema,p=r.serializeForClipboard(h).dom.innerHTML,y=vb(f,n),b=r5(h.content),w=y.exportBlocks(b,{}),k=Kk(w);t.dataTransfer.clearData(),t.dataTransfer.setData("blocknote/html",p),t.dataTransfer.setData("text/html",w),t.dataTransfer.setData("text/plain",k),t.dataTransfer.effectAllowed="move",t.dataTransfer.setDragImage(uo,0,0)}}const ed=.1;function eC(t,e,n,r=!0){const o=t.root.elementsFromPoint(e.left+(n==="editor"?50:0),e.top);for(const s of o)if(t.dom.contains(s))return r&&s.closest("[data-node-type=columnList]")?eC(t,{left:e.left+50,top:e.top},n,!1):h5(s,t)}function Coe(t,e,n){if(!e.dom.firstChild)return;const r=e.dom.firstChild.getBoundingClientRect(),o={left:t.x,top:t.y},s=o.left<r.left,i=o.left>r.right;n==="viewport"&&(s&&(o.left=r.left+10),i&&(o.left=r.right-10));let a=eC(e,o,n);if(!i&&a){const l=a.node.getBoundingClientRect();o.left=l.right-10,a=eC(e,o,"viewport",!1)}return a}class xoe{constructor(e,n,r,o){L(this,"state"),L(this,"emitUpdate"),L(this,"mousePos"),L(this,"hoveredBlock"),L(this,"menuFrozen",!1),L(this,"isDragOrigin",!1),L(this,"updateState",s=>{this.state=s,this.emitUpdate(this.state)}),L(this,"updateStateFromMousePos",()=>{var s,i,a,l;if(this.menuFrozen||!this.mousePos)return;const c=Coe(this.mousePos,this.pmView,this.sideMenuDetection);if(!c||!this.editor.isEditable){(s=this.state)!=null&&s.show&&(this.state.show=!1,this.updateState(this.state));return}if((i=this.state)!=null&&i.show&&(a=this.hoveredBlock)!=null&&a.hasAttribute("data-id")&&((l=this.hoveredBlock)==null?void 0:l.getAttribute("data-id"))===c.id)return;this.hoveredBlock=c.node;const u=c.node.firstChild;if(u&&this.editor.isEditable){const d=u.getBoundingClientRect(),h=c.node.closest("[data-node-type=column]");this.updateState({show:!0,referencePos:new DOMRect(h?h.firstElementChild.getBoundingClientRect().x:this.pmView.dom.firstChild.getBoundingClientRect().x,d.y,d.width,d.height),block:this.editor.getBlock(this.hoveredBlock.getAttribute("data-id"))})}}),L(this,"onDrop",s=>{var i,a;if(this.pmView.dragging===null)return;this.editor._tiptapEditor.commands.blur();const l=s.target instanceof Node&&((i=s.target instanceof HTMLElement?s.target:s.target.parentElement)==null?void 0:i.closest(".bn-editor"))||null;if(l&&(!this.isDragOrigin&&this.pmView.dom===l?this.pmView.dispatch(this.pmView.state.tr.setSelection(ee.create(this.pmView.state.tr.doc,this.pmView.state.tr.selection.to))):this.isDragOrigin&&this.pmView.dom!==l&&setTimeout(()=>this.pmView.dispatch(this.pmView.state.tr.deleteSelection()),0)),this.sideMenuDetection==="editor"||s.synthetic||!((a=s.dataTransfer)!=null&&a.types.includes("blocknote/html")))return;const c=this.pmView.posAtCoords({left:s.clientX,top:s.clientY});if(!c||c.inside===-1){const u=this.createSyntheticEvent(s);this.pmView.dom.dispatchEvent(u)}}),L(this,"onDragEnd",()=>{this.pmView.dragging=null}),L(this,"onDragStart",s=>{var i;const a=(i=s.dataTransfer)==null?void 0:i.getData("blocknote/html");if(!a)return;if(this.pmView.dragging)throw new Error("New drag was started while an existing drag is ongoing");const l=document.createElement("div");l.innerHTML=a;const c=Ls.fromSchema(this.pmView.state.schema).parse(l,{topNode:this.pmView.state.schema.nodes.blockGroup.create()});this.pmView.dragging={slice:new G(c.content,0,0),move:!0}}),L(this,"onDragOver",s=>{var i;if(this.sideMenuDetection==="editor"||s.synthetic||!((i=s.dataTransfer)!=null&&i.types.includes("blocknote/html")))return;const a=this.pmView.posAtCoords({left:s.clientX,top:s.clientY});if(!a||a.inside===-1&&this.pmView.dom.firstChild){const l=this.createSyntheticEvent(s);this.pmView.dom.dispatchEvent(l)}}),L(this,"onKeyDown",s=>{var i;(i=this.state)!=null&&i.show&&this.editor.isFocused()&&(this.state.show=!1,this.emitUpdate(this.state))}),L(this,"onMouseMove",s=>{var i;if(this.menuFrozen)return;this.mousePos={x:s.clientX,y:s.clientY};const a=this.pmView.dom.getBoundingClientRect(),l=this.mousePos.x>a.left&&this.mousePos.x<a.right&&this.mousePos.y>a.top&&this.mousePos.y<a.bottom,c=this.pmView.dom.parentElement;if(l&&s&&s.target&&!(c===s.target||c.contains(s.target))){(i=this.state)!=null&&i.show&&(this.state.show=!1,this.emitUpdate(this.state));return}this.updateStateFromMousePos()}),L(this,"onScroll",()=>{var s;(s=this.state)!=null&&s.show&&(this.state.referencePos=this.hoveredBlock.getBoundingClientRect(),this.emitUpdate(this.state))}),this.editor=e,this.sideMenuDetection=n,this.pmView=r,this.emitUpdate=()=>{if(!this.state)throw new Error("Attempting to update uninitialized side menu");o(this.state)},this.pmView.root.addEventListener("dragstart",this.onDragStart),this.pmView.root.addEventListener("dragover",this.onDragOver),this.pmView.root.addEventListener("drop",this.onDrop,!0),this.pmView.root.addEventListener("dragend",this.onDragEnd,!0),Gk(),this.pmView.root.addEventListener("mousemove",this.onMouseMove,!0),this.pmView.root.addEventListener("keydown",this.onKeyDown,!0),r.root.addEventListener("scroll",this.onScroll,!0)}createSyntheticEvent(e){const n=new Event(e.type,e),r=this.pmView.dom.firstChild.getBoundingClientRect();return n.clientX=e.clientX,n.clientY=e.clientY,e.clientX<r.left&&e.clientX>r.left-r.width*ed?n.clientX=r.left+r.width*ed/2:e.clientX>r.right&&e.clientX<r.right+r.width*ed?n.clientX=r.right-r.width*ed/2:(e.clientX<r.left||e.clientX>r.right)&&(n.clientX=r.left+ed*r.width*2),n.clientY=Math.min(Math.max(e.clientY,r.top),r.top+r.height),n.dataTransfer=e.dataTransfer,n.preventDefault=()=>e.preventDefault(),n.synthetic=!0,n}update(e,n){var r;!n.doc.eq(this.pmView.state.doc)&&(r=this.state)!=null&&r.show&&this.updateStateFromMousePos()}destroy(){var e;(e=this.state)!=null&&e.show&&(this.state.show=!1,this.emitUpdate(this.state)),this.pmView.root.removeEventListener("mousemove",this.onMouseMove,!0),this.pmView.root.removeEventListener("dragstart",this.onDragStart),this.pmView.root.removeEventListener("dragover",this.onDragOver),this.pmView.root.removeEventListener("drop",this.onDrop,!0),this.pmView.root.removeEventListener("dragend",this.onDragEnd,!0),this.pmView.root.removeEventListener("keydown",this.onKeyDown,!0),this.pmView.root.removeEventListener("scroll",this.onScroll,!0)}}const koe=new We("SideMenuPlugin");class Soe extends wn{constructor(e,n){super(),L(this,"view"),L(this,"blockDragStart",(r,o)=>{this.view&&(this.view.isDragOrigin=!0),woe(r,o,this.editor)}),L(this,"blockDragEnd",()=>{this.editor.prosemirrorView&&f5(this.editor.prosemirrorView.root),this.view&&(this.view.isDragOrigin=!1)}),L(this,"freezeMenu",()=>{this.view.menuFrozen=!0,this.view.state.show=!0,this.view.emitUpdate(this.view.state)}),L(this,"unfreezeMenu",()=>{this.view.menuFrozen=!1,this.view.state.show=!1,this.view.emitUpdate(this.view.state)}),this.editor=e,this.addProsemirrorPlugin(new Re({key:koe,view:r=>(this.view=new xoe(e,n,r,o=>{this.emit("update",o)}),this.view)}))}static key(){return"sideMenu"}onUpdate(e){return this.on("update",e)}}const Hp=new Map;function Eoe(t){if(Hp.has(t))return Hp.get(t);const e=new Pc;return t._tiptapEditor.on("transaction",({transaction:n})=>{e.appendMapping(n.mapping)}),t._tiptapEditor.on("destroy",()=>{Hp.delete(t)}),Hp.set(t,e),e}function Toe(t,e,n="left"){const r=Ke.getState(t._tiptapEditor.state);if(!r){const s=Eoe(t),i=s.maps.length;return()=>s.slice(i).map(e,n==="left"?-1:1)}const o=Ih(e+(n==="right"?1:0),r.binding.type,r.binding.mapping);return()=>{const s=Ke.getState(t._tiptapEditor.state),i=ul(s.doc,s.binding.type,o,s.binding.mapping);if(i===null)throw new Error("Position not found, cannot track positions");return i+(n==="right"?-1:0)}}const _oe=sb(t=>t.type.name==="blockContainer");class Aoe{constructor(e,n){L(this,"state"),L(this,"emitUpdate"),L(this,"rootEl"),L(this,"pluginState"),L(this,"handleScroll",()=>{var s,i;if((s=this.state)!=null&&s.show){const a=(i=this.rootEl)==null?void 0:i.querySelector(`[data-decoration-id="${this.pluginState.decorationId}"]`);if(!a)return;this.state.referencePos=a.getBoundingClientRect(),this.emitUpdate(this.pluginState.triggerCharacter)}}),L(this,"closeMenu",()=>{this.editor.transact(s=>s.setMeta(Ec,null))}),L(this,"clearQuery",()=>{this.pluginState!==void 0&&this.editor._tiptapEditor.chain().focus().deleteRange({from:this.pluginState.queryStartPos()-(this.pluginState.deleteTriggerCharacter?this.pluginState.triggerCharacter.length:0),to:this.editor.transact(s=>s.selection.from)}).run()});var r,o;this.editor=e,this.pluginState=void 0,this.emitUpdate=s=>{var i;if(!this.state)throw new Error("Attempting to update uninitialized suggestions menu");n(s,{...this.state,ignoreQueryLength:(i=this.pluginState)==null?void 0:i.ignoreQueryLength})},this.rootEl=(r=this.editor.prosemirrorView)==null?void 0:r.root,(o=this.rootEl)==null||o.addEventListener("scroll",this.handleScroll,!0)}update(e,n){var r;const o=Ec.getState(n),s=Ec.getState(e.state),i=o===void 0&&s!==void 0,a=o!==void 0&&s===void 0;if(!i&&!(o!==void 0&&s!==void 0)&&!a)return;if(this.pluginState=a?o:s,a||!this.editor.isEditable){this.state&&(this.state.show=!1),this.emitUpdate(this.pluginState.triggerCharacter);return}const l=(r=this.rootEl)==null?void 0:r.querySelector(`[data-decoration-id="${this.pluginState.decorationId}"]`);this.editor.isEditable&&l&&(this.state={show:!0,referencePos:l.getBoundingClientRect(),query:this.pluginState.query},this.emitUpdate(this.pluginState.triggerCharacter))}destroy(){var e;(e=this.rootEl)==null||e.removeEventListener("scroll",this.handleScroll,!0)}}const Ec=new We("SuggestionMenuPlugin");class Ioe extends wn{constructor(e){super(),L(this,"view"),L(this,"triggerCharacters",[]),L(this,"addTriggerCharacter",r=>{this.triggerCharacters.push(r)}),L(this,"removeTriggerCharacter",r=>{this.triggerCharacters=this.triggerCharacters.filter(o=>o!==r)}),L(this,"closeMenu",()=>this.view.closeMenu()),L(this,"clearQuery",()=>this.view.clearQuery());const n=this.triggerCharacters;this.addProsemirrorPlugin(new Re({key:Ec,view:()=>(this.view=new Aoe(e,(r,o)=>{this.emit(`update ${r}`,o)}),this.view),state:{init(){},apply:(r,o,s,i)=>{if(r.getMeta("orderedListIndexing")!==void 0||r.selection.$from.parent.type.spec.code)return o;const a=r.getMeta(Ec);if(typeof a=="object"&&a!==null){o&&this.closeMenu();const c=Toe(e,i.selection.from-a.triggerCharacter.length);return{triggerCharacter:a.triggerCharacter,deleteTriggerCharacter:a.deleteTriggerCharacter!==!1,queryStartPos:()=>c()+a.triggerCharacter.length,query:"",decorationId:`id_${Math.floor(Math.random()*4294967295)}`,ignoreQueryLength:a==null?void 0:a.ignoreQueryLength}}if(o===void 0)return o;if(i.selection.from!==i.selection.to||a===null||r.getMeta("focus")||r.getMeta("blur")||r.getMeta("pointer")||o.triggerCharacter!==void 0&&i.selection.from<o.queryStartPos()||!i.selection.$from.sameParent(i.doc.resolve(o.queryStartPos())))return;const l={...o};return l.query=i.doc.textBetween(o.queryStartPos(),i.selection.from),l}},props:{handleTextInput(r,o,s,i){return n.includes(i)?(r.dispatch(r.state.tr.insertText(i)),r.dispatch(r.state.tr.setMeta(Ec,{triggerCharacter:i}).scrollIntoView()),!0):!1},decorations(r){const o=this.getState(r);if(o===void 0)return null;if(!o.deleteTriggerCharacter){const s=_oe(r.selection);if(s)return Oe.create(r.doc,[et.node(s.pos,s.pos+s.node.nodeSize,{nodeName:"span",class:"bn-suggestion-decorator","data-decoration-id":o.decorationId})])}return Oe.create(r.doc,[et.inline(o.queryStartPos()-o.triggerCharacter.length,o.queryStartPos(),{nodeName:"span",class:"bn-suggestion-decorator","data-decoration-id":o.decorationId})])}}}))}static key(){return"suggestionMenu"}onUpdate(e,n){return this.triggerCharacters.includes(e)||this.addTriggerCharacter(e),this.on(`update ${e}`,n)}get shown(){var e,n;return((n=(e=this.view)==null?void 0:e.state)==null?void 0:n.show)||!1}}const Moe=vn.create({name:"insertion",inclusive:!1,excludes:"deletion modification insertion",addAttributes(){return{id:{default:null,validate:"number"}}},extendMarkSchema(t){return t.name!=="insertion"?{}:{blocknoteIgnore:!0,inclusive:!1,toDOM(e,n){return["ins",{"data-id":String(e.attrs.id),"data-inline":String(n),...!n&&{style:"display: contents"}},0]},parseDOM:[{tag:"ins",getAttrs(e){return e.dataset.id?{id:parseInt(e.dataset.id,10)}:!1}}]}}}),Roe=vn.create({name:"deletion",inclusive:!1,excludes:"insertion modification deletion",addAttributes(){return{id:{default:null,validate:"number"}}},extendMarkSchema(t){return t.name!=="deletion"?{}:{blocknoteIgnore:!0,inclusive:!1,toDOM(e,n){return["del",{"data-id":String(e.attrs.id),"data-inline":String(n),...!n&&{style:"display: contents"}},0]},parseDOM:[{tag:"del",getAttrs(e){return e.dataset.id?{id:parseInt(e.dataset.id,10)}:!1}}]}}}),Poe=vn.create({name:"modification",inclusive:!1,excludes:"deletion insertion",addAttributes(){return{id:{default:null,validate:"number"},type:{validate:"string"},attrName:{default:null,validate:"string|null"},previousValue:{default:null},newValue:{default:null}}},extendMarkSchema(t){return t.name!=="modification"?{}:{blocknoteIgnore:!0,inclusive:!1,toDOM(e,n){return[n?"span":"div",{"data-type":"modification","data-id":String(e.attrs.id),"data-mod-type":e.attrs.type,"data-mod-prev-val":JSON.stringify(e.attrs.previousValue),"data-mod-new-val":JSON.stringify(e.attrs.newValue)},0]},parseDOM:[{tag:"span[data-type='modification']",getAttrs(e){return e.dataset.id?{id:parseInt(e.dataset.id,10),type:e.dataset.modType,previousValue:e.dataset.modPrevVal,newValue:e.dataset.modNewVal}:!1}},{tag:"div[data-type='modification']",getAttrs(e){return e.dataset.id?{id:parseInt(e.dataset.id,10),type:e.dataset.modType,previousValue:e.dataset.modPrevVal}:!1}}]}}});let sr;function TI(t){sr||(sr=document.createElement("div"),sr.innerHTML="_",sr.style.opacity="0",sr.style.height="1px",sr.style.width="1px",t instanceof Document?t.body.appendChild(sr):t.appendChild(sr))}function Doe(t){sr&&(t instanceof Document?t.body.removeChild(sr):t.removeChild(sr),sr=void 0)}function zp(t){return Array.prototype.indexOf.call(t.parentElement.childNodes,t)}function Noe(t){let e=t;for(;e&&e.nodeName!=="TD"&&e.nodeName!=="TH"&&!e.classList.contains("tableWrapper");){if(e.classList.contains("ProseMirror"))return;const n=e.parentNode;if(!n||!(n instanceof Element))return;e=n}return e.nodeName==="TD"||e.nodeName==="TH"?{type:"cell",domNode:e,tbodyNode:e.closest("tbody")}:{type:"wrapper",domNode:e,tbodyNode:e.querySelector("tbody")}}function Ooe(t,e){const n=e.querySelectorAll(t);for(let r=0;r<n.length;r++)n[r].style.visibility="hidden"}class Loe{constructor(e,n,r){L(this,"state"),L(this,"emitUpdate"),L(this,"tableId"),L(this,"tablePos"),L(this,"tableElement"),L(this,"menuFrozen",!1),L(this,"mouseState","up"),L(this,"prevWasEditable",null),L(this,"viewMousedownHandler",()=>{this.mouseState="down"}),L(this,"mouseUpHandler",o=>{this.mouseState="up",this.mouseMoveHandler(o)}),L(this,"mouseMoveHandler",o=>{var s,i,a,l,c,u,d;if(this.menuFrozen||this.mouseState==="selecting"||!(o.target instanceof Element)||!this.pmView.dom.contains(o.target))return;const h=Noe(o.target);if((h==null?void 0:h.type)==="cell"&&this.mouseState==="down"&&!((s=this.state)!=null&&s.draggingState)){this.mouseState="selecting",(i=this.state)!=null&&i.show&&(this.state.show=!1,this.state.showAddOrRemoveRowsButton=!1,this.state.showAddOrRemoveColumnsButton=!1,this.emitUpdate());return}if(!h||!this.editor.isEditable){(a=this.state)!=null&&a.show&&(this.state.show=!1,this.state.showAddOrRemoveRowsButton=!1,this.state.showAddOrRemoveColumnsButton=!1,this.emitUpdate());return}if(!h.tbodyNode)return;const f=h.tbodyNode.getBoundingClientRect(),p=h5(h.domNode,this.pmView);if(!p)return;this.tableElement=p.node;let y;const b=this.editor.transact(x=>Ir(p.id,x.doc));if(!b)throw new Error(`Block with ID ${p.id} not found`);const w=vt(b.node,this.editor.pmSchema,this.editor.schema.blockSchema,this.editor.schema.inlineContentSchema,this.editor.schema.styleSchema);if(Une("table",w,this.editor)&&(this.tablePos=b.posBeforeNode+1,y=w),!y)return;this.tableId=p.id;const k=(l=h.domNode.closest(".tableWrapper"))==null?void 0:l.querySelector(".table-widgets-container");if((h==null?void 0:h.type)==="wrapper"){const x=o.clientY>=f.bottom-1&&o.clientY<f.bottom+20,A=o.clientX>=f.right-1&&o.clientX<f.right+20,I=o.clientX>f.right||o.clientY>f.bottom;this.state={...this.state,show:!0,showAddOrRemoveRowsButton:x,showAddOrRemoveColumnsButton:A,referencePosTable:f,block:y,widgetContainer:k,colIndex:I||(c=this.state)==null?void 0:c.colIndex,rowIndex:I||(u=this.state)==null?void 0:u.rowIndex,referencePosCell:I||(d=this.state)==null?void 0:d.referencePosCell}}else{const x=zp(h.domNode),A=zp(h.domNode.parentElement),I=h.domNode.getBoundingClientRect();if(this.state!==void 0&&this.state.show&&this.tableId===p.id&&this.state.rowIndex===A&&this.state.colIndex===x)return;this.state={show:!0,showAddOrRemoveColumnsButton:x===y.content.rows[0].cells.length-1,showAddOrRemoveRowsButton:A===y.content.rows.length-1,referencePosTable:f,block:y,draggingState:void 0,referencePosCell:I,colIndex:x,rowIndex:A,widgetContainer:k}}return this.emitUpdate(),!1}),L(this,"dragOverHandler",o=>{var s;if(((s=this.state)==null?void 0:s.draggingState)===void 0)return;o.preventDefault(),o.dataTransfer.dropEffect="move",Ooe(".prosemirror-dropcursor-block, .prosemirror-dropcursor-inline",this.pmView.root);const i={left:Math.min(Math.max(o.clientX,this.state.referencePosTable.left+1),this.state.referencePosTable.right-1),top:Math.min(Math.max(o.clientY,this.state.referencePosTable.top+1),this.state.referencePosTable.bottom-1)},a=this.pmView.root.elementsFromPoint(i.left,i.top).filter(y=>y.tagName==="TD"||y.tagName==="TH");if(a.length===0)return;const l=a[0];let c=!1;const u=zp(l.parentElement),d=zp(l),h=this.state.draggingState.draggedCellOrientation==="row"?this.state.rowIndex:this.state.colIndex,f=(this.state.draggingState.draggedCellOrientation==="row"?u:d)!==h;(this.state.rowIndex!==u||this.state.colIndex!==d)&&(this.state.rowIndex=u,this.state.colIndex=d,this.state.referencePosCell=l.getBoundingClientRect(),c=!0);const p=this.state.draggingState.draggedCellOrientation==="row"?i.top:i.left;this.state.draggingState.mousePos!==p&&(this.state.draggingState.mousePos=p,c=!0),c&&this.emitUpdate(),f&&this.editor.transact(y=>y.setMeta(vd,!0))}),L(this,"dropHandler",o=>{if(this.mouseState="up",this.state===void 0||this.state.draggingState===void 0)return!1;if(this.state.rowIndex===void 0||this.state.colIndex===void 0)throw new Error("Attempted to drop table row or column, but no table block was hovered prior.");o.preventDefault();const{draggingState:s,colIndex:i,rowIndex:a}=this.state,l=this.state.block.content.columnWidths;if(s.draggedCellOrientation==="row"){if(!kL(this.state.block,s.originalIndex,a))return!1;const c=Tte(this.state.block,s.originalIndex,a);this.editor.updateBlock(this.state.block,{type:"table",content:{...this.state.block.content,rows:c}})}else{if(!SL(this.state.block,s.originalIndex,i))return!1;const c=Ete(this.state.block,s.originalIndex,i),[u]=l.splice(s.originalIndex,1);l.splice(i,0,u),this.editor.updateBlock(this.state.block,{type:"table",content:{...this.state.block.content,columnWidths:l,rows:c}})}return this.editor.setTextCursorPosition(this.state.block.id),!0}),this.editor=e,this.pmView=n,this.emitUpdate=()=>{if(!this.state)throw new Error("Attempting to update uninitialized image toolbar");r(this.state)},n.dom.addEventListener("mousemove",this.mouseMoveHandler),n.dom.addEventListener("mousedown",this.viewMousedownHandler),window.addEventListener("mouseup",this.mouseUpHandler),n.root.addEventListener("dragover",this.dragOverHandler),n.root.addEventListener("drop",this.dropHandler)}update(){var e;if(!this.state||!this.state.show)return;if(this.state.block=this.editor.getBlock(this.state.block.id),!this.state.block||this.state.block.type!=="table"||!((e=this.tableElement)!=null&&e.isConnected)){this.state.show=!1,this.state.showAddOrRemoveRowsButton=!1,this.state.showAddOrRemoveColumnsButton=!1,this.emitUpdate();return}const{height:n,width:r}=jk(this.state.block);this.state.rowIndex!==void 0&&this.state.colIndex!==void 0&&(this.state.rowIndex>=n&&(this.state.rowIndex=n-1),this.state.colIndex>=r&&(this.state.colIndex=r-1));const o=this.tableElement.querySelector("tbody");if(!o)throw new Error("Table block does not contain a 'tbody' HTML element. This should never happen.");if(this.state.rowIndex!==void 0&&this.state.colIndex!==void 0){const s=o.children[this.state.rowIndex].children[this.state.colIndex];s?this.state.referencePosCell=s.getBoundingClientRect():(this.state.rowIndex=void 0,this.state.colIndex=void 0)}this.state.referencePosTable=o.getBoundingClientRect(),this.emitUpdate()}destroy(){this.pmView.dom.removeEventListener("mousemove",this.mouseMoveHandler),window.removeEventListener("mouseup",this.mouseUpHandler),this.pmView.dom.removeEventListener("mousedown",this.viewMousedownHandler),this.pmView.root.removeEventListener("dragover",this.dragOverHandler),this.pmView.root.removeEventListener("drop",this.dropHandler)}}const vd=new We("TableHandlesPlugin");class Voe extends wn{constructor(e){super(),L(this,"view"),L(this,"colDragStart",n=>{if(this.view.state===void 0||this.view.state.colIndex===void 0)throw new Error("Attempted to drag table column, but no table block was hovered prior.");if(this.view.state.draggingState={draggedCellOrientation:"col",originalIndex:this.view.state.colIndex,mousePos:n.clientX},this.view.emitUpdate(),this.editor.transact(r=>r.setMeta(vd,{draggedCellOrientation:this.view.state.draggingState.draggedCellOrientation,originalIndex:this.view.state.colIndex,newIndex:this.view.state.colIndex,tablePos:this.view.tablePos})),!this.editor.prosemirrorView)throw new Error("Editor view not initialized.");TI(this.editor.prosemirrorView.root),n.dataTransfer.setDragImage(sr,0,0),n.dataTransfer.effectAllowed="move"}),L(this,"rowDragStart",n=>{if(this.view.state===void 0||this.view.state.rowIndex===void 0)throw new Error("Attempted to drag table row, but no table block was hovered prior.");if(this.view.state.draggingState={draggedCellOrientation:"row",originalIndex:this.view.state.rowIndex,mousePos:n.clientY},this.view.emitUpdate(),this.editor.transact(r=>r.setMeta(vd,{draggedCellOrientation:this.view.state.draggingState.draggedCellOrientation,originalIndex:this.view.state.rowIndex,newIndex:this.view.state.rowIndex,tablePos:this.view.tablePos})),!this.editor.prosemirrorView)throw new Error("Editor view not initialized.");TI(this.editor.prosemirrorView.root),n.dataTransfer.setDragImage(sr,0,0),n.dataTransfer.effectAllowed="copyMove"}),L(this,"dragEnd",()=>{if(this.view.state===void 0)throw new Error("Attempted to drag table row, but no table block was hovered prior.");if(this.view.state.draggingState=void 0,this.view.emitUpdate(),this.editor.transact(n=>n.setMeta(vd,null)),!this.editor.prosemirrorView)throw new Error("Editor view not initialized.");Doe(this.editor.prosemirrorView.root)}),L(this,"freezeHandles",()=>{this.view.menuFrozen=!0}),L(this,"unfreezeHandles",()=>{this.view.menuFrozen=!1}),L(this,"getCellsAtRowHandle",(n,r)=>Uw(n,r)),L(this,"getCellsAtColumnHandle",(n,r)=>Ww(n,r)),L(this,"setCellSelection",(n,r,o=r)=>{const s=this.view;if(!s)throw new Error("Table handles view not initialized");const i=n.doc.resolve(s.tablePos+1),a=n.doc.resolve(i.posAtIndex(r.row)+1),l=n.doc.resolve(a.posAtIndex(r.col)),c=n.doc.resolve(i.posAtIndex(o.row)+1),u=n.doc.resolve(c.posAtIndex(o.col)),d=n.tr;return d.setSelection(new tt(l,u)),n.apply(d)}),L(this,"addRowOrColumn",(n,r)=>{this.editor.exec((o,s)=>{const i=this.setCellSelection(o,r.orientation==="row"?{row:n,col:0}:{row:0,col:n});return r.orientation==="row"?r.side==="above"?SX(i,s):EX(i,s):r.side==="left"?vX(i,s):wX(i,s)})}),L(this,"removeRowOrColumn",(n,r)=>r==="row"?this.editor.exec((o,s)=>{const i=this.setCellSelection(o,{row:n,col:0});return _X(i,s)}):this.editor.exec((o,s)=>{const i=this.setCellSelection(o,{row:0,col:n});return xX(i,s)})),L(this,"mergeCells",n=>this.editor.exec((r,o)=>{const s=n?this.setCellSelection(r,n.relativeStartCell,n.relativeEndCell):r;return IX(s,o)})),L(this,"splitCell",n=>this.editor.exec((r,o)=>{const s=n?this.setCellSelection(r,n):r;return MX(s,o)})),L(this,"getCellSelection",()=>this.editor.transact(n=>{const r=n.selection;let o=r.$from,s=r.$to;if(Xw(r)){const{ranges:p}=r;p.forEach(y=>{o=y.$from.min(o??y.$from),s=y.$to.max(s??y.$to)})}else if(o=n.doc.resolve(r.$from.pos-r.$from.parentOffset-1),s=n.doc.resolve(r.$to.pos-r.$to.parentOffset-1),o.pos===0||s.pos===0)return;const i=n.doc.resolve(o.pos-o.parentOffset-1),a=n.doc.resolve(s.pos-s.parentOffset-1),l=n.doc.resolve(i.pos-i.parentOffset-1),c=o.index(i.depth),u=i.index(l.depth),d=s.index(a.depth),h=a.index(l.depth),f=[];for(let p=u;p<=h;p++)for(let y=c;y<=d;y++)f.push({row:p,col:y});return{from:{row:u,col:c},to:{row:h,col:d},cells:f}})),L(this,"getMergeDirection",n=>this.editor.transact(r=>{const o=Xw(r.selection)?r.selection:void 0;if(!o||!n||o.ranges.length<=1)return;const s=this.getCellSelection();if(s)return Ite(s.from,s.to,n)?"vertical":"horizontal"})),L(this,"cropEmptyRowsOrColumns",(n,r)=>_te(n,r)),L(this,"addRowsOrColumns",(n,r,o)=>Ate(n,r,o)),this.editor=e,this.addProsemirrorPlugin(new Re({key:vd,view:n=>(this.view=new Loe(e,n,r=>{this.emit("update",r)}),this.view),props:{decorations:n=>{if(this.view===void 0||this.view.state===void 0||this.view.state.draggingState===void 0||this.view.tablePos===void 0)return;const r=this.view.state.draggingState.draggedCellOrientation==="row"?this.view.state.rowIndex:this.view.state.colIndex;if(r===void 0)return;const o=[],{block:s,draggingState:i}=this.view.state,{originalIndex:a,draggedCellOrientation:l}=i;if(r===a||!s||l==="row"&&!kL(s,a,r)||l==="col"&&!SL(s,a,r))return Oe.create(n.doc,o);const c=n.doc.resolve(this.view.tablePos+1);return this.view.state.draggingState.draggedCellOrientation==="row"?Uw(this.view.state.block,r).forEach(({row:u,col:d})=>{const h=n.doc.resolve(c.posAtIndex(u)+1),f=n.doc.resolve(h.posAtIndex(d)+1),p=f.node(),y=f.pos+(r>a?p.nodeSize-2:0);o.push(et.widget(y,()=>{const b=document.createElement("div");return b.className="bn-table-drop-cursor",b.style.left="0",b.style.right="0",r>a?b.style.bottom="-2px":b.style.top="-3px",b.style.height="4px",b}))}):Ww(this.view.state.block,r).forEach(({row:u,col:d})=>{const h=n.doc.resolve(c.posAtIndex(u)+1),f=n.doc.resolve(h.posAtIndex(d)+1),p=f.node(),y=f.pos+(r>a?p.nodeSize-2:0);o.push(et.widget(y,()=>{const b=document.createElement("div");return b.className="bn-table-drop-cursor",b.style.top="0",b.style.bottom="0",r>a?b.style.right="-2px":b.style.left="-3px",b.style.width="4px",b}))}),Oe.create(n.doc,o)}}}))}static key(){return"tableHandles"}onUpdate(e){return this.on("update",e)}}const joe=at.create({name:"textAlignment",addGlobalAttributes(){return[{types:["paragraph","heading","bulletListItem","numberedListItem","checkListItem","tableCell","tableHeader"],attributes:{textAlignment:{default:"left",parseHTML:t=>t.getAttribute("data-text-alignment"),renderHTML:t=>t.textAlignment==="left"?{}:{"data-text-alignment":t.textAlignment}}}}]}}),Boe=at.create({name:"blockTextColor",addGlobalAttributes(){return[{types:["blockContainer","tableCell","tableHeader"],attributes:{textColor:{default:zt.textColor.default,parseHTML:t=>t.hasAttribute("data-text-color")?t.getAttribute("data-text-color"):zt.textColor.default,renderHTML:t=>t.textColor===zt.textColor.default?{}:{"data-text-color":t.textColor}}}}]}}),$oe=at.create({name:"trailingNode",addProseMirrorPlugins(){const t=new We(this.name);return[new Re({key:t,appendTransaction:(e,n,r)=>{const{doc:o,tr:s,schema:i}=r,a=t.getState(r),l=o.content.size-2,c=i.nodes.blockContainer,u=i.nodes.paragraph;if(a)return s.insert(l,c.create(void 0,u.create()))},state:{init:(e,n)=>{},apply:(e,n)=>{if(!e.docChanged)return n;let r=e.doc.lastChild;if(!r||r.type.name!=="blockGroup")throw new Error("Expected blockGroup");if(r=r.lastChild,!r||r.type.name!=="blockContainer")return!0;const o=r.firstChild;if(!o)throw new Error("Expected blockContent");return r.nodeSize>4||o.type.spec.content!=="inline*"}}})]}}),Foe={blockColor:"data-block-color",blockStyle:"data-block-style",id:"data-id",depth:"data-depth",depthChange:"data-depth-change"},Hoe=cs.create({name:"blockContainer",group:"blockGroupChild bnBlock",content:"blockContent blockGroup?",priority:50,defining:!0,marks:"insertion modification deletion",parseHTML(){return[{tag:"div[data-node-type="+this.name+"]",getAttrs:t=>{if(typeof t=="string")return!1;const e={};for(const[n,r]of Object.entries(Foe))t.getAttribute(r)&&(e[n]=t.getAttribute(r));return e}},{tag:'div[data-node-type="blockOuter"]',skip:!0}]},renderHTML({HTMLAttributes:t}){var e;const n=document.createElement("div");n.className="bn-block-outer",n.setAttribute("data-node-type","blockOuter");for(const[s,i]of Object.entries(t))s!=="class"&&n.setAttribute(s,i);const r={...((e=this.options.domAttributes)==null?void 0:e.block)||{},...t},o=document.createElement("div");o.className=dt("bn-block",r.class),o.setAttribute("data-node-type",this.name);for(const[s,i]of Object.entries(r))s!=="class"&&o.setAttribute(s,i);return n.appendChild(o),{dom:n,contentDOM:o}}}),zoe=cs.create({name:"blockGroup",group:"childContainer",content:"blockGroupChild+",marks:"deletion insertion modification",parseHTML(){return[{tag:"div",getAttrs:t=>typeof t=="string"?!1:t.getAttribute("data-node-type")==="blockGroup"?null:!1}]},renderHTML({HTMLAttributes:t}){var e;const n={...((e=this.options.domAttributes)==null?void 0:e.blockGroup)||{},...t},r=document.createElement("div");r.className=dt("bn-block-group",n.class),r.setAttribute("data-node-type","blockGroup");for(const[o,s]of Object.entries(n))o!=="class"&&r.setAttribute(o,s);return{dom:r,contentDOM:r}}}),Uoe=cs.create({name:"doc",topNode:!0,content:"blockGroup",marks:"insertion modification deletion"});class Woe extends wn{constructor({editor:e,collaboration:n}){super(e),L(this,"editor"),L(this,"collaboration"),L(this,"forkedState"),this.editor=e,this.collaboration=n}static key(){return"ForkYDocPlugin"}findTypeInOtherYdoc(e,n){const r=e.doc;if(e._item===null){const o=Array.from(r.share.keys()).find(s=>r.share.get(s)===e);if(o==null)throw new Error("type does not exist in other ydoc");return n.get(o,e.constructor)}else{const o=e._item,s=n.store.clients.get(o.id.client)??[],i=Jr(s,o.id.clock);return s[i].content.type}}get isForkedFromRemote(){return this.forkedState!==void 0}fork(){if(this.isForkedFromRemote)return;const e=this.collaboration.fragment;if(!e)throw new Error("No fragment to fork from");const n=new ga;$A(n,FA(e.doc));const r=this.findTypeInOtherYdoc(e,n);this.forkedState={originalFragment:e,forkedFragment:r},this.editor._tiptapEditor.unregisterPlugin([yd,Fo,Ke]),this.editor._tiptapEditor.registerPlugin(new Qw(r).plugins[0]),this.editor._tiptapEditor.registerPlugin(new Zw().plugins[0]),this.emit("forked",!0)}merge({keepChanges:e}){if(!this.forkedState)return;this.editor._tiptapEditor.unregisterPlugin(Ke),this.editor._tiptapEditor.unregisterPlugin(Fo);const{originalFragment:n,forkedFragment:r}=this.forkedState;if(e){const o=FA(r.doc);$A(n.doc,o)}this.editor.extensions.ySyncPlugin=new Qw(n),this.editor.extensions.yCursorPlugin=new a5(this.collaboration),this.editor.extensions.yUndoPlugin=new Zw,this.editor._tiptapEditor.registerPlugin(this.editor.extensions.ySyncPlugin.plugins[0]),this.editor._tiptapEditor.registerPlugin(this.editor.extensions.yCursorPlugin.plugins[0]),this.editor._tiptapEditor.registerPlugin(this.editor.extensions.yUndoPlugin.plugins[0]),this.forkedState=void 0,this.emit("forked",!1)}}const qoe=t=>{var e;const n={},r=Goe(t);for(const s of r)n[s.name]=s;t.collaboration&&(n.ySyncPlugin=new Qw(t.collaboration.fragment),n.yUndoPlugin=new Zw,(e=t.collaboration.provider)!=null&&e.awareness&&(n.yCursorPlugin=new a5(t.collaboration)),n.forkYDocPlugin=new Woe({editor:t.editor,collaboration:t.collaboration})),n.formattingToolbar=new ooe(t.editor),n.linkToolbar=new doe(t.editor),n.sideMenu=new Soe(t.editor,t.sideMenuDetection),n.suggestionMenus=new Ioe(t.editor),n.filePanel=new toe(t.editor),n.placeholder=new moe(t.editor,t.placeholders),(t.animations??!0)&&(n.animations=new yoe),t.tableHandles&&(n.tableHandles=new Voe(t.editor)),n.nodeSelectionKeyboard=new foe,n.showSelection=new boe(t.editor),t.comments&&(n.comments=new Zre(t.editor,t.comments.threadStore,l5.name));const o=t.disableExtensions||[];for(const s of o)delete n[s];return n};let _I=!1;const Goe=t=>{const e=[Qu.ClipboardTextSerializer,Qu.Commands,Qu.Editable,Qu.FocusEvents,Qu.Tabindex,iJ,at.create({name:"dropCursor",addProseMirrorPlugins:()=>[t.dropCursor({width:5,color:"#ddeeff",editor:t.editor})]}),mb.configure({types:["blockContainer","columnList","column"],setIdAttribute:t.setIdAttribute}),soe,$J,Moe,Roe,Poe,BJ.extend({inclusive:!1}).configure({defaultProtocol:d5,protocols:_I?[]:u5}),...Object.values(t.styleSpecs).map(n=>n.implementation.mark.configure({editor:t.editor})),Boe,Yre,joe,at.create({name:"OverrideEscape",addKeyboardShortcuts(){return{Escape:()=>t.editor.suggestionMenus.shown?!1:this.editor.commands.blur()}}}),Uoe,Hoe.configure({editor:t.editor,domAttributes:t.domAttributes}),loe.configure({editor:t.editor,tabBehavior:t.tabBehavior}),zoe.configure({domAttributes:t.domAttributes}),...Object.values(t.inlineContentSpecs).filter(n=>n.config!=="link"&&n.config!=="text").map(n=>n.implementation.node.configure({editor:t.editor})),...Object.values(t.blockSpecs).flatMap(n=>[...(n.implementation.requiredExtensions||[]).map(r=>r.configure({editor:t.editor,domAttributes:t.domAttributes})),n.implementation.node.configure({editor:t.editor,domAttributes:t.domAttributes})]),Kre(t.editor),qre(t.editor,t.pasteHandler||(n=>n.defaultPasteHandler())),Ire(t.editor),...t.trailingBlock===void 0||t.trailingBlock?[$oe]:[],...t.comments?[l5]:[]];return _I=!0,t.collaboration||e.push(gJ),e};function Koe(t,e){const n=[];return t.forEach((r,o,s)=>{s!==e&&n.push(r)}),B.from(n)}function Yoe(t,e){const n=[];for(let r=0;r<t.childCount;r++)if(t.child(r).type.name==="tableRow")if(n.length>0&&n[n.length-1].type.name==="table"){const o=n[n.length-1],s=o.copy(o.content.addToEnd(t.child(r)));n[n.length-1]=s}else{const o=e.nodes.table.createChecked(void 0,t.child(r));n.push(o)}else n.push(t.child(r));return t=B.from(n),t}function Xoe(t,e){let n=B.from(t.content);if(n=Yoe(n,e.state.schema),!Joe(n,e))return new G(n,t.openStart,t.openEnd);for(let r=0;r<n.childCount;r++)if(n.child(r).type.spec.group==="blockContent"){const o=[n.child(r)];if(r+1<n.childCount&&n.child(r+1).type.name==="blockGroup"){const i=n.child(r+1).child(0).child(0);(i.type.name==="bulletListItem"||i.type.name==="numberedListItem"||i.type.name==="checkListItem")&&(o.push(n.child(r+1)),n=Koe(n,r+1))}const s=e.state.schema.nodes.blockContainer.createChecked(void 0,o);n=n.replaceChild(r,s)}return new G(n,t.openStart,t.openEnd)}function Joe(t,e){var n,r;const o=t.childCount===1,s=((n=t.firstChild)==null?void 0:n.type.spec.content)==="inline*",i=((r=t.firstChild)==null?void 0:r.type.spec.content)==="tableRow+";if(o){if(s)return!1;if(i){const a=ct(e.state);if(a.isBlockContainer)return a.blockContent.node.type.spec.content!=="tableRow+"}}return!0}const tC=class extends _Y{constructor(e,n){super({...e,content:void 0}),L(this,"_state"),L(this,"mount",(a,l,c)=>{l?(this.options.element=l,this.createViewAlternative(a,c)):this.destroy()});const r=this.schema;let o;const s=r.nodes.doc.createAndFill;r.nodes.doc.createAndFill=(...a)=>{if(o)return o;const l=s.apply(r.nodes.doc,a),c=JSON.parse(JSON.stringify(l.toJSON()));return c.content[0].content[0].attrs.id="initialBlockId",o=Os.fromJSON(r,c),o};let i;try{const a=e==null?void 0:e.content.map(l=>Ol(l,this.schema,n).toJSON());i=ag({type:"doc",content:[{type:"blockGroup",content:a}]},this.schema,this.options.parseOptions)}catch(a){throw console.error("Error creating document from blocks passed as `initialContent`. Caused by exception: ",a),new Error("Error creating document from blocks passed as `initialContent`:\n"+ +JSON.stringify(e.content))}this._state=Ya.create({doc:i,schema:this.schema})}get state(){return this.view&&(this._state=this.view.state),this._state}dispatch(e){if(!this.view){this._state=this.state.apply(e),this.emit("transaction",{editor:this,transaction:e});return}if(this.view.isDestroyed)return;if(this.isCapturingTransaction){this.dispatchTransaction(e);return}const{state:n,transactions:r}=this.state.applyTransaction(e),o=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),o&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=e.getMeta("focus"),i=e.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&(this.emit("update",{editor:this,transaction:e}),this.emit("v3-update",{editor:this,transaction:e,appendedTransactions:r.slice(1)}))}forceEnablePlugins(){if(this.view)throw new Error("forcePluginsEnabled called after view has been initialized");this._state=this.state.reconfigure({plugins:this.extensionManager.plugins})}createViewAlternative(e,n){this.contentComponent=n;const r={};this.extensionManager.extensions.forEach(s=>{s.type==="mark"&&s.config.addMarkView&&(r[s.name]=s.config.addMarkView(e))}),this.view=new rO({mount:this.options.element},{...this.options.editorProps,dispatchTransaction:this.dispatch.bind(this),state:this.state,markViews:r,nodeViews:this.extensionManager.nodeViews});const o=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(o),this.commands.focus(this.options.autofocus||this.options.element.getAttribute("data-bn-autofocus")==="true",{scrollIntoView:!1}),this.emit("create",{editor:this}),this.isInitialized=!0}};L(tC,"create",(t,e)=>{var n,r;const o=(n=globalThis==null?void 0:globalThis.window)==null?void 0:n.setTimeout;typeof((r=globalThis==null?void 0:globalThis.window)==null?void 0:r.setTimeout)<"u"&&(globalThis.window.setTimeout=()=>0);try{return new tC(t,e)}finally{o&&(globalThis.window.setTimeout=o)}});let p5=tC;p5.prototype.createView=function(){this.options.onPaste=this.options.onDrop=void 0};const Qoe={enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!1};let Zoe=class m5 extends Xk{constructor(e){var n,r,o,s,i,a,l,c,u,d,h,f,p,y,b;super(),L(this,"pmSchema"),L(this,"extensions",{}),L(this,"headless",!1),L(this,"_tiptapEditor"),L(this,"elementRenderer",null),L(this,"blockCache",new WeakMap),L(this,"dictionary"),L(this,"schema"),L(this,"blockImplementations"),L(this,"inlineContentImplementations"),L(this,"styleImplementations"),L(this,"formattingToolbar"),L(this,"linkToolbar"),L(this,"sideMenu"),L(this,"suggestionMenus"),L(this,"filePanel"),L(this,"tableHandles"),L(this,"comments"),L(this,"showSelectionPlugin"),L(this,"forkYDocPlugin"),L(this,"uploadFile"),L(this,"onUploadStartCallbacks",[]),L(this,"onUploadEndCallbacks",[]),L(this,"resolveFileUrl"),L(this,"resolveUsers"),L(this,"settings"),L(this,"activeTransaction",null),L(this,"mount",(T,S)=>{this._tiptapEditor.mount(this,T,S)}),this.options=e;const w=e;if(w.onEditorContentChange)throw new Error("onEditorContentChange initialization option is deprecated, use <BlockNoteView onChange={...} />, the useEditorChange(...) hook, or editor.onChange(...)");if(w.onTextCursorPositionChange)throw new Error("onTextCursorPositionChange initialization option is deprecated, use <BlockNoteView onSelectionChange={...} />, the useEditorSelectionChange(...) hook, or editor.onSelectionChange(...)");if(w.onEditorReady)throw new Error("onEditorReady is deprecated. Editor is immediately ready for use after creation.");if(w.editable)throw new Error("editable initialization option is deprecated, use <BlockNoteView editable={true/false} />, or alternatively editor.isEditable = true/false");this.dictionary=e.dictionary||mte,this.settings={tables:{splitCells:((n=e==null?void 0:e.tables)==null?void 0:n.splitCells)??!1,cellBackgroundColor:((r=e==null?void 0:e.tables)==null?void 0:r.cellBackgroundColor)??!1,cellTextColor:((o=e==null?void 0:e.tables)==null?void 0:o.cellTextColor)??!1,headers:((s=e==null?void 0:e.tables)==null?void 0:s.headers)??!1},codeBlock:{indentLineWithTab:((i=e==null?void 0:e.codeBlock)==null?void 0:i.indentLineWithTab)??!0,defaultLanguage:((a=e==null?void 0:e.codeBlock)==null?void 0:a.defaultLanguage)??"text",supportedLanguages:((l=e==null?void 0:e.codeBlock)==null?void 0:l.supportedLanguages)??{},createHighlighter:((c=e==null?void 0:e.codeBlock)==null?void 0:c.createHighlighter)??void 0}};const k={defaultStyles:!0,schema:e.schema||qk.create(),_headless:!1,...e,placeholders:{...this.dictionary.placeholders,...e.placeholders}};if(k.comments&&!k.resolveUsers)throw new Error("resolveUsers is required when using comments");this.resolveUsers=k.resolveUsers,this.schema=k.schema,this.blockImplementations=k.schema.blockSpecs,this.inlineContentImplementations=k.schema.inlineContentSpecs,this.styleImplementations=k.schema.styleSpecs,this.extensions=qoe({editor:this,domAttributes:k.domAttributes||{},blockSpecs:this.schema.blockSpecs,styleSpecs:this.schema.styleSpecs,inlineContentSpecs:this.schema.inlineContentSpecs,collaboration:k.collaboration,trailingBlock:k.trailingBlock,disableExtensions:k.disableExtensions,setIdAttribute:k.setIdAttribute,animations:k.animations??!0,tableHandles:or("table",this),dropCursor:this.options.dropCursor??fte,placeholders:k.placeholders,tabBehavior:k.tabBehavior,sideMenuDetection:k.sideMenuDetection||"viewport",comments:k.comments,pasteHandler:k.pasteHandler}),(((u=k._tiptapOptions)==null?void 0:u.extensions)||[]).forEach(T=>{this.extensions[T.name]=T});for(let T of k.extensions||[]){typeof T=="function"&&(T=T(this));const S=T.constructor.key();if(!S)throw new Error(`Extension ${T.constructor.name} does not have a key method`);if(this.extensions[S])throw new Error(`Extension ${T.constructor.name} already exists with key ${S}`);this.extensions[S]=T}if(Object.entries(k._extensions||{}).forEach(([T,S])=>{const _=typeof S=="function"?S(this):S;if(!("plugin"in _)){this.extensions[T]=_;return}this.extensions[T]=new class extends wn{static key(){return T}constructor(){super(),this.addProsemirrorPlugin(_.plugin)}get priority(){return _.priority}}}),this.formattingToolbar=this.extensions.formattingToolbar,this.linkToolbar=this.extensions.linkToolbar,this.sideMenu=this.extensions.sideMenu,this.suggestionMenus=this.extensions.suggestionMenus,this.filePanel=this.extensions.filePanel,this.tableHandles=this.extensions.tableHandles,this.comments=this.extensions.comments,this.showSelectionPlugin=this.extensions.showSelection,this.forkYDocPlugin=this.extensions.forkYDocPlugin,k.uploadFile){const T=k.uploadFile;this.uploadFile=async(S,_)=>{this.onUploadStartCallbacks.forEach(R=>R.apply(this,[_]));try{return await T(S,_)}finally{this.onUploadEndCallbacks.forEach(R=>R.apply(this,[_]))}}}this.resolveFileUrl=k.resolveFileUrl,this.headless=k._headless;const x="ySyncPlugin"in this.extensions||"liveblocksExtension"in this.extensions;x&&k.initialContent&&console.warn("When using Collaboration, initialContent might cause conflicts, because changes should come from the collaboration provider");const A=k.initialContent||(x?[{type:"paragraph",id:"initialBlockId"}]:[{type:"paragraph",id:mb.options.generateID()}]);if(!Array.isArray(A)||A.length===0)throw new Error("initialContent must be a non-empty array of blocks, received: "+A);const I=[...Object.entries(this.extensions).map(([T,S])=>{if(S instanceof at||S instanceof cs||S instanceof vn)return S;if(!(S instanceof wn&&!S.plugins.length))return at.create({name:T,priority:S.priority,addProseMirrorPlugins:()=>S.plugins})})].filter(T=>T!==void 0),M={...Qoe,...k._tiptapOptions,content:A,extensions:I,editorProps:{...(d=k._tiptapOptions)==null?void 0:d.editorProps,attributes:{tabIndex:"0",...(f=(h=k._tiptapOptions)==null?void 0:h.editorProps)==null?void 0:f.attributes,...(p=k.domAttributes)==null?void 0:p.editor,class:dt("bn-editor",k.defaultStyles?"bn-default-styles":"",((b=(y=k.domAttributes)==null?void 0:y.editor)==null?void 0:b.class)||"")},transformPasted:Xoe}};this.headless?this.pmSchema=ZK(M.extensions):(this._tiptapEditor=p5.create(M,this.schema.styleSchema),this.pmSchema=this._tiptapEditor.schema),this.pmSchema.cached.blockNoteEditor=this,this.emit("create")}static create(e={}){return new m5(e)}exec(e){if(this.activeTransaction)throw new Error("`exec` should not be called within a `transact` call, move the `exec` call outside of the `transact` call");const n=this._tiptapEditor.state,r=this._tiptapEditor.view;return e(n,o=>this._tiptapEditor.dispatch(o),r)}canExec(e){if(this.activeTransaction)throw new Error("`canExec` should not be called within a `transact` call, move the `canExec` call outside of the `transact` call");const n=this._tiptapEditor.state,r=this._tiptapEditor.view;return e(n,void 0,r)}transact(e){if(this.activeTransaction)return e(this.activeTransaction);try{this.activeTransaction=this._tiptapEditor.state.tr;const n=e(this.activeTransaction),r=this.activeTransaction;return this.activeTransaction=null,r&&(r.docChanged||r.selectionSet||r.scrolledIntoView||r.storedMarksSet||!r.isGeneric)&&this._tiptapEditor.dispatch(r),n}finally{this.activeTransaction=null}}extension(e,n=e.key()){const r=this.extensions[n];if(!r)throw new Error(`Extension ${n} not found`);return r}get prosemirrorState(){if(this.activeTransaction)throw new Error("`prosemirrorState` should not be called within a `transact` call, move the `prosemirrorState` call outside of the `transact` call or use `editor.transact` to read the current editor state");return this._tiptapEditor.state}get prosemirrorView(){return this._tiptapEditor.view}get domElement(){var e;return(e=this.prosemirrorView)==null?void 0:e.dom}isFocused(){var e;return((e=this.prosemirrorView)==null?void 0:e.hasFocus())||!1}focus(){var e;(e=this.prosemirrorView)==null||e.focus()}onUploadStart(e){return this.onUploadStartCallbacks.push(e),()=>{const n=this.onUploadStartCallbacks.indexOf(e);n>-1&&this.onUploadStartCallbacks.splice(n,1)}}onUploadEnd(e){return this.onUploadEndCallbacks.push(e),()=>{const n=this.onUploadEndCallbacks.indexOf(e);n>-1&&this.onUploadEndCallbacks.splice(n,1)}}get topLevelBlocks(){return this.document}get document(){return this.transact(e=>xte(e.doc,this.pmSchema))}getBlock(e){return this.transact(n=>lre(n.doc,e))}getPrevBlock(e){return this.transact(n=>cre(n.doc,e))}getNextBlock(e){return this.transact(n=>ure(n.doc,e))}getParentBlock(e){return this.transact(n=>dre(n.doc,e))}forEachBlock(e,n=!1){const r=this.document.slice();n&&r.reverse();function o(s){for(const i of s){if(e(i)===!1)return!1;const a=n?i.children.slice().reverse():i.children;if(!o(a))return!1}return!0}o(r)}onEditorContentChange(e){this._tiptapEditor.on("update",e)}onEditorSelectionChange(e){this._tiptapEditor.on("selectionUpdate",e)}getTextCursorPosition(){return this.transact(e=>gre(e))}setTextCursorPosition(e,n="start"){return this.transact(r=>QL(r,e,n))}getSelection(){return this.transact(e=>fre(e))}getSelectionCutBlocks(){return this.transact(e=>mre(e))}setSelection(e,n){return this.transact(r=>pre(r,e,n))}get isEditable(){if(!this._tiptapEditor){if(!this.headless)throw new Error("no editor, but also not headless?");return!1}return this._tiptapEditor.isEditable===void 0?!0:this._tiptapEditor.isEditable}set isEditable(e){if(!this._tiptapEditor){if(!this.headless)throw new Error("no editor, but also not headless?");return}this._tiptapEditor.options.editable!==e&&this._tiptapEditor.setEditable(e)}insertBlocks(e,n,r="before"){return this.transact(o=>Dte(o,e,n,r))}updateBlock(e,n){return this.transact(r=>Ote(r,e,n))}removeBlocks(e){return this.transact(n=>cI(n,e,[]).removedBlocks)}replaceBlocks(e,n){return this.transact(r=>cI(r,e,n))}undo(){return this.options.collaboration?this.exec(lte):this.exec(tk)}redo(){return this.options.collaboration?this.exec(cte):this.exec(nk)}insertInlineContent(e,{updateSelection:n=!1}={}){const r=ko(e,this.pmSchema);this.transact(o=>{hre(o,{from:o.selection.from,to:o.selection.to},r,{updateSelection:n})})}getActiveStyles(){return this.transact(e=>{const n={},r=e.selection.$to.marks();for(const o of r){const s=this.schema.styleSchema[o.type.name];if(!s){o.type.name!=="link"&&!o.type.spec.blocknoteIgnore&&console.warn("mark not found in styleschema",o.type.name);continue}s.propSchema==="boolean"?n[s.type]=!0:n[s.type]=o.attrs.stringValue}return n})}addStyles(e){for(const[n,r]of Object.entries(e)){const o=this.schema.styleSchema[n];if(!o)throw new Error(`style ${n} not found in styleSchema`);if(o.propSchema==="boolean")this._tiptapEditor.commands.setMark(n);else if(o.propSchema==="string")this._tiptapEditor.commands.setMark(n,{stringValue:r});else throw new Zo(o.propSchema)}}removeStyles(e){for(const n of Object.keys(e))this._tiptapEditor.commands.unsetMark(n)}toggleStyles(e){for(const[n,r]of Object.entries(e)){const o=this.schema.styleSchema[n];if(!o)throw new Error(`style ${n} not found in styleSchema`);if(o.propSchema==="boolean")this._tiptapEditor.commands.toggleMark(n);else if(o.propSchema==="string")this._tiptapEditor.commands.toggleMark(n,{stringValue:r});else throw new Zo(o.propSchema)}}getSelectedText(){return this.transact(e=>e.doc.textBetween(e.selection.from,e.selection.to))}getSelectedLinkUrl(){return this._tiptapEditor.getAttributes("link").href}createLink(e,n){if(e==="")return;const r=this.pmSchema.mark("link",{href:e});this.transact(o=>{const{from:s,to:i}=o.selection;n?o.insertText(n,s,i).addMark(s,s+n.length,r):o.setSelection(ee.create(o.doc,i)).addMark(s,i,r)})}canNestBlock(){return ire(this)}nestBlock(){JL(this)}canUnnestBlock(){return are(this)}unnestBlock(){sre(this)}moveBlocksUp(){return nre(this)}moveBlocksDown(){return rre(this)}async blocksToHTMLLossy(e=this.document){return vb(this.pmSchema,this).exportBlocks(e,{})}async blocksToFullHTML(e){return $te(this.pmSchema,this).serializeBlocks(e,{})}async tryParseHTMLToBlocks(e){return e5(e,this.pmSchema)}async blocksToMarkdownLossy(e=this.document){return vre(e,this.pmSchema,this,{})}async tryParseMarkdownToBlocks(e){return Tre(e,this.pmSchema)}updateCollaborationUserInfo(e){if(!this.options.collaboration)throw new Error("Cannot update collaboration user info when collaboration is disabled.");this.extensions.yCursorPlugin.updateUser(e)}onChange(e){if(this.headless)return;const n=({transaction:r,appendedTransactions:o})=>{e(this,{getChanges:()=>Pte(r,o)})};return this._tiptapEditor.on("v3-update",n),()=>{this._tiptapEditor.off("v3-update",n)}}onSelectionChange(e,n){if(this.headless)return;const r=o=>{o.transaction.getMeta(Ke)&&!n||e(this)};return this._tiptapEditor.on("selectionUpdate",r),()=>{this._tiptapEditor.off("selectionUpdate",r)}}onCreate(e){return this.on("create",e),()=>{this.off("create",e)}}getSelectionBoundingBox(){if(!this.prosemirrorView)return;const{selection:e}=this.prosemirrorState,{ranges:n}=e,r=Math.min(...n.map(s=>s.$from.pos)),o=Math.max(...n.map(s=>s.$to.pos));if(pw(e)){const s=this.prosemirrorView.nodeDOM(r);if(s)return s.getBoundingClientRect()}return cg(this.prosemirrorView,r,o)}get isEmpty(){const e=this.document;return e.length===0||e.length===1&&e[0].type==="paragraph"&&e[0].content.length===0}openSuggestionMenu(e,n){this.prosemirrorView&&(this.focus(),this.transact(r=>{n!=null&&n.deleteTriggerCharacter&&r.insertText(e),r.scrollIntoView().setMeta(this.suggestionMenus.plugins[0],{triggerCharacter:e,deleteTriggerCharacter:(n==null?void 0:n.deleteTriggerCharacter)||!1,ignoreQueryLength:(n==null?void 0:n.ignoreQueryLength)||!1})}))}getForceSelectionVisible(){return this.showSelectionPlugin.getEnabled()}setForceSelectionVisible(e){this.showSelectionPlugin.setEnabled(e)}convertHtmlToBlockNoteHtml(e){return ZL(e.trim()).innerHTML}pasteHTML(e,n=!1){var r;let o=e;n||(o=this.convertHtmlToBlockNoteHtml(e)),o&&((r=this.prosemirrorView)==null||r.pasteHTML(o))}pasteText(e){var n;return(n=this.prosemirrorView)==null?void 0:n.pasteText(e)}async pasteMarkdown(e){return this.pasteHTML(await t5(e))}},Vv;async function ese(){return Vv||(Vv=(async()=>{const[t,e]=await Promise.all([hn(()=>import("./module-BvCTiNll.js"),[]),hn(()=>import("./native-48B9X9Wg.js"),[])]),n="default"in t?t.default:t,r="default"in e?e.default:e;return await n.init({data:r}),{emojiMart:n,emojiData:r}})(),Vv)}async function tse(t,e){if(!zne("text",t))return[];const{emojiData:n,emojiMart:r}=await ese();return(e.trim()===""?Object.values(n.emojis):await r.SearchIndex.search(e)).map(o=>({id:o.skins[0].native,onItemClick:()=>t.insertInlineContent(o.skins[0].native+" ")}))}function nC(t){let e=t.activeElement;for(;((n=e)==null||(n=n.shadowRoot)==null?void 0:n.activeElement)!=null;){var n;e=e.shadowRoot.activeElement}return e}function Uc(t,e){if(!t||!e)return!1;const n=e.getRootNode==null?void 0:e.getRootNode();if(t.contains(e))return!0;if(n&&k$(n)){let r=e;for(;r;){if(t===r)return!0;r=r.parentNode||r.host}}return!1}function g5(){const t=navigator.userAgentData;return t!=null&&t.platform?t.platform:navigator.platform}function y5(){const t=navigator.userAgentData;return t&&Array.isArray(t.brands)?t.brands.map(e=>{let{brand:n,version:r}=e;return n+"/"+r}).join(" "):navigator.userAgent}function nse(t){return ose()?!1:!AI()&&t.width===0&&t.height===0||AI()&&t.width===1&&t.height===1&&t.pressure===0&&t.detail===0&&t.pointerType==="mouse"||t.width<1&&t.height<1&&t.pressure===0&&t.detail===0&&t.pointerType==="touch"}function b5(){return/apple/i.test(navigator.vendor)}function AI(){const t=/android/i;return t.test(g5())||t.test(y5())}function rse(){return g5().toLowerCase().startsWith("mac")&&!navigator.maxTouchPoints}function ose(){return y5().includes("jsdom/")}function rC(t,e){const n=["mouse","pen"];return n.push("",void 0),n.includes(t)}function sse(t){return"nativeEvent"in t}function ise(t){return t.matches("html,body")}function Vi(t){return(t==null?void 0:t.ownerDocument)||document}function jv(t,e){if(e==null)return!1;if("composedPath"in t)return t.composedPath().includes(e);const n=t;return n.target!=null&&e.contains(n.target)}function sc(t){return"composedPath"in t?t.composedPath()[0]:t.target}const ase="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])";function lse(t){return mx(t)&&t.matches(ase)}/*!
* tabbable 6.2.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var cse=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],oC=cse.join(","),v5=typeof Element>"u",Dh=v5?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,Xg=!v5&&Element.prototype.getRootNode?function(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}:function(t){return t==null?void 0:t.ownerDocument},Jg=function t(e,n){var r;n===void 0&&(n=!0);var o=e==null||(r=e.getAttribute)===null||r===void 0?void 0:r.call(e,"inert"),s=o===""||o==="true",i=s||n&&e&&t(e.parentNode);return i},use=function(e){var n,r=e==null||(n=e.getAttribute)===null||n===void 0?void 0:n.call(e,"contenteditable");return r===""||r==="true"},dse=function(e,n,r){if(Jg(e))return[];var o=Array.prototype.slice.apply(e.querySelectorAll(oC));return n&&Dh.call(e,oC)&&o.unshift(e),o=o.filter(r),o},hse=function t(e,n,r){for(var o=[],s=Array.from(e);s.length;){var i=s.shift();if(!Jg(i,!1))if(i.tagName==="SLOT"){var a=i.assignedElements(),l=a.length?a:i.children,c=t(l,!0,r);r.flatten?o.push.apply(o,c):o.push({scopeParent:i,candidates:c})}else{var u=Dh.call(i,oC);u&&r.filter(i)&&(n||!e.includes(i))&&o.push(i);var d=i.shadowRoot||typeof r.getShadowRoot=="function"&&r.getShadowRoot(i),h=!Jg(d,!1)&&(!r.shadowRootFilter||r.shadowRootFilter(i));if(d&&h){var f=t(d===!0?i.children:d.children,!0,r);r.flatten?o.push.apply(o,f):o.push({scopeParent:i,candidates:f})}else s.unshift.apply(s,i.children)}}return o},w5=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},C5=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||use(e))&&!w5(e)?0:e.tabIndex},fse=function(e,n){var r=C5(e);return r<0&&n&&!w5(e)?0:r},pse=function(e,n){return e.tabIndex===n.tabIndex?e.documentOrder-n.documentOrder:e.tabIndex-n.tabIndex},x5=function(e){return e.tagName==="INPUT"},mse=function(e){return x5(e)&&e.type==="hidden"},gse=function(e){var n=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(r){return r.tagName==="SUMMARY"});return n},yse=function(e,n){for(var r=0;r<e.length;r++)if(e[r].checked&&e[r].form===n)return e[r]},bse=function(e){if(!e.name)return!0;var n=e.form||Xg(e),r=function(a){return n.querySelectorAll('input[type="radio"][name="'+a+'"]')},o;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")o=r(window.CSS.escape(e.name));else try{o=r(e.name)}catch(i){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",i.message),!1}var s=yse(o,e.form);return!s||s===e},vse=function(e){return x5(e)&&e.type==="radio"},wse=function(e){return vse(e)&&!bse(e)},Cse=function(e){var n,r=e&&Xg(e),o=(n=r)===null||n===void 0?void 0:n.host,s=!1;if(r&&r!==e){var i,a,l;for(s=!!((i=o)!==null&&i!==void 0&&(a=i.ownerDocument)!==null&&a!==void 0&&a.contains(o)||e!=null&&(l=e.ownerDocument)!==null&&l!==void 0&&l.contains(e));!s&&o;){var c,u,d;r=Xg(o),o=(c=r)===null||c===void 0?void 0:c.host,s=!!((u=o)!==null&&u!==void 0&&(d=u.ownerDocument)!==null&&d!==void 0&&d.contains(o))}}return s},II=function(e){var n=e.getBoundingClientRect(),r=n.width,o=n.height;return r===0&&o===0},xse=function(e,n){var r=n.displayCheck,o=n.getShadowRoot;if(getComputedStyle(e).visibility==="hidden")return!0;var s=Dh.call(e,"details>summary:first-of-type"),i=s?e.parentElement:e;if(Dh.call(i,"details:not([open]) *"))return!0;if(!r||r==="full"||r==="legacy-full"){if(typeof o=="function"){for(var a=e;e;){var l=e.parentElement,c=Xg(e);if(l&&!l.shadowRoot&&o(l)===!0)return II(e);e.assignedSlot?e=e.assignedSlot:!l&&c!==e.ownerDocument?e=c.host:e=l}e=a}if(Cse(e))return!e.getClientRects().length;if(r!=="legacy-full")return!0}else if(r==="non-zero-area")return II(e);return!1},kse=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var n=e.parentElement;n;){if(n.tagName==="FIELDSET"&&n.disabled){for(var r=0;r<n.children.length;r++){var o=n.children.item(r);if(o.tagName==="LEGEND")return Dh.call(n,"fieldset[disabled] *")?!0:!o.contains(e)}return!0}n=n.parentElement}return!1},Sse=function(e,n){return!(n.disabled||Jg(n)||mse(n)||xse(n,e)||gse(n)||kse(n))},MI=function(e,n){return!(wse(n)||C5(n)<0||!Sse(e,n))},Ese=function(e){var n=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(n)||n>=0)},Tse=function t(e){var n=[],r=[];return e.forEach(function(o,s){var i=!!o.scopeParent,a=i?o.scopeParent:o,l=fse(a,i),c=i?t(o.candidates):a;l===0?i?n.push.apply(n,c):n.push(a):r.push({documentOrder:s,tabIndex:l,item:o,isScope:i,content:c})}),r.sort(pse).reduce(function(o,s){return s.isScope?o.push.apply(o,s.content):o.push(s.content),o},[]).concat(n)},k5=function(e,n){n=n||{};var r;return n.getShadowRoot?r=hse([e],n.includeContainer,{filter:MI.bind(null,n),flatten:!1,getShadowRoot:n.getShadowRoot,shadowRootFilter:Ese}):r=dse(e,n.includeContainer,MI.bind(null,n)),Tse(r)};const S5={...T$},_se=S5.useInsertionEffect,Ase=_se||(t=>t());function Ms(t){const e=v.useRef(()=>{});return Ase(()=>{e.current=t}),v.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e.current==null?void 0:e.current(...r)},[])}var jn=typeof document<"u"?v.useLayoutEffect:v.useEffect;function sC(){return sC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sC.apply(this,arguments)}let RI=!1,Ise=0;const PI=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Ise++;function Mse(){const[t,e]=v.useState(()=>RI?PI():void 0);return jn(()=>{t==null&&e(PI())},[]),v.useEffect(()=>{RI=!0},[]),t}const Rse=S5.useId,Jk=Rse||Mse;function Pse(){const t=new Map;return{emit(e,n){var r;(r=t.get(e))==null||r.forEach(o=>o(n))},on(e,n){t.set(e,[...t.get(e)||[],n])},off(e,n){var r;t.set(e,((r=t.get(e))==null?void 0:r.filter(o=>o!==n))||[])}}}const Dse=v.createContext(null),Nse=v.createContext(null),Qk=()=>{var t;return((t=v.useContext(Dse))==null?void 0:t.id)||null},Zk=()=>v.useContext(Nse);function If(t){return"data-floating-ui-"+t}function el(t){const e=v.useRef(t);return jn(()=>{e.current=t}),e}const DI=If("safe-polygon");function Mm(t,e,n){return n&&!rC(n)?0:typeof t=="number"?t:t==null?void 0:t[e]}function Ose(t,e){e===void 0&&(e={});const{open:n,onOpenChange:r,dataRef:o,events:s,elements:i}=t,{enabled:a=!0,delay:l=0,handleClose:c=null,mouseOnly:u=!1,restMs:d=0,move:h=!0}=e,f=Zk(),p=Qk(),y=el(c),b=el(l),w=el(n),k=v.useRef(),x=v.useRef(-1),A=v.useRef(),I=v.useRef(-1),M=v.useRef(!0),T=v.useRef(!1),S=v.useRef(()=>{}),_=v.useRef(!1),R=v.useCallback(()=>{var z;const W=(z=o.current.openEvent)==null?void 0:z.type;return(W==null?void 0:W.includes("mouse"))&&W!=="mousedown"},[o]);v.useEffect(()=>{if(!a)return;function z(W){let{open:X}=W;X||(clearTimeout(x.current),clearTimeout(I.current),M.current=!0,_.current=!1)}return s.on("openchange",z),()=>{s.off("openchange",z)}},[a,s]),v.useEffect(()=>{if(!a||!y.current||!n)return;function z(X){R()&&r(!1,X,"hover")}const W=Vi(i.floating).documentElement;return W.addEventListener("mouseleave",z),()=>{W.removeEventListener("mouseleave",z)}},[i.floating,n,r,a,y,R]);const D=v.useCallback(function(z,W,X){W===void 0&&(W=!0),X===void 0&&(X="hover");const le=Mm(b.current,"close",k.current);le&&!A.current?(clearTimeout(x.current),x.current=window.setTimeout(()=>r(!1,z,X),le)):W&&(clearTimeout(x.current),r(!1,z,X))},[b,r]),O=Ms(()=>{S.current(),A.current=void 0}),N=Ms(()=>{if(T.current){const z=Vi(i.floating).body;z.style.pointerEvents="",z.removeAttribute(DI),T.current=!1}}),K=Ms(()=>o.current.openEvent?["click","mousedown"].includes(o.current.openEvent.type):!1);v.useEffect(()=>{if(!a)return;function z(te){if(clearTimeout(x.current),M.current=!1,u&&!rC(k.current)||d>0&&!Mm(b.current,"open"))return;const oe=Mm(b.current,"open",k.current);oe?x.current=window.setTimeout(()=>{w.current||r(!0,te,"hover")},oe):n||r(!0,te,"hover")}function W(te){if(K())return;S.current();const oe=Vi(i.floating);if(clearTimeout(I.current),_.current=!1,y.current&&o.current.floatingContext){n||clearTimeout(x.current),A.current=y.current({...o.current.floatingContext,tree:f,x:te.clientX,y:te.clientY,onClose(){N(),O(),K()||D(te,!0,"safe-polygon")}});const lt=A.current;oe.addEventListener("mousemove",lt),S.current=()=>{oe.removeEventListener("mousemove",lt)};return}(k.current==="touch"?!Uc(i.floating,te.relatedTarget):!0)&&D(te)}function X(te){K()||o.current.floatingContext&&(y.current==null||y.current({...o.current.floatingContext,tree:f,x:te.clientX,y:te.clientY,onClose(){N(),O(),K()||D(te)}})(te))}if(Gn(i.domReference)){var le;const te=i.domReference;return n&&te.addEventListener("mouseleave",X),(le=i.floating)==null||le.addEventListener("mouseleave",X),h&&te.addEventListener("mousemove",z,{once:!0}),te.addEventListener("mouseenter",z),te.addEventListener("mouseleave",W),()=>{var oe;n&&te.removeEventListener("mouseleave",X),(oe=i.floating)==null||oe.removeEventListener("mouseleave",X),h&&te.removeEventListener("mousemove",z),te.removeEventListener("mouseenter",z),te.removeEventListener("mouseleave",W)}}},[i,a,t,u,d,h,D,O,N,r,n,w,f,b,y,o,K]),jn(()=>{var z;if(a&&n&&(z=y.current)!=null&&z.__options.blockPointerEvents&&R()){T.current=!0;const X=i.floating;if(Gn(i.domReference)&&X){var W;const le=Vi(i.floating).body;le.setAttribute(DI,"");const te=i.domReference,oe=f==null||(W=f.nodesRef.current.find(ue=>ue.id===p))==null||(W=W.context)==null?void 0:W.elements.floating;return oe&&(oe.style.pointerEvents=""),le.style.pointerEvents="none",te.style.pointerEvents="auto",X.style.pointerEvents="auto",()=>{le.style.pointerEvents="",te.style.pointerEvents="",X.style.pointerEvents=""}}}},[a,n,p,i,f,y,R]),jn(()=>{n||(k.current=void 0,_.current=!1,O(),N())},[n,O,N]),v.useEffect(()=>()=>{O(),clearTimeout(x.current),clearTimeout(I.current),N()},[a,i.domReference,O,N]);const Q=v.useMemo(()=>{function z(W){k.current=W.pointerType}return{onPointerDown:z,onPointerEnter:z,onMouseMove(W){const{nativeEvent:X}=W;function le(){!M.current&&!w.current&&r(!0,X,"hover")}u&&!rC(k.current)||n||d===0||_.current&&W.movementX**2+W.movementY**2<2||(clearTimeout(I.current),k.current==="touch"?le():(_.current=!0,I.current=window.setTimeout(le,d)))}}},[u,r,n,w,d]),ce=v.useMemo(()=>({onMouseEnter(){clearTimeout(x.current)},onMouseLeave(z){K()||D(z.nativeEvent,!1)}}),[D,K]);return v.useMemo(()=>a?{reference:Q,floating:ce}:{},[a,Q,ce])}const iC=()=>{},E5=v.createContext({delay:0,initialDelay:0,timeoutMs:0,currentId:null,setCurrentId:iC,setState:iC,isInstantPhase:!1}),Lse=()=>v.useContext(E5);function Vse(t){const{children:e,delay:n,timeoutMs:r=0}=t,[o,s]=v.useReducer((l,c)=>({...l,...c}),{delay:n,timeoutMs:r,initialDelay:n,currentId:null,isInstantPhase:!1}),i=v.useRef(null),a=v.useCallback(l=>{s({currentId:l})},[]);return jn(()=>{o.currentId?i.current===null?i.current=o.currentId:o.isInstantPhase||s({isInstantPhase:!0}):(o.isInstantPhase&&s({isInstantPhase:!1}),i.current=null)},[o.currentId,o.isInstantPhase]),v.createElement(E5.Provider,{value:v.useMemo(()=>({...o,setState:s,setCurrentId:a}),[o,a])},e)}function jse(t,e){e===void 0&&(e={});const{open:n,onOpenChange:r,floatingId:o}=t,{id:s,enabled:i=!0}=e,a=s??o,l=Lse(),{currentId:c,setCurrentId:u,initialDelay:d,setState:h,timeoutMs:f}=l;return jn(()=>{i&&c&&(h({delay:{open:1,close:Mm(d,"close")}}),c!==a&&r(!1))},[i,a,r,h,c,d]),jn(()=>{function p(){r(!1),h({delay:d,currentId:null})}if(i&&c&&!n&&c===a){if(f){const y=window.setTimeout(p,f);return()=>{clearTimeout(y)}}p()}},[i,n,h,c,a,r,d,f]),jn(()=>{i&&(u===iC||!n||u(a))},[i,n,u,a]),l}function Bv(t,e){let n=t.filter(o=>{var s;return o.parentId===e&&((s=o.context)==null?void 0:s.open)}),r=n;for(;r.length;)r=t.filter(o=>{var s;return(s=r)==null?void 0:s.some(i=>{var a;return o.parentId===i.id&&((a=o.context)==null?void 0:a.open)})}),n=n.concat(r);return n}const T5=()=>({getShadowRoot:!0,displayCheck:typeof ResizeObserver=="function"&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function _5(t,e){const n=k5(t,T5());e==="prev"&&n.reverse();const r=n.indexOf(nC(Vi(t)));return n.slice(r+1)[0]}function Bse(){return _5(document.body,"next")}function $se(){return _5(document.body,"prev")}function $v(t,e){const n=e||t.currentTarget,r=t.relatedTarget;return!r||!Uc(n,r)}function Fse(t){k5(t,T5()).forEach(n=>{n.dataset.tabindex=n.getAttribute("tabindex")||"",n.setAttribute("tabindex","-1")})}function NI(t){t.querySelectorAll("[data-tabindex]").forEach(n=>{const r=n.dataset.tabindex;delete n.dataset.tabindex,r?n.setAttribute("tabindex",r):n.removeAttribute("tabindex")})}const A5={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0};let Hse;function OI(t){t.key==="Tab"&&(t.target,clearTimeout(Hse))}const LI=v.forwardRef(function(e,n){const[r,o]=v.useState();jn(()=>(b5()&&o("button"),document.addEventListener("keydown",OI),()=>{document.removeEventListener("keydown",OI)}),[]);const s={ref:n,tabIndex:0,role:r,"aria-hidden":r?void 0:!0,[If("focus-guard")]:"",style:A5};return v.createElement("span",sC({},e,s))}),I5=v.createContext(null),VI=If("portal");function zse(t){t===void 0&&(t={});const{id:e,root:n}=t,r=Jk(),o=Wse(),[s,i]=v.useState(null),a=v.useRef(null);return jn(()=>()=>{s==null||s.remove(),queueMicrotask(()=>{a.current=null})},[s]),jn(()=>{if(!r||a.current)return;const l=e?document.getElementById(e):null;if(!l)return;const c=document.createElement("div");c.id=r,c.setAttribute(VI,""),l.appendChild(c),a.current=c,i(c)},[e,r]),jn(()=>{if(n===null||!r||a.current)return;let l=n||(o==null?void 0:o.portalNode);l&&!Gn(l)&&(l=l.current),l=l||document.body;let c=null;e&&(c=document.createElement("div"),c.id=e,l.appendChild(c));const u=document.createElement("div");u.id=r,u.setAttribute(VI,""),l=c||l,l.appendChild(u),a.current=u,i(u)},[e,n,r,o]),s}function Use(t){const{children:e,id:n,root:r,preserveTabOrder:o=!0}=t,s=zse({id:n,root:r}),[i,a]=v.useState(null),l=v.useRef(null),c=v.useRef(null),u=v.useRef(null),d=v.useRef(null),h=i==null?void 0:i.modal,f=i==null?void 0:i.open,p=!!i&&!i.modal&&i.open&&o&&!!(r||s);return v.useEffect(()=>{if(!s||!o||h)return;function y(b){s&&$v(b)&&(b.type==="focusin"?NI:Fse)(s)}return s.addEventListener("focusin",y,!0),s.addEventListener("focusout",y,!0),()=>{s.removeEventListener("focusin",y,!0),s.removeEventListener("focusout",y,!0)}},[s,o,h]),v.useEffect(()=>{s&&(f||NI(s))},[f,s]),v.createElement(I5.Provider,{value:v.useMemo(()=>({preserveTabOrder:o,beforeOutsideRef:l,afterOutsideRef:c,beforeInsideRef:u,afterInsideRef:d,portalNode:s,setFocusManagerState:a}),[o,s])},p&&s&&v.createElement(LI,{"data-type":"outside",ref:l,onFocus:y=>{if($v(y,s)){var b;(b=u.current)==null||b.focus()}else{const w=$se()||(i==null?void 0:i.refs.domReference.current);w==null||w.focus()}}}),p&&s&&v.createElement("span",{"aria-owns":s.id,style:A5}),s&&gn.createPortal(e,s),p&&s&&v.createElement(LI,{"data-type":"outside",ref:c,onFocus:y=>{if($v(y,s)){var b;(b=d.current)==null||b.focus()}else{const w=Bse()||(i==null?void 0:i.refs.domReference.current);w==null||w.focus(),i!=null&&i.closeOnFocusOut&&(i==null||i.onOpenChange(!1,y.nativeEvent,"focus-out"))}}}))}const Wse=()=>v.useContext(I5),qse="data-floating-ui-focusable",Gse={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},Kse={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},jI=t=>{var e,n;return{escapeKey:typeof t=="boolean"?t:(e=t==null?void 0:t.escapeKey)!=null?e:!1,outsidePress:typeof t=="boolean"?t:(n=t==null?void 0:t.outsidePress)!=null?n:!0}};function M5(t,e){e===void 0&&(e={});const{open:n,onOpenChange:r,elements:o,dataRef:s}=t,{enabled:i=!0,escapeKey:a=!0,outsidePress:l=!0,outsidePressEvent:c="pointerdown",referencePress:u=!1,referencePressEvent:d="pointerdown",ancestorScroll:h=!1,bubbles:f,capture:p}=e,y=Zk(),b=Ms(typeof l=="function"?l:()=>!1),w=typeof l=="function"?b:l,k=v.useRef(!1),x=v.useRef(!1),{escapeKey:A,outsidePress:I}=jI(f),{escapeKey:M,outsidePress:T}=jI(p),S=v.useRef(!1),_=Ms(Q=>{var ce;if(!n||!i||!a||Q.key!=="Escape"||S.current)return;const z=(ce=s.current.floatingContext)==null?void 0:ce.nodeId,W=y?Bv(y.nodesRef.current,z):[];if(!A&&(Q.stopPropagation(),W.length>0)){let X=!0;if(W.forEach(le=>{var te;if((te=le.context)!=null&&te.open&&!le.context.dataRef.current.__escapeKeyBubbles){X=!1;return}}),!X)return}r(!1,sse(Q)?Q.nativeEvent:Q,"escape-key")}),R=Ms(Q=>{var ce;const z=()=>{var W;_(Q),(W=sc(Q))==null||W.removeEventListener("keydown",z)};(ce=sc(Q))==null||ce.addEventListener("keydown",z)}),D=Ms(Q=>{var ce;const z=k.current;k.current=!1;const W=x.current;if(x.current=!1,c==="click"&&W||z||typeof w=="function"&&!w(Q))return;const X=sc(Q),le="["+If("inert")+"]",te=Vi(o.floating).querySelectorAll(le);let oe=Gn(X)?X:null;for(;oe&&!x_(oe);){const De=A$(oe);if(x_(De)||!Gn(De))break;oe=De}if(te.length&&Gn(X)&&!ise(X)&&!Uc(X,o.floating)&&Array.from(te).every(De=>!Uc(oe,De)))return;if(mx(X)&&K){const De=X.clientWidth>0&&X.scrollWidth>X.clientWidth,Ge=X.clientHeight>0&&X.scrollHeight>X.clientHeight;let gt=Ge&&Q.offsetX>X.clientWidth;if(Ge&&I$(X).direction==="rtl"&&(gt=Q.offsetX<=X.offsetWidth-X.clientWidth),gt||De&&Q.offsetY>X.clientHeight)return}const ue=(ce=s.current.floatingContext)==null?void 0:ce.nodeId,lt=y&&Bv(y.nodesRef.current,ue).some(De=>{var Ge;return jv(Q,(Ge=De.context)==null?void 0:Ge.elements.floating)});if(jv(Q,o.floating)||jv(Q,o.domReference)||lt)return;const Ze=y?Bv(y.nodesRef.current,ue):[];if(Ze.length>0){let De=!0;if(Ze.forEach(Ge=>{var gt;if((gt=Ge.context)!=null&&gt.open&&!Ge.context.dataRef.current.__outsidePressBubbles){De=!1;return}}),!De)return}r(!1,Q,"outside-press")}),O=Ms(Q=>{var ce;const z=()=>{var W;D(Q),(W=sc(Q))==null||W.removeEventListener(c,z)};(ce=sc(Q))==null||ce.addEventListener(c,z)});v.useEffect(()=>{if(!n||!i)return;s.current.__escapeKeyBubbles=A,s.current.__outsidePressBubbles=I;let Q=-1;function ce(te){r(!1,te,"ancestor-scroll")}function z(){window.clearTimeout(Q),S.current=!0}function W(){Q=window.setTimeout(()=>{S.current=!1},_$()?5:0)}const X=Vi(o.floating);a&&(X.addEventListener("keydown",M?R:_,M),X.addEventListener("compositionstart",z),X.addEventListener("compositionend",W)),w&&X.addEventListener(c,T?O:D,T);let le=[];return h&&(Gn(o.domReference)&&(le=dm(o.domReference)),Gn(o.floating)&&(le=le.concat(dm(o.floating))),!Gn(o.reference)&&o.reference&&o.reference.contextElement&&(le=le.concat(dm(o.reference.contextElement)))),le=le.filter(te=>{var oe;return te!==((oe=X.defaultView)==null?void 0:oe.visualViewport)}),le.forEach(te=>{te.addEventListener("scroll",ce,{passive:!0})}),()=>{a&&(X.removeEventListener("keydown",M?R:_,M),X.removeEventListener("compositionstart",z),X.removeEventListener("compositionend",W)),w&&X.removeEventListener(c,T?O:D,T),le.forEach(te=>{te.removeEventListener("scroll",ce)}),window.clearTimeout(Q)}},[s,o,a,w,c,n,r,h,i,A,I,_,M,R,D,T,O]),v.useEffect(()=>{k.current=!1},[w,c]);const N=v.useMemo(()=>({onKeyDown:_,[Gse[d]]:Q=>{u&&r(!1,Q.nativeEvent,"reference-press")}}),[_,r,u,d]),K=v.useMemo(()=>({onKeyDown:_,onMouseDown(){x.current=!0},onMouseUp(){x.current=!0},[Kse[c]]:()=>{k.current=!0}}),[_,c]);return v.useMemo(()=>i?{reference:N,floating:K}:{},[i,N,K])}function Yse(t){const{open:e=!1,onOpenChange:n,elements:r}=t,o=Jk(),s=v.useRef({}),[i]=v.useState(()=>Pse()),a=Qk()!=null,[l,c]=v.useState(r.reference),u=Ms((f,p,y)=>{s.current.openEvent=f?p:void 0,i.emit("openchange",{open:f,event:p,reason:y,nested:a}),n==null||n(f,p,y)}),d=v.useMemo(()=>({setPositionReference:c}),[]),h=v.useMemo(()=>({reference:l||r.reference||null,floating:r.floating||null,domReference:r.reference}),[l,r.reference,r.floating]);return v.useMemo(()=>({dataRef:s,open:e,onOpenChange:u,elements:h,events:i,floatingId:o,refs:d}),[e,u,h,i,o,d])}function fu(t){t===void 0&&(t={});const{nodeId:e}=t,n=Yse({...t,elements:{reference:null,floating:null,...t.elements}}),r=t.rootContext||n,o=r.elements,[s,i]=v.useState(null),[a,l]=v.useState(null),u=(o==null?void 0:o.domReference)||s,d=v.useRef(null),h=Zk();jn(()=>{u&&(d.current=u)},[u]);const f=S$({...t,elements:{...o,...a&&{reference:a}}}),p=v.useCallback(x=>{const A=Gn(x)?{getBoundingClientRect:()=>x.getBoundingClientRect(),contextElement:x}:x;l(A),f.refs.setReference(A)},[f.refs]),y=v.useCallback(x=>{(Gn(x)||x===null)&&(d.current=x,i(x)),(Gn(f.refs.reference.current)||f.refs.reference.current===null||x!==null&&!Gn(x))&&f.refs.setReference(x)},[f.refs]),b=v.useMemo(()=>({...f.refs,setReference:y,setPositionReference:p,domReference:d}),[f.refs,y,p]),w=v.useMemo(()=>({...f.elements,domReference:u}),[f.elements,u]),k=v.useMemo(()=>({...f,...r,refs:b,elements:w,nodeId:e}),[f,b,w,e,r]);return jn(()=>{r.dataRef.current.floatingContext=k;const x=h==null?void 0:h.nodesRef.current.find(A=>A.id===e);x&&(x.context=k)}),v.useMemo(()=>({...f,context:k,refs:b,elements:w}),[f,b,w,k])}function Xse(t,e){e===void 0&&(e={});const{open:n,onOpenChange:r,events:o,dataRef:s,elements:i}=t,{enabled:a=!0,visibleOnly:l=!0}=e,c=v.useRef(!1),u=v.useRef(),d=v.useRef(!0);v.useEffect(()=>{if(!a)return;const f=E$(i.domReference);function p(){!n&&mx(i.domReference)&&i.domReference===nC(Vi(i.domReference))&&(c.current=!0)}function y(){d.current=!0}return f.addEventListener("blur",p),f.addEventListener("keydown",y,!0),()=>{f.removeEventListener("blur",p),f.removeEventListener("keydown",y,!0)}},[i.domReference,n,a]),v.useEffect(()=>{if(!a)return;function f(p){let{reason:y}=p;(y==="reference-press"||y==="escape-key")&&(c.current=!0)}return o.on("openchange",f),()=>{o.off("openchange",f)}},[o,a]),v.useEffect(()=>()=>{clearTimeout(u.current)},[]);const h=v.useMemo(()=>({onPointerDown(f){nse(f.nativeEvent)||(d.current=!1)},onMouseLeave(){c.current=!1},onFocus(f){if(c.current)return;const p=sc(f.nativeEvent);if(l&&Gn(p))try{if(b5()&&rse())throw Error();if(!p.matches(":focus-visible"))return}catch{if(!d.current&&!lse(p))return}r(!0,f.nativeEvent,"focus")},onBlur(f){c.current=!1;const p=f.relatedTarget,y=f.nativeEvent,b=Gn(p)&&p.hasAttribute(If("focus-guard"))&&p.getAttribute("data-type")==="outside";u.current=window.setTimeout(()=>{var w;const k=nC(i.domReference?i.domReference.ownerDocument:document);!p&&k===i.domReference||Uc((w=s.current.floatingContext)==null?void 0:w.refs.floating.current,k)||Uc(i.domReference,k)||b||r(!1,y,"focus")})}}),[s,i.domReference,r,l]);return v.useMemo(()=>a?{reference:h}:{},[a,h])}const BI="active",$I="selected";function Fv(t,e,n){const r=new Map,o=n==="item";let s=t;if(o&&t){const{[BI]:i,[$I]:a,...l}=t;s=l}return{...n==="floating"&&{tabIndex:-1,[qse]:""},...s,...e.map(i=>{const a=i?i[n]:null;return typeof a=="function"?t?a(t):null:a}).concat(t).reduce((i,a)=>(a&&Object.entries(a).forEach(l=>{let[c,u]=l;if(!(o&&[BI,$I].includes(c)))if(c.indexOf("on")===0){if(r.has(c)||r.set(c,[]),typeof u=="function"){var d;(d=r.get(c))==null||d.push(u),i[c]=function(){for(var h,f=arguments.length,p=new Array(f),y=0;y<f;y++)p[y]=arguments[y];return(h=r.get(c))==null?void 0:h.map(b=>b(...p)).find(b=>b!==void 0)}}}else i[c]=u}),i),{})}}function R5(t){t===void 0&&(t=[]);const e=t.map(a=>a==null?void 0:a.reference),n=t.map(a=>a==null?void 0:a.floating),r=t.map(a=>a==null?void 0:a.item),o=v.useCallback(a=>Fv(a,t,"reference"),e),s=v.useCallback(a=>Fv(a,t,"floating"),n),i=v.useCallback(a=>Fv(a,t,"item"),r);return v.useMemo(()=>({getReferenceProps:o,getFloatingProps:s,getItemProps:i}),[o,s,i])}const Jse=new Map([["select","listbox"],["combobox","listbox"],["label",!1]]);function Qse(t,e){var n;e===void 0&&(e={});const{open:r,floatingId:o}=t,{enabled:s=!0,role:i="dialog"}=e,a=(n=Jse.get(i))!=null?n:i,l=Jk(),u=Qk()!=null,d=v.useMemo(()=>a==="tooltip"||i==="label"?{["aria-"+(i==="label"?"labelledby":"describedby")]:r?o:void 0}:{"aria-expanded":r?"true":"false","aria-haspopup":a==="alertdialog"?"dialog":a,"aria-controls":r?o:void 0,...a==="listbox"&&{role:"combobox"},...a==="menu"&&{id:l},...a==="menu"&&u&&{role:"menuitem"},...i==="select"&&{"aria-autocomplete":"none"},...i==="combobox"&&{"aria-autocomplete":"list"}},[a,o,u,r,l,i]),h=v.useMemo(()=>{const p={id:o,...a&&{role:a}};return a==="tooltip"||i==="label"?p:{...p,...a==="menu"&&{"aria-labelledby":l}}},[a,o,l,i]),f=v.useCallback(p=>{let{active:y,selected:b}=p;const w={role:"option",...y&&{id:o+"-option"}};switch(i){case"select":return{...w,"aria-selected":y&&b};case"combobox":return{...w,...y&&{"aria-selected":!0}}}return{}},[o,i]);return v.useMemo(()=>s?{reference:d,floating:h,item:f}:{},[s,d,h,f])}const FI=t=>t.replace(/[A-Z]+(?![a-z])|[A-Z]/g,(e,n)=>(n?"-":"")+e.toLowerCase());function Kl(t,e){return typeof t=="function"?t(e):t}function Zse(t,e){const[n,r]=v.useState(t);return t&&!n&&r(!0),v.useEffect(()=>{if(!t&&n){const o=setTimeout(()=>r(!1),e);return()=>clearTimeout(o)}},[t,n,e]),n}function eie(t,e){e===void 0&&(e={});const{open:n,elements:{floating:r}}=t,{duration:o=250}=e,i=(typeof o=="number"?o:o.close)||0,[a,l]=v.useState("unmounted"),c=Zse(n,i);return!c&&a==="close"&&l("unmounted"),jn(()=>{if(r){if(n){l("initial");const u=requestAnimationFrame(()=>{l("open")});return()=>{cancelAnimationFrame(u)}}l("close")}},[n,r]),{isMounted:c,status:a}}function eS(t,e){e===void 0&&(e={});const{initial:n={opacity:0},open:r,close:o,common:s,duration:i=250}=e,a=t.placement,l=a.split("-")[0],c=v.useMemo(()=>({side:l,placement:a}),[l,a]),u=typeof i=="number",d=(u?i:i.open)||0,h=(u?i:i.close)||0,[f,p]=v.useState(()=>({...Kl(s,c),...Kl(n,c)})),{isMounted:y,status:b}=eie(t,{duration:i}),w=el(n),k=el(r),x=el(o),A=el(s);return jn(()=>{const I=Kl(w.current,c),M=Kl(x.current,c),T=Kl(A.current,c),S=Kl(k.current,c)||Object.keys(I).reduce((_,R)=>(_[R]="",_),{});if(b==="initial"&&p(_=>({transitionProperty:_.transitionProperty,...T,...I})),b==="open"&&p({transitionProperty:Object.keys(S).map(FI).join(","),transitionDuration:d+"ms",...T,...S}),b==="close"){const _=M||I;p({transitionProperty:Object.keys(_).map(FI).join(","),transitionDuration:h+"ms",...T,..._})}},[h,x,w,k,A,d,b,c]),{isMounted:y,styles:f}}var P5={exports:{}},Hv={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HI;function tie(){if(HI)return Hv;HI=1;var t=$;function e(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,o=t.useEffect,s=t.useLayoutEffect,i=t.useDebugValue;function a(d,h){var f=h(),p=r({inst:{value:f,getSnapshot:h}}),y=p[0].inst,b=p[1];return s(function(){y.value=f,y.getSnapshot=h,l(y)&&b({inst:y})},[d,f,h]),o(function(){return l(y)&&b({inst:y}),d(function(){l(y)&&b({inst:y})})},[d]),i(f),f}function l(d){var h=d.getSnapshot;d=d.value;try{var f=h();return!n(d,f)}catch{return!0}}function c(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return Hv.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,Hv}P5.exports=tie();var D5=P5.exports;const nie=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},rie=({contentComponent:t})=>{const e=D5.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return $.createElement($.Fragment,null,Object.values(e))};function oie(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:ZD.createPortal(r.reactElement,r.element,n)},t.forEach(o=>o())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(o=>o())}}}class sie extends $.Component{constructor(e){var n;super(e),this.editorContentRef=$.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((n=e.editor)===null||n===void 0)&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.options.element.childNodes),e.setOptions({element:n}),e.contentComponent=oie(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})}render(){const{editor:e,innerRef:n,...r}=this.props;return $.createElement($.Fragment,null,$.createElement("div",{ref:nie(n,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&$.createElement(rie,{contentComponent:e.contentComponent}))}}const iie=v.forwardRef((t,e)=>{const n=$.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return $.createElement(sie,{key:n,innerRef:e,...t})});$.memo(iie);var zv={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zI;function aie(){if(zI)return zv;zI=1;var t=$,e=D5;function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,o=e.useSyncExternalStore,s=t.useRef,i=t.useEffect,a=t.useMemo,l=t.useDebugValue;return zv.useSyncExternalStoreWithSelector=function(c,u,d,h,f){var p=s(null);if(p.current===null){var y={hasValue:!1,value:null};p.current=y}else y=p.current;p=a(function(){function w(M){if(!k){if(k=!0,x=M,M=h(M),f!==void 0&&y.hasValue){var T=y.value;if(f(T,M))return A=T}return A=M}if(T=A,r(x,M))return T;var S=h(M);return f!==void 0&&f(T,S)?T:(x=M,A=S)}var k=!1,x,A,I=d===void 0?null:d;return[function(){return w(u())},I===null?void 0:function(){return w(I())}]},[u,d,h,f]);var b=o(c,p[0],p[1]);return i(function(){y.hasValue=!0,y.value=b},[b]),l(b),b},zv}aie();const lie=v.createContext({editor:null});lie.Consumer;const N5=v.createContext({onDragStart:void 0}),O5=()=>v.useContext(N5),cie=$.forwardRef((t,e)=>{const{onDragStart:n}=O5(),r=t.as||"div";return $.createElement(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});function uie(t){return!!(typeof t=="function"&&t.prototype&&t.prototype.isReactComponent)}function die(t){var e;return typeof t=="object"&&((e=t.$$typeof)===null||e===void 0?void 0:e.toString())==="Symbol(react.forward_ref)"}class hie{constructor(e,{editor:n,props:r={},as:o="div",className:s=""}){this.ref=null,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=e,this.editor=n,this.props=r,this.element=document.createElement(o),this.element.classList.add("react-renderer"),s&&this.element.classList.add(...s.split(" ")),this.editor.isInitialized?gn.flushSync(()=>{this.render()}):this.render()}render(){var e;const n=this.component,r=this.props,o=this.editor;(uie(n)||die(n))&&(r.ref=s=>{this.ref=s}),this.reactElement=$.createElement(n,{...r}),(e=o==null?void 0:o.contentComponent)===null||e===void 0||e.setRenderer(this.id,this)}updateProps(e={}){this.props={...this.props,...e},this.render()}destroy(){var e;const n=this.editor;(e=n==null?void 0:n.contentComponent)===null||e===void 0||e.removeRenderer(this.id)}updateAttributes(e){Object.keys(e).forEach(n=>{this.element.setAttribute(n,e[n])})}}class fie extends AY{mount(){const e={editor:this.editor,node:this.node,decorations:this.decorations,innerDecorations:this.innerDecorations,view:this.view,selected:!1,extension:this.extension,HTMLAttributes:this.HTMLAttributes,getPos:()=>this.getPos(),updateAttributes:(c={})=>this.updateAttributes(c),deleteNode:()=>this.deleteNode()};if(!this.component.displayName){const c=u=>u.charAt(0).toUpperCase()+u.substring(1);this.component.displayName=c(this.extension.name)}const o={onDragStart:this.onDragStart.bind(this),nodeViewContentRef:c=>{c&&this.contentDOMElement&&c.firstChild!==this.contentDOMElement&&c.appendChild(this.contentDOMElement)}},s=this.component,i=$.memo(c=>$.createElement(N5.Provider,{value:o},$.createElement(s,c)));i.displayName="ReactNodeView",this.node.isLeaf?this.contentDOMElement=null:this.options.contentDOMElementTag?this.contentDOMElement=document.createElement(this.options.contentDOMElementTag):this.contentDOMElement=document.createElement(this.node.isInline?"span":"div"),this.contentDOMElement&&(this.contentDOMElement.dataset.nodeViewContentReact="",this.contentDOMElement.style.whiteSpace="inherit");let a=this.node.isInline?"span":"div";this.options.as&&(a=this.options.as);const{className:l=""}=this.options;this.handleSelectionUpdate=this.handleSelectionUpdate.bind(this),this.renderer=new hie(i,{editor:this.editor,props:e,as:a,className:`node-${this.node.type.name} ${l}`.trim()}),this.editor.on("selectionUpdate",this.handleSelectionUpdate),this.updateElementAttributes()}get dom(){var e;if(this.renderer.element.firstElementChild&&!(!((e=this.renderer.element.firstElementChild)===null||e===void 0)&&e.hasAttribute("data-node-view-wrapper")))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){return this.node.isLeaf?null:this.contentDOMElement}handleSelectionUpdate(){const{from:e,to:n}=this.editor.state.selection,r=this.getPos();if(typeof r=="number")if(e<=r&&n>=r+this.node.nodeSize){if(this.renderer.props.selected)return;this.selectNode()}else{if(!this.renderer.props.selected)return;this.deselectNode()}}update(e,n,r){const o=s=>{this.renderer.updateProps(s),typeof this.options.attrs=="function"&&this.updateElementAttributes()};if(e.type!==this.node.type)return!1;if(typeof this.options.update=="function"){const s=this.node,i=this.decorations,a=this.innerDecorations;return this.node=e,this.decorations=n,this.innerDecorations=r,this.options.update({oldNode:s,oldDecorations:i,newNode:e,newDecorations:n,oldInnerDecorations:a,innerDecorations:r,updateProps:()=>o({node:e,decorations:n,innerDecorations:r})})}return e===this.node&&this.decorations===n&&this.innerDecorations===r||(this.node=e,this.decorations=n,this.innerDecorations=r,o({node:e,decorations:n,innerDecorations:r})),!0}selectNode(){this.renderer.updateProps({selected:!0}),this.renderer.element.classList.add("ProseMirror-selectednode")}deselectNode(){this.renderer.updateProps({selected:!1}),this.renderer.element.classList.remove("ProseMirror-selectednode")}destroy(){this.renderer.destroy(),this.editor.off("selectionUpdate",this.handleSelectionUpdate),this.contentDOMElement=null}updateElementAttributes(){if(this.options.attrs){let e={};if(typeof this.options.attrs=="function"){const n=this.editor.extensionManager.attributes,r=og(this.node,n);e=this.options.attrs({node:this.node,HTMLAttributes:r})}else e=this.options.attrs;this.renderer.updateAttributes(e)}}}function pie(t,e){return n=>n.editor.contentComponent?new fie(t,n,e):{}}var Up={},UI;function mie(){if(UI)return Up;UI=1;var t=M$();return Up.createRoot=t.createRoot,Up.hydrateRoot=t.hydrateRoot,Up}var gie=mie();const L5=v.createContext(void 0);function fs(t){return v.useContext(L5)}function pe(t){const e=fs();if(!(e!=null&&e.editor))throw new Error("useBlockNoteEditor was called outside of a BlockNoteContext provider or BlockNoteView component");return e.editor}function tS(t,e,n){const r=fs();e||(e=r==null?void 0:r.editor),v.useEffect(()=>{if(!e)throw new Error("'editor' is required, either from BlockNoteContext or as a function argument");return e.onSelectionChange(t,n)},[t,e,n])}function yie(t,e){const n=pe();e=e||n;const[r,o]=v.useState(()=>{if(t)return e.getSelectionBoundingBox()}),s=v.useCallback(()=>{if(!t)return;const i=e.getSelectionBoundingBox();o(i)},[e,t]);return tS(s,e,!0),v.useEffect(()=>{o(t?e.getSelectionBoundingBox():void 0)},[t,e]),r}function bie(t){return t.getBoundingClientRect!==void 0}function ba(t,e,n,r){const{refs:o,update:s,context:i,floatingStyles:a,isPositioned:l}=fu({open:t,...r}),{isMounted:c,styles:u}=eS(i),d=typeof(r==null?void 0:r.canDismiss)=="object"?r.canDismiss:{enabled:r==null?void 0:r.canDismiss},h=M5(i,d),{getReferenceProps:f,getFloatingProps:p}=R5([h]);return v.useEffect(()=>{s()},[e,s]),v.useEffect(()=>{e!==null&&(e instanceof HTMLElement||bie(e)?o.setReference(e):o.setReference({getBoundingClientRect:()=>e}))},[e,o]),v.useMemo(()=>({isMounted:c,ref:o.setFloating,setReference:o.setReference,style:{display:"flex",...u,...a,zIndex:n},getFloatingProps:p,getReferenceProps:f,isPositioned:l}),[l,a,c,o.setFloating,o.setReference,u,n,p,f])}function ei(t){const[e,n]=v.useState();return v.useEffect(()=>t(r=>{n({...r})}),[t]),e}const V5=v.createContext(void 0);function de(){return v.useContext(V5)}const xb=(t={},e=[])=>v.useMemo(()=>{const n=Zoe.create(t);return window&&(window.ProseMirror=n._tiptapEditor),n},e);function _e(){return fs().editor.dictionary}function nS(t,e){const n=fs();e||(e=n==null?void 0:n.editor),v.useEffect(()=>{if(!e)throw new Error("'editor' is required, either from BlockNoteContext or as a function argument");return e.onChange(t)},[t,e])}const rS=t=>{const[e,n]=v.useState(!1),[r,o]=v.useState(t.editor.isEmpty),s=de();nS(()=>{o(t.editor.isEmpty)},t.editor);const i=v.useCallback(()=>{n(!0)},[]),a=v.useCallback(()=>{n(!1)},[]);return v.useEffect(()=>{t.editable&&t.autoFocus&&t.editor.focus()},[t.autoFocus,t.editable,t.editor]),m.jsxs(m.Fragment,{children:[m.jsx(s.Comments.Editor,{autoFocus:t.autoFocus,className:"bn-comment-editor",editor:t.editor,onFocus:i,onBlur:a,editable:t.editable}),t.actions&&m.jsx("div",{className:"bn-comment-actions-wrapper",children:m.jsx(t.actions,{isFocused:e,isEmpty:r})})]})},vie=Zs(Qr(Uk.paragraph.implementation.node.config),{}),{textColor:mIe,backgroundColor:gIe,...wie}=Wk,oS=qk.create({blockSpecs:{paragraph:vie},styleSpecs:wie});function Cie(){const t=pe();if(!t.comments)throw new Error("Comments plugin not found");const e=t.comments,n=de(),r=_e(),o=xb({trailingBlock:!1,dictionary:{...r,placeholders:{emptyDocument:r.placeholders.new_comment}},schema:oS,sideMenuDetection:"editor"});return m.jsx(n.Comments.Card,{className:"bn-thread",children:m.jsx(rS,{autoFocus:!0,editable:!0,editor:o,actions:({isEmpty:s})=>m.jsx(n.Generic.Toolbar.Root,{className:dt("bn-action-toolbar","bn-comment-actions"),variant:"action-toolbar",children:m.jsx(n.Generic.Toolbar.Button,{className:"bn-button",mainTooltip:"Save",variant:"compact",isDisabled:s,onClick:async()=>{await e.createThread({initialComment:{body:o.document}}),e.stopPendingComment()},children:"Save"})})})})}const xie=t=>{const e=pe();if(!e.comments)throw new Error("FloatingComposerController can only be used when BlockNote editor has enabled comments");const n=e.comments;v.useEffect(()=>{const u=n.onUpdate(d=>e.setForceSelectionVisible(d.pendingComment));return()=>u()},[n,e]);const r=ei(n.onUpdate.bind(n)),o=yie(r==null?void 0:r.pendingComment),{isMounted:s,ref:i,style:a,getFloatingProps:l}=ba((r==null?void 0:r.pendingComment)||!1,o||null,5e3,{placement:"bottom",middleware:[is(10),Pl(),bo()],onOpenChange:u=>{u||(n.stopPendingComment(),e.focus())},...t.floatingOptions});if(!s||!r)return null;const c=t.floatingComposer||Cie;return m.jsx("div",{ref:i,style:a,...l(),children:m.jsx(c,{})})};var j5={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},WI=$.createContext&&$.createContext(j5),kie=["attr","size","title"];function Sie(t,e){if(t==null)return{};var n=Eie(t,e),r,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)r=s[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Eie(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Qg(){return Qg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Qg.apply(this,arguments)}function qI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Zg(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?qI(Object(n),!0).forEach(function(r){Tie(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qI(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Tie(t,e,n){return e=_ie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ie(t){var e=Aie(t,"string");return typeof e=="symbol"?e:e+""}function Aie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function B5(t){return t&&t.map((e,n)=>$.createElement(e.tag,Zg({key:n},e.attr),B5(e.child)))}function ve(t){return e=>$.createElement(Iie,Qg({attr:Zg({},t.attr)},e),B5(t.child))}function Iie(t){var e=n=>{var{attr:r,size:o,title:s}=t,i=Sie(t,kie),a=o||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),$.createElement("svg",Qg({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,i,{className:l,style:Zg(Zg({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),s&&$.createElement("title",null,s),t.children)};return WI!==void 0?$.createElement(WI.Consumer,null,n=>e(n)):e(j5)}function Mie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8 7V11L2 6L8 1V5H13C17.4183 5 21 8.58172 21 13C21 17.4183 17.4183 21 13 21H4V19H13C16.3137 19 19 16.3137 19 13C19 9.68629 16.3137 7 13 7H8Z"},child:[]}]})(t)}function $5(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M7.29117 20.8242L2 22L3.17581 16.7088C2.42544 15.3056 2 13.7025 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C10.2975 22 8.6944 21.5746 7.29117 20.8242ZM7.58075 18.711L8.23428 19.0605C9.38248 19.6745 10.6655 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 13.3345 4.32549 14.6175 4.93949 15.7657L5.28896 16.4192L4.63416 19.3658L7.58075 18.711Z"},child:[]}]})(t)}function Rie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M7.24264 17.9967H3V13.754L14.435 2.319C14.8256 1.92848 15.4587 1.92848 15.8492 2.319L18.6777 5.14743C19.0682 5.53795 19.0682 6.17112 18.6777 6.56164L7.24264 17.9967ZM3 19.9967H21V21.9967H3V19.9967Z"},child:[]}]})(t)}function Pie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M23 12L15.9289 19.0711L14.5147 17.6569L20.1716 12L14.5147 6.34317L15.9289 4.92896L23 12ZM3.82843 12L9.48528 17.6569L8.07107 19.0711L1 12L8.07107 4.92896L9.48528 6.34317L3.82843 12Z"},child:[]}]})(t)}function sS(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 8L9.00319 2H19.9978C20.5513 2 21 2.45531 21 2.9918V21.0082C21 21.556 20.5551 22 20.0066 22H3.9934C3.44476 22 3 21.5501 3 20.9932V8ZM10 4V9H5V20H19V4H10Z"},child:[]}]})(t)}function Die(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 4H21V6H3V4ZM5 19H19V21H5V19ZM3 14H21V16H3V14ZM5 9H19V11H5V9Z"},child:[]}]})(t)}function Nie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 4H21V6H3V4ZM3 19H21V21H3V19ZM3 14H21V16H3V14ZM3 9H21V11H3V9Z"},child:[]}]})(t)}function Oie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 4H21V6H3V4ZM3 19H17V21H3V19ZM3 14H21V16H3V14ZM3 9H17V11H3V9Z"},child:[]}]})(t)}function Lie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 4H21V6H3V4ZM7 19H21V21H7V19ZM3 14H21V16H3V14ZM7 9H21V11H7V9Z"},child:[]}]})(t)}function Vie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8 11H12.5C13.8807 11 15 9.88071 15 8.5C15 7.11929 13.8807 6 12.5 6H8V11ZM18 15.5C18 17.9853 15.9853 20 13.5 20H6V4H12.5C14.9853 4 17 6.01472 17 8.5C17 9.70431 16.5269 10.7981 15.7564 11.6058C17.0979 12.3847 18 13.837 18 15.5ZM8 13V18H13.5C14.8807 18 16 16.8807 16 15.5C16 14.1193 14.8807 13 13.5 13H8Z"},child:[]}]})(t)}function jie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3.41436 5.99995L5.70726 3.70706L4.29304 2.29285L0.585938 5.99995L4.29304 9.70706L5.70726 8.29285L3.41436 5.99995ZM9.58594 5.99995L7.29304 3.70706L8.70726 2.29285L12.4144 5.99995L8.70726 9.70706L7.29304 8.29285L9.58594 5.99995ZM14.0002 2.99995H21.0002C21.5524 2.99995 22.0002 3.44767 22.0002 3.99995V20C22.0002 20.5522 21.5524 21 21.0002 21H3.00015C2.44787 21 2.00015 20.5522 2.00015 20V12H4.00015V19H20.0002V4.99995H14.0002V2.99995Z"},child:[]}]})(t)}function GI(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M5.55397 22H3.3999L10.9999 3H12.9999L20.5999 22H18.4458L16.0458 16H7.95397L5.55397 22ZM8.75397 14H15.2458L11.9999 5.88517L8.75397 14Z"},child:[]}]})(t)}function F5(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M13 20H11V13H4V20H2V4H4V11H11V4H13V20ZM21.0005 8V20H19.0005L19 10.204L17 10.74V8.67L19.5005 8H21.0005Z"},child:[]}]})(t)}function H5(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M4 4V11H11V4H13V20H11V13H4V20H2V4H4ZM18.5 8C20.5711 8 22.25 9.67893 22.25 11.75C22.25 12.6074 21.9623 13.3976 21.4781 14.0292L21.3302 14.2102L18.0343 18H22V20H15L14.9993 18.444L19.8207 12.8981C20.0881 12.5908 20.25 12.1893 20.25 11.75C20.25 10.7835 19.4665 10 18.5 10C17.5818 10 16.8288 10.7071 16.7558 11.6065L16.75 11.75H14.75C14.75 9.67893 16.4289 8 18.5 8Z"},child:[]}]})(t)}function z5(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M22 8L21.9984 10L19.4934 12.883C21.0823 13.3184 22.25 14.7728 22.25 16.5C22.25 18.5711 20.5711 20.25 18.5 20.25C16.674 20.25 15.1528 18.9449 14.8184 17.2166L16.7821 16.8352C16.9384 17.6413 17.6481 18.25 18.5 18.25C19.4665 18.25 20.25 17.4665 20.25 16.5C20.25 15.5335 19.4665 14.75 18.5 14.75C18.214 14.75 17.944 14.8186 17.7056 14.9403L16.3992 13.3932L19.3484 10H15V8H22ZM4 4V11H11V4H13V20H11V13H4V20H2V4H4Z"},child:[]}]})(t)}function Bie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 4H21V6H3V4ZM3 19H21V21H3V19ZM11 14H21V16H11V14ZM11 9H21V11H11V9ZM3 12.5L7 9V16L3 12.5Z"},child:[]}]})(t)}function $ie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 4H21V6H3V4ZM3 19H21V21H3V19ZM11 14H21V16H11V14ZM11 9H21V11H11V9ZM7 12.5L3 16V9L7 12.5Z"},child:[]}]})(t)}function KI(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8 5H11V19H8V21H16V19H13V5H16V3H8V5ZM2 7C1.44772 7 1 7.44772 1 8V16C1 16.5523 1.44772 17 2 17H8V15H3V9H8V7H2ZM16 9H21V15H16V17H22C22.5523 17 23 16.5523 23 16V8C23 7.44772 22.5523 7 22 7H16V9Z"},child:[]}]})(t)}function Fie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M15 20H7V18H9.92661L12.0425 6H9V4H17V6H14.0734L11.9575 18H15V20Z"},child:[]}]})(t)}function Hie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M17 17H22V19H19V22H17V17ZM7 7H2V5H5V2H7V7ZM18.364 15.5355L16.9497 14.1213L18.364 12.7071C20.3166 10.7545 20.3166 7.58866 18.364 5.63604C16.4113 3.68342 13.2455 3.68342 11.2929 5.63604L9.87868 7.05025L8.46447 5.63604L9.87868 4.22183C12.6123 1.48816 17.0445 1.48816 19.7782 4.22183C22.5118 6.9555 22.5118 11.3877 19.7782 14.1213L18.364 15.5355ZM15.5355 18.364L14.1213 19.7782C11.3877 22.5118 6.9555 22.5118 4.22183 19.7782C1.48816 17.0445 1.48816 12.6123 4.22183 9.87868L5.63604 8.46447L7.05025 9.87868L5.63604 11.2929C3.68342 13.2455 3.68342 16.4113 5.63604 18.364C7.58866 20.3166 10.7545 20.3166 12.7071 18.364L14.1213 16.9497L15.5355 18.364ZM14.8284 7.75736L16.2426 9.17157L9.17157 16.2426L7.75736 14.8284L14.8284 7.75736Z"},child:[]}]})(t)}function U5(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M18.3638 15.5355L16.9496 14.1213L18.3638 12.7071C20.3164 10.7545 20.3164 7.58866 18.3638 5.63604C16.4112 3.68341 13.2453 3.68341 11.2927 5.63604L9.87849 7.05025L8.46428 5.63604L9.87849 4.22182C12.6122 1.48815 17.0443 1.48815 19.778 4.22182C22.5117 6.95549 22.5117 11.3876 19.778 14.1213L18.3638 15.5355ZM15.5353 18.364L14.1211 19.7782C11.3875 22.5118 6.95531 22.5118 4.22164 19.7782C1.48797 17.0445 1.48797 12.6123 4.22164 9.87868L5.63585 8.46446L7.05007 9.87868L5.63585 11.2929C3.68323 13.2455 3.68323 16.4113 5.63585 18.364C7.58847 20.3166 10.7543 20.3166 12.7069 18.364L14.1211 16.9497L15.5353 18.364ZM14.8282 7.75736L16.2425 9.17157L9.17139 16.2426L7.75717 14.8284L14.8282 7.75736Z"},child:[]}]})(t)}function W5(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8.00008 6V9H5.00008V6H8.00008ZM3.00008 4V11H10.0001V4H3.00008ZM13.0001 4H21.0001V6H13.0001V4ZM13.0001 11H21.0001V13H13.0001V11ZM13.0001 18H21.0001V20H13.0001V18ZM10.7072 16.2071L9.29297 14.7929L6.00008 18.0858L4.20718 16.2929L2.79297 17.7071L6.00008 20.9142L10.7072 16.2071Z"},child:[]}]})(t)}function q5(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8 4H21V6H8V4ZM5 3V6H6V7H3V6H4V4H3V3H5ZM3 14V11.5H5V11H3V10H6V12.5H4V13H6V14H3ZM5 19.5H3V18.5H5V18H3V17H6V21H3V20H5V19.5ZM8 11H21V13H8V11ZM8 18H21V20H8V18Z"},child:[]}]})(t)}function G5(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8 4H21V6H8V4ZM4.5 6.5C3.67157 6.5 3 5.82843 3 5C3 4.17157 3.67157 3.5 4.5 3.5C5.32843 3.5 6 4.17157 6 5C6 5.82843 5.32843 6.5 4.5 6.5ZM4.5 13.5C3.67157 13.5 3 12.8284 3 12C3 11.1716 3.67157 10.5 4.5 10.5C5.32843 10.5 6 11.1716 6 12C6 12.8284 5.32843 13.5 4.5 13.5ZM4.5 20.4C3.67157 20.4 3 19.7284 3 18.9C3 18.0716 3.67157 17.4 4.5 17.4C5.32843 17.4 6 18.0716 6 18.9C6 19.7284 5.32843 20.4 4.5 20.4ZM8 11H21V13H8V11ZM8 18H21V20H8V18Z"},child:[]}]})(t)}function zie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M20 3C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3H20ZM11 5H5V10.999H7V9L10 12L7 15V13H5V19H11V17H13V19H19V13H17V15L14 12L17 9V10.999H19V5H13V7H11V5ZM13 13V15H11V13H13ZM13 9V11H11V9H13Z"},child:[]}]})(t)}function Uie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M21 20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3H20C20.5523 3 21 3.44772 21 4V20ZM19 11V5H13.001V7H15L12 10L9 7H11V5H5V11H7V13H5V19H11V17H9L12 14L15 17H13.001V19H19V13H17V11H19ZM11 13H9V11H11V13ZM15 13H13V11H15V13Z"},child:[]}]})(t)}function K5(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M21 4H3V6H21V4ZM21 11H8V13H21V11ZM21 18H8V20H21V18ZM5 11H3V20H5V11Z"},child:[]}]})(t)}function Wie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M17.1538 14C17.3846 14.5161 17.5 15.0893 17.5 15.7196C17.5 17.0625 16.9762 18.1116 15.9286 18.867C14.8809 19.6223 13.4335 20 11.5862 20C9.94674 20 8.32335 19.6185 6.71592 18.8555V16.6009C8.23538 17.4783 9.7908 17.917 11.3822 17.917C13.9333 17.917 15.2128 17.1846 15.2208 15.7196C15.2208 15.0939 15.0049 14.5598 14.5731 14.1173C14.5339 14.0772 14.4939 14.0381 14.4531 14H3V12H21V14H17.1538ZM13.076 11H7.62908C7.4566 10.8433 7.29616 10.6692 7.14776 10.4778C6.71592 9.92084 6.5 9.24559 6.5 8.45207C6.5 7.21602 6.96583 6.165 7.89749 5.299C8.82916 4.43299 10.2706 4 12.2219 4C13.6934 4 15.1009 4.32808 16.4444 4.98426V7.13591C15.2448 6.44921 13.9293 6.10587 12.4978 6.10587C10.0187 6.10587 8.77917 6.88793 8.77917 8.45207C8.77917 8.87172 8.99709 9.23796 9.43293 9.55079C9.86878 9.86362 10.4066 10.1135 11.0463 10.3004C11.6665 10.4816 12.3431 10.7148 13.076 11H13.076Z"},child:[]}]})(t)}function qie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M13 10V14H19V10H13ZM11 10H5V14H11V10ZM13 19H19V16H13V19ZM11 19V16H5V19H11ZM13 5V8H19V5H13ZM11 5H5V8H11V5ZM4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3Z"},child:[]}]})(t)}function iS(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M13 6V21H11V6H5V4H19V6H13Z"},child:[]}]})(t)}function Gie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8 3V12C8 14.2091 9.79086 16 12 16C14.2091 16 16 14.2091 16 12V3H18V12C18 15.3137 15.3137 18 12 18C8.68629 18 6 15.3137 6 12V3H8ZM4 20H20V22H4V20Z"},child:[]}]})(t)}function Kie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M2 3.9934C2 3.44476 2.45531 3 2.9918 3H21.0082C21.556 3 22 3.44495 22 3.9934V20.0066C22 20.5552 21.5447 21 21.0082 21H2.9918C2.44405 21 2 20.5551 2 20.0066V3.9934ZM8 5V19H16V5H8ZM4 5V7H6V5H4ZM18 5V7H20V5H18ZM4 9V11H6V9H4ZM18 9V11H20V9H18ZM4 13V15H6V13H4ZM18 13V15H20V13H18ZM4 17V19H6V17H4ZM18 17V19H20V17H18Z"},child:[]}]})(t)}function Y5(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M5 11.1005L7 9.1005L12.5 14.6005L16 11.1005L19 14.1005V5H5V11.1005ZM4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3ZM15.5 10C14.6716 10 14 9.32843 14 8.5C14 7.67157 14.6716 7 15.5 7C16.3284 7 17 7.67157 17 8.5C17 9.32843 16.3284 10 15.5 10Z"},child:[]}]})(t)}function Yie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M21 15V18H24V20H21V23H19V20H16V18H19V15H21ZM21.0082 3C21.556 3 22 3.44495 22 3.9934L22.0007 13.3417C21.3749 13.1204 20.7015 13 20 13V5H4L4.001 19L13.2929 9.70715C13.6528 9.34604 14.22 9.31823 14.6123 9.62322L14.7065 9.70772L18.2521 13.2586C15.791 14.0069 14 16.2943 14 19C14 19.7015 14.1204 20.3749 14.3417 21.0007L2.9918 21C2.44405 21 2 20.5551 2 20.0066V3.9934C2 3.44476 2.45531 3 2.9918 3H21.0082ZM8 7C9.10457 7 10 7.89543 10 9C10 10.1046 9.10457 11 8 11C6.89543 11 6 10.1046 6 9C6 7.89543 6.89543 7 8 7Z"},child:[]}]})(t)}function Xie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M20 3C20.5523 3 21 3.44772 21 4V5.757L19 7.757V5H5V13.1L9 9.1005L13.328 13.429L12.0012 14.7562L11.995 18.995L16.2414 19.0012L17.571 17.671L18.8995 19H19V16.242L21 14.242V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3H20ZM21.7782 7.80761L23.1924 9.22183L15.4142 17L13.9979 16.9979L14 15.5858L21.7782 7.80761ZM15.5 7C16.3284 7 17 7.67157 17 8.5C17 9.32843 16.3284 10 15.5 10C14.6716 10 14 9.32843 14 8.5C14 7.67157 14.6716 7 15.5 7Z"},child:[]}]})(t)}function Jie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 3.9934C3 3.44476 3.44495 3 3.9934 3H20.0066C20.5552 3 21 3.44495 21 3.9934V20.0066C21 20.5552 20.5551 21 20.0066 21H3.9934C3.44476 21 3 20.5551 3 20.0066V3.9934ZM10.6219 8.41459C10.5562 8.37078 10.479 8.34741 10.4 8.34741C10.1791 8.34741 10 8.52649 10 8.74741V15.2526C10 15.3316 10.0234 15.4088 10.0672 15.4745C10.1897 15.6583 10.4381 15.708 10.6219 15.5854L15.5008 12.3328C15.5447 12.3035 15.5824 12.2658 15.6117 12.2219C15.7343 12.0381 15.6846 11.7897 15.5008 11.6672L10.6219 8.41459Z"},child:[]}]})(t)}function X5(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M2 16.0001H5.88889L11.1834 20.3319C11.2727 20.405 11.3846 20.4449 11.5 20.4449C11.7761 20.4449 12 20.2211 12 19.9449V4.05519C12 3.93977 11.9601 3.8279 11.887 3.73857C11.7121 3.52485 11.3971 3.49335 11.1834 3.66821L5.88889 8.00007H2C1.44772 8.00007 1 8.44778 1 9.00007V15.0001C1 15.5524 1.44772 16.0001 2 16.0001ZM23 12C23 15.292 21.5539 18.2463 19.2622 20.2622L17.8445 18.8444C19.7758 17.1937 21 14.7398 21 12C21 9.26016 19.7758 6.80629 17.8445 5.15557L19.2622 3.73779C21.5539 5.75368 23 8.70795 23 12ZM18 12C18 10.0883 17.106 8.38548 15.7133 7.28673L14.2842 8.71584C15.3213 9.43855 16 10.64 16 12C16 13.36 15.3213 14.5614 14.2842 15.2841L15.7133 16.7132C17.106 15.6145 18 13.9116 18 12Z"},child:[]}]})(t)}function Qie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M11 11V5H13V11H19V13H13V19H11V13H5V11H11Z"},child:[]}]})(t)}function Zie(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M9.9997 15.1709L19.1921 5.97852L20.6063 7.39273L9.9997 17.9993L3.63574 11.6354L5.04996 10.2212L9.9997 15.1709Z"},child:[]}]})(t)}function eae(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M17 6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6ZM18 8H6V20H18V8ZM9 4V6H15V4H9Z"},child:[]}]})(t)}function tae(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M17 6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6ZM9 11V17H11V11H9ZM13 11V17H15V11H13ZM9 4V6H15V4H9Z"},child:[]}]})(t)}function nae(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M4 19H20V12H22V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V12H4V19ZM14 9H19L12 16L5 9H10V3H14V9Z"},child:[]}]})(t)}function rae(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M10 6V8H5V19H16V14H18V20C18 20.5523 17.5523 21 17 21H4C3.44772 21 3 20.5523 3 20V7C3 6.44772 3.44772 6 4 6H10ZM21 3V12L17.206 8.207L11.2071 14.2071L9.79289 12.7929L15.792 6.793L12 3H21Z"},child:[]}]})(t)}function oae(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M5 10C3.9 10 3 10.9 3 12C3 13.1 3.9 14 5 14C6.1 14 7 13.1 7 12C7 10.9 6.1 10 5 10ZM19 10C17.9 10 17 10.9 17 12C17 13.1 17.9 14 19 14C20.1 14 21 13.1 21 12C21 10.9 20.1 10 19 10ZM12 10C10.9 10 10 10.9 10 12C10 13.1 10.9 14 12 14C13.1 14 14 13.1 14 12C14 10.9 13.1 10 12 10Z"},child:[]}]})(t)}function sae(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM8 13C8 15.2091 9.79086 17 12 17C14.2091 17 16 15.2091 16 13H8ZM8 11C8.82843 11 9.5 10.3284 9.5 9.5C9.5 8.67157 8.82843 8 8 8C7.17157 8 6.5 8.67157 6.5 9.5C6.5 10.3284 7.17157 11 8 11ZM16 11C16.8284 11 17.5 10.3284 17.5 9.5C17.5 8.67157 16.8284 8 16 8C15.1716 8 14.5 8.67157 14.5 9.5C14.5 10.3284 15.1716 11 16 11Z"},child:[]}]})(t)}function YI(t){return ve({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20ZM8 13H16C16 15.2091 14.2091 17 12 17C9.79086 17 8 15.2091 8 13ZM8 11C7.17157 11 6.5 10.3284 6.5 9.5C6.5 8.67157 7.17157 8 8 8C8.82843 8 9.5 8.67157 9.5 9.5C9.5 10.3284 8.82843 11 8 11ZM16 11C15.1716 11 14.5 10.3284 14.5 9.5C14.5 8.67157 15.1716 8 16 8C16.8284 8 17.5 8.67157 17.5 9.5C17.5 10.3284 16.8284 11 16 11Z"},child:[]}]})(t)}let Uv;async function iae(){return Uv||(Uv=(async()=>{const[t,e]=await Promise.all([hn(()=>import("./module-BvCTiNll.js"),[]),hn(()=>import("./native-48B9X9Wg.js"),[])]),n="default"in t?t.default:t,r="default"in e?e.default:e;return await n.init({data:r}),{emojiMart:n,emojiData:r}})(),Uv)}function aae(t){const e=v.useRef(null),n=v.useRef(null);return n.current&&n.current.update(t),v.useEffect(()=>((async()=>{const{emojiMart:r}=await iae();n.current=new r.Picker({...t,ref:e})})(),()=>{n.current=null}),[]),$.createElement("div",{ref:e})}const XI=t=>{const[e,n]=v.useState(!1),r=de(),o=fs();return m.jsxs(r.Generic.Popover.Root,{opened:e,children:[m.jsx(r.Generic.Popover.Trigger,{children:m.jsx("div",{onClick:s=>{s.preventDefault(),s.stopPropagation(),n(!e)},style:{display:"flex",justifyContent:"center",alignItems:"center"},children:t.children})}),m.jsx(r.Generic.Popover.Content,{variant:"panel-popover",children:m.jsx(aae,{perLine:7,onClickOutside:()=>n(!1),onEmojiSelect:s=>{t.onEmojiSelect(s),n(!1)},theme:o==null?void 0:o.colorSchemePreference})})]})};function lae(t,e){return aS(t,[e]).get(e)}function aS(t,e){const n=t.comments;if(!n)throw new Error("Comments plugin not found");const r=n.userStore,o=v.useCallback(()=>{const a=new Map;for(const l of e){const c=r.getUser(l);c&&a.set(l,c)}return a},[r,e]),s=v.useMemo(()=>({current:o()}),[o]),i=v.useCallback(a=>{const l=r.subscribe(c=>{s.current=o(),a()});return r.loadUsers(e),l},[r,o,e,s]);return v.useSyncExternalStore(i,()=>s.current)}const cae=t=>{const e=de(),n=_e(),r=pe();if(!r.comments)throw new Error("ReactionBadge must be used inside a BlockNote editor with comments enabled");const o=t.comment.reactions.find(l=>l.emoji===t.emoji);if(!o)throw new Error("Trying to render reaction badge for non-existing reaction");const[s,i]=v.useState([]),a=aS(r,s);return m.jsx(e.Generic.Badge.Root,{className:dt("bn-badge","bn-comment-reaction"),text:o.userIds.length.toString(),icon:o.emoji,isSelected:r.comments.threadStore.auth.canDeleteReaction(t.comment,o.emoji),onClick:()=>t.onReactionSelect(o.emoji),onMouseEnter:()=>i(o.userIds),mainTooltip:n.comments.reactions.reacted_by,secondaryTooltip:`${Array.from(a.values()).map(l=>l.username).join(`
`)}`},o.emoji)},uae=({comment:t,thread:e,showResolveButton:n})=>{const r=_e(),o=xb({initialContent:t.body,trailingBlock:!1,dictionary:{...r,placeholders:{emptyDocument:r.placeholders.edit_comment}},schema:oS,sideMenuDetection:"editor"},[t.body]),s=de(),[i,a]=v.useState(!1),l=pe();if(!l.comments)throw new Error("Comments plugin not found");const c=l.comments.threadStore,u=v.useCallback(()=>{a(!0)},[]),d=v.useCallback(()=>{o.replaceBlocks(o.document,t.body),a(!1)},[o,t.body]),h=v.useCallback(async S=>{await c.updateComment({commentId:t.id,comment:{body:o.document},threadId:e.id}),a(!1)},[t,e.id,o,c]),f=v.useCallback(async()=>{await c.deleteComment({commentId:t.id,threadId:e.id})},[t,e.id,c]),p=v.useCallback(async S=>{c.auth.canAddReaction(t,S)?await c.addReaction({threadId:e.id,commentId:t.id,emoji:S}):c.auth.canDeleteReaction(t,S)&&await c.deleteReaction({threadId:e.id,commentId:t.id,emoji:S})},[c,t,e.id]),y=v.useCallback(async()=>{await c.resolveThread({threadId:e.id})},[e.id,c]),b=v.useCallback(async()=>{await c.unresolveThread({threadId:e.id})},[e.id,c]),w=lae(l,t.userId);if(!t.body)return null;let k;const x=c.auth.canAddReaction(t),A=c.auth.canDeleteComment(t),I=c.auth.canUpdateComment(t),M=n&&(e.resolved?c.auth.canUnresolveThread(e):c.auth.canResolveThread(e));i||(k=m.jsxs(s.Generic.Toolbar.Root,{className:dt("bn-action-toolbar","bn-comment-actions"),variant:"action-toolbar",children:[x&&m.jsx(XI,{onEmojiSelect:S=>p(S.native),children:m.jsx(s.Generic.Toolbar.Button,{mainTooltip:r.comments.actions.add_reaction,variant:"compact",children:m.jsx(YI,{size:16})},"add-reaction")}),M&&(e.resolved?m.jsx(s.Generic.Toolbar.Button,{mainTooltip:"Re-open",variant:"compact",onClick:b,children:m.jsx(Mie,{size:16})},"reopen"):m.jsx(s.Generic.Toolbar.Button,{mainTooltip:r.comments.actions.resolve,variant:"compact",onClick:y,children:m.jsx(Zie,{size:16})},"resolve")),(A||I)&&m.jsxs(s.Generic.Menu.Root,{position:"bottom-start",children:[m.jsx(s.Generic.Menu.Trigger,{children:m.jsx(s.Generic.Toolbar.Button,{mainTooltip:r.comments.actions.more_actions,variant:"compact",children:m.jsx(oae,{size:16})},"more-actions")}),m.jsxs(s.Generic.Menu.Dropdown,{className:"bn-menu-dropdown",children:[I&&m.jsx(s.Generic.Menu.Item,{icon:m.jsx(Rie,{}),onClick:u,children:r.comments.actions.edit_comment},"edit-comment"),A&&m.jsx(s.Generic.Menu.Item,{icon:m.jsx(tae,{}),onClick:f,children:r.comments.actions.delete_comment},"delete-comment")]})]})]}));const T=t.createdAt.toLocaleDateString(void 0,{month:"short",day:"numeric"});if(!t.body)throw new Error("soft deletes are not yet supported");return m.jsx(s.Comments.Comment,{authorInfo:w??"loading",timeString:T,edited:t.updatedAt.getTime()!==t.createdAt.getTime(),showActions:"hover",actions:k,className:"bn-thread-comment",children:m.jsx(rS,{autoFocus:i,editor:o,editable:i,actions:t.reactions.length>0||i?({isEmpty:S})=>m.jsxs(m.Fragment,{children:[t.reactions.length>0&&!i&&m.jsxs(s.Generic.Badge.Group,{className:dt("bn-badge-group","bn-comment-reactions"),children:[t.reactions.map(_=>m.jsx(cae,{comment:t,emoji:_.emoji,onReactionSelect:p},_.emoji)),m.jsx(XI,{onEmojiSelect:_=>p(_.native),children:m.jsx(s.Generic.Badge.Root,{className:dt("bn-badge","bn-comment-add-reaction"),text:"+",icon:m.jsx(YI,{size:16}),mainTooltip:r.comments.actions.add_reaction})})]}),i&&m.jsxs(s.Generic.Toolbar.Root,{variant:"action-toolbar",className:dt("bn-action-toolbar","bn-comment-actions"),children:[m.jsx(s.Generic.Toolbar.Button,{mainTooltip:"Save",variant:"compact",onClick:h,isDisabled:S,children:"Save"}),m.jsx(s.Generic.Toolbar.Button,{className:"bn-button",mainTooltip:"Cancel",variant:"compact",onClick:d,children:"Cancel"})]})]}):void 0})})},dae=({thread:t,maxCommentsBeforeCollapse:e})=>{const n=de(),r=_e(),o=pe(),s=aS(o,t.resolvedBy?[t.resolvedBy]:[]),i=t.comments.map((a,l)=>m.jsx(uae,{thread:t,comment:a,showResolveButton:l===0},a.id));if(t.resolved&&t.resolvedUpdatedAt&&t.resolvedBy){if(!s.get(t.resolvedBy))throw new Error(`User ${t.resolvedBy} resolved thread ${t.id}, but their data could not be found.`);const a=t.comments.findLastIndex(l=>t.resolvedUpdatedAt.getTime()>l.createdAt.getTime())+1;i.splice(a,0,m.jsx(n.Comments.Comment,{className:"bn-thread-comment",authorInfo:t.resolvedBy&&s.get(t.resolvedBy)||"loading",timeString:t.resolvedUpdatedAt.toLocaleDateString(void 0,{month:"short",day:"numeric"}),edited:!1,showActions:!1,children:m.jsx("div",{className:"bn-resolved-text",children:r.comments.sidebar.marked_as_resolved})},"resolved-comment"))}return e&&i.length>e&&i.splice(1,i.length-2,m.jsx(n.Comments.ExpandSectionsPrompt,{className:"bn-thread-expand-prompt",children:r.comments.sidebar.more_replies(t.comments.length-2)},"expand-prompt")),i},J5=({thread:t,selected:e,referenceText:n,maxCommentsBeforeCollapse:r,onFocus:o,onBlur:s,tabIndex:i})=>{const a=de(),l=_e(),c=pe().comments;if(!c)throw new Error("Comments plugin not found");const u=xb({trailingBlock:!1,dictionary:{...l,placeholders:{emptyDocument:l.placeholders.comment_reply}},schema:oS,sideMenuDetection:"editor"}),d=v.useCallback(async()=>{await c.threadStore.addComment({comment:{body:u.document},threadId:t.id}),u.removeBlocks(u.document)},[c,u,t.id]);return m.jsxs(a.Comments.Card,{className:"bn-thread",headerText:n,onFocus:o,onBlur:s,selected:e,tabIndex:i,children:[m.jsx(a.Comments.CardSection,{className:"bn-thread-comments",children:m.jsx(dae,{thread:t,maxCommentsBeforeCollapse:e?void 0:r||5})}),e&&m.jsx(a.Comments.CardSection,{className:"bn-thread-composer",children:m.jsx(rS,{autoFocus:!1,editable:!0,editor:u,actions:({isEmpty:h})=>h?null:m.jsx(a.Generic.Toolbar.Root,{variant:"action-toolbar",className:dt("bn-action-toolbar","bn-comment-actions"),children:m.jsx(a.Generic.Toolbar.Button,{mainTooltip:"Save",variant:"compact",isDisabled:h,onClick:d,children:"Save"})})})})]})};function hae(t){const e=t.comments;if(!e)throw new Error("Comments plugin not found");const n=e.threadStore,r=v.useRef();r.current||(r.current=n.getThreads());const o=v.useCallback(s=>n.subscribe(i=>{r.current=i,s()}),[n]);return v.useSyncExternalStore(o,()=>r.current)}const fae=t=>{const e=pe();if(!e.comments)throw new Error("FloatingComposerController can only be used when BlockNote editor has enabled comments");const n=ei(e.comments.onUpdate.bind(e.comments)),{isMounted:r,ref:o,style:s,getFloatingProps:i,setReference:a}=ba(!!(n!=null&&n.selectedThreadId),null,5e3,{placement:"bottom",middleware:[is(10),Pl(),bo()],onOpenChange:d=>{var h;d||((h=e.comments)==null||h.selectThread(void 0),e.focus())},...t.floatingOptions}),l=v.useCallback(()=>{var d;if(!(n!=null&&n.selectedThreadId))return;const h=(d=e.domElement)==null?void 0:d.querySelector(`[data-bn-thread-id="${n==null?void 0:n.selectedThreadId}"]`);h&&a(h)},[a,e,n==null?void 0:n.selectedThreadId]);v.useEffect(()=>{if(n!=null&&n.selectedThreadId)return e.onChange(()=>{l()})},[e,l,n==null?void 0:n.selectedThreadId]),v.useLayoutEffect(l,[l]);const c=hae(e);if(!r||!n||!n.selectedThreadId)return null;const u=t.floatingThread||J5;return m.jsx("div",{ref:o,style:s,...i(),children:m.jsx(u,{thread:c.get(n.selectedThreadId),selected:!0})})},pae=t=>{const e=de(),n=_e(),{block:r}=t,o=pe(),[s,i]=v.useState(""),a=v.useCallback(u=>{i(u.currentTarget.value)},[]),l=v.useCallback(u=>{u.key==="Enter"&&(u.preventDefault(),o.updateBlock(r,{props:{name:aI(s),url:s}}))},[o,r,s]),c=v.useCallback(()=>{o.updateBlock(r,{props:{name:aI(s),url:s}})},[o,r,s]);return m.jsxs(e.FilePanel.TabPanel,{className:"bn-tab-panel",children:[m.jsx(e.FilePanel.TextInput,{className:"bn-text-input",placeholder:n.file_panel.embed.url_placeholder,value:s,onChange:a,onKeyDown:l,"data-test":"embed-input"}),m.jsx(e.FilePanel.Button,{className:"bn-button",onClick:c,"data-test":"embed-input-button",children:n.file_panel.embed.embed_button[r.type]||n.file_panel.embed.embed_button.file})]})},mae=t=>{var e;const n=de(),r=_e(),{block:o,setLoading:s}=t,i=pe(),[a,l]=v.useState(!1);v.useEffect(()=>{a&&setTimeout(()=>{l(!1)},3e3)},[a]);const c=v.useCallback(h=>{if(h===null)return;async function f(p){if(s(!0),i.uploadFile!==void 0)try{let y=await i.uploadFile(p,o.id);typeof y=="string"&&(y={props:{name:p.name,url:y}}),i.updateBlock(o,y)}catch{l(!0)}finally{s(!1)}}f(h)},[o,i,s]),u=i.schema.blockSchema[o.type],d=u.isFileBlock&&(e=u.fileBlockAccept)!=null&&e.length?u.fileBlockAccept.join(","):"*/*";return m.jsxs(n.FilePanel.TabPanel,{className:"bn-tab-panel",children:[m.jsx(n.FilePanel.FileInput,{className:"bn-file-input","data-test":"upload-input",accept:d,placeholder:r.file_panel.upload.file_placeholder[o.type]||r.file_panel.upload.file_placeholder.file,value:null,onChange:c}),a&&m.jsx("div",{className:"bn-error-text",children:r.file_panel.upload.upload_error})]})},Q5=t=>{const e=de(),n=_e(),r=pe(),[o,s]=v.useState(!1),i=t.tabs??[...r.uploadFile!==void 0?[{name:n.file_panel.upload.title,tabPanel:m.jsx(mae,{block:t.block,setLoading:s})}]:[],{name:n.file_panel.embed.title,tabPanel:m.jsx(pae,{block:t.block})}],[a,l]=v.useState(t.defaultOpenTab||i[0].name);return m.jsx(e.FilePanel.Root,{className:"bn-panel",defaultOpenTab:a,openTab:a,setOpenTab:l,tabs:i,loading:o})},gae=t=>{const e=pe();if(!e.filePanel)throw new Error("FileToolbarController can only be used when BlockNote editor schema contains file block");const n=ei(e.filePanel.onUpdate.bind(e.filePanel)),{isMounted:r,ref:o,style:s,getFloatingProps:i}=ba((n==null?void 0:n.show)||!1,(n==null?void 0:n.referencePos)||null,5e3,{placement:"bottom",middleware:[is(10),bo()],onOpenChange:d=>{d||(e.filePanel.closeMenu(),e.focus())},...t.floatingOptions});if(!r||!n)return null;const{show:a,referencePos:l,...c}=n,u=t.filePanel||Q5;return m.jsx("div",{ref:o,style:s,...i(),children:m.jsx(u,{...c})})};function va(t,e){nS(t,e),tS(t,e)}function lS(t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}function mr(t){const e=fs();if(t||(t=e==null?void 0:e.editor),!t)throw new Error("'editor' is required, either from BlockNoteContext or as a function argument");const n=t,[r,o]=v.useState(()=>{var s;return((s=n.getSelection())==null?void 0:s.blocks)||[n.getTextCursorPosition().block]});return va(()=>{var s;return o(((s=n.getSelection())==null?void 0:s.blocks)||[n.getTextCursorPosition().block])},n),r}const yae={bold:Vie,italic:Fie,underline:Gie,strike:Wie,code:Pie};function bae(t,e){return t in e.schema.styleSchema&&e.schema.styleSchema[t].type===t&&e.schema.styleSchema[t].propSchema==="boolean"}const Wp=t=>{const e=_e(),n=de(),r=pe(),o=bae(t.basicTextStyle,r),s=mr(r),[i,a]=v.useState(t.basicTextStyle in r.getActiveStyles());va(()=>{o&&a(t.basicTextStyle in r.getActiveStyles())},r);const l=u=>{if(r.focus(),!!o){if(r.schema.styleSchema[u].propSchema!=="boolean")throw new Error("can only toggle boolean styles");r.toggleStyles({[u]:!0})}};if(!v.useMemo(()=>o?!!s.find(u=>u.content!==void 0):!1,[o,s])||!r.isEditable)return null;const c=yae[t.basicTextStyle];return m.jsx(n.FormattingToolbar.Button,{className:"bn-button","data-test":t.basicTextStyle,onClick:()=>l(t.basicTextStyle),isSelected:i,label:e.formatting_toolbar[t.basicTextStyle].tooltip,mainTooltip:e.formatting_toolbar[t.basicTextStyle].tooltip,secondaryTooltip:jr(e.formatting_toolbar[t.basicTextStyle].secondary_tooltip,e.generic.ctrl_shortcut),icon:m.jsx(c,{})})},aC=t=>{const e=t.textColor||"default",n=t.backgroundColor||"default",r=t.size||16,o=v.useMemo(()=>({pointerEvents:"none",fontSize:(r*.75).toString()+"px",height:r.toString()+"px",lineHeight:r.toString()+"px",textAlign:"center",width:r.toString()+"px"}),[r]);return m.jsx("div",{className:"bn-color-icon","data-background-color":n,"data-text-color":e,style:o,children:"A"})},JI=["default","gray","brown","red","orange","yellow","green","blue","purple","pink"],kb=t=>{const e=de(),n=_e();return m.jsxs(m.Fragment,{children:[m.jsx(()=>t.text?m.jsxs(m.Fragment,{children:[m.jsx(e.Generic.Menu.Label,{children:n.color_picker.text_title}),JI.map(r=>m.jsx(e.Generic.Menu.Item,{onClick:()=>{t.onClick&&t.onClick(),t.text.setColor(r)},"data-test":"text-color-"+r,icon:m.jsx(aC,{textColor:r,size:t.iconSize}),checked:t.text.color===r,children:n.color_picker.colors[r]},"text-color-"+r))]}):null,{}),m.jsx(()=>t.background?m.jsxs(m.Fragment,{children:[m.jsx(e.Generic.Menu.Label,{children:n.color_picker.background_title}),JI.map(r=>m.jsx(e.Generic.Menu.Item,{onClick:()=>{t.onClick&&t.onClick(),t.background.setColor(r)},"data-test":"background-color-"+r,icon:m.jsx(aC,{backgroundColor:r,size:t.iconSize}),checked:t.background.color===r,children:n.color_picker.colors[r]},"background-color-"+r))]}):null,{})]})};function QI(t,e){return`${t}Color`in e.schema.styleSchema&&e.schema.styleSchema[`${t}Color`].type===`${t}Color`&&e.schema.styleSchema[`${t}Color`].propSchema==="string"}const vae=()=>{const t=de(),e=_e(),n=pe(),r=QI("text",n),o=QI("background",n),s=mr(n),[i,a]=v.useState(r&&n.getActiveStyles().textColor||"default"),[l,c]=v.useState(o&&n.getActiveStyles().backgroundColor||"default");va(()=>{r&&a(n.getActiveStyles().textColor||"default"),o&&c(n.getActiveStyles().backgroundColor||"default")},n);const u=v.useCallback(h=>{if(!r)throw Error("Tried to set text color, but style does not exist in editor schema.");h==="default"?n.removeStyles({textColor:h}):n.addStyles({textColor:h}),setTimeout(()=>{n.focus()})},[n,r]),d=v.useCallback(h=>{if(!o)throw Error("Tried to set background color, but style does not exist in editor schema.");h==="default"?n.removeStyles({backgroundColor:h}):n.addStyles({backgroundColor:h}),setTimeout(()=>{n.focus()})},[o,n]);return!v.useMemo(()=>{if(!r&&!o)return!1;for(const h of s)if(h.content!==void 0)return!0;return!1},[o,s,r])||!n.isEditable?null:m.jsxs(t.Generic.Menu.Root,{children:[m.jsx(t.Generic.Menu.Trigger,{children:m.jsx(t.FormattingToolbar.Button,{className:"bn-button","data-test":"colors",label:e.formatting_toolbar.colors.tooltip,mainTooltip:e.formatting_toolbar.colors.tooltip,icon:m.jsx(aC,{textColor:i,backgroundColor:l,size:20})})}),m.jsx(t.Generic.Menu.Dropdown,{className:"bn-menu-dropdown bn-color-picker-dropdown",children:m.jsx(kb,{text:r?{color:i,setColor:u}:void 0,background:o?{color:l,setColor:d}:void 0})})]})},ZI=t=>{for(const e of u5)if(t.startsWith(e))return t;return`${d5}://${t}`},Z5=t=>{const e=de(),n=_e(),{url:r,text:o,editLink:s,showTextField:i}=t,[a,l]=v.useState(r),[c,u]=v.useState(o);v.useEffect(()=>{l(r),u(o)},[o,r]);const d=v.useCallback(y=>{y.key==="Enter"&&(y.preventDefault(),s(ZI(a),c))},[s,a,c]),h=v.useCallback(y=>l(y.currentTarget.value),[]),f=v.useCallback(y=>u(y.currentTarget.value),[]),p=v.useCallback(()=>s(ZI(a),c),[s,a,c]);return m.jsxs(e.Generic.Form.Root,{children:[m.jsx(e.Generic.Form.TextInput,{className:"bn-text-input",name:"url",icon:m.jsx(U5,{}),autoFocus:!0,placeholder:n.link_toolbar.form.url_placeholder,value:a,onKeyDown:d,onChange:h,onSubmit:p}),i!==!1&&m.jsx(e.Generic.Form.TextInput,{className:"bn-text-input",name:"title",icon:m.jsx(iS,{}),placeholder:n.link_toolbar.form.title_placeholder,value:c,onKeyDown:d,onChange:f,onSubmit:p})]})};function wae(t){return"link"in t.schema.inlineContentSchema&&t.schema.inlineContentSchema.link==="link"}const Cae=()=>{var t;const e=pe(),n=de(),r=_e(),o=wae(e),s=mr(e),[i,a]=v.useState(!1),[l,c]=v.useState(e.getSelectedLinkUrl()||""),[u,d]=v.useState(e.getSelectedText());va(()=>{d(e.getSelectedText()||""),c(e.getSelectedLinkUrl()||"")},e),v.useEffect(()=>{var p;const y=b=>{(b.ctrlKey||b.metaKey)&&b.key==="k"&&(a(!0),b.preventDefault())};return(p=e.prosemirrorView)==null||p.dom.addEventListener("keydown",y),()=>{var b;(b=e.prosemirrorView)==null||b.dom.removeEventListener("keydown",y)}},[(t=e.prosemirrorView)==null?void 0:t.dom]);const h=v.useCallback(p=>{e.createLink(p),e.focus()},[e]),f=e.transact(p=>Xw(p.selection));return!v.useMemo(()=>{if(!o)return!1;for(const p of s)if(p.content===void 0)return!1;return!f},[o,s,f])||!("link"in e.schema.inlineContentSchema)||!e.isEditable?null:m.jsxs(n.Generic.Popover.Root,{opened:i,children:[m.jsx(n.Generic.Popover.Trigger,{children:m.jsx(n.FormattingToolbar.Button,{className:"bn-button","data-test":"createLink",label:r.formatting_toolbar.link.tooltip,mainTooltip:r.formatting_toolbar.link.tooltip,secondaryTooltip:jr(r.formatting_toolbar.link.secondary_tooltip,r.generic.ctrl_shortcut),icon:m.jsx(U5,{}),onClick:()=>a(!0)})}),m.jsx(n.Generic.Popover.Content,{className:"bn-popover-content bn-form-popover",variant:"form-popover",children:m.jsx(Z5,{url:l,text:u,editLink:h,showTextField:!1})})]})},xae=()=>{const t=_e(),e=de(),n=pe(),[r,o]=v.useState(),s=mr(n),i=v.useMemo(()=>{if(s.length!==1)return;const c=s[0];if(_f(c,n))return o(c.props.caption),c},[n,s]),a=v.useCallback(c=>{i&&c.key==="Enter"&&(c.preventDefault(),n.updateBlock(i,{props:{caption:r}}))},[r,n,i]),l=v.useCallback(c=>o(c.currentTarget.value),[]);return!i||Af(i,n)||!n.isEditable?null:m.jsxs(e.Generic.Popover.Root,{children:[m.jsx(e.Generic.Popover.Trigger,{children:m.jsx(e.FormattingToolbar.Button,{className:"bn-button",label:t.formatting_toolbar.file_caption.tooltip,mainTooltip:t.formatting_toolbar.file_caption.tooltip,icon:m.jsx(KI,{}),isSelected:i.props.caption!==""})}),m.jsx(e.Generic.Popover.Content,{className:"bn-popover-content bn-form-popover",variant:"form-popover",children:m.jsx(e.Generic.Form.Root,{children:m.jsx(e.Generic.Form.TextInput,{name:"file-caption",icon:m.jsx(KI,{}),value:r||"",autoFocus:!0,placeholder:t.formatting_toolbar.file_caption.input_placeholder,onKeyDown:a,onChange:l})})})]})},kae=()=>{const t=_e(),e=de(),n=pe(),r=mr(n),o=v.useMemo(()=>{if(r.length!==1)return;const i=r[0];if(_f(i,n))return i},[n,r]),s=v.useCallback(()=>{n.focus(),n.removeBlocks([o])},[n,o]);return!o||Af(o,n)||!n.isEditable?null:m.jsx(e.FormattingToolbar.Button,{className:"bn-button",label:t.formatting_toolbar.file_delete.tooltip[o.type]||t.formatting_toolbar.file_delete.tooltip.file,mainTooltip:t.formatting_toolbar.file_delete.tooltip[o.type]||t.formatting_toolbar.file_delete.tooltip.file,icon:m.jsx(eae,{}),onClick:s})},Sae=()=>{const t=_e(),e=de(),n=pe(),[r,o]=v.useState(),s=mr(n),i=v.useMemo(()=>{if(s.length!==1)return;const c=s[0];if(_f(c,n))return o(c.props.name),c},[n,s]),a=v.useCallback(c=>{i&&c.key==="Enter"&&(c.preventDefault(),n.updateBlock(i,{props:{name:r}}))},[r,n,i]),l=v.useCallback(c=>o(c.currentTarget.value),[]);return!i||Af(i,n)||!n.isEditable?null:m.jsxs(e.Generic.Popover.Root,{children:[m.jsx(e.Generic.Popover.Trigger,{children:m.jsx(e.FormattingToolbar.Button,{className:"bn-button",label:t.formatting_toolbar.file_rename.tooltip[i.type]||t.formatting_toolbar.file_rename.tooltip.file,mainTooltip:t.formatting_toolbar.file_rename.tooltip[i.type]||t.formatting_toolbar.file_rename.tooltip.file,icon:m.jsx(GI,{})})}),m.jsx(e.Generic.Popover.Content,{className:"bn-popover-content bn-form-popover",variant:"form-popover",children:m.jsx(e.Generic.Form.Root,{children:m.jsx(e.Generic.Form.TextInput,{name:"file-name",icon:m.jsx(GI,{}),value:r||"",autoFocus:!0,placeholder:t.formatting_toolbar.file_rename.input_placeholder[i.type]||t.formatting_toolbar.file_rename.input_placeholder.file,onKeyDown:a,onChange:l})})})]})},Eae=()=>{const t=_e(),e=de(),n=pe(),r=mr(n),[o,s]=v.useState(!1);v.useEffect(()=>{s(!1)},[r]);const i=r.length===1?r[0]:void 0;return i===void 0||!_f(i,n)||!n.isEditable?null:m.jsxs(e.Generic.Popover.Root,{opened:o,position:"bottom",children:[m.jsx(e.Generic.Popover.Trigger,{children:m.jsx(e.FormattingToolbar.Button,{className:"bn-button",onClick:()=>s(!o),isSelected:o,mainTooltip:t.formatting_toolbar.file_replace.tooltip[i.type]||t.formatting_toolbar.file_replace.tooltip.file,label:t.formatting_toolbar.file_replace.tooltip[i.type]||t.formatting_toolbar.file_replace.tooltip.file,icon:m.jsx(Xie,{})})}),m.jsx(e.Generic.Popover.Content,{className:"bn-popover-content bn-panel-popover",variant:"panel-popover",children:m.jsx(Q5,{block:i})})]})},Tae=()=>{const t=_e(),e=de(),n=pe(),r=mr(n),[o,s]=v.useState(()=>n.canNestBlock());va(()=>{s(n.canNestBlock())},n);const i=v.useCallback(()=>{n.focus(),n.nestBlock()},[n]);return!v.useMemo(()=>!r.find(a=>n.schema.blockSchema[a.type].content!=="inline"),[n.schema.blockSchema,r])||!n.isEditable?null:m.jsx(e.FormattingToolbar.Button,{className:"bn-button","data-test":"nestBlock",onClick:i,isDisabled:!o,label:t.formatting_toolbar.nest.tooltip,mainTooltip:t.formatting_toolbar.nest.tooltip,secondaryTooltip:jr(t.formatting_toolbar.nest.secondary_tooltip,t.generic.ctrl_shortcut),icon:m.jsx($ie,{})})},_ae=()=>{const t=_e(),e=de(),n=pe(),r=mr(n),[o,s]=v.useState(()=>n.canUnnestBlock());va(()=>{s(n.canUnnestBlock())},n);const i=v.useCallback(()=>{n.focus(),n.unnestBlock()},[n]);return!v.useMemo(()=>!r.find(a=>n.schema.blockSchema[a.type].content!=="inline"),[n.schema.blockSchema,r])||!n.isEditable?null:m.jsx(e.FormattingToolbar.Button,{className:"bn-button","data-test":"unnestBlock",onClick:i,isDisabled:!o,label:t.formatting_toolbar.unnest.tooltip,mainTooltip:t.formatting_toolbar.unnest.tooltip,secondaryTooltip:jr(t.formatting_toolbar.unnest.secondary_tooltip,t.generic.ctrl_shortcut),icon:m.jsx(Bie,{})})},Aae=t=>[{name:t.slash_menu.paragraph.title,type:"paragraph",icon:iS,isSelected:e=>e.type==="paragraph"},{name:t.slash_menu.heading.title,type:"heading",props:{level:1},icon:F5,isSelected:e=>e.type==="heading"&&"level"in e.props&&e.props.level===1},{name:t.slash_menu.heading_2.title,type:"heading",props:{level:2},icon:H5,isSelected:e=>e.type==="heading"&&"level"in e.props&&e.props.level===2},{name:t.slash_menu.heading_3.title,type:"heading",props:{level:3},icon:z5,isSelected:e=>e.type==="heading"&&"level"in e.props&&e.props.level===3},{name:t.slash_menu.quote.title,type:"quote",icon:K5,isSelected:e=>e.type==="quote"},{name:t.slash_menu.bullet_list.title,type:"bulletListItem",icon:G5,isSelected:e=>e.type==="bulletListItem"},{name:t.slash_menu.numbered_list.title,type:"numberedListItem",icon:q5,isSelected:e=>e.type==="numberedListItem"},{name:t.slash_menu.check_list.title,type:"checkListItem",icon:W5,isSelected:e=>e.type==="checkListItem"}],Iae=t=>{const e=de(),n=_e(),r=pe(),o=mr(r),[s,i]=v.useState(r.getTextCursorPosition().block),a=v.useMemo(()=>(t.items||Aae(n)).filter(u=>u.type in r.schema.blockSchema),[r,n,t.items]),l=v.useMemo(()=>a.find(u=>u.type===s.type)!==void 0,[s.type,a]),c=v.useMemo(()=>{const u=d=>{r.focus(),r.transact(()=>{for(const h of o)r.updateBlock(h,{type:d.type,props:d.props})})};return a.map(d=>{const h=d.icon;return{text:d.name,icon:m.jsx(h,{size:16}),onClick:()=>u(d),isSelected:d.isSelected(s)}})},[s,a,r,o]);return va(()=>{i(r.getTextCursorPosition().block)},r),!l||!r.isEditable?null:m.jsx(e.FormattingToolbar.Select,{className:"bn-select",items:c})},Mae=()=>{const t=_e(),e=de(),n=pe(),r=v.useCallback(()=>{var o;(o=n.comments)==null||o.startPendingComment(),n.formattingToolbar.closeMenu()},[n]);return n.comments?m.jsx(e.FormattingToolbar.Button,{className:"bn-button",label:t.formatting_toolbar.comment.tooltip,mainTooltip:t.formatting_toolbar.comment.tooltip,icon:m.jsx($5,{}),onClick:r}):null},Rae=()=>{const t=_e(),e=de(),n=pe(),r=v.useCallback(()=>{n._tiptapEditor.chain().focus().addPendingComment().run()},[n]);return!n._tiptapEditor.commands.addPendingComment||!n.isEditable?null:m.jsx(e.FormattingToolbar.Button,{className:"bn-button",label:t.formatting_toolbar.comment.tooltip,mainTooltip:t.formatting_toolbar.comment.tooltip,icon:m.jsx($5,{}),onClick:r})};function lC(t,e){try{const n=new URL(t,e);if(n.protocol!=="javascript:")return n.href}catch{}return"#"}const Pae=()=>{const t=_e(),e=de(),n=pe(),r=mr(n),o=v.useMemo(()=>{if(r.length!==1)return;const i=r[0];if(_f(i,n))return i},[n,r]),s=v.useCallback(()=>{o&&o.props.url&&(n.focus(),n.resolveFileUrl?n.resolveFileUrl(o.props.url).then(i=>window.open(lC(i,window.location.href))):window.open(lC(o.props.url,window.location.href)))},[n,o]);return!o||Af(o,n)?null:m.jsx(e.FormattingToolbar.Button,{className:"bn-button",label:t.formatting_toolbar.file_download.tooltip[o.type]||t.formatting_toolbar.file_download.tooltip.file,mainTooltip:t.formatting_toolbar.file_download.tooltip[o.type]||t.formatting_toolbar.file_download.tooltip.file,icon:m.jsx(nae,{}),onClick:s})},Dae=()=>{const t=_e(),e=de(),n=pe(),r=mr(n),o=v.useMemo(()=>{if(r.length!==1)return;const i=r[0];if(Wne(i,n))return i},[n,r]),s=v.useCallback(()=>{o&&n.updateBlock(o,{props:{showPreview:!o.props.showPreview}})},[n,o]);return!o||Af(o,n)||!n.isEditable?null:m.jsx(e.FormattingToolbar.Button,{className:"bn-button",label:"Toggle preview",mainTooltip:t.formatting_toolbar.file_preview_toggle.tooltip,icon:m.jsx(Yie,{}),isSelected:o.props.showPreview,onClick:s})},Nae=()=>{const t=_e(),e=de(),n=pe(),r=mr(n),o=v.useMemo(()=>{var i;if(r.length!==1)return;const a=r[0];if(a.type==="table")return(i=n.tableHandles)==null?void 0:i.getMergeDirection(a)},[n,r]),s=v.useCallback(()=>{var i;(i=n.tableHandles)==null||i.mergeCells()},[n]);return!n.isEditable||o===void 0||!n.settings.tables.splitCells?null:m.jsx(e.FormattingToolbar.Button,{className:"bn-button",label:t.formatting_toolbar.table_cell_merge.tooltip,mainTooltip:t.formatting_toolbar.table_cell_merge.tooltip,icon:o==="horizontal"?m.jsx(zie,{}):m.jsx(Uie,{}),onClick:s})},Oae={left:Oie,center:Die,right:Lie,justify:Nie},Wv=t=>{const e=de(),n=_e(),r=pe(),o=mr(r),s=v.useMemo(()=>{var l;const c=o[0];if(Yw("textAlignment",c,r))return c.props.textAlignment;if(c.type==="table"){const u=(l=r.tableHandles)==null?void 0:l.getCellSelection();if(!u)return;const d=u.cells.map(({row:f,col:p})=>ta(c.content.rows[f].cells[p]).props.textAlignment),h=d[0];if(d.every(f=>f===h))return h}},[r,o]),i=v.useCallback(l=>{var c;r.focus();for(const u of o)if(dc("textAlignment",u.type,r))r.updateBlock(u,{props:{textAlignment:l}});else if(u.type==="table"){const d=(c=r.tableHandles)==null?void 0:c.getCellSelection();if(!d)continue;const h=u.content.rows.map(f=>({...f,cells:f.cells.map(p=>ta(p))}));d.cells.forEach(({row:f,col:p})=>{h[f].cells[p].props.textAlignment=l}),r.updateBlock(u,{type:"table",content:{...u.content,type:"tableContent",rows:h}}),r.setTextCursorPosition(u)}},[r,o]);if(!v.useMemo(()=>!!o.find(l=>"textAlignment"in l.props||l.type==="table"&&l.children),[o])||!r.isEditable)return null;const a=Oae[t.textAlignment];return m.jsx(e.FormattingToolbar.Button,{className:"bn-button","data-test":`alignText${t.textAlignment.slice(0,1).toUpperCase()+t.textAlignment.slice(1)}`,onClick:()=>i(t.textAlignment),isSelected:s===t.textAlignment,label:n.formatting_toolbar[`align_${t.textAlignment}`].tooltip,mainTooltip:n.formatting_toolbar[`align_${t.textAlignment}`].tooltip,icon:m.jsx(a,{})})},eV=t=>[m.jsx(Iae,{items:t},"blockTypeSelect"),m.jsx(Nae,{},"tableCellMergeButton"),m.jsx(xae,{},"fileCaptionButton"),m.jsx(Eae,{},"replaceFileButton"),m.jsx(Sae,{},"fileRenameButton"),m.jsx(kae,{},"fileDeleteButton"),m.jsx(Pae,{},"fileDownloadButton"),m.jsx(Dae,{},"filePreviewButton"),m.jsx(Wp,{basicTextStyle:"bold"},"boldStyleButton"),m.jsx(Wp,{basicTextStyle:"italic"},"italicStyleButton"),m.jsx(Wp,{basicTextStyle:"underline"},"underlineStyleButton"),m.jsx(Wp,{basicTextStyle:"strike"},"strikeStyleButton"),m.jsx(Wv,{textAlignment:"left"},"textAlignLeftButton"),m.jsx(Wv,{textAlignment:"center"},"textAlignCenterButton"),m.jsx(Wv,{textAlignment:"right"},"textAlignRightButton"),m.jsx(vae,{},"colorStyleButton"),m.jsx(Tae,{},"nestBlockButton"),m.jsx(_ae,{},"unnestBlockButton"),m.jsx(Cae,{},"createLinkButton"),m.jsx(Mae,{},"addCommentButton"),m.jsx(Rae,{},"addTiptapCommentButton")],tV=t=>{const e=de();return m.jsx(e.FormattingToolbar.Root,{className:"bn-toolbar bn-formatting-toolbar",children:t.children||eV(t.blockTypeSelectItems)})},eM=t=>{switch(t){case"left":return"top-start";case"center":return"top";case"right":return"top-end";default:return"top-start"}},nV=t=>{const e=v.useRef(null),n=pe(),[r,o]=v.useState(()=>{const h=n.getTextCursorPosition().block;return"textAlignment"in h.props?eM(h.props.textAlignment):"top-start"});va(()=>{const h=n.getTextCursorPosition().block;"textAlignment"in h.props?o(eM(h.props.textAlignment)):o("top-start")},n);const s=ei(n.formattingToolbar.onUpdate.bind(n.formattingToolbar)),{isMounted:i,ref:a,style:l,getFloatingProps:c}=ba((s==null?void 0:s.show)||!1,(s==null?void 0:s.referencePos)||null,3e3,{placement:r,middleware:[is(10),Pl(),bo()],onOpenChange:(h,f)=>{h||(n.formattingToolbar.closeMenu(),n.focus())},...t.floatingOptions}),u=v.useMemo(()=>lS([e,a]),[e,a]);if(!i||!s)return null;if(!s.show&&e.current)return m.jsx("div",{ref:u,style:l,dangerouslySetInnerHTML:{__html:e.current.innerHTML}});const d=t.formattingToolbar||tV;return m.jsx("div",{ref:u,style:l,...c(),children:m.jsx(d,{})})},Lae=t=>{const e=de(),n=_e();return m.jsx(e.LinkToolbar.Button,{className:"bn-button",label:n.link_toolbar.delete.tooltip,mainTooltip:n.link_toolbar.delete.tooltip,isSelected:!1,onClick:t.deleteLink,icon:m.jsx(Hie,{})})},Vae=t=>{const e=de(),n=_e();return m.jsxs(e.Generic.Popover.Root,{children:[m.jsx(e.Generic.Popover.Trigger,{children:m.jsx(e.LinkToolbar.Button,{className:"bn-button",mainTooltip:n.link_toolbar.edit.tooltip,isSelected:!1,children:n.link_toolbar.edit.text})}),m.jsx(e.Generic.Popover.Content,{className:"bn-popover-content bn-form-popover",variant:"form-popover",children:m.jsx(Z5,{...t})})]})},jae=t=>{const e=de(),n=_e();return m.jsx(e.LinkToolbar.Button,{className:"bn-button",mainTooltip:n.link_toolbar.open.tooltip,label:n.link_toolbar.open.tooltip,isSelected:!1,onClick:()=>{window.open(lC(t.url,window.location.href),"_blank")},icon:m.jsx(rae,{})})},Bae=t=>{const e=de();return t.children?m.jsx(e.LinkToolbar.Root,{className:"bn-toolbar bn-link-toolbar",children:t.children}):m.jsxs(e.LinkToolbar.Root,{className:"bn-toolbar bn-link-toolbar",onMouseEnter:t.stopHideTimer,onMouseLeave:t.startHideTimer,children:[m.jsx(Vae,{url:t.url,text:t.text,editLink:t.editLink}),m.jsx(jae,{url:t.url}),m.jsx(Lae,{deleteLink:t.deleteLink})]})},$ae=t=>{const e=pe(),n={deleteLink:e.linkToolbar.deleteLink,editLink:e.linkToolbar.editLink,startHideTimer:e.linkToolbar.startHideTimer,stopHideTimer:e.linkToolbar.stopHideTimer},r=ei(e.linkToolbar.onUpdate.bind(e.linkToolbar)),{isMounted:o,ref:s,style:i,getFloatingProps:a}=ba((r==null?void 0:r.show)||!1,(r==null?void 0:r.referencePos)||null,4e3,{placement:"top-start",middleware:[is(10),bo()],onOpenChange:h=>{h||(e.linkToolbar.closeMenu(),e.focus())},...t.floatingOptions});if(!o||!r)return null;const{show:l,referencePos:c,...u}=r,d=t.linkToolbar||Bae;return m.jsx("div",{ref:s,style:i,...a(),children:m.jsx(d,{...u,...n})})};function Fae(t){return ve({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8Z"},child:[]},{tag:"path",attr:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8Z"},child:[]}]})(t)}const Hae=t=>{const e=de(),n=_e(),r=pe(),o=v.useCallback(()=>{const s=t.block.content;if(s!==void 0&&Array.isArray(s)&&s.length===0)r.setTextCursorPosition(t.block),r.openSuggestionMenu("/");else{const i=r.insertBlocks([{type:"paragraph"}],t.block,"after")[0];r.setTextCursorPosition(i),r.openSuggestionMenu("/")}},[r,t.block]);return m.jsx(e.SideMenu.Button,{className:"bn-button",label:n.side_menu.add_block_label,icon:m.jsx(Fae,{size:24,onClick:o,"data-test":"dragHandleAdd"})})};function rV(t){return ve({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"},child:[]}]})(t)}function zae(t){return ve({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m7 10 5 5 5-5z"},child:[]}]})(t)}const Uae=t=>{const e=de(),n=pe();return!dc("textColor",t.block.type,n)&&!dc("backgroundColor",t.block.type,n)?null:m.jsxs(e.Generic.Menu.Root,{position:"right",sub:!0,children:[m.jsx(e.Generic.Menu.Trigger,{sub:!0,children:m.jsx(e.Generic.Menu.Item,{className:"bn-menu-item",subTrigger:!0,children:t.children})}),m.jsx(e.Generic.Menu.Dropdown,{sub:!0,className:"bn-menu-dropdown bn-color-picker-dropdown",children:m.jsx(kb,{iconSize:18,text:dc("textColor",t.block.type,n)&&Yw("textColor",t.block,n)?{color:t.block.props.textColor,setColor:r=>n.updateBlock(t.block,{type:t.block.type,props:{textColor:r}})}:void 0,background:dc("backgroundColor",t.block.type,n)&&Yw("backgroundColor",t.block,n)?{color:t.block.props.backgroundColor,setColor:r=>n.updateBlock(t.block,{props:{backgroundColor:r}})}:void 0})})]})},Wae=t=>{const e=de(),n=pe();return m.jsx(e.Generic.Menu.Item,{className:"bn-menu-item",onClick:()=>n.removeBlocks([t.block]),children:t.children})},qae=t=>{const e=de(),n=pe();if(t.block.type!=="table"||!n.settings.tables.headers)return null;const r=!!t.block.content.headerRows;return m.jsx(e.Generic.Menu.Item,{className:"bn-menu-item",checked:r,onClick:()=>{const o=n.getBlock(t.block.id);o&&n.updateBlock(o,{...o,content:{...o.content,headerRows:r?void 0:1}})},children:t.children})},Gae=t=>{const e=de(),n=pe();if(t.block.type!=="table"||!n.settings.tables.headers)return null;const r=!!t.block.content.headerCols;return m.jsx(e.Generic.Menu.Item,{className:"bn-menu-item",checked:r,onClick:()=>{n.updateBlock(t.block,{type:"table",content:{...t.block.content,type:"tableContent",headerCols:r?void 0:1}})},children:t.children})},Kae=t=>{const e=de(),n=_e();return m.jsx(e.Generic.Menu.Dropdown,{className:"bn-menu-dropdown bn-drag-handle-menu",children:t.children||m.jsxs(m.Fragment,{children:[m.jsx(Wae,{...t,children:n.drag_handle.delete_menuitem}),m.jsx(Uae,{...t,children:n.drag_handle.colors_menuitem}),m.jsx(qae,{...t,children:n.drag_handle.header_row_menuitem}),m.jsx(Gae,{...t,children:n.drag_handle.header_column_menuitem})]})})},Yae=t=>{const e=de(),n=_e(),r=t.dragHandleMenu||Kae;return m.jsxs(e.Generic.Menu.Root,{onOpenChange:o=>{o?t.freezeMenu():t.unfreezeMenu()},position:"left",children:[m.jsx(e.Generic.Menu.Trigger,{children:m.jsx(e.SideMenu.Button,{label:n.side_menu.drag_handle_label,draggable:!0,onDragStart:o=>t.blockDragStart(o,t.block),onDragEnd:t.blockDragEnd,className:"bn-button",icon:m.jsx(rV,{size:24,"data-test":"dragHandle"})})}),m.jsx(r,{block:t.block,children:t.children})]})},Xae=t=>{const e=de(),n=v.useMemo(()=>{const r={"data-block-type":t.block.type};return t.block.type==="heading"&&(r["data-level"]=t.block.props.level.toString()),t.editor.schema.blockSchema[t.block.type].isFileBlock&&(t.block.props.url?r["data-url"]="true":r["data-url"]="false"),r},[t.block,t.editor.schema.blockSchema]);return m.jsx(e.SideMenu.Root,{className:"bn-side-menu",...n,children:t.children||m.jsxs(m.Fragment,{children:[m.jsx(Hae,{...t}),m.jsx(Yae,{...t})]})})},Jae=t=>{const e=pe(),n={blockDragStart:e.sideMenu.blockDragStart,blockDragEnd:e.sideMenu.blockDragEnd,freezeMenu:e.sideMenu.freezeMenu,unfreezeMenu:e.sideMenu.unfreezeMenu},r=ei(e.sideMenu.onUpdate.bind(e.sideMenu)),{isMounted:o,ref:s,style:i,getFloatingProps:a}=ba((r==null?void 0:r.show)||!1,(r==null?void 0:r.referencePos)||null,1e3,{placement:"left-start",...t.floatingOptions});if(!o||!r)return null;const{show:l,referencePos:c,...u}=r,d=t.sideMenu||Xae;return m.jsx("div",{ref:s,style:i,...a(),children:m.jsx(d,{...u,...n,editor:e})})};async function Qae(t,e){return(await tse(t,e)).map(({id:n,onItemClick:r})=>({id:n,onItemClick:r,icon:n}))}function Zae(t){const e=de(),n=_e(),{items:r,loadingState:o,selectedIndex:s,onItemClick:i,columns:a}=t,l=o==="loading-initial"||o==="loading"?m.jsx(e.GridSuggestionMenu.Loader,{className:"bn-grid-suggestion-menu-loader",columns:a}):null,c=v.useMemo(()=>{const u=[];for(let d=0;d<r.length;d++){const h=r[d];u.push(m.jsx(e.GridSuggestionMenu.Item,{className:"bn-grid-suggestion-menu-item",item:h,id:`bn-grid-suggestion-menu-item-${d}`,isSelected:d===s,onClick:()=>i==null?void 0:i(h)},h.id))}return u},[e,r,i,s]);return m.jsxs(e.GridSuggestionMenu.Root,{id:"bn-grid-suggestion-menu",columns:a,className:"bn-grid-suggestion-menu",children:[l,c,c.length===0&&t.loadingState==="loaded"&&m.jsx(e.GridSuggestionMenu.EmptyItem,{className:"bn-grid-suggestion-menu-empty-item",columns:a,children:n.suggestion_menu.no_items_title})]})}function oV(t,e,n,r=3){const o=v.useRef(0);v.useEffect(()=>{e!==void 0&&(t.length>0?o.current=e.length:e.length-o.current>r&&n())},[n,r,t.length,e])}function sV(t,e){const[n,r]=v.useState([]),[o,s]=v.useState(!1),i=v.useRef(),a=v.useRef();return v.useEffect(()=>{const l=t;i.current=t,s(!0),e(t).then(c=>{i.current===l&&(r(c),s(!1),a.current=l)})},[t,e]),{items:n||[],usedQuery:a.current,loadingState:a.current===void 0?"loading-initial":o?"loading":"loaded"}}function ele(t,e,n,r,o){const[s,i]=v.useState(0),a=r!==void 0&&r>1;return v.useEffect(()=>{var l;const c=u=>(u.key==="ArrowLeft"&&(u.preventDefault(),n.length&&i((s-1+n.length)%n.length)),u.key==="ArrowRight"&&(u.preventDefault(),n.length&&i((s+1+n.length)%n.length)),u.key==="ArrowUp"?(u.preventDefault(),n.length&&i((s-r+n.length)%n.length),!0):u.key==="ArrowDown"?(u.preventDefault(),n.length&&i((s+r)%n.length),!0):u.key==="Enter"&&!u.isComposing?(u.stopPropagation(),u.preventDefault(),n.length&&(o==null||o(n[s])),!0):!1);return(l=t.domElement)==null||l.addEventListener("keydown",c,!0),()=>{var u;(u=t.domElement)==null||u.removeEventListener("keydown",c,!0)}},[t.domElement,n,s,o,r,a]),v.useEffect(()=>{i(0)},[e]),{selectedIndex:n.length===0?void 0:s}}function tle(t){const e=fs().setContentEditableProps,n=pe(),{getItems:r,gridSuggestionMenuComponent:o,query:s,clearQuery:i,closeMenu:a,onItemClick:l,columns:c}=t,u=v.useCallback(y=>{a(),i(),l==null||l(y)},[l,a,i]),{items:d,usedQuery:h,loadingState:f}=sV(s,r);oV(d,h,a);const{selectedIndex:p}=ele(n,s,d,c,u);return v.useEffect(()=>(e(y=>({...y,"aria-expanded":!0,"aria-controls":"bn-suggestion-menu"})),()=>{e(y=>({...y,"aria-expanded":!1,"aria-controls":void 0}))}),[e]),v.useEffect(()=>(e(y=>({...y,"aria-activedescendant":p?"bn-suggestion-menu-item-"+p:void 0})),()=>{e(y=>({...y,"aria-activedescendant":void 0}))}),[e,p]),m.jsx(o,{items:d,onItemClick:u,loadingState:f,selectedIndex:p,columns:c})}function nle(t){const e=pe(),{triggerCharacter:n,gridSuggestionMenuComponent:r,columns:o,minQueryLength:s,onItemClick:i,getItems:a,floatingOptions:l}=t,c=v.useMemo(()=>i||(k=>{k.onItemClick(e)}),[e,i]),u=v.useMemo(()=>a||(async k=>await Qae(e,k)),[e,a]),d={closeMenu:e.suggestionMenus.closeMenu,clearQuery:e.suggestionMenus.clearQuery},h=v.useCallback(k=>e.suggestionMenus.onUpdate(n,k),[e.suggestionMenus,n]),f=ei(h),{isMounted:p,ref:y,style:b,getFloatingProps:w}=ba((f==null?void 0:f.show)||!1,(f==null?void 0:f.referencePos)||null,2e3,{placement:"bottom-start",middleware:[is(10),bo(),Ly({apply({availableHeight:k,elements:x}){Object.assign(x.floating.style,{maxHeight:`${k-10}px`})}})],onOpenChange(k){k||e.suggestionMenus.closeMenu()},...l});return!p||!f||!(f!=null&&f.ignoreQueryLength)&&s&&(f.query.startsWith(" ")||f.query.length<s)?null:m.jsx("div",{ref:y,style:b,...w(),children:m.jsx(tle,{query:f.query,closeMenu:d.closeMenu,clearQuery:d.clearQuery,getItems:u,columns:o,gridSuggestionMenuComponent:r||Zae,onItemClick:c})})}function rle(t){const e=de(),n=_e(),{items:r,loadingState:o,selectedIndex:s,onItemClick:i}=t,a=o==="loading-initial"||o==="loading"?m.jsx(e.SuggestionMenu.Loader,{className:"bn-suggestion-menu-loader"}):null,l=v.useMemo(()=>{let c;const u=[];for(let d=0;d<r.length;d++){const h=r[d];h.group!==c&&(c=h.group,u.push(m.jsx(e.SuggestionMenu.Label,{className:"bn-suggestion-menu-label",children:c},c))),u.push(m.jsx(e.SuggestionMenu.Item,{className:dt("bn-suggestion-menu-item",h.size==="small"?"bn-suggestion-menu-item-small":""),item:h,id:`bn-suggestion-menu-item-${d}`,isSelected:d===s,onClick:()=>i==null?void 0:i(h)},h.title))}return u},[e,r,i,s]);return m.jsxs(e.SuggestionMenu.Root,{id:"bn-suggestion-menu",className:"bn-suggestion-menu",children:[l,l.length===0&&(t.loadingState==="loading"||t.loadingState==="loaded")&&m.jsx(e.SuggestionMenu.EmptyItem,{className:"bn-suggestion-menu-item",children:n.suggestion_menu.no_items_title}),a]})}function ole(t,e){const[n,r]=v.useState(0);return{selectedIndex:n,setSelectedIndex:r,handler:o=>{if(o.key==="ArrowUp")return o.preventDefault(),t.length&&r((n-1+t.length)%t.length),!0;if(o.key==="ArrowDown")return o.preventDefault(),t.length&&r((n+1)%t.length),!0;const s=sle(o)?o.nativeEvent.isComposing:o.isComposing;return o.key==="Enter"&&!s?(o.preventDefault(),o.stopPropagation(),t.length&&(e==null||e(t[n])),!0):!1}}}function sle(t){return t.nativeEvent!==void 0}function ile(t,e,n,r,o){const{selectedIndex:s,setSelectedIndex:i,handler:a}=ole(n,r);return v.useEffect(()=>{var l;return(l=t.domElement)==null||l.addEventListener("keydown",a,!0),()=>{var c;(c=t.domElement)==null||c.removeEventListener("keydown",a,!0)}},[t.domElement,n,s,r,o,a]),v.useEffect(()=>{i(0)},[e,i]),{selectedIndex:n.length===0?void 0:s}}function ale(t){const e=fs().setContentEditableProps,n=pe(),{getItems:r,suggestionMenuComponent:o,query:s,clearQuery:i,closeMenu:a,onItemClick:l}=t,c=v.useCallback(p=>{a(),i(),l==null||l(p)},[l,a,i]),{items:u,usedQuery:d,loadingState:h}=sV(s,r);oV(u,d,a);const{selectedIndex:f}=ile(n,s,u,c);return v.useEffect(()=>(e(p=>({...p,"aria-expanded":!0,"aria-controls":"bn-suggestion-menu"})),()=>{e(p=>({...p,"aria-expanded":!1,"aria-controls":void 0}))}),[e]),v.useEffect(()=>(e(p=>({...p,"aria-activedescendant":f?"bn-suggestion-menu-item-"+f:void 0})),()=>{e(p=>({...p,"aria-activedescendant":void 0}))}),[e,f]),m.jsx(o,{items:u,onItemClick:c,loadingState:h,selectedIndex:f})}const lle={heading:F5,heading_2:H5,heading_3:z5,quote:K5,numbered_list:q5,bullet_list:G5,check_list:W5,paragraph:iS,table:qie,image:Y5,video:Kie,audio:X5,file:sS,emoji:sae,code_block:jie};function cle(t){return Gne(t).map(e=>{const n=lle[e.key];return{...e,icon:m.jsx(n,{size:18})}})}function ule(t){const e=pe(),{triggerCharacter:n,suggestionMenuComponent:r,minQueryLength:o,onItemClick:s,getItems:i,floatingOptions:a}=t,l=v.useMemo(()=>s||(w=>{w.onItemClick(e)}),[e,s]),c=v.useMemo(()=>i||(async w=>Kne(cle(e),w)),[e,i]),u={closeMenu:e.suggestionMenus.closeMenu,clearQuery:e.suggestionMenus.clearQuery},d=v.useCallback(w=>e.suggestionMenus.onUpdate(n,w),[e.suggestionMenus,n]),h=ei(d),{isMounted:f,ref:p,style:y,getFloatingProps:b}=ba((h==null?void 0:h.show)||!1,(h==null?void 0:h.referencePos)||null,2e3,{placement:"bottom-start",middleware:[is(10),bo({mainAxis:!0,crossAxis:!1}),Pl(),Ly({apply({availableHeight:w,elements:k}){Object.assign(k.floating.style,{maxHeight:`${w-10}px`})}})],onOpenChange(w){w||e.suggestionMenus.closeMenu()},...a});return!f||!h||!(h!=null&&h.ignoreQueryLength)&&o&&(h.query.startsWith(" ")||h.query.length<o)?null:m.jsx("div",{ref:p,style:y,...b(),children:m.jsx(ale,{query:h.query,closeMenu:u.closeMenu,clearQuery:u.clearQuery,getItems:c,suggestionMenuComponent:r||rle,onItemClick:l})})}const dle=(t,e=.3)=>{const n=Math.floor(t)+e,r=Math.ceil(t)-e;return t>=n&&t<=r?Math.round(t):t<n?Math.floor(t):Math.ceil(t)},hle=t=>{const e=de(),n=v.useRef(!1),[r,o]=v.useState(),s=v.useCallback(a=>{t.onMouseDown(),o({originalContent:t.block.content,originalCroppedContent:{rows:t.editor.tableHandles.cropEmptyRowsOrColumns(t.block,t.orientation==="addOrRemoveColumns"?"columns":"rows")},startPos:t.orientation==="addOrRemoveColumns"?a.clientX:a.clientY}),n.current=!1,a.preventDefault()},[t]),i=v.useCallback(()=>{n.current||t.editor.updateBlock(t.block,{type:"table",content:{...t.block.content,rows:t.orientation==="addOrRemoveColumns"?t.editor.tableHandles.addRowsOrColumns(t.block,"columns",1):t.editor.tableHandles.addRowsOrColumns(t.block,"rows",1)}})},[t.block,t.orientation,t.editor]);return v.useEffect(()=>{const a=l=>{var c,u;if(!r)throw new Error("editingState is undefined");n.current=!0;const d=(t.orientation==="addOrRemoveColumns"?l.clientX:l.clientY)-r.startPos,h=t.orientation==="addOrRemoveColumns"?((c=r.originalCroppedContent.rows[0])==null?void 0:c.cells.length)??0:r.originalCroppedContent.rows.length,f=t.orientation==="addOrRemoveColumns"?((u=r.originalContent.rows[0])==null?void 0:u.cells.length)??0:r.originalContent.rows.length,p=t.orientation==="addOrRemoveColumns"?t.block.content.rows[0].cells.length:t.block.content.rows.length,y=f+dle(d/(t.orientation==="addOrRemoveColumns"?zk:Ine),.3);y>=h&&y>0&&y!==p&&(t.editor.updateBlock(t.block,{type:"table",content:{...t.block.content,rows:t.orientation==="addOrRemoveColumns"?t.editor.tableHandles.addRowsOrColumns({type:"table",content:r.originalCroppedContent},"columns",y-h):t.editor.tableHandles.addRowsOrColumns({type:"table",content:r.originalCroppedContent},"rows",y-h)}}),t.block.content&&t.editor.setTextCursorPosition(t.block))};return r&&window.addEventListener("mousemove",a),()=>{window.removeEventListener("mousemove",a)}},[r,t.block,t.editor,t.orientation]),v.useEffect(()=>{const a=t.onMouseUp,l=()=>{o(void 0),a()};return r&&window.addEventListener("mouseup",l),()=>{window.removeEventListener("mouseup",l)}},[r,t.onMouseUp]),m.jsx(e.TableHandle.ExtendButton,{className:dt("bn-extend-button",t.orientation==="addOrRemoveColumns"?"bn-extend-button-add-remove-columns":"bn-extend-button-add-remove-rows",r!==null?"bn-extend-button-editing":""),onClick:i,onMouseDown:s,children:t.children||m.jsx(Qie,{size:18,"data-test":"extendButton"})})},tM=t=>{const e=de(),n=_e(),r=pe().tableHandles;return r?m.jsx(e.Generic.Menu.Item,{onClick:()=>{r.addRowOrColumn(t.index,t.orientation==="row"?{orientation:"row",side:t.side}:{orientation:"column",side:t.side})},children:n.table_handle[`add_${t.side}_menuitem`]}):null},fle=t=>{const e=de(),n=_e(),r=pe().tableHandles;return r?m.jsx(e.Generic.Menu.Item,{onClick:()=>{r.removeRowOrColumn(t.index,t.orientation)},children:t.orientation==="row"?n.table_handle.delete_row_menuitem:n.table_handle.delete_column_menuitem}):null},ple=t=>{const e=de(),n=_e(),r=pe(),o=r.tableHandles,s=v.useMemo(()=>!o||!t.block?[]:t.orientation==="row"?o.getCellsAtRowHandle(t.block,t.index):o.getCellsAtColumnHandle(t.block,t.index),[t.block,t.index,t.orientation,o]),i=(l,c)=>{const u=t.block.content.rows.map(d=>({...d,cells:d.cells.map(h=>ta(h))}));s.forEach(({row:d,col:h})=>{c==="text"?u[d].cells[h].props.textColor=l:u[d].cells[h].props.backgroundColor=l}),r.updateBlock(t.block,{type:"table",content:{...t.block.content,rows:u}}),r.setTextCursorPosition(t.block)};if(!s||!s[0]||!o||r.settings.tables.cellTextColor===!1&&r.settings.tables.cellBackgroundColor===!1)return null;const a=ta(s[0].cell);return m.jsxs(e.Generic.Menu.Root,{position:"right",sub:!0,children:[m.jsx(e.Generic.Menu.Trigger,{sub:!0,children:m.jsx(e.Generic.Menu.Item,{className:"bn-menu-item",subTrigger:!0,children:t.children||n.drag_handle.colors_menuitem})}),m.jsx(e.Generic.Menu.Dropdown,{sub:!0,className:"bn-menu-dropdown bn-color-picker-dropdown",children:m.jsx(kb,{iconSize:18,text:r.settings.tables.cellTextColor?{color:s.every(({cell:l})=>na(l)&&l.props.textColor===a.props.textColor)?a.props.textColor:"default",setColor:l=>{i(l,"text")}}:void 0,background:r.settings.tables.cellBackgroundColor?{color:s.every(({cell:l})=>na(l)&&l.props.backgroundColor===a.props.backgroundColor)?a.props.backgroundColor:"default",setColor:l=>i(l,"background")}:void 0})})]})},mle=t=>{const e=de(),n=_e(),r=pe();if(!r.tableHandles||t.index!==0||t.orientation!=="row"||!r.settings.tables.headers)return null;const o=!!t.block.content.headerRows;return m.jsx(e.Generic.Menu.Item,{className:"bn-menu-item",checked:o,onClick:()=>{const s=r.getBlock(t.block.id);s&&r.updateBlock(s,{...s,content:{...s.content,headerRows:o?void 0:1}})},children:n.drag_handle.header_row_menuitem})},gle=t=>{const e=de(),n=_e(),r=pe();if(!r.tableHandles||t.index!==0||t.orientation!=="column"||!r.settings.tables.headers)return null;const o=!!t.block.content.headerCols;return m.jsx(e.Generic.Menu.Item,{className:"bn-menu-item",checked:o,onClick:()=>{const s=r.getBlock(t.block.id);s&&r.updateBlock(s,{...s,content:{...s.content,headerCols:o?void 0:1}})},children:n.drag_handle.header_column_menuitem})},yle=t=>{const e=de();return m.jsx(e.Generic.Menu.Dropdown,{className:"bn-table-handle-menu",children:t.children||m.jsxs(m.Fragment,{children:[m.jsx(fle,{orientation:t.orientation,block:t.block,index:t.index}),m.jsx(tM,{orientation:t.orientation,block:t.block,index:t.index,side:t.orientation==="row"?"above":"left"}),m.jsx(tM,{orientation:t.orientation,block:t.block,index:t.index,side:t.orientation==="row"?"below":"right"}),m.jsx(mle,{orientation:t.orientation,block:t.block,index:t.index}),m.jsx(gle,{orientation:t.orientation,block:t.block,index:t.index}),m.jsx(ple,{orientation:t.orientation,block:t.block,index:t.index})]})})},ble=t=>{const e=de(),[n,r]=v.useState(!1),o=t.tableHandleMenu||yle,s=v.useMemo(()=>{const i=t.editor.tableHandles;return!i||!t.block||t.block.type!=="table"?!1:t.orientation==="column"?i.getCellsAtColumnHandle(t.block,t.index).every(({cell:a})=>_l(a)===1):i.getCellsAtRowHandle(t.block,t.index).every(({cell:a})=>Rh(a)===1)},[t.block,t.editor.tableHandles,t.index,t.orientation]);return m.jsxs(e.Generic.Menu.Root,{onOpenChange:i=>{i?(t.freezeHandles(),t.hideOtherSide()):(t.unfreezeHandles(),t.showOtherSide(),t.editor.focus())},position:"right",children:[m.jsx(e.Generic.Menu.Trigger,{children:m.jsx(e.TableHandle.Root,{className:dt("bn-table-handle",n?"bn-table-handle-dragging":"",s?"":"bn-table-handle-not-draggable"),draggable:s,onDragStart:i=>{r(!0),t.dragStart(i)},onDragEnd:()=>{t.dragEnd(),r(!1)},style:t.orientation==="column"?{transform:"rotate(0.25turn)"}:void 0,children:t.children||m.jsx(rV,{size:24,"data-test":"tableHandle"})})}),gn.createPortal(m.jsx(o,{orientation:t.orientation,block:t.block,index:t.index}),t.menuContainer)]})};function nM(t,e,n){const{refs:r,update:o,context:s,floatingStyles:i}=fu({open:e,placement:t==="addOrRemoveColumns"?"right":"bottom",middleware:[Ly({apply({rects:c,elements:u}){Object.assign(u.floating.style,t==="addOrRemoveColumns"?{height:`${c.reference.height}px`}:{width:`${c.reference.width}px`})}})]}),{isMounted:a,styles:l}=eS(s);return v.useEffect(()=>{o()},[n,o]),v.useEffect(()=>{n!==null&&r.setReference({getBoundingClientRect:()=>n})},[t,n,r]),v.useMemo(()=>({isMounted:a,ref:r.setFloating,style:{display:"flex",...l,...i}}),[i,a,r.setFloating,l])}function vle(t,e,n){const r=nM("addOrRemoveRows",e,n),o=nM("addOrRemoveColumns",t,n);return v.useMemo(()=>({addOrRemoveRowsButton:r,addOrRemoveColumnsButton:o}),[o,r])}function wle(t,e,n){return n&&n.draggedCellOrientation==="row"?new DOMRect(e.x,n.mousePos,e.width,0):new DOMRect(e.x,t.y,e.width,t.height)}function Cle(t,e,n){return n&&n.draggedCellOrientation==="col"?new DOMRect(n.mousePos,e.y,0,e.height):new DOMRect(t.x,e.y,t.width,e.height)}function xle(t){return new DOMRect(t.x,t.y,t.width,0)}function qv(t,e,n,r,o){const{refs:s,update:i,context:a,floatingStyles:l}=fu({open:e,placement:t==="row"?"left":t==="col"?"top":"bottom-end",middleware:[is(t==="row"?-10:t==="col"?-12:{mainAxis:1,crossAxis:-1})]}),{isMounted:c,styles:u}=eS(a);return v.useEffect(()=>{i()},[n,r,i]),v.useEffect(()=>{n===null||r===null||o&&t==="cell"||s.setReference({getBoundingClientRect:()=>(t==="row"?wle:t==="col"?Cle:xle)(n,r,o)})},[o,t,n,r,s]),v.useMemo(()=>({isMounted:c,ref:s.setFloating,style:{display:"flex",...u,...l}}),[l,c,s.setFloating,u])}function kle(t,e,n,r){const o=qv("row",t,e,n,r),s=qv("col",t,e,n,r),i=qv("cell",t,e,n,r);return v.useMemo(()=>({rowHandle:o,colHandle:s,cellHandle:i}),[s,o,i])}const Sle=t=>{var e,n;const r=de(),o=_e(),s=pe(),i=(l,c)=>{const u=t.block.content.rows.map(d=>({...d,cells:d.cells.map(h=>ta(h))}));c==="text"?u[t.rowIndex].cells[t.colIndex].props.textColor=l:u[t.rowIndex].cells[t.colIndex].props.backgroundColor=l,s.updateBlock(t.block,{type:"table",content:{...t.block.content,rows:u}}),s.setTextCursorPosition(t.block)},a=(n=(e=t.block.content.rows[t.rowIndex])==null?void 0:e.cells)==null?void 0:n[t.colIndex];return!a||s.settings.tables.cellTextColor===!1&&s.settings.tables.cellBackgroundColor===!1?null:m.jsxs(r.Generic.Menu.Root,{position:"right",sub:!0,children:[m.jsx(r.Generic.Menu.Trigger,{sub:!0,children:m.jsx(r.Generic.Menu.Item,{className:"bn-menu-item",subTrigger:!0,children:t.children||o.drag_handle.colors_menuitem})}),m.jsx(r.Generic.Menu.Dropdown,{sub:!0,className:"bn-menu-dropdown bn-color-picker-dropdown",children:m.jsx(kb,{iconSize:18,text:s.settings.tables.cellTextColor?{color:na(a)?a.props.textColor:"default",setColor:l=>i(l,"text")}:void 0,background:s.settings.tables.cellBackgroundColor?{color:na(a)?a.props.backgroundColor:"default",setColor:l=>i(l,"background")}:void 0})})]})},Ele=t=>{var e,n;const r=de(),o=_e(),s=pe(),i=(n=(e=t.block.content.rows[t.rowIndex])==null?void 0:e.cells)==null?void 0:n[t.colIndex];return!i||!na(i)||Rh(i)===1&&_l(i)===1||!s.settings.tables.splitCells?null:m.jsx(r.Generic.Menu.Item,{onClick:()=>{var a;(a=s.tableHandles)==null||a.splitCell({row:t.rowIndex,col:t.colIndex})},children:o.table_handle.split_cell_menuitem})},Tle=t=>{const e=de();return m.jsx(e.Generic.Menu.Dropdown,{className:"bn-menu-dropdown bn-drag-handle-menu",children:t.children||m.jsxs(m.Fragment,{children:[m.jsx(Ele,{block:t.block,rowIndex:t.rowIndex,colIndex:t.colIndex}),m.jsx(Sle,{block:t.block,rowIndex:t.rowIndex,colIndex:t.colIndex})]})})},_le=t=>{const e=de(),n=t.tableCellMenu||Tle;return!t.editor.settings.tables.splitCells&&!t.editor.settings.tables.cellBackgroundColor&&!t.editor.settings.tables.cellTextColor?null:m.jsxs(e.Generic.Menu.Root,{onOpenChange:r=>{r?t.freezeHandles():(t.unfreezeHandles(),t.editor.focus())},position:"right",children:[m.jsx(e.Generic.Menu.Trigger,{children:m.jsx(e.Generic.Menu.Button,{className:"bn-table-cell-handle",children:t.children||m.jsx(zae,{size:12,"data-test":"tableCellHandle"})})}),gn.createPortal(m.jsx(n,{block:t.block,rowIndex:t.rowIndex,colIndex:t.colIndex}),t.menuContainer)]})},Ale=t=>{var e,n;const r=pe(),[o,s]=v.useState(null);if(!r.tableHandles)throw new Error("TableHandlesController can only be used when BlockNote editor schema contains table block");const i={rowDragStart:r.tableHandles.rowDragStart,colDragStart:r.tableHandles.colDragStart,dragEnd:r.tableHandles.dragEnd,freezeHandles:r.tableHandles.freezeHandles,unfreezeHandles:r.tableHandles.unfreezeHandles},{freezeHandles:a,unfreezeHandles:l}=i,c=v.useCallback(()=>{a(),I(!0),x(!0)},[a]),u=v.useCallback(()=>{l(),I(!1),x(!1)},[l]),d=ei(r.tableHandles.onUpdate.bind(r.tableHandles)),h=v.useMemo(()=>{var _,R;return d!=null&&d.draggingState?{draggedCellOrientation:(_=d==null?void 0:d.draggingState)==null?void 0:_.draggedCellOrientation,mousePos:(R=d==null?void 0:d.draggingState)==null?void 0:R.mousePos}:void 0},[d==null?void 0:d.draggingState,(e=d==null?void 0:d.draggingState)==null?void 0:e.draggedCellOrientation,(n=d==null?void 0:d.draggingState)==null?void 0:n.mousePos]),{rowHandle:f,colHandle:p,cellHandle:y}=kle((d==null?void 0:d.show)||!1,(d==null?void 0:d.referencePosCell)||null,(d==null?void 0:d.referencePosTable)||null,h),{addOrRemoveColumnsButton:b,addOrRemoveRowsButton:w}=vle((d==null?void 0:d.showAddOrRemoveColumnsButton)||!1,(d==null?void 0:d.showAddOrRemoveRowsButton)||!1,(d==null?void 0:d.referencePosTable)||null),[k,x]=v.useState(!1),[A,I]=v.useState(!1);if(!d)return null;const M=t.tableHandle||ble,T=t.extendButton||hle,S=t.tableCellHandle||_le;return m.jsxs(m.Fragment,{children:[m.jsx("div",{ref:s}),m.jsxs(Use,{root:d.widgetContainer,children:[!k&&o&&f.isMounted&&d.rowIndex!==void 0&&m.jsx("div",{ref:f.ref,style:f.style,children:m.jsx(M,{editor:r,orientation:"row",showOtherSide:()=>I(!1),hideOtherSide:()=>I(!0),index:d.rowIndex,block:d.block,dragStart:i.rowDragStart,dragEnd:i.dragEnd,freezeHandles:i.freezeHandles,unfreezeHandles:i.unfreezeHandles,menuContainer:o})}),!A&&o&&p.isMounted&&d.colIndex!==void 0&&m.jsx("div",{ref:p.ref,style:p.style,children:m.jsx(M,{editor:r,orientation:"column",showOtherSide:()=>x(!1),hideOtherSide:()=>x(!0),index:d.colIndex,block:d.block,dragStart:i.colDragStart,dragEnd:i.dragEnd,freezeHandles:i.freezeHandles,unfreezeHandles:i.unfreezeHandles,menuContainer:o})}),o&&y.isMounted&&d.colIndex!==void 0&&d.rowIndex!==void 0&&m.jsx("div",{ref:y.ref,style:y.style,children:m.jsx(S,{editor:r,block:d.block,rowIndex:d.rowIndex,colIndex:d.colIndex,menuContainer:o,freezeHandles:i.freezeHandles,unfreezeHandles:i.unfreezeHandles})}),m.jsx("div",{ref:w.ref,style:w.style,children:m.jsx(T,{editor:r,orientation:"addOrRemoveRows",block:d.block,onMouseDown:c,onMouseUp:u})}),m.jsx("div",{ref:b.ref,style:b.style,children:m.jsx(T,{editor:r,orientation:"addOrRemoveColumns",block:d.block,onMouseDown:c,onMouseUp:u})})]})]})};function Ile(t){const e=pe();if(!e)throw new Error("BlockNoteDefaultUI must be used within a BlockNoteContext.Provider");return m.jsxs(m.Fragment,{children:[t.formattingToolbar!==!1&&m.jsx(nV,{}),t.linkToolbar!==!1&&m.jsx($ae,{}),t.slashMenu!==!1&&m.jsx(ule,{triggerCharacter:"/"}),t.emojiPicker!==!1&&m.jsx(nle,{triggerCharacter:":",columns:10,minQueryLength:2}),t.sideMenu!==!1&&m.jsx(Jae,{}),e.filePanel&&t.filePanel!==!1&&m.jsx(gae,{}),e.tableHandles&&t.tableHandles!==!1&&m.jsx(Ale,{}),e.comments&&t.comments!==!1&&m.jsxs(m.Fragment,{children:[m.jsx(xie,{}),m.jsx(fae,{})]})]})}const iV=()=>{const t=v.useMemo(()=>{var i;return(i=window.matchMedia)==null?void 0:i.call(window,"(prefers-color-scheme: dark)")},[]),e=v.useMemo(()=>{var i;return(i=window.matchMedia)==null?void 0:i.call(window,"(prefers-color-scheme: light)")},[]),n=t==null?void 0:t.matches,r=e==null?void 0:e.matches,[o,s]=v.useState(n?"dark":r?"light":"no-preference");return v.useEffect(()=>{s(n?"dark":r?"light":"no-preference")},[n,r]),v.useEffect(()=>{if(typeof(t==null?void 0:t.addEventListener)=="function"){const i=({matches:l})=>l&&s("dark"),a=({matches:l})=>l&&s("light");return t==null||t.addEventListener("change",i),e==null||e.addEventListener("change",a),()=>{t==null||t.removeEventListener("change",i),e==null||e.removeEventListener("change",a)}}else{const i=()=>s(t.matches?"dark":e.matches?"light":"no-preference");return t==null||t.addEventListener("change",i),e==null||e.addEventListener("change",i),()=>{t==null||t.removeEventListener("change",i),e==null||e.removeEventListener("change",i)}}},[t,e]),o},aV=v.createContext(void 0);function Mle(){return v.useContext(aV)}function Rle(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:gn.createPortal(r.reactElement,r.element,n)},t.forEach(o=>o())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(o=>o())}}}const Ple=({contentComponent:t})=>{const e=v.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return m.jsx(m.Fragment,{children:Object.values(e)})},Dle=v.forwardRef((t,e)=>{const[n,r]=v.useState();return v.useImperativeHandle(e,()=>(o,s)=>{gn.flushSync(()=>{r({node:o,container:s})}),r(void 0)},[]),m.jsx(m.Fragment,{children:n&&gn.createPortal(n.node,n.container)})}),rM=()=>{};function Nle(t,e){const{editor:n,className:r,theme:o,children:s,editable:i,onSelectionChange:a,onChange:l,formattingToolbar:c,linkToolbar:u,slashMenu:d,emojiPicker:h,sideMenu:f,filePanel:p,tableHandles:y,comments:b,autoFocus:w,renderEditor:k=!n.headless,...x}=t,[A,I]=v.useState(),M=fs(),T=iV(),S=(M==null?void 0:M.colorSchemePreference)||T,_=o||(S==="dark"?"dark":"light");nS(l||rM,n),tS(a||rM,n),v.useEffect(()=>{n.isEditable=i!==!1},[i,n]);const R=v.useCallback(K=>{n.elementRenderer=K},[n]),D=v.useMemo(()=>({...M,editor:n,setContentEditableProps:I}),[M,n]),O={formattingToolbar:c,linkToolbar:u,slashMenu:d,emojiPicker:h,sideMenu:f,filePanel:p,tableHandles:y,comments:b},N={autoFocus:w,contentEditableProps:A};return m.jsx(L5.Provider,{value:D,children:m.jsxs(aV.Provider,{value:{editorProps:N,defaultUIProps:O},children:[m.jsx(Dle,{ref:R}),m.jsx(Ole,{className:r,renderEditor:k,editorColorScheme:_,ref:e,...x,children:s})]})})}const Ole=$.forwardRef(({className:t,renderEditor:e,editorColorScheme:n,children:r,...o},s)=>m.jsx("div",{className:dt("bn-container",n,t),"data-color-scheme":n,...o,ref:s,children:e?m.jsx(Vle,{children:r}):r})),Lle=$.forwardRef(Nle),Vle=t=>{const e=Mle(),n=pe(),r=v.useMemo(()=>Rle(),[]),o=v.useCallback(s=>{n.mount(s,r)},[n,r]);return m.jsxs(m.Fragment,{children:[m.jsx(Ple,{contentComponent:r}),m.jsx(jle,{...e.editorProps,...t,mount:o}),m.jsx(Ile,{...e.defaultUIProps}),t.children]})},jle=t=>{const{autoFocus:e,mount:n,contentEditableProps:r}=t;return m.jsx("div",{"aria-autocomplete":"list","aria-haspopup":"listbox","data-bn-autofocus":e,ref:n,...r})};function oM(t,e){let n;const r=document.createElement("div");let o;if(e!=null&&e.elementRenderer)e.elementRenderer(t(l=>n=l||void 0),r);else{if(!(e!=null&&e.headless))throw new Error("elementRenderer not available, expected headless editor");o=gie.createRoot(r),gn.flushSync(()=>{o.render(t(l=>n=l||void 0))})}if(!r.childElementCount)return console.warn("ReactInlineContentSpec: renderHTML() failed"),{dom:document.createElement("span")};n==null||n.setAttribute("data-tmp-find","true");const s=r.cloneNode(!0),i=s.firstElementChild,a=s.querySelector("[data-tmp-find]");return a==null||a.removeAttribute("data-tmp-find"),o==null||o.unmount(),{dom:i,contentDOM:a||void 0}}function Gv(t){var e;return m.jsx(cie,{onDragOver:n=>n.preventDefault(),...Object.fromEntries(Object.entries(t.domAttributes||{}).filter(([n])=>n!=="class")),className:dt("bn-block-content",((e=t.domAttributes)==null?void 0:e.class)||""),"data-content-type":t.blockType,...Object.fromEntries(Object.entries(t.blockProps).filter(([n,r])=>{const o=t.propSchema[n];return!Pk.includes(n)&&r!==o.default}).map(([n,r])=>[Yg(n),r])),"data-file-block":t.isFileBlock===!0||void 0,children:t.children})}function Sb(t,e){const n=Qr({name:t.type,content:t.content==="inline"?"inline*":"",group:"blockContent",selectable:t.isSelectable??!0,isolating:!0,addAttributes(){return kf(t.propSchema)},parseHTML(){return yL(t,e.parse)},renderHTML({HTMLAttributes:r}){const o=document.createElement("div");return bd({dom:o,contentDOM:t.content==="inline"?o:void 0},t.type,{},t.propSchema,t.isFileBlock,r)},addNodeView(){return r=>{const o=pie(s=>{var i;const a=this.options.editor,l=pL(s.getPos,a,this.editor,t.type),c=((i=this.options.domAttributes)==null?void 0:i.blockContent)||{},u=O5().nodeViewContentRef;if(!u)throw new Error("nodeViewContentRef is not set");const d=e.render;return m.jsx(Gv,{blockType:l.type,blockProps:l.props,propSchema:t.propSchema,isFileBlock:t.isFileBlock,domAttributes:c,children:m.jsx(d,{block:l,editor:a,contentRef:h=>{u(h),h&&(h.className=dt("bn-inline-content",h.className))}})})},{className:"bn-react-node-view-renderer"})(r);return t.isSelectable===!1&&gL(o,this.editor),o}}});return Dk(t,{node:n,toInternalHTML:(r,o)=>{var s;const i=((s=n.options.domAttributes)==null?void 0:s.blockContent)||{},a=e.render;return oM(l=>m.jsx(Gv,{blockType:r.type,blockProps:r.props,propSchema:t.propSchema,domAttributes:i,children:m.jsx(a,{block:r,editor:o,contentRef:c=>{l(c),c&&(c.className=dt("bn-inline-content",c.className))}})}),o)},toExternalHTML:(r,o)=>{var s;const i=((s=n.options.domAttributes)==null?void 0:s.blockContent)||{},a=e.toExternalHTML||e.render;return oM(l=>m.jsx(Gv,{blockType:r.type,blockProps:r.props,propSchema:t.propSchema,domAttributes:i,children:m.jsx(a,{block:r,editor:o,contentRef:c=>{l(c),c&&(c.className=dt("bn-inline-content",c.className))}})}),o)}})}function cS(t){const e=pe(),[n,r]=v.useState("loading"),[o,s]=v.useState();if(v.useEffect(()=>{let i=!0;return(async()=>{let a="";r("loading");try{a=e.resolveFileUrl?await e.resolveFileUrl(t):t}catch{r("error");return}i&&(r("loaded"),s(a))})(),()=>{i=!1}},[e,t]),n!=="loaded")return{loadingState:n};if(!o)throw new Error("Finished fetching file but did not get download URL.");return{loadingState:n,downloadUrl:o}}const uS=t=>m.jsxs("figure",{children:[t.children,m.jsx("figcaption",{children:t.caption})]});function Ble(t){const e=pe();v.useEffect(()=>e.onUploadEnd(t),[t,e])}function $le(t){const e=pe();v.useEffect(()=>e.onUploadStart(t),[t,e])}function lV(t){const[e,n]=v.useState(!1);return $le(r=>{r===t&&n(!0)}),Ble(r=>{r===t&&n(!1)}),e}const Fle=t=>{const e=_e(),n=v.useCallback(o=>{o.preventDefault()},[]),r=v.useCallback(()=>{t.editor.transact(o=>o.setMeta(t.editor.filePanel.plugins[0],{block:t.block}))},[t.block,t.editor]);return m.jsxs("div",{className:"bn-add-file-button",onMouseDown:n,onClick:r,children:[m.jsx("div",{className:"bn-add-file-button-icon",children:t.buttonIcon||m.jsx(sS,{size:24})}),m.jsx("div",{className:"bn-add-file-button-text",children:t.buttonText||e.file_blocks.file.add_button_text})]})},Hle=t=>m.jsxs("div",{className:"bn-file-name-with-icon",contentEditable:!1,draggable:!1,children:[m.jsx("div",{className:"bn-file-icon",children:m.jsx(sS,{size:24})}),m.jsx("p",{className:"bn-file-name",children:t.block.props.name})]}),dS=t=>{const e=lV(t.block.id);return m.jsx("div",{className:"bn-file-block-content-wrapper",onMouseEnter:t.onMouseEnter,onMouseLeave:t.onMouseLeave,style:t.style,children:e?m.jsx("div",{className:"bn-file-loading-preview",children:"Loading..."}):t.block.props.url===""?m.jsx(Fle,{...t}):m.jsxs(m.Fragment,{children:[t.block.props.showPreview===!1||!t.children?m.jsx(Hle,{...t}):t.children,t.block.props.caption&&m.jsx("p",{className:"bn-file-caption",children:t.block.props.caption})]})})},Eb=t=>m.jsxs("div",{children:[t.children,m.jsx("p",{children:t.caption})]}),zle=t=>{const e=cS(t.block.props.url);return m.jsx("audio",{className:"bn-audio",src:e.loadingState==="loading"?t.block.props.url:e.downloadUrl,controls:!0,contentEditable:!1,draggable:!1})},Ule=t=>{if(!t.block.props.url)return m.jsx("p",{children:"Add audio"});const e=t.block.props.showPreview?m.jsx("audio",{src:t.block.props.url}):m.jsx("a",{href:t.block.props.url,children:t.block.props.name||t.block.props.url});return t.block.props.caption?t.block.props.showPreview?m.jsx(uS,{caption:t.block.props.caption,children:e}):m.jsx(Eb,{caption:t.block.props.caption,children:e}):e},Wle=t=>m.jsx(dS,{...t,buttonText:t.editor.dictionary.file_blocks.audio.add_button_text,buttonIcon:m.jsx(X5,{size:24}),children:m.jsx(zle,{...t})});Sb(PL,{render:Wle,parse:DL,toExternalHTML:Ule});const qle=t=>{if(!t.block.props.url)return m.jsx("p",{children:"Add file"});const e=m.jsx("a",{href:t.block.props.url,children:t.block.props.name||t.block.props.url});return t.block.props.caption?m.jsx(Eb,{caption:t.block.props.caption,children:e}):e},Gle=t=>m.jsx(dS,{...t});Sb(NL,{render:Gle,parse:OL,toExternalHTML:qle});const cV=t=>{const[e,n]=v.useState(void 0),[r,o]=v.useState(t.block.props.previewWidth),[s,i]=v.useState(!1),a=v.useRef(null);v.useEffect(()=>{const f=y=>{var b,w;let k;t.block.props.textAlignment==="center"?e.handleUsed==="left"?k=e.initialWidth+(e.initialClientX-y.clientX)*2:k=e.initialWidth+(y.clientX-e.initialClientX)*2:e.handleUsed==="left"?k=e.initialWidth+e.initialClientX-y.clientX:k=e.initialWidth+y.clientX-e.initialClientX,o(Math.min(Math.max(k,64),((w=(b=t.editor.domElement)==null?void 0:b.firstElementChild)==null?void 0:w.clientWidth)||Number.MAX_VALUE))},p=()=>{n(void 0),t.editor.updateBlock(t.block,{props:{previewWidth:r}})};return e&&(window.addEventListener("mousemove",f),window.addEventListener("mouseup",p)),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",p)}},[t,e,r]);const l=v.useCallback(()=>{t.editor.isEditable&&i(!0)},[t.editor.isEditable]),c=v.useCallback(()=>{i(!1)},[]),u=v.useCallback(f=>{f.preventDefault(),n({handleUsed:"left",initialWidth:a.current.clientWidth,initialClientX:f.clientX})},[]),d=v.useCallback(f=>{f.preventDefault(),n({handleUsed:"right",initialWidth:a.current.clientWidth,initialClientX:f.clientX})},[]),h=lV(t.block.id);return m.jsx(dS,{...t,onMouseEnter:l,onMouseLeave:c,style:t.block.props.url&&!h&&t.block.props.showPreview?{width:r?`${r}px`:"fit-content"}:void 0,children:m.jsxs("div",{className:"bn-visual-media-wrapper",ref:a,children:[t.children,(s||e)&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"bn-resize-handle",style:{left:"4px"},onMouseDown:u}),m.jsx("div",{className:"bn-resize-handle",style:{right:"4px"},onMouseDown:d})]})]})})},Kle=t=>{const e=cS(t.block.props.url);return m.jsx("img",{className:"bn-visual-media",src:e.loadingState==="loading"?t.block.props.url:e.downloadUrl,alt:t.block.props.caption||"BlockNote image",contentEditable:!1,draggable:!1})},Yle=t=>{if(!t.block.props.url)return m.jsx("p",{children:"Add image"});const e=t.block.props.showPreview?m.jsx("img",{src:t.block.props.url,alt:t.block.props.name||t.block.props.caption||"BlockNote image",width:t.block.props.previewWidth}):m.jsx("a",{href:t.block.props.url,children:t.block.props.name||t.block.props.url});return t.block.props.caption?t.block.props.showPreview?m.jsx(uS,{caption:t.block.props.caption,children:e}):m.jsx(Eb,{caption:t.block.props.caption,children:e}):e},Xle=t=>m.jsx(cV,{...t,buttonText:t.editor.dictionary.file_blocks.image.add_button_text,buttonIcon:m.jsx(Y5,{size:24}),children:m.jsx(Kle,{...t})});Sb(jL,{render:Xle,parse:BL,toExternalHTML:Yle});const Jle=t=>{const e=cS(t.block.props.url);return m.jsx("video",{className:"bn-visual-media",src:e.loadingState==="loading"?t.block.props.url:e.downloadUrl,controls:!0,contentEditable:!1,draggable:!1})},Qle=t=>{if(!t.block.props.url)return m.jsx("p",{children:"Add video"});const e=t.block.props.showPreview?m.jsx("video",{src:t.block.props.url}):m.jsx("a",{href:t.block.props.url,children:t.block.props.name||t.block.props.url});return t.block.props.caption?t.block.props.showPreview?m.jsx(uS,{caption:t.block.props.caption,children:e}):m.jsx(Eb,{caption:t.block.props.caption,children:e}):e},Zle=t=>m.jsx(cV,{...t,buttonText:t.editor.dictionary.file_blocks.video.add_button_text,buttonIcon:m.jsx(Jie,{size:24}),children:m.jsx(Jle,{...t})});Sb(zL,{render:Zle,parse:UL,toExternalHTML:Qle});$.memo(({thread:t,selectedThreadId:e,editor:n,maxCommentsBeforeCollapse:r,referenceText:o})=>{const s=v.useCallback(a=>{var l;a.target.closest(".bn-action-toolbar")||(l=n.comments)==null||l.selectThread(t.id)},[n.comments,t.id]),i=v.useCallback(a=>{var l;if(!a.relatedTarget||a.relatedTarget.closest(".bn-action-toolbar"))return;const c=a.target instanceof Node?a.target:null,u=a.relatedTarget instanceof Node?a.relatedTarget.closest(".bn-thread"):null;(!c||!u||!u.contains(c))&&((l=n.comments)==null||l.selectThread(void 0))},[n.comments]);return m.jsx(J5,{thread:t,selected:t.id===e,referenceText:o,maxCommentsBeforeCollapse:r,onFocus:s,onBlur:i,tabIndex:0})});function uV(t,e){const n=t.getBoundingClientRect(),r=e.getBoundingClientRect(),o=n.top<r.top,s=n.bottom>r.bottom;return o&&s?"both":o?"top":s?"bottom":"none"}function zo(t){return Object.keys(t)}function Kv(t){return t&&typeof t=="object"&&!Array.isArray(t)}function hS(t,e){const n={...t},r=e;return Kv(t)&&Kv(e)&&Object.keys(e).forEach(o=>{Kv(r[o])&&o in t?n[o]=hS(n[o],r[o]):n[o]=r[o]}),n}function ece(t){return t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}function tce(t){var e;return typeof t!="string"||!t.includes("var(--mantine-scale)")?t:(e=t.match(/^calc\((.*?)\)$/))==null?void 0:e[1].split("*")[0].trim()}function nce(t){const e=tce(t);return typeof e=="number"?e:typeof e=="string"?e.includes("calc")||e.includes("var")?e:e.includes("px")?Number(e.replace("px","")):e.includes("rem")?Number(e.replace("rem",""))*16:e.includes("em")?Number(e.replace("em",""))*16:Number(e):NaN}function Yv(t){return t==="0rem"?"0rem":`calc(${t} * var(--mantine-scale))`}function dV(t,{shouldScale:e=!1}={}){function n(r){if(r===0||r==="0")return`0${t}`;if(typeof r=="number"){const o=`${r/16}${t}`;return e?Yv(o):o}if(typeof r=="string"){if(r===""||r.startsWith("calc(")||r.startsWith("clamp(")||r.includes("rgba("))return r;if(r.includes(","))return r.split(",").map(s=>n(s)).join(",");if(r.includes(" "))return r.split(" ").map(s=>n(s)).join(" ");if(r.includes(t))return e?Yv(r):r;const o=r.replace("px","");if(!Number.isNaN(Number(o))){const s=`${Number(o)/16}${t}`;return e?Yv(s):s}}return r}return n}const U=dV("rem",{shouldScale:!0}),sM=dV("em");function Tb(t){return Object.keys(t).reduce((e,n)=>(t[n]!==void 0&&(e[n]=t[n]),e),{})}function hV(t){if(typeof t=="number")return!0;if(typeof t=="string"){if(t.startsWith("calc(")||t.startsWith("var(")||t.includes(" ")&&t.trim()!=="")return!0;const e=/^[+-]?[0-9]+(\.[0-9]+)?(px|em|rem|ex|ch|lh|rlh|vw|vh|vmin|vmax|vb|vi|svw|svh|lvw|lvh|dvw|dvh|cm|mm|in|pt|pc|q|cqw|cqh|cqi|cqb|cqmin|cqmax|%)?$/;return t.trim().split(/\s+/).every(r=>e.test(r))}return!1}function Mf(t){return Array.isArray(t)||t===null?!1:typeof t=="object"?t.type!==v.Fragment:!1}function _b(t){const e=v.createContext(null);return[({children:o,value:s})=>m.jsx(e.Provider,{value:s,children:o}),()=>{const o=v.useContext(e);if(o===null)throw new Error(t);return o}]}function fS(t=null){const e=v.createContext(t);return[({children:o,value:s})=>m.jsx(e.Provider,{value:s,children:o}),()=>v.useContext(e)]}function iM(t,e){return n=>{if(typeof n!="string"||n.trim().length===0)throw new Error(e);return`${t}-${n}`}}function ey(t,e){let n=t;for(;(n=n.parentElement)&&!n.matches(e););return n}function rce(t,e,n){for(let r=t-1;r>=0;r-=1)if(!e[r].disabled)return r;if(n){for(let r=e.length-1;r>-1;r-=1)if(!e[r].disabled)return r}return t}function oce(t,e,n){for(let r=t+1;r<e.length;r+=1)if(!e[r].disabled)return r;if(n){for(let r=0;r<e.length;r+=1)if(!e[r].disabled)return r}return t}function sce(t,e,n){return ey(t,n)===ey(e,n)}function fV({parentSelector:t,siblingSelector:e,onKeyDown:n,loop:r=!0,activateOnFocus:o=!1,dir:s="rtl",orientation:i}){return a=>{var p;n==null||n(a);const l=Array.from(((p=ey(a.currentTarget,t))==null?void 0:p.querySelectorAll(e))||[]).filter(y=>sce(a.currentTarget,y,t)),c=l.findIndex(y=>a.currentTarget===y),u=oce(c,l,r),d=rce(c,l,r),h=s==="rtl"?d:u,f=s==="rtl"?u:d;switch(a.key){case"ArrowRight":{i==="horizontal"&&(a.stopPropagation(),a.preventDefault(),l[h].focus(),o&&l[h].click());break}case"ArrowLeft":{i==="horizontal"&&(a.stopPropagation(),a.preventDefault(),l[f].focus(),o&&l[f].click());break}case"ArrowUp":{i==="vertical"&&(a.stopPropagation(),a.preventDefault(),l[d].focus(),o&&l[d].click());break}case"ArrowDown":{i==="vertical"&&(a.stopPropagation(),a.preventDefault(),l[u].focus(),o&&l[u].click());break}case"Home":{a.stopPropagation(),a.preventDefault(),!l[0].disabled&&l[0].focus();break}case"End":{a.stopPropagation(),a.preventDefault();const y=l.length-1;!l[y].disabled&&l[y].focus();break}}}}const ice={app:100,modal:200,popover:300,overlay:400,max:9999};function Rf(t){return ice[t]}const ace=()=>{};function lce(t,e={active:!0}){return typeof t!="function"||!e.active?e.onKeyDown||ace:n=>{var r;n.key==="Escape"&&(t(n),(r=e.onTrigger)==null||r.call(e))}}function ut(t,e="size",n=!0){if(t!==void 0)return hV(t)?n?U(t):t:`var(--${e}-${t})`}function Pf(t){return ut(t,"mantine-spacing")}function Fn(t){return t===void 0?"var(--mantine-radius-default)":ut(t,"mantine-radius")}function pr(t){return ut(t,"mantine-font-size")}function cce(t){return ut(t,"mantine-line-height",!1)}function pV(t){if(t)return ut(t,"mantine-shadow",!1)}function $o(t,e){return n=>{t==null||t(n),e==null||e(n)}}function uce(t,e,n){var r;return n?Array.from(((r=ey(n,e))==null?void 0:r.querySelectorAll(t))||[]).findIndex(o=>o===n):null}function dce(){const[t,e]=v.useState(-1);return[t,{setHovered:e,resetHovered:()=>e(-1)}]}function hce(t="mantine-"){return`${t}${Math.random().toString(36).slice(2,11)}`}const aM=["mousedown","touchstart"];function fce(t,e,n){const r=v.useRef(null);return v.useEffect(()=>{const o=s=>{const{target:i}=s??{};if(Array.isArray(n)){const a=(i==null?void 0:i.hasAttribute("data-ignore-outside-clicks"))||!document.body.contains(i)&&i.tagName!=="HTML";n.every(c=>!!c&&!s.composedPath().includes(c))&&!a&&t()}else r.current&&!r.current.contains(i)&&t()};return(e||aM).forEach(s=>document.addEventListener(s,o)),()=>{(e||aM).forEach(s=>document.removeEventListener(s,o))}},[r,t,n]),r}function pce(t,e){try{return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}catch{return t.addListener(e),()=>t.removeListener(e)}}function mce(t,e){return typeof window<"u"&&"matchMedia"in window?window.matchMedia(t).matches:!1}function gce(t,e,{getInitialValueInEffect:n}={getInitialValueInEffect:!0}){const[r,o]=v.useState(n?e:mce(t)),s=v.useRef(null);return v.useEffect(()=>{if("matchMedia"in window)return s.current=window.matchMedia(t),o(s.current.matches),pce(s.current,i=>o(i.matches))},[t]),r}const Ab=typeof document<"u"?v.useLayoutEffect:v.useEffect;function oa(t,e){const n=v.useRef(!1);v.useEffect(()=>()=>{n.current=!1},[]),v.useEffect(()=>{if(n.current)return t();n.current=!0},e)}function yce({opened:t,shouldReturnFocus:e=!0}){const n=v.useRef(null),r=()=>{var o;n.current&&"focus"in n.current&&typeof n.current.focus=="function"&&((o=n.current)==null||o.focus({preventScroll:!0}))};return oa(()=>{let o=-1;const s=i=>{i.key==="Tab"&&window.clearTimeout(o)};return document.addEventListener("keydown",s),t?n.current=document.activeElement:e&&(o=window.setTimeout(r,10)),()=>{window.clearTimeout(o),document.removeEventListener("keydown",s)}},[t,e]),r}const bce=/input|select|textarea|button|object/,mV="a, input, select, textarea, button, object, [tabindex]";function vce(t){return t.style.display==="none"}function wce(t){if(t.getAttribute("aria-hidden")||t.getAttribute("hidden")||t.getAttribute("type")==="hidden")return!1;let n=t;for(;n&&!(n===document.body||n.nodeType===11);){if(vce(n))return!1;n=n.parentNode}return!0}function gV(t){let e=t.getAttribute("tabindex");return e===null&&(e=void 0),parseInt(e,10)}function cC(t){const e=t.nodeName.toLowerCase(),n=!Number.isNaN(gV(t));return(bce.test(e)&&!t.disabled||t instanceof HTMLAnchorElement&&t.href||n)&&wce(t)}function yV(t){const e=gV(t);return(Number.isNaN(e)||e>=0)&&cC(t)}function Cce(t){return Array.from(t.querySelectorAll(mV)).filter(yV)}function xce(t,e){const n=Cce(t);if(!n.length){e.preventDefault();return}const r=n[e.shiftKey?0:n.length-1],o=t.getRootNode();let s=r===o.activeElement||t===o.activeElement;const i=o.activeElement;if(i.tagName==="INPUT"&&i.getAttribute("type")==="radio"&&(s=n.filter(u=>u.getAttribute("type")==="radio"&&u.getAttribute("name")===i.getAttribute("name")).includes(r)),!s)return;e.preventDefault();const l=n[e.shiftKey?n.length-1:0];l&&l.focus()}function bV(t=!0){const e=v.useRef(null),n=o=>{let s=o.querySelector("[data-autofocus]");if(!s){const i=Array.from(o.querySelectorAll(mV));s=i.find(yV)||i.find(cC)||null,!s&&cC(o)&&(s=o)}s&&s.focus({preventScroll:!0})},r=v.useCallback(o=>{t&&o!==null&&e.current!==o&&(o?(setTimeout(()=>{o.getRootNode()&&n(o)}),e.current=o):e.current=null)},[t]);return v.useEffect(()=>{if(!t)return;e.current&&setTimeout(()=>n(e.current));const o=s=>{s.key==="Tab"&&e.current&&xce(e.current,s)};return document.addEventListener("keydown",o),()=>document.removeEventListener("keydown",o)},[t]),r}const kce=$.useId||(()=>{});function Sce(){const t=kce();return t?`mantine-${t.replace(/:/g,"")}`:""}function Df(t){const e=Sce(),[n,r]=v.useState(e);return Ab(()=>{r(hce())},[]),typeof t=="string"?t:typeof window>"u"?e:n}function ty(t,e){if(typeof t=="function")return t(e);typeof t=="object"&&t!==null&&"current"in t&&(t.current=e)}function Nf(...t){const e=new Map;return n=>{if(t.forEach(r=>{const o=ty(r,n);o&&e.set(r,o)}),e.size>0)return()=>{t.forEach(r=>{const o=e.get(r);o?o():ty(r,null)}),e.clear()}}}function ti(...t){return v.useCallback(Nf(...t),t)}function pu({value:t,defaultValue:e,finalValue:n,onChange:r=()=>{}}){const[o,s]=v.useState(e!==void 0?e:n),i=(a,...l)=>{s(a),r==null||r(a,...l)};return t!==void 0?[t,r,!0]:[o,i,!1]}function Ece(t,e){return gce("(prefers-reduced-motion: reduce)",t,e)}function Tce(){const[t,e]=v.useState(!1),n=v.useRef(null),r=v.useCallback(()=>e(!0),[]),o=v.useCallback(()=>e(!1),[]);return v.useEffect(()=>{const s=n.current;if(s)return s.addEventListener("mouseenter",r),s.addEventListener("mouseleave",o),()=>{s==null||s.removeEventListener("mouseenter",r),s==null||s.removeEventListener("mouseleave",o)}},[n.current]),{ref:n,hovered:t}}function _ce(t){return t.currentTarget instanceof HTMLElement&&t.relatedTarget instanceof HTMLElement?t.currentTarget.contains(t.relatedTarget):!1}function vV({onBlur:t,onFocus:e}={}){const n=v.useRef(null),[r,o]=v.useState(!1),s=v.useRef(!1),i=c=>{o(c),s.current=c},a=c=>{s.current||(i(!0),e==null||e(c))},l=c=>{s.current&&!_ce(c)&&(i(!1),t==null||t(c))};return v.useEffect(()=>{const c=n.current;if(c)return c.addEventListener("focusin",a),c.addEventListener("focusout",l),()=>{c==null||c.removeEventListener("focusin",a),c==null||c.removeEventListener("focusout",l)}},[a,l]),{ref:n,focused:r}}function pS(t){var n;const e=$.version;return typeof $.version!="string"||e.startsWith("18.")?t==null?void 0:t.ref:(n=t==null?void 0:t.props)==null?void 0:n.ref}function wV(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(n=wV(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function ni(){for(var t,e,n=0,r="",o=arguments.length;n<o;n++)(t=arguments[n])&&(e=wV(t))&&(r&&(r+=" "),r+=e);return r}const Ace={};function Ice(t){const e={};return t.forEach(n=>{Object.entries(n).forEach(([r,o])=>{e[r]?e[r]=ni(e[r],o):e[r]=o})}),e}function Ib({theme:t,classNames:e,props:n,stylesCtx:r}){const s=(Array.isArray(e)?e:[e]).map(i=>typeof i=="function"?i(t,n,r):i||Ace);return Ice(s)}function ny({theme:t,styles:e,props:n,stylesCtx:r}){return(Array.isArray(e)?e:[e]).reduce((s,i)=>typeof i=="function"?{...s,...i(t,n,r)}:{...s,...i},{})}const CV=v.createContext(null);function wa(){const t=v.useContext(CV);if(!t)throw new Error("[@mantine/core] MantineProvider was not found in tree");return t}function Mce(){return wa().cssVariablesResolver}function Rce(){return wa().classNamesPrefix}function mS(){return wa().getStyleNonce}function Pce(){return wa().withStaticClasses}function Dce(){return wa().headless}function Nce(){var t;return(t=wa().stylesTransform)==null?void 0:t.sx}function Oce(){var t;return(t=wa().stylesTransform)==null?void 0:t.styles}function xV(){return wa().env||"default"}function Lce(t){return/^#?([0-9A-F]{3}){1,2}([0-9A-F]{2})?$/i.test(t)}function Vce(t){let e=t.replace("#","");if(e.length===3){const i=e.split("");e=[i[0],i[0],i[1],i[1],i[2],i[2]].join("")}if(e.length===8){const i=parseInt(e.slice(6,8),16)/255;return{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16),a:i}}const n=parseInt(e,16),r=n>>16&255,o=n>>8&255,s=n&255;return{r,g:o,b:s,a:1}}function jce(t){const[e,n,r,o]=t.replace(/[^0-9,./]/g,"").split(/[/,]/).map(Number);return{r:e,g:n,b:r,a:o||1}}function Bce(t){const e=/^hsla?\(\s*(\d+)\s*,\s*(\d+%)\s*,\s*(\d+%)\s*(,\s*(0?\.\d+|\d+(\.\d+)?))?\s*\)$/i,n=t.match(e);if(!n)return{r:0,g:0,b:0,a:1};const r=parseInt(n[1],10),o=parseInt(n[2],10)/100,s=parseInt(n[3],10)/100,i=n[5]?parseFloat(n[5]):void 0,a=(1-Math.abs(2*s-1))*o,l=r/60,c=a*(1-Math.abs(l%2-1)),u=s-a/2;let d,h,f;return l>=0&&l<1?(d=a,h=c,f=0):l>=1&&l<2?(d=c,h=a,f=0):l>=2&&l<3?(d=0,h=a,f=c):l>=3&&l<4?(d=0,h=c,f=a):l>=4&&l<5?(d=c,h=0,f=a):(d=a,h=0,f=c),{r:Math.round((d+u)*255),g:Math.round((h+u)*255),b:Math.round((f+u)*255),a:i||1}}function gS(t){return Lce(t)?Vce(t):t.startsWith("rgb")?jce(t):t.startsWith("hsl")?Bce(t):{r:0,g:0,b:0,a:1}}function qp(t,e){if(t.startsWith("var("))return`color-mix(in srgb, ${t}, black ${e*100}%)`;const{r:n,g:r,b:o,a:s}=gS(t),i=1-e,a=l=>Math.round(l*i);return`rgba(${a(n)}, ${a(r)}, ${a(o)}, ${s})`}function Nh(t,e){return typeof t.primaryShade=="number"?t.primaryShade:e==="dark"?t.primaryShade.dark:t.primaryShade.light}function Xv(t){return t<=.03928?t/12.92:((t+.055)/1.055)**2.4}function $ce(t){const e=t.match(/oklch\((.*?)%\s/);return e?parseFloat(e[1]):null}function Fce(t){if(t.startsWith("oklch("))return($ce(t)||0)/100;const{r:e,g:n,b:r}=gS(t),o=e/255,s=n/255,i=r/255,a=Xv(o),l=Xv(s),c=Xv(i);return .2126*a+.7152*l+.0722*c}function td(t,e=.179){return t.startsWith("var(")?!1:Fce(t)>e}function mu({color:t,theme:e,colorScheme:n}){if(typeof t!="string")throw new Error(`[@mantine/core] Failed to parse color. Expected color to be a string, instead got ${typeof t}`);if(t==="bright")return{color:t,value:n==="dark"?e.white:e.black,shade:void 0,isThemeColor:!1,isLight:td(n==="dark"?e.white:e.black,e.luminanceThreshold),variable:"--mantine-color-bright"};if(t==="dimmed")return{color:t,value:n==="dark"?e.colors.dark[2]:e.colors.gray[7],shade:void 0,isThemeColor:!1,isLight:td(n==="dark"?e.colors.dark[2]:e.colors.gray[6],e.luminanceThreshold),variable:"--mantine-color-dimmed"};if(t==="white"||t==="black")return{color:t,value:t==="white"?e.white:e.black,shade:void 0,isThemeColor:!1,isLight:td(t==="white"?e.white:e.black,e.luminanceThreshold),variable:`--mantine-color-${t}`};const[r,o]=t.split("."),s=o?Number(o):void 0,i=r in e.colors;if(i){const a=s!==void 0?e.colors[r][s]:e.colors[r][Nh(e,n||"light")];return{color:r,value:a,shade:s,isThemeColor:i,isLight:td(a,e.luminanceThreshold),variable:o?`--mantine-color-${r}-${s}`:`--mantine-color-${r}-filled`}}return{color:t,value:t,isThemeColor:i,isLight:td(t,e.luminanceThreshold),shade:s,variable:void 0}}function ts(t,e){const n=mu({color:t||e.primaryColor,theme:e});return n.variable?`var(${n.variable})`:t}function uC(t,e){const n={from:(t==null?void 0:t.from)||e.defaultGradient.from,to:(t==null?void 0:t.to)||e.defaultGradient.to,deg:(t==null?void 0:t.deg)??e.defaultGradient.deg??0},r=ts(n.from,e),o=ts(n.to,e);return`linear-gradient(${n.deg}deg, ${r} 0%, ${o} 100%)`}function Oo(t,e){if(typeof t!="string"||e>1||e<0)return"rgba(0, 0, 0, 1)";if(t.startsWith("var(")){const s=(1-e)*100;return`color-mix(in srgb, ${t}, transparent ${s}%)`}if(t.startsWith("oklch"))return t.includes("/")?t.replace(/\/\s*[\d.]+\s*\)/,`/ ${e})`):t.replace(")",` / ${e})`);const{r:n,g:r,b:o}=gS(t);return`rgba(${n}, ${r}, ${o}, ${e})`}const Yl=Oo,Hce=({color:t,theme:e,variant:n,gradient:r,autoContrast:o})=>{const s=mu({color:t,theme:e}),i=typeof o=="boolean"?o:e.autoContrast;if(n==="filled"){const a=i&&s.isLight?"var(--mantine-color-black)":"var(--mantine-color-white)";return s.isThemeColor?s.shade===void 0?{background:`var(--mantine-color-${t}-filled)`,hover:`var(--mantine-color-${t}-filled-hover)`,color:a,border:`${U(1)} solid transparent`}:{background:`var(--mantine-color-${s.color}-${s.shade})`,hover:`var(--mantine-color-${s.color}-${s.shade===9?8:s.shade+1})`,color:a,border:`${U(1)} solid transparent`}:{background:t,hover:qp(t,.1),color:a,border:`${U(1)} solid transparent`}}if(n==="light"){if(s.isThemeColor){if(s.shade===void 0)return{background:`var(--mantine-color-${t}-light)`,hover:`var(--mantine-color-${t}-light-hover)`,color:`var(--mantine-color-${t}-light-color)`,border:`${U(1)} solid transparent`};const a=e.colors[s.color][s.shade];return{background:Oo(a,.1),hover:Oo(a,.12),color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${U(1)} solid transparent`}}return{background:Oo(t,.1),hover:Oo(t,.12),color:t,border:`${U(1)} solid transparent`}}if(n==="outline")return s.isThemeColor?s.shade===void 0?{background:"transparent",hover:`var(--mantine-color-${t}-outline-hover)`,color:`var(--mantine-color-${t}-outline)`,border:`${U(1)} solid var(--mantine-color-${t}-outline)`}:{background:"transparent",hover:Oo(e.colors[s.color][s.shade],.05),color:`var(--mantine-color-${s.color}-${s.shade})`,border:`${U(1)} solid var(--mantine-color-${s.color}-${s.shade})`}:{background:"transparent",hover:Oo(t,.05),color:t,border:`${U(1)} solid ${t}`};if(n==="subtle"){if(s.isThemeColor){if(s.shade===void 0)return{background:"transparent",hover:`var(--mantine-color-${t}-light-hover)`,color:`var(--mantine-color-${t}-light-color)`,border:`${U(1)} solid transparent`};const a=e.colors[s.color][s.shade];return{background:"transparent",hover:Oo(a,.12),color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${U(1)} solid transparent`}}return{background:"transparent",hover:Oo(t,.12),color:t,border:`${U(1)} solid transparent`}}return n==="transparent"?s.isThemeColor?s.shade===void 0?{background:"transparent",hover:"transparent",color:`var(--mantine-color-${t}-light-color)`,border:`${U(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${U(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:t,border:`${U(1)} solid transparent`}:n==="white"?s.isThemeColor?s.shade===void 0?{background:"var(--mantine-color-white)",hover:qp(e.white,.01),color:`var(--mantine-color-${t}-filled)`,border:`${U(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:qp(e.white,.01),color:`var(--mantine-color-${s.color}-${s.shade})`,border:`${U(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:qp(e.white,.01),color:t,border:`${U(1)} solid transparent`}:n==="gradient"?{background:uC(r,e),hover:uC(r,e),color:"var(--mantine-color-white)",border:"none"}:n==="default"?{background:"var(--mantine-color-default)",hover:"var(--mantine-color-default-hover)",color:"var(--mantine-color-default-color)",border:`${U(1)} solid var(--mantine-color-default-border)`}:{}},zce={dark:["#C9C9C9","#b8b8b8","#828282","#696969","#424242","#3b3b3b","#2e2e2e","#242424","#1f1f1f","#141414"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]},lM="-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",yS={scale:1,fontSmoothing:!0,focusRing:"auto",white:"#fff",black:"#000",colors:zce,primaryShade:{light:6,dark:8},primaryColor:"blue",variantColorResolver:Hce,autoContrast:!1,luminanceThreshold:.3,fontFamily:lM,fontFamilyMonospace:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace",respectReducedMotion:!1,cursorType:"default",defaultGradient:{from:"blue",to:"cyan",deg:45},defaultRadius:"sm",activeClassName:"mantine-active",focusClassName:"",headings:{fontFamily:lM,fontWeight:"700",textWrap:"wrap",sizes:{h1:{fontSize:U(34),lineHeight:"1.3"},h2:{fontSize:U(26),lineHeight:"1.35"},h3:{fontSize:U(22),lineHeight:"1.4"},h4:{fontSize:U(18),lineHeight:"1.45"},h5:{fontSize:U(16),lineHeight:"1.5"},h6:{fontSize:U(14),lineHeight:"1.5"}}},fontSizes:{xs:U(12),sm:U(14),md:U(16),lg:U(18),xl:U(20)},lineHeights:{xs:"1.4",sm:"1.45",md:"1.55",lg:"1.6",xl:"1.65"},radius:{xs:U(2),sm:U(4),md:U(8),lg:U(16),xl:U(32)},spacing:{xs:U(10),sm:U(12),md:U(16),lg:U(20),xl:U(32)},breakpoints:{xs:"36em",sm:"48em",md:"62em",lg:"75em",xl:"88em"},shadows:{xs:`0 ${U(1)} ${U(3)} rgba(0, 0, 0, 0.05), 0 ${U(1)} ${U(2)} rgba(0, 0, 0, 0.1)`,sm:`0 ${U(1)} ${U(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${U(10)} ${U(15)} ${U(-5)}, rgba(0, 0, 0, 0.04) 0 ${U(7)} ${U(7)} ${U(-5)}`,md:`0 ${U(1)} ${U(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${U(20)} ${U(25)} ${U(-5)}, rgba(0, 0, 0, 0.04) 0 ${U(10)} ${U(10)} ${U(-5)}`,lg:`0 ${U(1)} ${U(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${U(28)} ${U(23)} ${U(-7)}, rgba(0, 0, 0, 0.04) 0 ${U(12)} ${U(12)} ${U(-7)}`,xl:`0 ${U(1)} ${U(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${U(36)} ${U(28)} ${U(-7)}, rgba(0, 0, 0, 0.04) 0 ${U(17)} ${U(17)} ${U(-7)}`},other:{},components:{}};function cM(t){return t==="auto"||t==="dark"||t==="light"}function Uce({key:t="mantine-color-scheme-value"}={}){let e;return{get:n=>{if(typeof window>"u")return n;try{const r=window.localStorage.getItem(t);return cM(r)?r:n}catch{return n}},set:n=>{try{window.localStorage.setItem(t,n)}catch(r){console.warn("[@mantine/core] Local storage color scheme manager was unable to save color scheme.",r)}},subscribe:n=>{e=r=>{r.storageArea===window.localStorage&&r.key===t&&cM(r.newValue)&&n(r.newValue)},window.addEventListener("storage",e)},unsubscribe:()=>{window.removeEventListener("storage",e)},clear:()=>{window.localStorage.removeItem(t)}}}const Wce="[@mantine/core] MantineProvider: Invalid theme.primaryColor, it accepts only key of theme.colors, learn more â€“ https://mantine.dev/theming/colors/#primary-color",uM="[@mantine/core] MantineProvider: Invalid theme.primaryShade, it accepts only 0-9 integers or an object { light: 0-9, dark: 0-9 }";function Jv(t){return t<0||t>9?!1:parseInt(t.toString(),10)===t}function dM(t){if(!(t.primaryColor in t.colors))throw new Error(Wce);if(typeof t.primaryShade=="object"&&(!Jv(t.primaryShade.dark)||!Jv(t.primaryShade.light)))throw new Error(uM);if(typeof t.primaryShade=="number"&&!Jv(t.primaryShade))throw new Error(uM)}function qce(t,e){var r;if(!e)return dM(t),t;const n=hS(t,e);return e.fontFamily&&!((r=e.headings)!=null&&r.fontFamily)&&(n.headings.fontFamily=e.fontFamily),dM(n),n}const bS=v.createContext(null),Gce=()=>v.useContext(bS)||yS;function Rr(){const t=v.useContext(bS);if(!t)throw new Error("@mantine/core: MantineProvider was not found in component tree, make sure you have it in your app");return t}function kV({theme:t,children:e,inherit:n=!0}){const r=Gce(),o=v.useMemo(()=>qce(n?r:yS,t),[t,r,n]);return m.jsx(bS.Provider,{value:o,children:e})}kV.displayName="@mantine/core/MantineThemeProvider";function Kce(){const t=Rr(),e=mS(),n=zo(t.breakpoints).reduce((r,o)=>{const s=t.breakpoints[o].includes("px"),i=nce(t.breakpoints[o]),a=s?`${i-.1}px`:sM(i-.1),l=s?`${i}px`:sM(i);return`${r}@media (max-width: ${a}) {.mantine-visible-from-${o} {display: none !important;}}@media (min-width: ${l}) {.mantine-hidden-from-${o} {display: none !important;}}`},"");return m.jsx("style",{"data-mantine-styles":"classes",nonce:e==null?void 0:e(),dangerouslySetInnerHTML:{__html:n}})}function Qv(t){return Object.entries(t).map(([e,n])=>`${e}: ${n};`).join("")}function nd(t,e){return(Array.isArray(t)?t:[t]).reduce((r,o)=>`${o}{${r}}`,e)}function Yce(t,e){const n=Qv(t.variables),r=n?nd(e,n):"",o=Qv(t.dark),s=Qv(t.light),i=o?nd(e===":host"?`${e}([data-mantine-color-scheme="dark"])`:`${e}[data-mantine-color-scheme="dark"]`,o):"",a=s?nd(e===":host"?`${e}([data-mantine-color-scheme="light"])`:`${e}[data-mantine-color-scheme="light"]`,s):"";return`${r}${i}${a}`}function SV({color:t,theme:e,autoContrast:n}){return(typeof n=="boolean"?n:e.autoContrast)&&mu({color:t||e.primaryColor,theme:e}).isLight?"var(--mantine-color-black)":"var(--mantine-color-white)"}function hM(t,e){return SV({color:t.colors[t.primaryColor][Nh(t,e)],theme:t,autoContrast:null})}function Gp({theme:t,color:e,colorScheme:n,name:r=e,withColorValues:o=!0}){if(!t.colors[e])return{};if(n==="light"){const a=Nh(t,"light"),l={[`--mantine-color-${r}-text`]:`var(--mantine-color-${r}-filled)`,[`--mantine-color-${r}-filled`]:`var(--mantine-color-${r}-${a})`,[`--mantine-color-${r}-filled-hover`]:`var(--mantine-color-${r}-${a===9?8:a+1})`,[`--mantine-color-${r}-light`]:Yl(t.colors[e][a],.1),[`--mantine-color-${r}-light-hover`]:Yl(t.colors[e][a],.12),[`--mantine-color-${r}-light-color`]:`var(--mantine-color-${r}-${a})`,[`--mantine-color-${r}-outline`]:`var(--mantine-color-${r}-${a})`,[`--mantine-color-${r}-outline-hover`]:Yl(t.colors[e][a],.05)};return o?{[`--mantine-color-${r}-0`]:t.colors[e][0],[`--mantine-color-${r}-1`]:t.colors[e][1],[`--mantine-color-${r}-2`]:t.colors[e][2],[`--mantine-color-${r}-3`]:t.colors[e][3],[`--mantine-color-${r}-4`]:t.colors[e][4],[`--mantine-color-${r}-5`]:t.colors[e][5],[`--mantine-color-${r}-6`]:t.colors[e][6],[`--mantine-color-${r}-7`]:t.colors[e][7],[`--mantine-color-${r}-8`]:t.colors[e][8],[`--mantine-color-${r}-9`]:t.colors[e][9],...l}:l}const s=Nh(t,"dark"),i={[`--mantine-color-${r}-text`]:`var(--mantine-color-${r}-4)`,[`--mantine-color-${r}-filled`]:`var(--mantine-color-${r}-${s})`,[`--mantine-color-${r}-filled-hover`]:`var(--mantine-color-${r}-${s===9?8:s+1})`,[`--mantine-color-${r}-light`]:Yl(t.colors[e][Math.max(0,s-2)],.15),[`--mantine-color-${r}-light-hover`]:Yl(t.colors[e][Math.max(0,s-2)],.2),[`--mantine-color-${r}-light-color`]:`var(--mantine-color-${r}-${Math.max(s-5,0)})`,[`--mantine-color-${r}-outline`]:`var(--mantine-color-${r}-${Math.max(s-4,0)})`,[`--mantine-color-${r}-outline-hover`]:Yl(t.colors[e][Math.max(s-4,0)],.05)};return o?{[`--mantine-color-${r}-0`]:t.colors[e][0],[`--mantine-color-${r}-1`]:t.colors[e][1],[`--mantine-color-${r}-2`]:t.colors[e][2],[`--mantine-color-${r}-3`]:t.colors[e][3],[`--mantine-color-${r}-4`]:t.colors[e][4],[`--mantine-color-${r}-5`]:t.colors[e][5],[`--mantine-color-${r}-6`]:t.colors[e][6],[`--mantine-color-${r}-7`]:t.colors[e][7],[`--mantine-color-${r}-8`]:t.colors[e][8],[`--mantine-color-${r}-9`]:t.colors[e][9],...i}:i}function Xce(t){return!!t&&typeof t=="object"&&"mantine-virtual-color"in t}function Xl(t,e,n){zo(e).forEach(r=>Object.assign(t,{[`--mantine-${n}-${r}`]:e[r]}))}const EV=t=>{const e=Nh(t,"light"),n=t.defaultRadius in t.radius?t.radius[t.defaultRadius]:U(t.defaultRadius),r={variables:{"--mantine-scale":t.scale.toString(),"--mantine-cursor-type":t.cursorType,"--mantine-color-scheme":"light dark","--mantine-webkit-font-smoothing":t.fontSmoothing?"antialiased":"unset","--mantine-moz-font-smoothing":t.fontSmoothing?"grayscale":"unset","--mantine-color-white":t.white,"--mantine-color-black":t.black,"--mantine-line-height":t.lineHeights.md,"--mantine-font-family":t.fontFamily,"--mantine-font-family-monospace":t.fontFamilyMonospace,"--mantine-font-family-headings":t.headings.fontFamily,"--mantine-heading-font-weight":t.headings.fontWeight,"--mantine-heading-text-wrap":t.headings.textWrap,"--mantine-radius-default":n,"--mantine-primary-color-filled":`var(--mantine-color-${t.primaryColor}-filled)`,"--mantine-primary-color-filled-hover":`var(--mantine-color-${t.primaryColor}-filled-hover)`,"--mantine-primary-color-light":`var(--mantine-color-${t.primaryColor}-light)`,"--mantine-primary-color-light-hover":`var(--mantine-color-${t.primaryColor}-light-hover)`,"--mantine-primary-color-light-color":`var(--mantine-color-${t.primaryColor}-light-color)`},light:{"--mantine-primary-color-contrast":hM(t,"light"),"--mantine-color-bright":"var(--mantine-color-black)","--mantine-color-text":t.black,"--mantine-color-body":t.white,"--mantine-color-error":"var(--mantine-color-red-6)","--mantine-color-placeholder":"var(--mantine-color-gray-5)","--mantine-color-anchor":`var(--mantine-color-${t.primaryColor}-${e})`,"--mantine-color-default":"var(--mantine-color-white)","--mantine-color-default-hover":"var(--mantine-color-gray-0)","--mantine-color-default-color":"var(--mantine-color-black)","--mantine-color-default-border":"var(--mantine-color-gray-4)","--mantine-color-dimmed":"var(--mantine-color-gray-6)"},dark:{"--mantine-primary-color-contrast":hM(t,"dark"),"--mantine-color-bright":"var(--mantine-color-white)","--mantine-color-text":"var(--mantine-color-dark-0)","--mantine-color-body":"var(--mantine-color-dark-7)","--mantine-color-error":"var(--mantine-color-red-8)","--mantine-color-placeholder":"var(--mantine-color-dark-3)","--mantine-color-anchor":`var(--mantine-color-${t.primaryColor}-4)`,"--mantine-color-default":"var(--mantine-color-dark-6)","--mantine-color-default-hover":"var(--mantine-color-dark-5)","--mantine-color-default-color":"var(--mantine-color-white)","--mantine-color-default-border":"var(--mantine-color-dark-4)","--mantine-color-dimmed":"var(--mantine-color-dark-2)"}};Xl(r.variables,t.breakpoints,"breakpoint"),Xl(r.variables,t.spacing,"spacing"),Xl(r.variables,t.fontSizes,"font-size"),Xl(r.variables,t.lineHeights,"line-height"),Xl(r.variables,t.shadows,"shadow"),Xl(r.variables,t.radius,"radius"),t.colors[t.primaryColor].forEach((s,i)=>{r.variables[`--mantine-primary-color-${i}`]=`var(--mantine-color-${t.primaryColor}-${i})`}),zo(t.colors).forEach(s=>{const i=t.colors[s];if(Xce(i)){Object.assign(r.light,Gp({theme:t,name:i.name,color:i.light,colorScheme:"light",withColorValues:!0})),Object.assign(r.dark,Gp({theme:t,name:i.name,color:i.dark,colorScheme:"dark",withColorValues:!0}));return}i.forEach((a,l)=>{r.variables[`--mantine-color-${s}-${l}`]=a}),Object.assign(r.light,Gp({theme:t,color:s,colorScheme:"light",withColorValues:!1})),Object.assign(r.dark,Gp({theme:t,color:s,colorScheme:"dark",withColorValues:!1}))});const o=t.headings.sizes;return zo(o).forEach(s=>{r.variables[`--mantine-${s}-font-size`]=o[s].fontSize,r.variables[`--mantine-${s}-line-height`]=o[s].lineHeight,r.variables[`--mantine-${s}-font-weight`]=o[s].fontWeight||t.headings.fontWeight}),r};function Jce({theme:t,generator:e}){const n=EV(t),r=e==null?void 0:e(t);return r?hS(n,r):n}const Zv=EV(yS);function Qce(t){const e={variables:{},light:{},dark:{}};return zo(t.variables).forEach(n=>{Zv.variables[n]!==t.variables[n]&&(e.variables[n]=t.variables[n])}),zo(t.light).forEach(n=>{Zv.light[n]!==t.light[n]&&(e.light[n]=t.light[n])}),zo(t.dark).forEach(n=>{Zv.dark[n]!==t.dark[n]&&(e.dark[n]=t.dark[n])}),e}function Zce(t){return`
  ${t}[data-mantine-color-scheme="dark"] { --mantine-color-scheme: dark; }
  ${t}[data-mantine-color-scheme="light"] { --mantine-color-scheme: light; }
`}function TV({cssVariablesSelector:t,deduplicateCssVariables:e}){const n=Rr(),r=mS(),o=Mce(),s=Jce({theme:n,generator:o}),i=t===":root"&&e,a=i?Qce(s):s,l=Yce(a,t);return l?m.jsx("style",{"data-mantine-styles":!0,nonce:r==null?void 0:r(),dangerouslySetInnerHTML:{__html:`${l}${i?"":Zce(t)}`}}):null}TV.displayName="@mantine/CssVariables";function eue(){const t=console.error;console.error=(...e)=>{e.length>1&&typeof e[0]=="string"&&e[0].toLowerCase().includes("extra attributes from the server")&&typeof e[1]=="string"&&e[1].toLowerCase().includes("data-mantine-color-scheme")||t(...e)}}function Jl(t,e){var o,s;const n=typeof window<"u"&&"matchMedia"in window&&((o=window.matchMedia("(prefers-color-scheme: dark)"))==null?void 0:o.matches),r=t!=="auto"?t:n?"dark":"light";(s=e())==null||s.setAttribute("data-mantine-color-scheme",r)}function tue({manager:t,defaultColorScheme:e,getRootElement:n,forceColorScheme:r}){const o=v.useRef(null),[s,i]=v.useState(()=>t.get(e)),a=r||s,l=v.useCallback(u=>{r||(Jl(u,n),i(u),t.set(u))},[t.set,a,r]),c=v.useCallback(()=>{i(e),Jl(e,n),t.clear()},[t.clear,e]);return v.useEffect(()=>(t.subscribe(l),t.unsubscribe),[t.subscribe,t.unsubscribe]),Ab(()=>{Jl(t.get(e),n)},[]),v.useEffect(()=>{var d;if(r)return Jl(r,n),()=>{};r===void 0&&Jl(s,n),typeof window<"u"&&"matchMedia"in window&&(o.current=window.matchMedia("(prefers-color-scheme: dark)"));const u=h=>{s==="auto"&&Jl(h.matches?"dark":"light",n)};return(d=o.current)==null||d.addEventListener("change",u),()=>{var h;return(h=o.current)==null?void 0:h.removeEventListener("change",u)}},[s,r]),{colorScheme:a,setColorScheme:l,clearColorScheme:c}}function nue({respectReducedMotion:t,getRootElement:e}){Ab(()=>{var n;t&&((n=e())==null||n.setAttribute("data-respect-reduced-motion","true"))},[t])}eue();function _V({theme:t,children:e,getStyleNonce:n,withStaticClasses:r=!0,withGlobalClasses:o=!0,deduplicateCssVariables:s=!0,withCssVariables:i=!0,cssVariablesSelector:a=":root",classNamesPrefix:l="mantine",colorSchemeManager:c=Uce(),defaultColorScheme:u="light",getRootElement:d=()=>document.documentElement,cssVariablesResolver:h,forceColorScheme:f,stylesTransform:p,env:y}){const{colorScheme:b,setColorScheme:w,clearColorScheme:k}=tue({defaultColorScheme:u,forceColorScheme:f,manager:c,getRootElement:d});return nue({respectReducedMotion:(t==null?void 0:t.respectReducedMotion)||!1,getRootElement:d}),m.jsx(CV.Provider,{value:{colorScheme:b,setColorScheme:w,clearColorScheme:k,getRootElement:d,classNamesPrefix:l,getStyleNonce:n,cssVariablesResolver:h,cssVariablesSelector:a,withStaticClasses:r,stylesTransform:p,env:y},children:m.jsxs(kV,{theme:t,children:[i&&m.jsx(TV,{cssVariablesSelector:a,deduplicateCssVariables:s}),o&&m.jsx(Kce,{}),e]})})}_V.displayName="@mantine/core/MantineProvider";function Mb({classNames:t,styles:e,props:n,stylesCtx:r}){const o=Rr();return{resolvedClassNames:Ib({theme:o,classNames:t,props:n,stylesCtx:r||void 0}),resolvedStyles:ny({theme:o,styles:e,props:n,stylesCtx:r||void 0})}}const rue={always:"mantine-focus-always",auto:"mantine-focus-auto",never:"mantine-focus-never"};function oue({theme:t,options:e,unstyled:n}){return ni((e==null?void 0:e.focusable)&&!n&&(t.focusClassName||rue[t.focusRing]),(e==null?void 0:e.active)&&!n&&t.activeClassName)}function sue({selector:t,stylesCtx:e,options:n,props:r,theme:o}){return Ib({theme:o,classNames:n==null?void 0:n.classNames,props:(n==null?void 0:n.props)||r,stylesCtx:e})[t]}function fM({selector:t,stylesCtx:e,theme:n,classNames:r,props:o}){return Ib({theme:n,classNames:r,props:o,stylesCtx:e})[t]}function iue({rootSelector:t,selector:e,className:n}){return t===e?n:void 0}function aue({selector:t,classes:e,unstyled:n}){return n?void 0:e[t]}function lue({themeName:t,classNamesPrefix:e,selector:n,withStaticClass:r}){return r===!1?[]:t.map(o=>`${e}-${o}-${n}`)}function cue({themeName:t,theme:e,selector:n,props:r,stylesCtx:o}){return t.map(s=>{var i,a;return(a=Ib({theme:e,classNames:(i=e.components[s])==null?void 0:i.classNames,props:r,stylesCtx:o}))==null?void 0:a[n]})}function uue({options:t,classes:e,selector:n,unstyled:r}){return t!=null&&t.variant&&!r?e[`${n}--${t.variant}`]:void 0}function due({theme:t,options:e,themeName:n,selector:r,classNamesPrefix:o,classNames:s,classes:i,unstyled:a,className:l,rootSelector:c,props:u,stylesCtx:d,withStaticClasses:h,headless:f,transformedStyles:p}){return ni(oue({theme:t,options:e,unstyled:a||f}),cue({theme:t,themeName:n,selector:r,props:u,stylesCtx:d}),uue({options:e,classes:i,selector:r,unstyled:a}),fM({selector:r,stylesCtx:d,theme:t,classNames:s,props:u}),fM({selector:r,stylesCtx:d,theme:t,classNames:p,props:u}),sue({selector:r,stylesCtx:d,options:e,props:u,theme:t}),iue({rootSelector:c,selector:r,className:l}),aue({selector:r,classes:i,unstyled:a||f}),h&&!f&&lue({themeName:n,classNamesPrefix:o,selector:r,withStaticClass:e==null?void 0:e.withStaticClass}),e==null?void 0:e.className)}function hue({theme:t,themeName:e,props:n,stylesCtx:r,selector:o}){return e.map(s=>{var i;return ny({theme:t,styles:(i=t.components[s])==null?void 0:i.styles,props:n,stylesCtx:r})[o]}).reduce((s,i)=>({...s,...i}),{})}function dC({style:t,theme:e}){return Array.isArray(t)?[...t].reduce((n,r)=>({...n,...dC({style:r,theme:e})}),{}):typeof t=="function"?t(e):t??{}}function fue(t){return t.reduce((e,n)=>(n&&Object.keys(n).forEach(r=>{e[r]={...e[r],...Tb(n[r])}}),e),{})}function pue({vars:t,varsResolver:e,theme:n,props:r,stylesCtx:o,selector:s,themeName:i,headless:a}){var l;return(l=fue([a?{}:e==null?void 0:e(n,r,o),...i.map(c=>{var u,d,h;return(h=(d=(u=n.components)==null?void 0:u[c])==null?void 0:d.vars)==null?void 0:h.call(d,n,r,o)}),t==null?void 0:t(n,r,o)]))==null?void 0:l[s]}function mue({theme:t,themeName:e,selector:n,options:r,props:o,stylesCtx:s,rootSelector:i,styles:a,style:l,vars:c,varsResolver:u,headless:d,withStylesTransform:h}){return{...!h&&hue({theme:t,themeName:e,props:o,stylesCtx:s,selector:n}),...!h&&ny({theme:t,styles:a,props:o,stylesCtx:s})[n],...!h&&ny({theme:t,styles:r==null?void 0:r.styles,props:(r==null?void 0:r.props)||o,stylesCtx:s})[n],...pue({theme:t,props:o,stylesCtx:s,vars:c,varsResolver:u,selector:n,themeName:e,headless:d}),...i===n?dC({style:l,theme:t}):null,...dC({style:r==null?void 0:r.style,theme:t})}}function gue({props:t,stylesCtx:e,themeName:n}){var i;const r=Rr(),o=(i=Oce())==null?void 0:i();return{getTransformedStyles:a=>o?[...a.map(c=>o(c,{props:t,theme:r,ctx:e})),...n.map(c=>{var u;return o((u=r.components[c])==null?void 0:u.styles,{props:t,theme:r,ctx:e})})].filter(Boolean):[],withStylesTransform:!!o}}function Be({name:t,classes:e,props:n,stylesCtx:r,className:o,style:s,rootSelector:i="root",unstyled:a,classNames:l,styles:c,vars:u,varsResolver:d}){const h=Rr(),f=Rce(),p=Pce(),y=Dce(),b=(Array.isArray(t)?t:[t]).filter(x=>x),{withStylesTransform:w,getTransformedStyles:k}=gue({props:n,stylesCtx:r,themeName:b});return(x,A)=>({className:due({theme:h,options:A,themeName:b,selector:x,classNamesPrefix:f,classNames:l,classes:e,unstyled:a,className:o,rootSelector:i,props:n,stylesCtx:r,withStaticClasses:p,headless:y,transformedStyles:k([A==null?void 0:A.styles,c])}),style:mue({theme:h,themeName:b,selector:x,options:A,props:n,stylesCtx:r,rootSelector:i,styles:c,style:s,vars:u,varsResolver:d,headless:y,withStylesTransform:w})})}function yue(t,e){return typeof t=="boolean"?t:e.autoContrast}function ie(t,e,n){var i;const r=Rr(),o=(i=r.components[t])==null?void 0:i.defaultProps,s=typeof o=="function"?o(r):o;return{...e,...s,...Tb(n)}}function e1(t){return zo(t).reduce((e,n)=>t[n]!==void 0?`${e}${ece(n)}:${t[n]};`:e,"").trim()}function bue({selector:t,styles:e,media:n,container:r}){const o=e?e1(e):"",s=Array.isArray(n)?n.map(a=>`@media${a.query}{${t}{${e1(a.styles)}}}`):[],i=Array.isArray(r)?r.map(a=>`@container ${a.query}{${t}{${e1(a.styles)}}}`):[];return`${o?`${t}{${o}}`:""}${s.join("")}${i.join("")}`.trim()}function AV(t){const e=mS();return m.jsx("style",{"data-mantine-styles":"inline",nonce:e==null?void 0:e(),dangerouslySetInnerHTML:{__html:bue(t)}})}function Rb(t){const{m:e,mx:n,my:r,mt:o,mb:s,ml:i,mr:a,me:l,ms:c,p:u,px:d,py:h,pt:f,pb:p,pl:y,pr:b,pe:w,ps:k,bd:x,bg:A,c:I,opacity:M,ff:T,fz:S,fw:_,lts:R,ta:D,lh:O,fs:N,tt:K,td:Q,w:ce,miw:z,maw:W,h:X,mih:le,mah:te,bgsz:oe,bgp:ue,bgr:lt,bga:Ze,pos:De,top:Ge,left:gt,bottom:nt,right:ge,inset:Wt,display:Ot,flex:Xt,hiddenFrom:Lt,visibleFrom:Sn,lightHidden:gr,darkHidden:ri,sx:oi,...eo}=t;return{styleProps:Tb({m:e,mx:n,my:r,mt:o,mb:s,ml:i,mr:a,me:l,ms:c,p:u,px:d,py:h,pt:f,pb:p,pl:y,pr:b,pe:w,ps:k,bd:x,bg:A,c:I,opacity:M,ff:T,fz:S,fw:_,lts:R,ta:D,lh:O,fs:N,tt:K,td:Q,w:ce,miw:z,maw:W,h:X,mih:le,mah:te,bgsz:oe,bgp:ue,bgr:lt,bga:Ze,pos:De,top:Ge,left:gt,bottom:nt,right:ge,inset:Wt,display:Ot,flex:Xt,hiddenFrom:Lt,visibleFrom:Sn,lightHidden:gr,darkHidden:ri,sx:oi}),rest:eo}}const vue={m:{type:"spacing",property:"margin"},mt:{type:"spacing",property:"marginTop"},mb:{type:"spacing",property:"marginBottom"},ml:{type:"spacing",property:"marginLeft"},mr:{type:"spacing",property:"marginRight"},ms:{type:"spacing",property:"marginInlineStart"},me:{type:"spacing",property:"marginInlineEnd"},mx:{type:"spacing",property:"marginInline"},my:{type:"spacing",property:"marginBlock"},p:{type:"spacing",property:"padding"},pt:{type:"spacing",property:"paddingTop"},pb:{type:"spacing",property:"paddingBottom"},pl:{type:"spacing",property:"paddingLeft"},pr:{type:"spacing",property:"paddingRight"},ps:{type:"spacing",property:"paddingInlineStart"},pe:{type:"spacing",property:"paddingInlineEnd"},px:{type:"spacing",property:"paddingInline"},py:{type:"spacing",property:"paddingBlock"},bd:{type:"border",property:"border"},bg:{type:"color",property:"background"},c:{type:"textColor",property:"color"},opacity:{type:"identity",property:"opacity"},ff:{type:"fontFamily",property:"fontFamily"},fz:{type:"fontSize",property:"fontSize"},fw:{type:"identity",property:"fontWeight"},lts:{type:"size",property:"letterSpacing"},ta:{type:"identity",property:"textAlign"},lh:{type:"lineHeight",property:"lineHeight"},fs:{type:"identity",property:"fontStyle"},tt:{type:"identity",property:"textTransform"},td:{type:"identity",property:"textDecoration"},w:{type:"spacing",property:"width"},miw:{type:"spacing",property:"minWidth"},maw:{type:"spacing",property:"maxWidth"},h:{type:"spacing",property:"height"},mih:{type:"spacing",property:"minHeight"},mah:{type:"spacing",property:"maxHeight"},bgsz:{type:"size",property:"backgroundSize"},bgp:{type:"identity",property:"backgroundPosition"},bgr:{type:"identity",property:"backgroundRepeat"},bga:{type:"identity",property:"backgroundAttachment"},pos:{type:"identity",property:"position"},top:{type:"size",property:"top"},left:{type:"size",property:"left"},bottom:{type:"size",property:"bottom"},right:{type:"size",property:"right"},inset:{type:"size",property:"inset"},display:{type:"identity",property:"display"},flex:{type:"identity",property:"flex"}};function vS(t,e){const n=mu({color:t,theme:e});return n.color==="dimmed"?"var(--mantine-color-dimmed)":n.color==="bright"?"var(--mantine-color-bright)":n.variable?`var(${n.variable})`:n.color}function wue(t,e){const n=mu({color:t,theme:e});return n.isThemeColor&&n.shade===void 0?`var(--mantine-color-${n.color}-text)`:vS(t,e)}function Cue(t,e){if(typeof t=="number")return U(t);if(typeof t=="string"){const[n,r,...o]=t.split(" ").filter(i=>i.trim()!=="");let s=`${U(n)}`;return r&&(s+=` ${r}`),o.length>0&&(s+=` ${vS(o.join(" "),e)}`),s.trim()}return t}const pM={text:"var(--mantine-font-family)",mono:"var(--mantine-font-family-monospace)",monospace:"var(--mantine-font-family-monospace)",heading:"var(--mantine-font-family-headings)",headings:"var(--mantine-font-family-headings)"};function xue(t){return typeof t=="string"&&t in pM?pM[t]:t}const kue=["h1","h2","h3","h4","h5","h6"];function Sue(t,e){return typeof t=="string"&&t in e.fontSizes?`var(--mantine-font-size-${t})`:typeof t=="string"&&kue.includes(t)?`var(--mantine-${t}-font-size)`:typeof t=="number"||typeof t=="string"?U(t):t}function Eue(t){return t}const Tue=["h1","h2","h3","h4","h5","h6"];function _ue(t,e){return typeof t=="string"&&t in e.lineHeights?`var(--mantine-line-height-${t})`:typeof t=="string"&&Tue.includes(t)?`var(--mantine-${t}-line-height)`:t}function Aue(t){return typeof t=="number"?U(t):t}function Iue(t,e){if(typeof t=="number")return U(t);if(typeof t=="string"){const n=t.replace("-","");if(!(n in e.spacing))return U(t);const r=`--mantine-spacing-${n}`;return t.startsWith("-")?`calc(var(${r}) * -1)`:`var(${r})`}return t}const t1={color:vS,textColor:wue,fontSize:Sue,spacing:Iue,identity:Eue,size:Aue,lineHeight:_ue,fontFamily:xue,border:Cue};function mM(t){return t.replace("(min-width: ","").replace("em)","")}function Mue({media:t,...e}){const r=Object.keys(t).sort((o,s)=>Number(mM(o))-Number(mM(s))).map(o=>({query:o,styles:t[o]}));return{...e,media:r}}function Rue(t){if(typeof t!="object"||t===null)return!1;const e=Object.keys(t);return!(e.length===1&&e[0]==="base")}function Pue(t){return typeof t=="object"&&t!==null?"base"in t?t.base:void 0:t}function Due(t){return typeof t=="object"&&t!==null?zo(t).filter(e=>e!=="base"):[]}function Nue(t,e){return typeof t=="object"&&t!==null&&e in t?t[e]:t}function IV({styleProps:t,data:e,theme:n}){return Mue(zo(t).reduce((r,o)=>{if(o==="hiddenFrom"||o==="visibleFrom"||o==="sx")return r;const s=e[o],i=Array.isArray(s.property)?s.property:[s.property],a=Pue(t[o]);if(!Rue(t[o]))return i.forEach(c=>{r.inlineStyles[c]=t1[s.type](a,n)}),r;r.hasResponsiveStyles=!0;const l=Due(t[o]);return i.forEach(c=>{a&&(r.styles[c]=t1[s.type](a,n)),l.forEach(u=>{const d=`(min-width: ${n.breakpoints[u]})`;r.media[d]={...r.media[d],[c]:t1[s.type](Nue(t[o],u),n)}})}),r},{hasResponsiveStyles:!1,styles:{},inlineStyles:{},media:{}}))}function MV(){return`__m__-${v.useId().replace(/:/g,"")}`}function RV(t,e){return Array.isArray(t)?[...t].reduce((n,r)=>({...n,...RV(r,e)}),{}):typeof t=="function"?t(e):t??{}}function PV(t){return t.startsWith("data-")?t:`data-${t}`}function Oue(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return r===void 0||r===""||r===!1||r===null||(e[PV(n)]=t[n]),e},{})}function DV(t){return t?typeof t=="string"?{[PV(t)]:!0}:Array.isArray(t)?[...t].reduce((e,n)=>({...e,...DV(n)}),{}):Oue(t):null}function hC(t,e){return Array.isArray(t)?[...t].reduce((n,r)=>({...n,...hC(r,e)}),{}):typeof t=="function"?t(e):t??{}}function Lue({theme:t,style:e,vars:n,styleProps:r}){const o=hC(e,t),s=hC(n,t);return{...o,...s,...r}}const NV=v.forwardRef(({component:t,style:e,__vars:n,className:r,variant:o,mod:s,size:i,hiddenFrom:a,visibleFrom:l,lightHidden:c,darkHidden:u,renderRoot:d,__size:h,...f},p)=>{var S;const y=Rr(),b=t||"div",{styleProps:w,rest:k}=Rb(f),x=Nce(),A=(S=x==null?void 0:x())==null?void 0:S(w.sx),I=MV(),M=IV({styleProps:w,theme:y,data:vue}),T={ref:p,style:Lue({theme:y,style:e,vars:n,styleProps:M.inlineStyles}),className:ni(r,A,{[I]:M.hasResponsiveStyles,"mantine-light-hidden":c,"mantine-dark-hidden":u,[`mantine-hidden-from-${a}`]:a,[`mantine-visible-from-${l}`]:l}),"data-variant":o,"data-size":hV(i)?void 0:i||void 0,size:h,...DV(s),...k};return m.jsxs(m.Fragment,{children:[M.hasResponsiveStyles&&m.jsx(AV,{selector:`.${I}`,styles:M.styles,media:M.media}),typeof d=="function"?d(T):m.jsx(b,{...T})]})});NV.displayName="@mantine/core/Box";const Ce=NV;function OV(t){return t}function Vue(t){const e=t;return n=>{const r=v.forwardRef((o,s)=>m.jsx(e,{...n,...o,ref:s}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r}}function He(t){const e=v.forwardRef(t);return e.extend=OV,e.withProps=n=>{const r=v.forwardRef((o,s)=>m.jsx(e,{...n,...o,ref:s}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r},e}function er(t){const e=v.forwardRef(t);return e.withProps=n=>{const r=v.forwardRef((o,s)=>m.jsx(e,{...n,...o,ref:s}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r},e.extend=OV,e}const jue=v.createContext({dir:"ltr",toggleDirection:()=>{},setDirection:()=>{}});function Of(){return v.useContext(jue)}var LV={root:"m_87cf2631"};const Bue={__staticSelector:"UnstyledButton"},Ll=er((t,e)=>{const n=ie("UnstyledButton",Bue,t),{className:r,component:o="button",__staticSelector:s,unstyled:i,classNames:a,styles:l,style:c,...u}=n,d=Be({name:s,props:n,classes:LV,className:r,style:c,classNames:a,styles:l,unstyled:i});return m.jsx(Ce,{...d("root",{focusable:!0}),component:o,ref:e,type:o==="button"?"button":void 0,...u})});Ll.classes=LV;Ll.displayName="@mantine/core/UnstyledButton";var VV={root:"m_515a97f8"};const $ue={},wS=He((t,e)=>{const n=ie("VisuallyHidden",$ue,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,...c}=n,u=Be({name:"VisuallyHidden",classes:VV,props:n,className:o,style:s,classNames:r,styles:i,unstyled:a});return m.jsx(Ce,{component:"span",ref:e,...u("root"),...c})});wS.classes=VV;wS.displayName="@mantine/core/VisuallyHidden";var jV={root:"m_1b7284a3"};const Fue={},Hue=(t,{radius:e,shadow:n})=>({root:{"--paper-radius":e===void 0?void 0:Fn(e),"--paper-shadow":pV(n)}}),CS=er((t,e)=>{const n=ie("Paper",Fue,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,withBorder:l,vars:c,radius:u,shadow:d,variant:h,mod:f,...p}=n,y=Be({name:"Paper",props:n,classes:jV,className:o,style:s,classNames:r,styles:i,unstyled:a,vars:c,varsResolver:Hue});return m.jsx(Ce,{ref:e,mod:[{"data-with-border":l},f],...y("root"),variant:h,...p})});CS.classes=jV;CS.displayName="@mantine/core/Paper";function BV(t,e){if(t==="rtl"&&(e.includes("right")||e.includes("left"))){const[n,r]=e.split("-"),o=n==="right"?"left":"right";return r===void 0?o:`${o}-${r}`}return e}function gM(t,e,n,r){return t==="center"||r==="center"?{top:e}:t==="end"?{bottom:n}:t==="start"?{top:n}:{}}function yM(t,e,n,r,o){return t==="center"||r==="center"?{left:e}:t==="end"?{[o==="ltr"?"right":"left"]:n}:t==="start"?{[o==="ltr"?"left":"right"]:n}:{}}const zue={bottom:"borderTopLeftRadius",left:"borderTopRightRadius",right:"borderBottomLeftRadius",top:"borderBottomRightRadius"};function Uue({position:t,arrowSize:e,arrowOffset:n,arrowRadius:r,arrowPosition:o,arrowX:s,arrowY:i,dir:a}){const[l,c="center"]=t.split("-"),u={width:e,height:e,transform:"rotate(45deg)",position:"absolute",[zue[l]]:r},d=-e/2;return l==="left"?{...u,...gM(c,i,n,o),right:d,borderLeftColor:"transparent",borderBottomColor:"transparent",clipPath:"polygon(100% 0, 0 0, 100% 100%)"}:l==="right"?{...u,...gM(c,i,n,o),left:d,borderRightColor:"transparent",borderTopColor:"transparent",clipPath:"polygon(0 100%, 0 0, 100% 100%)"}:l==="top"?{...u,...yM(c,s,n,o,a),bottom:d,borderTopColor:"transparent",borderLeftColor:"transparent",clipPath:"polygon(0 100%, 100% 100%, 100% 0)"}:l==="bottom"?{...u,...yM(c,s,n,o,a),top:d,borderBottomColor:"transparent",borderRightColor:"transparent",clipPath:"polygon(0 100%, 0 0, 100% 0)"}:{}}const xS=v.forwardRef(({position:t,arrowSize:e,arrowOffset:n,arrowRadius:r,arrowPosition:o,visible:s,arrowX:i,arrowY:a,style:l,...c},u)=>{const{dir:d}=Of();return s?m.jsx("div",{...c,ref:u,style:{...l,...Uue({position:t,arrowSize:e,arrowOffset:n,arrowRadius:r,arrowPosition:o,dir:d,arrowX:i,arrowY:a})}}):null});xS.displayName="@mantine/core/FloatingArrow";var $V={root:"m_9814e45f"};const Wue={zIndex:Rf("modal")},que=(t,{gradient:e,color:n,backgroundOpacity:r,blur:o,radius:s,zIndex:i})=>({root:{"--overlay-bg":e||(n!==void 0||r!==void 0)&&Oo(n||"#000",r??.6)||void 0,"--overlay-filter":o?`blur(${U(o)})`:void 0,"--overlay-radius":s===void 0?void 0:Fn(s),"--overlay-z-index":i==null?void 0:i.toString()}}),Oh=er((t,e)=>{const n=ie("Overlay",Wue,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,fixed:c,center:u,children:d,radius:h,zIndex:f,gradient:p,blur:y,color:b,backgroundOpacity:w,mod:k,...x}=n,A=Be({name:"Overlay",props:n,classes:$V,className:o,style:s,classNames:r,styles:i,unstyled:a,vars:l,varsResolver:que});return m.jsx(Ce,{ref:e,...A("root"),mod:[{center:u,fixed:c},k],...x,children:d})});Oh.classes=$V;Oh.displayName="@mantine/core/Overlay";function n1(t){const e=document.createElement("div");return e.setAttribute("data-portal","true"),typeof t.className=="string"&&e.classList.add(...t.className.split(" ").filter(Boolean)),typeof t.style=="object"&&Object.assign(e.style,t.style),typeof t.id=="string"&&e.setAttribute("id",t.id),e}function Gue({target:t,reuseTargetNode:e,...n}){if(t)return typeof t=="string"?document.querySelector(t)||n1(n):t;if(e){const r=document.querySelector("[data-mantine-shared-portal-node]");if(r)return r;const o=n1(n);return o.setAttribute("data-mantine-shared-portal-node","true"),document.body.appendChild(o),o}return n1(n)}const Kue={},FV=He((t,e)=>{const{children:n,target:r,reuseTargetNode:o,...s}=ie("Portal",Kue,t),[i,a]=v.useState(!1),l=v.useRef(null);return Ab(()=>(a(!0),l.current=Gue({target:r,reuseTargetNode:o,...s}),ty(e,l.current),!r&&!o&&l.current&&document.body.appendChild(l.current),()=>{!r&&!o&&l.current&&document.body.removeChild(l.current)}),[r]),!i||!l.current?null:gn.createPortal(m.jsx(m.Fragment,{children:n}),l.current)});FV.displayName="@mantine/core/Portal";const Lf=He(({withinPortal:t=!0,children:e,...n},r)=>xV()==="test"||!t?m.jsx(m.Fragment,{children:e}):m.jsx(FV,{ref:r,...n,children:e}));Lf.displayName="@mantine/core/OptionalPortal";const rd=t=>({in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:`scale(.9) translateY(${t==="bottom"?10:-10}px)`},transitionProperty:"transform, opacity"}),Kp={fade:{in:{opacity:1},out:{opacity:0},transitionProperty:"opacity"},"fade-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(30px)"},transitionProperty:"opacity, transform"},"fade-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-30px)"},transitionProperty:"opacity, transform"},"fade-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(30px)"},transitionProperty:"opacity, transform"},"fade-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-30px)"},transitionProperty:"opacity, transform"},scale:{in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-y":{in:{opacity:1,transform:"scaleY(1)"},out:{opacity:0,transform:"scaleY(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-x":{in:{opacity:1,transform:"scaleX(1)"},out:{opacity:0,transform:"scaleX(0)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"skew-up":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(-20px) skew(-10deg, -5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"skew-down":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(20px) skew(-10deg, -5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-left":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(-5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-right":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-100%)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(100%)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"slide-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(100%)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"slide-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-100%)"},common:{transformOrigin:"right"},transitionProperty:"transform, opacity"},pop:{...rd("bottom"),common:{transformOrigin:"center center"}},"pop-bottom-left":{...rd("bottom"),common:{transformOrigin:"bottom left"}},"pop-bottom-right":{...rd("bottom"),common:{transformOrigin:"bottom right"}},"pop-top-left":{...rd("top"),common:{transformOrigin:"top left"}},"pop-top-right":{...rd("top"),common:{transformOrigin:"top right"}}},bM={entering:"in",entered:"in",exiting:"out",exited:"out","pre-exiting":"out","pre-entering":"out"};function Yue({transition:t,state:e,duration:n,timingFunction:r}){const o={WebkitBackfaceVisibility:"hidden",willChange:"transform, opacity",transitionDuration:`${n}ms`,transitionTimingFunction:r};return typeof t=="string"?t in Kp?{transitionProperty:Kp[t].transitionProperty,...o,...Kp[t].common,...Kp[t][bM[e]]}:{}:{transitionProperty:t.transitionProperty,...o,...t.common,...t[bM[e]]}}function Xue({duration:t,exitDuration:e,timingFunction:n,mounted:r,onEnter:o,onExit:s,onEntered:i,onExited:a,enterDelay:l,exitDelay:c}){const u=Rr(),d=Ece(),h=u.respectReducedMotion?d:!1,[f,p]=v.useState(h?0:t),[y,b]=v.useState(r?"entered":"exited"),w=v.useRef(-1),k=v.useRef(-1),x=v.useRef(-1),A=M=>{const T=M?o:s,S=M?i:a;window.clearTimeout(w.current);const _=h?0:M?t:e;p(_),_===0?(typeof T=="function"&&T(),typeof S=="function"&&S(),b(M?"entered":"exited")):x.current=requestAnimationFrame(()=>{ZD.flushSync(()=>{b(M?"pre-entering":"pre-exiting")}),x.current=requestAnimationFrame(()=>{typeof T=="function"&&T(),b(M?"entering":"exiting"),w.current=window.setTimeout(()=>{typeof S=="function"&&S(),b(M?"entered":"exited")},_)})})},I=M=>{if(window.clearTimeout(k.current),typeof(M?l:c)!="number"){A(M);return}k.current=window.setTimeout(()=>{A(M)},M?l:c)};return oa(()=>{I(r)},[r]),v.useEffect(()=>()=>{window.clearTimeout(w.current),cancelAnimationFrame(x.current)},[]),{transitionDuration:f,transitionStatus:y,transitionTimingFunction:n||"ease"}}function Vl({keepMounted:t,transition:e="fade",duration:n=250,exitDuration:r=n,mounted:o,children:s,timingFunction:i="ease",onExit:a,onEntered:l,onEnter:c,onExited:u,enterDelay:d,exitDelay:h}){const f=xV(),{transitionDuration:p,transitionStatus:y,transitionTimingFunction:b}=Xue({mounted:o,exitDuration:r,duration:n,timingFunction:i,onExit:a,onEntered:l,onEnter:c,onExited:u,enterDelay:d,exitDelay:h});return p===0||f==="test"?o?m.jsx(m.Fragment,{children:s({})}):t?s({display:"none"}):null:y==="exited"?t?s({display:"none"}):null:m.jsx(m.Fragment,{children:s(Yue({transition:e,duration:p,state:y,timingFunction:b}))})}Vl.displayName="@mantine/core/Transition";const[Jue,HV]=_b("Popover component was not found in the tree");function kS({children:t,active:e=!0,refProp:n="ref",innerRef:r}){const o=bV(e),s=ti(o,r);return Mf(t)?v.cloneElement(t,{[n]:s}):t}function zV(t){return m.jsx(wS,{tabIndex:-1,"data-autofocus":!0,...t})}kS.displayName="@mantine/core/FocusTrap";zV.displayName="@mantine/core/FocusTrapInitialFocus";kS.InitialFocus=zV;var UV={dropdown:"m_38a85659",arrow:"m_a31dc6c1",overlay:"m_3d7bc908"};const Que={},Pb=He((t,e)=>{var b,w,k,x;const n=ie("PopoverDropdown",Que,t),{className:r,style:o,vars:s,children:i,onKeyDownCapture:a,variant:l,classNames:c,styles:u,...d}=n,h=HV(),f=yce({opened:h.opened,shouldReturnFocus:h.returnFocus}),p=h.withRoles?{"aria-labelledby":h.getTargetId(),id:h.getDropdownId(),role:"dialog",tabIndex:-1}:{},y=ti(e,h.floating);return h.disabled?null:m.jsx(Lf,{...h.portalProps,withinPortal:h.withinPortal,children:m.jsx(Vl,{mounted:h.opened,...h.transitionProps,transition:((b=h.transitionProps)==null?void 0:b.transition)||"fade",duration:((w=h.transitionProps)==null?void 0:w.duration)??150,keepMounted:h.keepMounted,exitDuration:typeof((k=h.transitionProps)==null?void 0:k.exitDuration)=="number"?h.transitionProps.exitDuration:(x=h.transitionProps)==null?void 0:x.duration,children:A=>m.jsx(kS,{active:h.trapFocus&&h.opened,innerRef:y,children:m.jsxs(Ce,{...p,...d,variant:l,onKeyDownCapture:lce(()=>{var I,M;(I=h.onClose)==null||I.call(h),(M=h.onDismiss)==null||M.call(h)},{active:h.closeOnEscape,onTrigger:f,onKeyDown:a}),"data-position":h.placement,"data-fixed":h.floatingStrategy==="fixed"||void 0,...h.getStyles("dropdown",{className:r,props:n,classNames:c,styles:u,style:[{...A,zIndex:h.zIndex,top:h.y??0,left:h.x??0,width:h.width==="target"?void 0:U(h.width)},h.resolvedStyles.dropdown,u==null?void 0:u.dropdown,o]}),children:[i,m.jsx(xS,{ref:h.arrowRef,arrowX:h.arrowX,arrowY:h.arrowY,visible:h.withArrow,position:h.placement,arrowSize:h.arrowSize,arrowRadius:h.arrowRadius,arrowOffset:h.arrowOffset,arrowPosition:h.arrowPosition,...h.getStyles("arrow",{props:n,classNames:c,styles:u})})]})})})})});Pb.classes=UV;Pb.displayName="@mantine/core/PopoverDropdown";const Zue={refProp:"ref",popupType:"dialog"},SS=He((t,e)=>{const{children:n,refProp:r,popupType:o,...s}=ie("PopoverTarget",Zue,t);if(!Mf(n))throw new Error("Popover.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const i=s,a=HV(),l=ti(a.reference,pS(n),e),c=a.withRoles?{"aria-haspopup":o,"aria-expanded":a.opened,"aria-controls":a.getDropdownId(),id:a.getTargetId()}:{};return v.cloneElement(n,{...i,...c,...a.targetProps,className:ni(a.targetProps.className,i.className,n.props.className),[r]:l,...a.controlled?null:{onClick:a.onToggle}})});SS.displayName="@mantine/core/PopoverTarget";function WV({opened:t,floating:e,position:n,positionDependencies:r}){const[o,s]=v.useState(0);v.useEffect(()=>{if(e.refs.reference.current&&e.refs.floating.current&&t)return R$(e.refs.reference.current,e.refs.floating.current,e.update)},[e.refs.reference.current,e.refs.floating.current,t,o,n]),oa(()=>{e.update()},r),oa(()=>{s(i=>i+1)},[t])}function ede(t){if(t===void 0)return{shift:!0,flip:!0};const e={...t};return t.shift===void 0&&(e.shift=!0),t.flip===void 0&&(e.flip=!0),e}function tde(t,e){const n=ede(t.middlewares),r=[is(t.offset)];return n.shift&&r.push(Pl(typeof n.shift=="boolean"?{limiter:k_(),padding:5}:{limiter:k_(),padding:5,...n.shift})),n.flip&&r.push(typeof n.flip=="boolean"?bo():bo(n.flip)),n.inline&&r.push(typeof n.inline=="boolean"?Ed():Ed(n.inline)),r.push(eN({element:t.arrowRef,padding:t.arrowOffset})),(n.size||t.width==="target")&&r.push(Ly({...typeof n.size=="boolean"?{}:n.size,apply({rects:o,availableWidth:s,availableHeight:i,...a}){var u;const c=((u=e().refs.floating.current)==null?void 0:u.style)??{};n.size&&(typeof n.size=="object"&&n.size.apply?n.size.apply({rects:o,availableWidth:s,availableHeight:i,...a}):Object.assign(c,{maxWidth:`${s}px`,maxHeight:`${i}px`})),t.width==="target"&&Object.assign(c,{width:`${o.reference.width}px`})}})),r}function nde(t){const[e,n]=pu({value:t.opened,defaultValue:t.defaultOpened,finalValue:!1,onChange:t.onChange}),r=v.useRef(e),o=()=>{e&&n(!1)},s=()=>n(!e),i=fu({strategy:t.strategy,placement:t.position,middleware:tde(t,()=>i)});return WV({opened:e,position:t.position,positionDependencies:t.positionDependencies||[],floating:i}),oa(()=>{var a;(a=t.onPositionChange)==null||a.call(t,i.placement)},[i.placement]),oa(()=>{var a,l;e!==r.current&&(e?(l=t.onOpen)==null||l.call(t):(a=t.onClose)==null||a.call(t)),r.current=e},[e,t.onClose,t.onOpen]),{floating:i,controlled:typeof t.opened=="boolean",opened:e,onClose:o,onToggle:s}}const rde={position:"bottom",offset:8,positionDependencies:[],transitionProps:{transition:"fade",duration:150},middlewares:{flip:!0,shift:!0,inline:!1},arrowSize:7,arrowOffset:5,arrowRadius:0,arrowPosition:"side",closeOnClickOutside:!0,withinPortal:!0,closeOnEscape:!0,trapFocus:!1,withRoles:!0,returnFocus:!1,withOverlay:!1,clickOutsideEvents:["mousedown","touchstart"],zIndex:Rf("popover"),__staticSelector:"Popover",width:"max-content"},ode=(t,{radius:e,shadow:n})=>({dropdown:{"--popover-radius":e===void 0?void 0:Fn(e),"--popover-shadow":pV(n)}});function Ca(t){var Ta,It,ht,nr,to,li;const e=ie("Popover",rde,t),{children:n,position:r,offset:o,onPositionChange:s,positionDependencies:i,opened:a,transitionProps:l,onExitTransitionEnd:c,onEnterTransitionEnd:u,width:d,middlewares:h,withArrow:f,arrowSize:p,arrowOffset:y,arrowRadius:b,arrowPosition:w,unstyled:k,classNames:x,styles:A,closeOnClickOutside:I,withinPortal:M,portalProps:T,closeOnEscape:S,clickOutsideEvents:_,trapFocus:R,onClose:D,onDismiss:O,onOpen:N,onChange:K,zIndex:Q,radius:ce,shadow:z,id:W,defaultOpened:X,__staticSelector:le,withRoles:te,disabled:oe,returnFocus:ue,variant:lt,keepMounted:Ze,vars:De,floatingStrategy:Ge,withOverlay:gt,overlayProps:nt,...ge}=e,Wt=Be({name:le,props:e,classes:UV,classNames:x,styles:A,unstyled:k,rootSelector:"dropdown",vars:De,varsResolver:ode}),{resolvedStyles:Ot}=Mb({classNames:x,styles:A,props:e}),Xt=v.useRef(null),[Lt,Sn]=v.useState(null),[gr,ri]=v.useState(null),{dir:oi}=Of(),eo=Df(W),Xe=nde({middlewares:h,width:d,position:BV(oi,r),offset:typeof o=="number"?o+(f?p/2:0):o,arrowRef:Xt,arrowOffset:y,onPositionChange:s,positionDependencies:i,opened:a,defaultOpened:X,onChange:K,onOpen:N,onClose:D,onDismiss:O,strategy:Ge});fce(()=>{I&&(Xe.onClose(),O==null||O())},_,[Lt,gr]);const ps=v.useCallback(yt=>{Sn(yt),Xe.floating.refs.setReference(yt)},[Xe.floating.refs.setReference]),si=v.useCallback(yt=>{ri(yt),Xe.floating.refs.setFloating(yt)},[Xe.floating.refs.setFloating]),ii=v.useCallback(()=>{var yt;(yt=l==null?void 0:l.onExited)==null||yt.call(l),c==null||c()},[l==null?void 0:l.onExited,c]),ai=v.useCallback(()=>{var yt;(yt=l==null?void 0:l.onEntered)==null||yt.call(l),u==null||u()},[l==null?void 0:l.onEntered,u]);return m.jsxs(Jue,{value:{returnFocus:ue,disabled:oe,controlled:Xe.controlled,reference:ps,floating:si,x:Xe.floating.x,y:Xe.floating.y,arrowX:(ht=(It=(Ta=Xe.floating)==null?void 0:Ta.middlewareData)==null?void 0:It.arrow)==null?void 0:ht.x,arrowY:(li=(to=(nr=Xe.floating)==null?void 0:nr.middlewareData)==null?void 0:to.arrow)==null?void 0:li.y,opened:Xe.opened,arrowRef:Xt,transitionProps:{...l,onExited:ii,onEntered:ai},width:d,withArrow:f,arrowSize:p,arrowOffset:y,arrowRadius:b,arrowPosition:w,placement:Xe.floating.placement,trapFocus:R,withinPortal:M,portalProps:T,zIndex:Q,radius:ce,shadow:z,closeOnEscape:S,onDismiss:O,onClose:Xe.onClose,onToggle:Xe.onToggle,getTargetId:()=>`${eo}-target`,getDropdownId:()=>`${eo}-dropdown`,withRoles:te,targetProps:ge,__staticSelector:le,classNames:x,styles:A,unstyled:k,variant:lt,keepMounted:Ze,getStyles:Wt,resolvedStyles:Ot,floatingStrategy:Ge},children:[n,gt&&m.jsx(Vl,{transition:"fade",mounted:Xe.opened,duration:(l==null?void 0:l.duration)||250,exitDuration:(l==null?void 0:l.exitDuration)||250,children:yt=>m.jsx(Lf,{withinPortal:M,children:m.jsx(Oh,{...nt,...Wt("overlay",{className:nt==null?void 0:nt.className,style:[yt,nt==null?void 0:nt.style]})})})})]})}Ca.Target=SS;Ca.Dropdown=Pb;Ca.displayName="@mantine/core/Popover";Ca.extend=t=>t;var mo={root:"m_5ae2e3c",barsLoader:"m_7a2bd4cd",bar:"m_870bb79","bars-loader-animation":"m_5d2b3b9d",dotsLoader:"m_4e3f22d7",dot:"m_870c4af","loader-dots-animation":"m_aac34a1",ovalLoader:"m_b34414df","oval-loader-animation":"m_f8e89c4b"};const qV=v.forwardRef(({className:t,...e},n)=>m.jsxs(Ce,{component:"span",className:ni(mo.barsLoader,t),...e,ref:n,children:[m.jsx("span",{className:mo.bar}),m.jsx("span",{className:mo.bar}),m.jsx("span",{className:mo.bar})]}));qV.displayName="@mantine/core/Bars";const GV=v.forwardRef(({className:t,...e},n)=>m.jsxs(Ce,{component:"span",className:ni(mo.dotsLoader,t),...e,ref:n,children:[m.jsx("span",{className:mo.dot}),m.jsx("span",{className:mo.dot}),m.jsx("span",{className:mo.dot})]}));GV.displayName="@mantine/core/Dots";const KV=v.forwardRef(({className:t,...e},n)=>m.jsx(Ce,{component:"span",className:ni(mo.ovalLoader,t),...e,ref:n}));KV.displayName="@mantine/core/Oval";const YV={bars:qV,oval:KV,dots:GV},sde={loaders:YV,type:"oval"},ide=(t,{size:e,color:n})=>({root:{"--loader-size":ut(e,"loader-size"),"--loader-color":n?ts(n,t):void 0}}),xa=He((t,e)=>{const n=ie("Loader",sde,t),{size:r,color:o,type:s,vars:i,className:a,style:l,classNames:c,styles:u,unstyled:d,loaders:h,variant:f,children:p,...y}=n,b=Be({name:"Loader",props:n,classes:mo,className:a,style:l,classNames:c,styles:u,unstyled:d,vars:i,varsResolver:ide});return p?m.jsx(Ce,{...b("root"),ref:e,...y,children:p}):m.jsx(Ce,{...b("root"),ref:e,component:h[s],variant:f,size:r,...y})});xa.defaultLoaders=YV;xa.classes=mo;xa.displayName="@mantine/core/Loader";var gu={root:"m_8d3f4000",icon:"m_8d3afb97",loader:"m_302b9fb1",group:"m_1a0f1b21",groupSection:"m_437b6484"};const vM={orientation:"horizontal"},ade=(t,{borderWidth:e})=>({group:{"--ai-border-width":U(e)}}),ES=He((t,e)=>{const n=ie("ActionIconGroup",vM,t),{className:r,style:o,classNames:s,styles:i,unstyled:a,orientation:l,vars:c,borderWidth:u,variant:d,mod:h,...f}=ie("ActionIconGroup",vM,t),p=Be({name:"ActionIconGroup",props:n,classes:gu,className:r,style:o,classNames:s,styles:i,unstyled:a,vars:c,varsResolver:ade,rootSelector:"group"});return m.jsx(Ce,{...p("group"),ref:e,variant:d,mod:[{"data-orientation":l},h],role:"group",...f})});ES.classes=gu;ES.displayName="@mantine/core/ActionIconGroup";const wM={},lde=(t,{radius:e,color:n,gradient:r,variant:o,autoContrast:s,size:i})=>{const a=t.variantColorResolver({color:n||t.primaryColor,theme:t,gradient:r,variant:o||"filled",autoContrast:s});return{groupSection:{"--section-height":ut(i,"section-height"),"--section-padding-x":ut(i,"section-padding-x"),"--section-fz":pr(i),"--section-radius":e===void 0?void 0:Fn(e),"--section-bg":n||o?a.background:void 0,"--section-color":a.color,"--section-bd":n||o?a.border:void 0}}},TS=He((t,e)=>{const n=ie("ActionIconGroupSection",wM,t),{className:r,style:o,classNames:s,styles:i,unstyled:a,vars:l,variant:c,gradient:u,radius:d,autoContrast:h,...f}=ie("ActionIconGroupSection",wM,t),p=Be({name:"ActionIconGroupSection",props:n,classes:gu,className:r,style:o,classNames:s,styles:i,unstyled:a,vars:l,varsResolver:lde,rootSelector:"groupSection"});return m.jsx(Ce,{...p("groupSection"),ref:e,variant:c,...f})});TS.classes=gu;TS.displayName="@mantine/core/ActionIconGroupSection";const cde={},ude=(t,{size:e,radius:n,variant:r,gradient:o,color:s,autoContrast:i})=>{const a=t.variantColorResolver({color:s||t.primaryColor,theme:t,gradient:o,variant:r||"filled",autoContrast:i});return{root:{"--ai-size":ut(e,"ai-size"),"--ai-radius":n===void 0?void 0:Fn(n),"--ai-bg":s||r?a.background:void 0,"--ai-hover":s||r?a.hover:void 0,"--ai-hover-color":s||r?a.hoverColor:void 0,"--ai-color":a.color,"--ai-bd":s||r?a.border:void 0}}},jl=er((t,e)=>{const n=ie("ActionIcon",cde,t),{className:r,unstyled:o,variant:s,classNames:i,styles:a,style:l,loading:c,loaderProps:u,size:d,color:h,radius:f,__staticSelector:p,gradient:y,vars:b,children:w,disabled:k,"data-disabled":x,autoContrast:A,mod:I,...M}=n,T=Be({name:["ActionIcon",p],props:n,className:r,style:l,classes:gu,classNames:i,styles:a,unstyled:o,vars:b,varsResolver:ude});return m.jsxs(Ll,{...T("root",{active:!k&&!c&&!x}),...M,unstyled:o,variant:s,size:d,disabled:k||c,ref:e,mod:[{loading:c,disabled:k||x},I],children:[m.jsx(Vl,{mounted:!!c,transition:"slide-down",duration:150,children:S=>m.jsx(Ce,{component:"span",...T("loader",{style:S}),"aria-hidden":!0,children:m.jsx(xa,{color:"var(--ai-color)",size:"calc(var(--ai-size) * 0.55)",...u})})}),m.jsx(Ce,{component:"span",mod:{loading:c},...T("icon"),children:w})]})});jl.classes=gu;jl.displayName="@mantine/core/ActionIcon";jl.Group=ES;jl.GroupSection=TS;const XV=v.forwardRef(({size:t="var(--cb-icon-size, 70%)",style:e,...n},r)=>m.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...e,width:t,height:t},ref:r,...n,children:m.jsx("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}));XV.displayName="@mantine/core/CloseIcon";var JV={root:"m_86a44da5","root--subtle":"m_220c80f2"};const dde={variant:"subtle"},hde=(t,{size:e,radius:n,iconSize:r})=>({root:{"--cb-size":ut(e,"cb-size"),"--cb-radius":n===void 0?void 0:Fn(n),"--cb-icon-size":U(r)}}),Db=er((t,e)=>{const n=ie("CloseButton",dde,t),{iconSize:r,children:o,vars:s,radius:i,className:a,classNames:l,style:c,styles:u,unstyled:d,"data-disabled":h,disabled:f,variant:p,icon:y,mod:b,__staticSelector:w,...k}=n,x=Be({name:w||"CloseButton",props:n,className:a,style:c,classes:JV,classNames:l,styles:u,unstyled:d,vars:s,varsResolver:hde});return m.jsxs(Ll,{ref:e,...k,unstyled:d,variant:p,disabled:f,mod:[{disabled:f||h},b],...x("root",{variant:p,active:!f&&!h}),children:[y||m.jsx(XV,{}),o]})});Db.classes=JV;Db.displayName="@mantine/core/CloseButton";function fde(t){return v.Children.toArray(t).filter(Boolean)}var QV={root:"m_4081bf90"};const pde={preventGrowOverflow:!0,gap:"md",align:"center",justify:"flex-start",wrap:"wrap"},mde=(t,{grow:e,preventGrowOverflow:n,gap:r,align:o,justify:s,wrap:i},{childWidth:a})=>({root:{"--group-child-width":e&&n?a:void 0,"--group-gap":Pf(r),"--group-align":o,"--group-justify":s,"--group-wrap":i}}),bn=He((t,e)=>{const n=ie("Group",pde,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,children:l,gap:c,align:u,justify:d,wrap:h,grow:f,preventGrowOverflow:p,vars:y,variant:b,__size:w,mod:k,...x}=n,A=fde(l),I=A.length,M=Pf(c??"md"),S={childWidth:`calc(${100/I}% - (${M} - ${M} / ${I}))`},_=Be({name:"Group",props:n,stylesCtx:S,className:o,style:s,classes:QV,classNames:r,styles:i,unstyled:a,vars:y,varsResolver:mde});return m.jsx(Ce,{..._("root"),ref:e,variant:b,mod:[{grow:f},k],size:w,...x,children:A})});bn.classes=QV;bn.displayName="@mantine/core/Group";const[gde,yde]=fS({size:"sm"}),bde={},ZV=He((t,e)=>{const n=ie("InputClearButton",bde,t),{size:r,variant:o,vars:s,classNames:i,styles:a,...l}=n,c=yde(),{resolvedClassNames:u,resolvedStyles:d}=Mb({classNames:i,styles:a,props:n});return m.jsx(Db,{variant:o||"transparent",ref:e,size:r||(c==null?void 0:c.size)||"sm",classNames:u,styles:d,__staticSelector:"InputClearButton",...l})});ZV.displayName="@mantine/core/InputClearButton";const[vde,Nb]=fS({offsetBottom:!1,offsetTop:!1,describedBy:void 0,getStyles:null,inputId:void 0,labelId:void 0});var Zr={wrapper:"m_6c018570",input:"m_8fb7ebe7",section:"m_82577fc2",placeholder:"m_88bacfd0",root:"m_46b77525",label:"m_8fdc1311",required:"m_78a94662",error:"m_8f816625",description:"m_fe47ce59"};const CM={},wde=(t,{size:e})=>({description:{"--input-description-size":e===void 0?void 0:`calc(${pr(e)} - ${U(2)})`}}),Ob=He((t,e)=>{const n=ie("InputDescription",CM,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,size:c,__staticSelector:u,__inheritStyles:d=!0,variant:h,...f}=ie("InputDescription",CM,n),p=Nb(),y=Be({name:["InputWrapper",u],props:n,classes:Zr,className:o,style:s,classNames:r,styles:i,unstyled:a,rootSelector:"description",vars:l,varsResolver:wde}),b=d&&(p==null?void 0:p.getStyles)||y;return m.jsx(Ce,{component:"p",ref:e,variant:h,size:c,...b("description",p!=null&&p.getStyles?{className:o,style:s}:void 0),...f})});Ob.classes=Zr;Ob.displayName="@mantine/core/InputDescription";const Cde={},xde=(t,{size:e})=>({error:{"--input-error-size":e===void 0?void 0:`calc(${pr(e)} - ${U(2)})`}}),Lb=He((t,e)=>{const n=ie("InputError",Cde,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,size:c,__staticSelector:u,__inheritStyles:d=!0,variant:h,...f}=n,p=Be({name:["InputWrapper",u],props:n,classes:Zr,className:o,style:s,classNames:r,styles:i,unstyled:a,rootSelector:"error",vars:l,varsResolver:xde}),y=Nb(),b=d&&(y==null?void 0:y.getStyles)||p;return m.jsx(Ce,{component:"p",ref:e,variant:h,size:c,...b("error",y!=null&&y.getStyles?{className:o,style:s}:void 0),...f})});Lb.classes=Zr;Lb.displayName="@mantine/core/InputError";const xM={labelElement:"label"},kde=(t,{size:e})=>({label:{"--input-label-size":pr(e),"--input-asterisk-color":void 0}}),Vb=He((t,e)=>{const n=ie("InputLabel",xM,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,labelElement:c,size:u,required:d,htmlFor:h,onMouseDown:f,children:p,__staticSelector:y,variant:b,mod:w,...k}=ie("InputLabel",xM,n),x=Be({name:["InputWrapper",y],props:n,classes:Zr,className:o,style:s,classNames:r,styles:i,unstyled:a,rootSelector:"label",vars:l,varsResolver:kde}),A=Nb(),I=(A==null?void 0:A.getStyles)||x;return m.jsxs(Ce,{...I("label",A!=null&&A.getStyles?{className:o,style:s}:void 0),component:c,variant:b,size:u,ref:e,htmlFor:c==="label"?h:void 0,mod:[{required:d},w],onMouseDown:M=>{f==null||f(M),!M.defaultPrevented&&M.detail>1&&M.preventDefault()},...k,children:[p,d&&m.jsx("span",{...I("required"),"aria-hidden":!0,children:" *"})]})});Vb.classes=Zr;Vb.displayName="@mantine/core/InputLabel";const kM={},_S=He((t,e)=>{const n=ie("InputPlaceholder",kM,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,__staticSelector:c,variant:u,error:d,mod:h,...f}=ie("InputPlaceholder",kM,n),p=Be({name:["InputPlaceholder",c],props:n,classes:Zr,className:o,style:s,classNames:r,styles:i,unstyled:a,rootSelector:"placeholder"});return m.jsx(Ce,{...p("placeholder"),mod:[{error:!!d},h],component:"span",variant:u,ref:e,...f})});_S.classes=Zr;_S.displayName="@mantine/core/InputPlaceholder";function Sde(t,{hasDescription:e,hasError:n}){const r=t.findIndex(l=>l==="input"),o=t.slice(0,r),s=t.slice(r+1),i=e&&o.includes("description")||n&&o.includes("error");return{offsetBottom:e&&s.includes("description")||n&&s.includes("error"),offsetTop:i}}const Ede={labelElement:"label",inputContainer:t=>t,inputWrapperOrder:["label","description","input","error"]},Tde=(t,{size:e})=>({label:{"--input-label-size":pr(e),"--input-asterisk-color":void 0},error:{"--input-error-size":e===void 0?void 0:`calc(${pr(e)} - ${U(2)})`},description:{"--input-description-size":e===void 0?void 0:`calc(${pr(e)} - ${U(2)})`}}),AS=He((t,e)=>{const n=ie("InputWrapper",Ede,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,size:c,variant:u,__staticSelector:d,inputContainer:h,inputWrapperOrder:f,label:p,error:y,description:b,labelProps:w,descriptionProps:k,errorProps:x,labelElement:A,children:I,withAsterisk:M,id:T,required:S,__stylesApiProps:_,mod:R,...D}=n,O=Be({name:["InputWrapper",d],props:_||n,classes:Zr,className:o,style:s,classNames:r,styles:i,unstyled:a,vars:l,varsResolver:Tde}),N={size:c,variant:u,__staticSelector:d},K=Df(T),Q=typeof M=="boolean"?M:S,ce=(x==null?void 0:x.id)||`${K}-error`,z=(k==null?void 0:k.id)||`${K}-description`,W=K,X=!!y&&typeof y!="boolean",le=!!b,te=`${X?ce:""} ${le?z:""}`,oe=te.trim().length>0?te.trim():void 0,ue=(w==null?void 0:w.id)||`${K}-label`,lt=p&&m.jsx(Vb,{labelElement:A,id:ue,htmlFor:W,required:Q,...N,...w,children:p},"label"),Ze=le&&m.jsx(Ob,{...k,...N,size:(k==null?void 0:k.size)||N.size,id:(k==null?void 0:k.id)||z,children:b},"description"),De=m.jsx(v.Fragment,{children:h(I)},"input"),Ge=X&&v.createElement(Lb,{...x,...N,size:(x==null?void 0:x.size)||N.size,key:"error",id:(x==null?void 0:x.id)||ce},y),gt=f.map(nt=>{switch(nt){case"label":return lt;case"input":return De;case"description":return Ze;case"error":return Ge;default:return null}});return m.jsx(vde,{value:{getStyles:O,describedBy:oe,inputId:W,labelId:ue,...Sde(f,{hasDescription:le,hasError:X})},children:m.jsx(Ce,{ref:e,variant:u,size:c,mod:[{error:!!y},R],...O("root"),...D,children:gt})})});AS.classes=Zr;AS.displayName="@mantine/core/InputWrapper";const _de={variant:"default",leftSectionPointerEvents:"none",rightSectionPointerEvents:"none",withAria:!0,withErrorStyles:!0},Ade=(t,e,n)=>({wrapper:{"--input-margin-top":n.offsetTop?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-margin-bottom":n.offsetBottom?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-height":ut(e.size,"input-height"),"--input-fz":pr(e.size),"--input-radius":e.radius===void 0?void 0:Fn(e.radius),"--input-left-section-width":e.leftSectionWidth!==void 0?U(e.leftSectionWidth):void 0,"--input-right-section-width":e.rightSectionWidth!==void 0?U(e.rightSectionWidth):void 0,"--input-padding-y":e.multiline?ut(e.size,"input-padding-y"):void 0,"--input-left-section-pointer-events":e.leftSectionPointerEvents,"--input-right-section-pointer-events":e.rightSectionPointerEvents}}),Mr=er((t,e)=>{const n=ie("Input",_de,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,required:l,__staticSelector:c,__stylesApiProps:u,size:d,wrapperProps:h,error:f,disabled:p,leftSection:y,leftSectionProps:b,leftSectionWidth:w,rightSection:k,rightSectionProps:x,rightSectionWidth:A,rightSectionPointerEvents:I,leftSectionPointerEvents:M,variant:T,vars:S,pointer:_,multiline:R,radius:D,id:O,withAria:N,withErrorStyles:K,mod:Q,inputSize:ce,__clearSection:z,__clearable:W,__defaultRightSection:X,...le}=n,{styleProps:te,rest:oe}=Rb(le),ue=Nb(),lt={offsetBottom:ue==null?void 0:ue.offsetBottom,offsetTop:ue==null?void 0:ue.offsetTop},Ze=Be({name:["Input",c],props:u||n,classes:Zr,className:o,style:s,classNames:r,styles:i,unstyled:a,stylesCtx:lt,rootSelector:"wrapper",vars:S,varsResolver:Ade}),De=N?{required:l,disabled:p,"aria-invalid":!!f,"aria-describedby":ue==null?void 0:ue.describedBy,id:(ue==null?void 0:ue.inputId)||O}:{},Ge=k||W&&z||X;return m.jsx(gde,{value:{size:d||"sm"},children:m.jsxs(Ce,{...Ze("wrapper"),...te,...h,mod:[{error:!!f&&K,pointer:_,disabled:p,multiline:R,"data-with-right-section":!!Ge,"data-with-left-section":!!y},Q],variant:T,size:d,children:[y&&m.jsx("div",{...b,"data-position":"left",...Ze("section",{className:b==null?void 0:b.className,style:b==null?void 0:b.style}),children:y}),m.jsx(Ce,{component:"input",...oe,...De,ref:e,required:l,mod:{disabled:p,error:!!f&&K},variant:T,__size:ce,...Ze("input")}),Ge&&m.jsx("div",{...x,"data-position":"right",...Ze("section",{className:x==null?void 0:x.className,style:x==null?void 0:x.style}),children:Ge})]})})});Mr.classes=Zr;Mr.Wrapper=AS;Mr.Label=Vb;Mr.Error=Lb;Mr.Description=Ob;Mr.Placeholder=_S;Mr.ClearButton=ZV;Mr.displayName="@mantine/core/Input";function Ide(t,e,n){const r=ie(t,e,n),{label:o,description:s,error:i,required:a,classNames:l,styles:c,className:u,unstyled:d,__staticSelector:h,__stylesApiProps:f,errorProps:p,labelProps:y,descriptionProps:b,wrapperProps:w,id:k,size:x,style:A,inputContainer:I,inputWrapperOrder:M,withAsterisk:T,variant:S,vars:_,mod:R,...D}=r,{styleProps:O,rest:N}=Rb(D),K={label:o,description:s,error:i,required:a,classNames:l,className:u,__staticSelector:h,__stylesApiProps:f||r,errorProps:p,labelProps:y,descriptionProps:b,unstyled:d,styles:c,size:x,style:A,inputContainer:I,inputWrapperOrder:M,withAsterisk:T,variant:S,id:k,mod:R,...w};return{...N,classNames:l,styles:c,unstyled:d,wrapperProps:{...K,...O},inputProps:{required:a,classNames:l,styles:c,unstyled:d,size:x,__staticSelector:h,__stylesApiProps:f||r,error:i,variant:S,id:k}}}const Mde={__staticSelector:"InputBase",withAria:!0},yu=er((t,e)=>{const{inputProps:n,wrapperProps:r,...o}=Ide("InputBase",Mde,t);return m.jsx(Mr.Wrapper,{...r,children:m.jsx(Mr,{...n,...o,ref:e})})});yu.classes={...Mr.classes,...Mr.Wrapper.classes};yu.displayName="@mantine/core/InputBase";const Rde={gap:{type:"spacing",property:"gap"},rowGap:{type:"spacing",property:"rowGap"},columnGap:{type:"spacing",property:"columnGap"},align:{type:"identity",property:"alignItems"},justify:{type:"identity",property:"justifyContent"},wrap:{type:"identity",property:"flexWrap"},direction:{type:"identity",property:"flexDirection"}};var e9={root:"m_8bffd616"};const Pde={},IS=er((t,e)=>{const n=ie("Flex",Pde,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,gap:c,rowGap:u,columnGap:d,align:h,justify:f,wrap:p,direction:y,...b}=n,w=Be({name:"Flex",classes:e9,props:n,className:o,style:s,classNames:r,styles:i,unstyled:a,vars:l}),k=Rr(),x=MV(),A=IV({styleProps:{gap:c,rowGap:u,columnGap:d,align:h,justify:f,wrap:p,direction:y},theme:k,data:Rde});return m.jsxs(m.Fragment,{children:[A.hasResponsiveStyles&&m.jsx(AV,{selector:`.${x}`,styles:A.styles,media:A.media}),m.jsx(Ce,{ref:e,...w("root",{className:x,style:Tb(A.inlineStyles)}),...b})]})});IS.classes=e9;IS.displayName="@mantine/core/Flex";var t9={root:"m_b6d8b162"};function Dde(t){if(t==="start")return"start";if(t==="end"||t)return"end"}const Nde={inherit:!1},Ode=(t,{variant:e,lineClamp:n,gradient:r,size:o,color:s})=>({root:{"--text-fz":pr(o),"--text-lh":cce(o),"--text-gradient":e==="gradient"?uC(r,t):void 0,"--text-line-clamp":typeof n=="number"?n.toString():void 0,"--text-color":s?ts(s,t):void 0}}),ns=er((t,e)=>{const n=ie("Text",Nde,t),{lineClamp:r,truncate:o,inline:s,inherit:i,gradient:a,span:l,__staticSelector:c,vars:u,className:d,style:h,classNames:f,styles:p,unstyled:y,variant:b,mod:w,size:k,...x}=n,A=Be({name:["Text",c],props:n,classes:t9,className:d,style:h,classNames:f,styles:p,unstyled:y,vars:u,varsResolver:Ode});return m.jsx(Ce,{...A("root",{focusable:!0}),ref:e,component:l?"span":"p",variant:b,mod:[{"data-truncate":Dde(o),"data-line-clamp":typeof r=="number","data-inline":s,"data-inherit":i},w],size:k,...x})});ns.classes=t9;ns.displayName="@mantine/core/Text";function MS({size:t,style:e,...n}){const r=t!==void 0?{width:U(t),height:U(t),...e}:e;return m.jsx("svg",{viewBox:"0 0 10 7",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:r,"aria-hidden":!0,...n,children:m.jsx("path",{d:"M4 4.586L1.707 2.293A1 1 0 1 0 .293 3.707l3 3a.997.997 0 0 0 1.414 0l5-5A1 1 0 1 0 8.293.293L4 4.586z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}const n9=v.createContext(null),Lde=n9.Provider;function Vde(){return{withinGroup:!!v.useContext(n9)}}var jb={group:"m_11def92b",root:"m_f85678b6",image:"m_11f8ac07",placeholder:"m_104cd71f"};const jde={},Bde=(t,{spacing:e})=>({group:{"--ag-spacing":Pf(e)}}),RS=He((t,e)=>{const n=ie("AvatarGroup",jde,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,spacing:c,...u}=n,d=Be({name:"AvatarGroup",classes:jb,props:n,className:o,style:s,classNames:r,styles:i,unstyled:a,vars:l,varsResolver:Bde,rootSelector:"group"});return m.jsx(Lde,{value:!0,children:m.jsx(Ce,{ref:e,...d("group"),...u})})});RS.classes=jb;RS.displayName="@mantine/core/AvatarGroup";function $de(t){return m.jsx("svg",{...t,"data-avatar-placeholder-icon":!0,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:m.jsx("path",{d:"M0.877014 7.49988C0.877014 3.84219 3.84216 0.877045 7.49985 0.877045C11.1575 0.877045 14.1227 3.84219 14.1227 7.49988C14.1227 11.1575 11.1575 14.1227 7.49985 14.1227C3.84216 14.1227 0.877014 11.1575 0.877014 7.49988ZM7.49985 1.82704C4.36683 1.82704 1.82701 4.36686 1.82701 7.49988C1.82701 8.97196 2.38774 10.3131 3.30727 11.3213C4.19074 9.94119 5.73818 9.02499 7.50023 9.02499C9.26206 9.02499 10.8093 9.94097 11.6929 11.3208C12.6121 10.3127 13.1727 8.97172 13.1727 7.49988C13.1727 4.36686 10.6328 1.82704 7.49985 1.82704ZM10.9818 11.9787C10.2839 10.7795 8.9857 9.97499 7.50023 9.97499C6.01458 9.97499 4.71624 10.7797 4.01845 11.9791C4.97952 12.7272 6.18765 13.1727 7.49985 13.1727C8.81227 13.1727 10.0206 12.727 10.9818 11.9787ZM5.14999 6.50487C5.14999 5.207 6.20212 4.15487 7.49999 4.15487C8.79786 4.15487 9.84999 5.207 9.84999 6.50487C9.84999 7.80274 8.79786 8.85487 7.49999 8.85487C6.20212 8.85487 5.14999 7.80274 5.14999 6.50487ZM7.49999 5.10487C6.72679 5.10487 6.09999 5.73167 6.09999 6.50487C6.09999 7.27807 6.72679 7.90487 7.49999 7.90487C8.27319 7.90487 8.89999 7.27807 8.89999 6.50487C8.89999 5.73167 8.27319 5.10487 7.49999 5.10487Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function Fde(t){let e=0;for(let n=0;n<t.length;n+=1){const r=t.charCodeAt(n);e=(e<<5)-e+r,e|=0}return e}const Hde=["blue","cyan","grape","green","indigo","lime","orange","pink","red","teal","violet"];function zde(t,e=Hde){const n=Fde(t),r=Math.abs(n)%e.length;return e[r]}function Ude(t,e=2){const n=t.split(" ");return n.length===1?t.slice(0,e).toUpperCase():n.map(r=>r[0]).slice(0,e).join("").toUpperCase()}const Wde={},qde=(t,{size:e,radius:n,variant:r,gradient:o,color:s,autoContrast:i,name:a,allowedInitialsColors:l})=>{const c=s==="initials"&&typeof a=="string"?zde(a,l):s,u=t.variantColorResolver({color:c||"gray",theme:t,gradient:o,variant:r||"light",autoContrast:i});return{root:{"--avatar-size":ut(e,"avatar-size"),"--avatar-radius":n===void 0?void 0:Fn(n),"--avatar-bg":c||r?u.background:void 0,"--avatar-color":c||r?u.color:void 0,"--avatar-bd":c||r?u.border:void 0}}},Bb=er((t,e)=>{const n=ie("Avatar",Wde,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,src:c,alt:u,radius:d,color:h,gradient:f,imageProps:p,children:y,autoContrast:b,mod:w,name:k,allowedInitialsColors:x,...A}=n,I=Vde(),[M,T]=v.useState(!c),S=Be({name:"Avatar",props:n,classes:jb,className:o,style:s,classNames:r,styles:i,unstyled:a,vars:l,varsResolver:qde});return v.useEffect(()=>T(!c),[c]),m.jsx(Ce,{...S("root"),mod:[{"within-group":I.withinGroup},w],ref:e,...A,children:M?m.jsx("span",{...S("placeholder"),title:u,children:y||typeof k=="string"&&Ude(k)||m.jsx($de,{})}):m.jsx("img",{...p,...S("image"),src:c,alt:u,onError:_=>{var R;T(!0),(R=p==null?void 0:p.onError)==null||R.call(p,_)}})})});Bb.classes=jb;Bb.displayName="@mantine/core/Avatar";Bb.Group=RS;var r9={root:"m_347db0ec","root--dot":"m_fbd81e3d",label:"m_5add502a",section:"m_91fdda9b"};const Gde={},Kde=(t,{radius:e,color:n,gradient:r,variant:o,size:s,autoContrast:i})=>{const a=t.variantColorResolver({color:n||t.primaryColor,theme:t,gradient:r,variant:o||"filled",autoContrast:i});return{root:{"--badge-height":ut(s,"badge-height"),"--badge-padding-x":ut(s,"badge-padding-x"),"--badge-fz":ut(s,"badge-fz"),"--badge-radius":e===void 0?void 0:Fn(e),"--badge-bg":n||o?a.background:void 0,"--badge-color":n||o?a.color:void 0,"--badge-bd":n||o?a.border:void 0,"--badge-dot-color":o==="dot"?ts(n,t):void 0}}},PS=er((t,e)=>{const n=ie("Badge",Gde,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,radius:c,color:u,gradient:d,leftSection:h,rightSection:f,children:p,variant:y,fullWidth:b,autoContrast:w,circle:k,mod:x,...A}=n,I=Be({name:"Badge",props:n,classes:r9,className:o,style:s,classNames:r,styles:i,unstyled:a,vars:l,varsResolver:Kde});return m.jsxs(Ce,{variant:y,mod:[{block:b,circle:k,"with-right-section":!!f,"with-left-section":!!h},x],...I("root",{variant:y}),ref:e,...A,children:[h&&m.jsx("span",{...I("section"),"data-position":"left",children:h}),m.jsx("span",{...I("label"),children:p}),f&&m.jsx("span",{...I("section"),"data-position":"right",children:f})]})});PS.classes=r9;PS.displayName="@mantine/core/Badge";var bu={root:"m_77c9d27d",inner:"m_80f1301b",label:"m_811560b9",section:"m_a74036a",loader:"m_a25b86ee",group:"m_80d6d844",groupSection:"m_70be2a01"};const SM={orientation:"horizontal"},Yde=(t,{borderWidth:e})=>({group:{"--button-border-width":U(e)}}),DS=He((t,e)=>{const n=ie("ButtonGroup",SM,t),{className:r,style:o,classNames:s,styles:i,unstyled:a,orientation:l,vars:c,borderWidth:u,variant:d,mod:h,...f}=ie("ButtonGroup",SM,t),p=Be({name:"ButtonGroup",props:n,classes:bu,className:r,style:o,classNames:s,styles:i,unstyled:a,vars:c,varsResolver:Yde,rootSelector:"group"});return m.jsx(Ce,{...p("group"),ref:e,variant:d,mod:[{"data-orientation":l},h],role:"group",...f})});DS.classes=bu;DS.displayName="@mantine/core/ButtonGroup";const EM={},Xde=(t,{radius:e,color:n,gradient:r,variant:o,autoContrast:s,size:i})=>{const a=t.variantColorResolver({color:n||t.primaryColor,theme:t,gradient:r,variant:o||"filled",autoContrast:s});return{groupSection:{"--section-height":ut(i,"section-height"),"--section-padding-x":ut(i,"section-padding-x"),"--section-fz":i!=null&&i.includes("compact")?pr(i.replace("compact-","")):pr(i),"--section-radius":e===void 0?void 0:Fn(e),"--section-bg":n||o?a.background:void 0,"--section-color":a.color,"--section-bd":n||o?a.border:void 0}}},NS=He((t,e)=>{const n=ie("ButtonGroupSection",EM,t),{className:r,style:o,classNames:s,styles:i,unstyled:a,vars:l,variant:c,gradient:u,radius:d,autoContrast:h,...f}=ie("ButtonGroupSection",EM,t),p=Be({name:"ButtonGroupSection",props:n,classes:bu,className:r,style:o,classNames:s,styles:i,unstyled:a,vars:l,varsResolver:Xde,rootSelector:"groupSection"});return m.jsx(Ce,{...p("groupSection"),ref:e,variant:c,...f})});NS.classes=bu;NS.displayName="@mantine/core/ButtonGroupSection";const Jde={in:{opacity:1,transform:`translate(-50%, calc(-50% + ${U(1)}))`},out:{opacity:0,transform:"translate(-50%, -200%)"},common:{transformOrigin:"center"},transitionProperty:"transform, opacity"},Qde={},Zde=(t,{radius:e,color:n,gradient:r,variant:o,size:s,justify:i,autoContrast:a})=>{const l=t.variantColorResolver({color:n||t.primaryColor,theme:t,gradient:r,variant:o||"filled",autoContrast:a});return{root:{"--button-justify":i,"--button-height":ut(s,"button-height"),"--button-padding-x":ut(s,"button-padding-x"),"--button-fz":s!=null&&s.includes("compact")?pr(s.replace("compact-","")):pr(s),"--button-radius":e===void 0?void 0:Fn(e),"--button-bg":n||o?l.background:void 0,"--button-hover":n||o?l.hover:void 0,"--button-color":l.color,"--button-bd":n||o?l.border:void 0,"--button-hover-color":n||o?l.hoverColor:void 0}}},Mo=er((t,e)=>{const n=ie("Button",Qde,t),{style:r,vars:o,className:s,color:i,disabled:a,children:l,leftSection:c,rightSection:u,fullWidth:d,variant:h,radius:f,loading:p,loaderProps:y,gradient:b,classNames:w,styles:k,unstyled:x,"data-disabled":A,autoContrast:I,mod:M,...T}=n,S=Be({name:"Button",props:n,classes:bu,className:s,style:r,classNames:w,styles:k,unstyled:x,vars:o,varsResolver:Zde}),_=!!c,R=!!u;return m.jsxs(Ll,{ref:e,...S("root",{active:!a&&!p&&!A}),unstyled:x,variant:h,disabled:a||p,mod:[{disabled:a||A,loading:p,block:d,"with-left-section":_,"with-right-section":R},M],...T,children:[m.jsx(Vl,{mounted:!!p,transition:Jde,duration:150,children:D=>m.jsx(Ce,{component:"span",...S("loader",{style:D}),"aria-hidden":!0,children:m.jsx(xa,{color:"var(--button-color)",size:"calc(var(--button-height) / 1.8)",...y})})}),m.jsxs("span",{...S("inner"),children:[c&&m.jsx(Ce,{component:"span",...S("section"),mod:{position:"left"},children:c}),m.jsx(Ce,{component:"span",mod:{loading:p},...S("label"),children:l}),u&&m.jsx(Ce,{component:"span",...S("section"),mod:{position:"right"},children:u})]})]})});Mo.classes=bu;Mo.displayName="@mantine/core/Button";Mo.Group=DS;Mo.GroupSection=NS;const[ehe,the]=_b("Card component was not found in tree");var OS={root:"m_e615b15f",section:"m_599a2148"};const nhe={},$b=er((t,e)=>{const n=ie("CardSection",nhe,t),{classNames:r,className:o,style:s,styles:i,vars:a,withBorder:l,inheritPadding:c,mod:u,...d}=n,h=the();return m.jsx(Ce,{ref:e,mod:[{"with-border":l,"inherit-padding":c},u],...h.getStyles("section",{className:o,style:s,styles:i,classNames:r}),...d})});$b.classes=OS;$b.displayName="@mantine/core/CardSection";const rhe={},ohe=(t,{padding:e})=>({root:{"--card-padding":Pf(e)}}),Vf=er((t,e)=>{const n=ie("Card",rhe,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,children:c,padding:u,...d}=n,h=Be({name:"Card",props:n,classes:OS,className:o,style:s,classNames:r,styles:i,unstyled:a,vars:l,varsResolver:ohe}),f=v.Children.toArray(c),p=f.map((y,b)=>typeof y=="object"&&y&&"type"in y&&y.type===$b?v.cloneElement(y,{"data-first-section":b===0||void 0,"data-last-section":b===f.length-1||void 0}):y);return m.jsx(ehe,{value:{getStyles:h},children:m.jsx(CS,{ref:e,unstyled:a,...h("root"),...d,children:p})})});Vf.classes=OS;Vf.displayName="@mantine/core/Card";Vf.Section=$b;const[she,ihe]=fS(),ahe={};function o9(t){const{value:e,defaultValue:n,onChange:r,multiple:o,children:s}=ie("ChipGroup",ahe,t),[i,a]=pu({value:e,defaultValue:n,finalValue:o?[]:null,onChange:r}),l=u=>Array.isArray(i)?i.includes(u):u===i,c=u=>{const d=u.currentTarget.value;Array.isArray(i)?a(i.includes(d)?i.filter(h=>h!==d):[...i,d]):a(d)};return m.jsx(she,{value:{isChipSelected:l,onChange:c,multiple:o},children:s})}o9.displayName="@mantine/core/ChipGroup";var s9={root:"m_f59ffda3",label:"m_be049a53","label--outline":"m_3904c1af","label--filled":"m_fa109255","label--light":"m_f7e165c3",iconWrapper:"m_9ac86df9",checkIcon:"m_d6d72580",input:"m_bde07329"};const lhe={type:"checkbox"},che=(t,{size:e,radius:n,variant:r,color:o,autoContrast:s})=>{const i=t.variantColorResolver({color:o||t.primaryColor,theme:t,variant:r||"filled",autoContrast:s});return{root:{"--chip-fz":pr(e),"--chip-size":ut(e,"chip-size"),"--chip-radius":n===void 0?void 0:Fn(n),"--chip-checked-padding":ut(e,"chip-checked-padding"),"--chip-padding":ut(e,"chip-padding"),"--chip-icon-size":ut(e,"chip-icon-size"),"--chip-bg":o||r?i.background:void 0,"--chip-hover":o||r?i.hover:void 0,"--chip-color":o||r?i.color:void 0,"--chip-bd":o||r?i.border:void 0,"--chip-spacing":ut(e,"chip-spacing")}}},Fb=He((t,e)=>{const n=ie("Chip",lhe,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,id:c,checked:u,defaultChecked:d,onChange:h,value:f,wrapperProps:p,type:y,disabled:b,children:w,size:k,variant:x,icon:A,rootRef:I,autoContrast:M,mod:T,...S}=n,_=Be({name:"Chip",classes:s9,props:n,className:o,style:s,classNames:r,styles:i,unstyled:a,vars:l,varsResolver:che}),R=ihe(),D=Df(c),{styleProps:O,rest:N}=Rb(S),[K,Q]=pu({value:u,defaultValue:d,finalValue:!1,onChange:h}),ce=R?{checked:R.isChipSelected(f),onChange:W=>{R.onChange(W),h==null||h(W.currentTarget.checked)},type:R.multiple?"checkbox":"radio"}:{},z=ce.checked||K;return m.jsxs(Ce,{size:k,variant:x,ref:I,mod:T,..._("root"),...O,...p,children:[m.jsx("input",{type:y,..._("input"),checked:z,onChange:W=>Q(W.currentTarget.checked),id:D,disabled:b,ref:e,value:f,...ce,...N}),m.jsxs("label",{htmlFor:D,"data-checked":z||void 0,"data-disabled":b||void 0,..._("label",{variant:x||"filled"}),children:[z&&m.jsx("span",{..._("iconWrapper"),children:A||m.jsx(MS,{..._("checkIcon")})}),m.jsx("span",{children:w})]})]})});Fb.classes=s9;Fb.displayName="@mantine/core/Chip";Fb.Group=o9;var i9={root:"m_3eebeb36",label:"m_9e365f20"};const uhe={orientation:"horizontal"},dhe=(t,{color:e,variant:n,size:r})=>({root:{"--divider-color":e?ts(e,t):void 0,"--divider-border-style":n,"--divider-size":ut(r,"divider-size")}}),LS=He((t,e)=>{const n=ie("Divider",uhe,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,color:c,orientation:u,label:d,labelPosition:h,mod:f,...p}=n,y=Be({name:"Divider",classes:i9,props:n,className:o,style:s,classNames:r,styles:i,unstyled:a,vars:l,varsResolver:dhe});return m.jsx(Ce,{ref:e,mod:[{orientation:u,"with-label":!!d},f],...y("root"),...p,role:"separator",children:d&&m.jsx(Ce,{component:"span",mod:{position:h},...y("label"),children:d})})});LS.classes=i9;LS.displayName="@mantine/core/Divider";const hhe={multiple:!1},a9=v.forwardRef((t,e)=>{const{onChange:n,children:r,multiple:o,accept:s,name:i,form:a,resetRef:l,disabled:c,capture:u,inputProps:d,...h}=ie("FileButton",hhe,t),f=v.useRef(null),p=()=>{var w;!c&&((w=f.current)==null||w.click())},y=w=>{n(o?Array.from(w.currentTarget.files):w.currentTarget.files[0]||null)};return ty(l,()=>{f.current&&(f.current.value="")}),m.jsxs(m.Fragment,{children:[r({onClick:p,...h}),m.jsx("input",{style:{display:"none"},type:"file",accept:s,multiple:o,onChange:y,ref:ti(e,f),name:i,form:a,capture:u,...d})]})});a9.displayName="@mantine/core/FileButton";const fhe=({value:t})=>m.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Array.isArray(t)?t.map(e=>e.name).join(", "):t==null?void 0:t.name}),phe={valueComponent:fhe},VS=He((t,e)=>{const n=ie("FileInput",phe,t),{unstyled:r,vars:o,onChange:s,value:i,defaultValue:a,multiple:l,accept:c,name:u,form:d,valueComponent:h,clearable:f,clearButtonProps:p,readOnly:y,capture:b,fileInputProps:w,rightSection:k,size:x,placeholder:A,component:I,resetRef:M,classNames:T,styles:S,..._}=n,R=v.useRef(null),{resolvedClassNames:D,resolvedStyles:O}=Mb({classNames:T,styles:S,props:n}),[N,K]=pu({value:i,defaultValue:a,onChange:s,finalValue:l?[]:null}),Q=Array.isArray(N)?N.length!==0:N!==null,ce=k||(f&&Q&&!y?m.jsx(Db,{...p,variant:"subtle",onClick:()=>K(l?[]:null),size:x,unstyled:r}):null);v.useEffect(()=>{var W;(Array.isArray(N)&&N.length===0||N===null)&&((W=R.current)==null||W.call(R))},[N]);const z=h;return m.jsx(a9,{onChange:K,multiple:l,accept:c,name:u,form:d,resetRef:ti(R,M),disabled:y,capture:b,inputProps:w,children:W=>m.jsx(yu,{component:I||"button",ref:e,rightSection:ce,...W,..._,__staticSelector:"FileInput",multiline:!0,type:"button",pointer:!0,__stylesApiProps:n,unstyled:r,size:x,classNames:T,styles:S,children:Q?m.jsx(z,{value:N}):m.jsx(Mr.Placeholder,{__staticSelector:"FileInput",classNames:D,styles:O,children:A})})})});VS.classes=yu.classes;VS.displayName="@mantine/core/FileInput";const mhe=VS;function ghe({open:t,close:e,openDelay:n,closeDelay:r}){const o=v.useRef(-1),s=v.useRef(-1),i=()=>{window.clearTimeout(o.current),window.clearTimeout(s.current)},a=()=>{i(),n===0||n===void 0?t():o.current=window.setTimeout(t,n)},l=()=>{i(),r===0||r===void 0?e():s.current=window.setTimeout(e,r)};return v.useEffect(()=>i,[]),{openDropdown:a,closeDropdown:l}}function fC(){return fC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},fC.apply(null,arguments)}function yhe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var bhe=v.useLayoutEffect,vhe=function(e){var n=v.useRef(e);return bhe(function(){n.current=e}),n},TM=function(e,n){if(typeof e=="function"){e(n);return}e.current=n},whe=function(e,n){var r=v.useRef();return v.useCallback(function(o){e.current=o,r.current&&TM(r.current,null),r.current=n,n&&TM(n,o)},[n])},_M={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},Che=function(e){Object.keys(_M).forEach(function(n){e.style.setProperty(n,_M[n],"important")})},AM=Che,Un=null,IM=function(e,n){var r=e.scrollHeight;return n.sizingStyle.boxSizing==="border-box"?r+n.borderSize:r-n.paddingSize};function xhe(t,e,n,r){n===void 0&&(n=1),r===void 0&&(r=1/0),Un||(Un=document.createElement("textarea"),Un.setAttribute("tabindex","-1"),Un.setAttribute("aria-hidden","true"),AM(Un)),Un.parentNode===null&&document.body.appendChild(Un);var o=t.paddingSize,s=t.borderSize,i=t.sizingStyle,a=i.boxSizing;Object.keys(i).forEach(function(h){var f=h;Un.style[f]=i[f]}),AM(Un),Un.value=e;var l=IM(Un,t);Un.value=e,l=IM(Un,t),Un.value="x";var c=Un.scrollHeight-o,u=c*n;a==="border-box"&&(u=u+o+s),l=Math.max(u,l);var d=c*r;return a==="border-box"&&(d=d+o+s),l=Math.min(d,l),[l,c]}var MM=function(){},khe=function(e,n){return e.reduce(function(r,o){return r[o]=n[o],r},{})},She=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],Ehe=!!document.documentElement.currentStyle,The=function(e){var n=window.getComputedStyle(e);if(n===null)return null;var r=khe(She,n),o=r.boxSizing;if(o==="")return null;Ehe&&o==="border-box"&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px");var s=parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),i=parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth);return{sizingStyle:r,paddingSize:s,borderSize:i}},_he=The;function jS(t,e,n){var r=vhe(n);v.useLayoutEffect(function(){var o=function(i){return r.current(i)};if(t)return t.addEventListener(e,o),function(){return t.removeEventListener(e,o)}},[])}var Ahe=function(e,n){jS(document.body,"reset",function(r){e.current.form===r.target&&n(r)})},Ihe=function(e){jS(window,"resize",e)},Mhe=function(e){jS(document.fonts,"loadingdone",e)},Rhe=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],Phe=function(e,n){var r=e.cacheMeasurements,o=e.maxRows,s=e.minRows,i=e.onChange,a=i===void 0?MM:i,l=e.onHeightChange,c=l===void 0?MM:l,u=yhe(e,Rhe),d=u.value!==void 0,h=v.useRef(null),f=whe(h,n),p=v.useRef(0),y=v.useRef(),b=function(){var x=h.current,A=r&&y.current?y.current:_he(x);if(A){y.current=A;var I=xhe(A,x.value||x.placeholder||"x",s,o),M=I[0],T=I[1];p.current!==M&&(p.current=M,x.style.setProperty("height",M+"px","important"),c(M,{rowHeight:T}))}},w=function(x){d||b(),a(x)};return v.useLayoutEffect(b),Ahe(h,function(){if(!d){var k=h.current.value;requestAnimationFrame(function(){var x=h.current;x&&k!==x.value&&b()})}}),Ihe(b),Mhe(b),v.createElement("textarea",fC({},u,{onChange:w,ref:f}))},Dhe=v.forwardRef(Phe),l9={root:"m_6e45937b",loader:"m_e8eb006c",overlay:"m_df587f17"};const RM={transitionProps:{transition:"fade",duration:0},overlayProps:{backgroundOpacity:.75},zIndex:Rf("overlay")},Nhe=(t,{zIndex:e})=>({root:{"--lo-z-index":e==null?void 0:e.toString()}}),BS=He((t,e)=>{const n=ie("LoadingOverlay",RM,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,transitionProps:c,loaderProps:u,overlayProps:d,visible:h,zIndex:f,...p}=n,y=Rr(),b=Be({name:"LoadingOverlay",classes:l9,props:n,className:o,style:s,classNames:r,styles:i,unstyled:a,vars:l,varsResolver:Nhe}),w={...RM.overlayProps,...d};return m.jsx(Vl,{transition:"fade",...c,mounted:!!h,children:k=>m.jsxs(Ce,{...b("root",{style:k}),ref:e,...p,children:[m.jsx(xa,{...b("loader"),unstyled:a,...u}),m.jsx(Oh,{...w,...b("overlay"),darkHidden:!0,unstyled:a,color:(d==null?void 0:d.color)||y.white}),m.jsx(Oh,{...w,...b("overlay"),lightHidden:!0,unstyled:a,color:(d==null?void 0:d.color)||y.colors.dark[5]})]})})});BS.classes=l9;BS.displayName="@mantine/core/LoadingOverlay";const[Ohe,jf]=_b("Menu component was not found in the tree");var vu={dropdown:"m_dc9b7c9f",label:"m_9bfac126",divider:"m_efdf90cb",item:"m_99ac2aa1",itemLabel:"m_5476e0d3",itemSection:"m_8b75e504"};const Lhe={},$S=He((t,e)=>{const{classNames:n,className:r,style:o,styles:s,vars:i,...a}=ie("MenuDivider",Lhe,t),l=jf();return m.jsx(Ce,{ref:e,...l.getStyles("divider",{className:r,style:o,styles:s,classNames:n}),...a})});$S.classes=vu;$S.displayName="@mantine/core/MenuDivider";const Vhe={},FS=He((t,e)=>{const{classNames:n,className:r,style:o,styles:s,vars:i,onMouseEnter:a,onMouseLeave:l,onKeyDown:c,children:u,...d}=ie("MenuDropdown",Vhe,t),h=v.useRef(null),f=jf(),p=$o(c,w=>{var k,x;(w.key==="ArrowUp"||w.key==="ArrowDown")&&(w.preventDefault(),(x=(k=h.current)==null?void 0:k.querySelectorAll("[data-menu-item]:not(:disabled)")[0])==null||x.focus())}),y=$o(a,()=>(f.trigger==="hover"||f.trigger==="click-hover")&&f.openDropdown()),b=$o(l,()=>(f.trigger==="hover"||f.trigger==="click-hover")&&f.closeDropdown());return m.jsxs(Ca.Dropdown,{...d,onMouseEnter:y,onMouseLeave:b,role:"menu","aria-orientation":"vertical",ref:ti(e,h),...f.getStyles("dropdown",{className:r,style:o,styles:s,classNames:n,withStaticClass:!1}),tabIndex:-1,"data-menu-dropdown":!0,onKeyDown:p,children:[f.withInitialFocusPlaceholder&&m.jsx("div",{tabIndex:-1,"data-autofocus":!0,"data-mantine-stop-propagation":!0,style:{outline:0}}),u]})});FS.classes=vu;FS.displayName="@mantine/core/MenuDropdown";const jhe={},HS=er((t,e)=>{const{classNames:n,className:r,style:o,styles:s,vars:i,color:a,closeMenuOnClick:l,leftSection:c,rightSection:u,children:d,disabled:h,"data-disabled":f,...p}=ie("MenuItem",jhe,t),y=jf(),b=Rr(),{dir:w}=Of(),k=v.useRef(null),x=y.getItemIndex(k.current),A=p,I=$o(A.onMouseLeave,()=>y.setHovered(-1)),M=$o(A.onMouseEnter,()=>y.setHovered(y.getItemIndex(k.current))),T=$o(A.onClick,()=>{f||(typeof l=="boolean"?l&&y.closeDropdownImmediately():y.closeOnItemClick&&y.closeDropdownImmediately())}),S=$o(A.onFocus,()=>y.setHovered(y.getItemIndex(k.current))),_=a?b.variantColorResolver({color:a,theme:b,variant:"light"}):void 0,R=a?mu({color:a,theme:b}):null;return m.jsxs(Ll,{...p,unstyled:y.unstyled,tabIndex:y.menuItemTabIndex,onFocus:S,...y.getStyles("item",{className:r,style:o,styles:s,classNames:n}),ref:ti(k,e),role:"menuitem",disabled:h,"data-menu-item":!0,"data-disabled":h||f||void 0,"data-hovered":y.hovered===x?!0:void 0,"data-mantine-stop-propagation":!0,onMouseEnter:M,onMouseLeave:I,onClick:T,onKeyDown:fV({siblingSelector:"[data-menu-item]:not([data-disabled])",parentSelector:"[data-menu-dropdown]",activateOnFocus:!1,loop:y.loop,dir:w,orientation:"vertical",onKeyDown:A.onKeyDown}),__vars:{"--menu-item-color":R!=null&&R.isThemeColor&&(R==null?void 0:R.shade)===void 0?`var(--mantine-color-${R.color}-6)`:_==null?void 0:_.color,"--menu-item-hover":_==null?void 0:_.hover},children:[c&&m.jsx("div",{...y.getStyles("itemSection",{styles:s,classNames:n}),"data-position":"left",children:c}),d&&m.jsx("div",{...y.getStyles("itemLabel",{styles:s,classNames:n}),children:d}),u&&m.jsx("div",{...y.getStyles("itemSection",{styles:s,classNames:n}),"data-position":"right",children:u})]})});HS.classes=vu;HS.displayName="@mantine/core/MenuItem";const Bhe={},zS=He((t,e)=>{const{classNames:n,className:r,style:o,styles:s,vars:i,...a}=ie("MenuLabel",Bhe,t),l=jf();return m.jsx(Ce,{ref:e,...l.getStyles("label",{className:r,style:o,styles:s,classNames:n}),...a})});zS.classes=vu;zS.displayName="@mantine/core/MenuLabel";const $he={refProp:"ref"},c9=v.forwardRef((t,e)=>{const{children:n,refProp:r,...o}=ie("MenuTarget",$he,t);if(!Mf(n))throw new Error("Menu.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const s=jf(),i=n.props,a=$o(i.onClick,()=>{s.trigger==="click"?s.toggleDropdown():s.trigger==="click-hover"&&(s.setOpenedViaClick(!0),s.opened||s.openDropdown())}),l=$o(i.onMouseEnter,()=>(s.trigger==="hover"||s.trigger==="click-hover")&&s.openDropdown()),c=$o(i.onMouseLeave,()=>{(s.trigger==="hover"||s.trigger==="click-hover"&&!s.openedViaClick)&&s.closeDropdown()});return m.jsx(Ca.Target,{refProp:r,popupType:"menu",ref:e,...o,children:v.cloneElement(n,{onClick:a,onMouseEnter:l,onMouseLeave:c,"data-expanded":s.opened?!0:void 0})})});c9.displayName="@mantine/core/MenuTarget";const Fhe={trapFocus:!0,closeOnItemClick:!0,withInitialFocusPlaceholder:!0,clickOutsideEvents:["mousedown","touchstart","keydown"],loop:!0,trigger:"click",openDelay:0,closeDelay:100,menuItemTabIndex:-1};function At(t){const e=ie("Menu",Fhe,t),{children:n,onOpen:r,onClose:o,opened:s,defaultOpened:i,trapFocus:a,onChange:l,closeOnItemClick:c,loop:u,closeOnEscape:d,trigger:h,openDelay:f,closeDelay:p,classNames:y,styles:b,unstyled:w,variant:k,vars:x,menuItemTabIndex:A,keepMounted:I,withInitialFocusPlaceholder:M,...T}=e,S=Be({name:"Menu",classes:vu,props:e,classNames:y,styles:b,unstyled:w}),[_,{setHovered:R,resetHovered:D}]=dce(),[O,N]=pu({value:s,defaultValue:i,finalValue:!1,onChange:l}),[K,Q]=v.useState(!1),ce=()=>{N(!1),Q(!1),O&&(o==null||o())},z=()=>{N(!0),!O&&(r==null||r())},W=()=>{O?ce():z()},{openDropdown:X,closeDropdown:le}=ghe({open:z,close:ce,closeDelay:p,openDelay:f}),te=lt=>uce("[data-menu-item]","[data-menu-dropdown]",lt),{resolvedClassNames:oe,resolvedStyles:ue}=Mb({classNames:y,styles:b,props:e});return oa(()=>{D()},[O]),m.jsx(Ohe,{value:{getStyles:S,opened:O,toggleDropdown:W,getItemIndex:te,hovered:_,setHovered:R,openedViaClick:K,setOpenedViaClick:Q,closeOnItemClick:c,closeDropdown:h==="click"?ce:le,openDropdown:h==="click"?z:X,closeDropdownImmediately:ce,loop:u,trigger:h,unstyled:w,menuItemTabIndex:A,withInitialFocusPlaceholder:M},children:m.jsx(Ca,{...T,opened:O,onChange:W,defaultOpened:i,trapFocus:I?!1:a,closeOnEscape:d,__staticSelector:"Menu",classNames:oe,styles:ue,unstyled:w,variant:k,keepMounted:I,children:n})})}At.extend=t=>t;At.withProps=Vue(At);At.classes=vu;At.displayName="@mantine/core/Menu";At.Item=HS;At.Label=zS;At.Dropdown=FS;At.Target=c9;At.Divider=$S;const Hhe={duration:100,transition:"fade"};function zhe(t,e){return{...Hhe,...e,...t}}function Uhe({offset:t,position:e,defaultOpened:n}){const[r,o]=v.useState(n),s=v.useRef(null),{x:i,y:a,elements:l,refs:c,update:u,placement:d}=fu({placement:e,middleware:[Pl({crossAxis:!0,padding:5,rootBoundary:"document"})]}),h=d.includes("right")?t:e.includes("left")?t*-1:0,f=d.includes("bottom")?t:e.includes("top")?t*-1:0,p=v.useCallback(({clientX:y,clientY:b})=>{c.setPositionReference({getBoundingClientRect(){return{width:0,height:0,x:y,y:b,left:y+h,top:b+f,right:y,bottom:b}}})},[l.reference]);return v.useEffect(()=>{if(c.floating.current){const y=s.current;y.addEventListener("mousemove",p);const b=dm(c.floating.current);return b.forEach(w=>{w.addEventListener("scroll",u)}),()=>{y.removeEventListener("mousemove",p),b.forEach(w=>{w.removeEventListener("scroll",u)})}}},[l.reference,c.floating.current,u,p,r]),{handleMouseMove:p,x:i,y:a,opened:r,setOpened:o,boundaryRef:s,floating:c.setFloating}}var Hb={tooltip:"m_1b3c8819",arrow:"m_f898399f"};const Whe={refProp:"ref",withinPortal:!0,offset:10,defaultOpened:!1,position:"right",zIndex:Rf("popover")},qhe=(t,{radius:e,color:n})=>({tooltip:{"--tooltip-radius":e===void 0?void 0:Fn(e),"--tooltip-bg":n?ts(n,t):void 0,"--tooltip-color":n?"var(--mantine-color-white)":void 0}}),US=He((t,e)=>{const n=ie("TooltipFloating",Whe,t),{children:r,refProp:o,withinPortal:s,style:i,className:a,classNames:l,styles:c,unstyled:u,radius:d,color:h,label:f,offset:p,position:y,multiline:b,zIndex:w,disabled:k,defaultOpened:x,variant:A,vars:I,portalProps:M,...T}=n,S=Rr(),_=Be({name:"TooltipFloating",props:n,classes:Hb,className:a,style:i,classNames:l,styles:c,unstyled:u,rootSelector:"tooltip",vars:I,varsResolver:qhe}),{handleMouseMove:R,x:D,y:O,opened:N,boundaryRef:K,floating:Q,setOpened:ce}=Uhe({offset:p,position:y,defaultOpened:x});if(!Mf(r))throw new Error("[@mantine/core] Tooltip.Floating component children should be an element or a component that accepts ref, fragments, strings, numbers and other primitive values are not supported");const z=ti(K,pS(r),e),W=r.props,X=te=>{var oe;(oe=W.onMouseEnter)==null||oe.call(W,te),R(te),ce(!0)},le=te=>{var oe;(oe=W.onMouseLeave)==null||oe.call(W,te),ce(!1)};return m.jsxs(m.Fragment,{children:[m.jsx(Lf,{...M,withinPortal:s,children:m.jsx(Ce,{...T,..._("tooltip",{style:{...RV(i,S),zIndex:w,display:!k&&N?"block":"none",top:(O&&Math.round(O))??"",left:(D&&Math.round(D))??""}}),variant:A,ref:Q,mod:{multiline:b},children:f})}),v.cloneElement(r,{...W,[o]:z,onMouseEnter:X,onMouseLeave:le})]})});US.classes=Hb;US.displayName="@mantine/core/TooltipFloating";const u9=v.createContext(!1),Ghe=u9.Provider,Khe=()=>v.useContext(u9),Yhe={openDelay:0,closeDelay:0};function WS(t){const{openDelay:e,closeDelay:n,children:r}=ie("TooltipGroup",Yhe,t);return m.jsx(Ghe,{value:!0,children:m.jsx(Vse,{delay:{open:e,close:n},children:r})})}WS.displayName="@mantine/core/TooltipGroup";WS.extend=t=>t;function Xhe(t){if(t===void 0)return{shift:!0,flip:!0};const e={...t};return t.shift===void 0&&(e.shift=!0),t.flip===void 0&&(e.flip=!0),e}function Jhe(t){const e=Xhe(t.middlewares),n=[is(t.offset)];return e.shift&&n.push(Pl(typeof e.shift=="boolean"?{padding:8}:{padding:8,...e.shift})),e.flip&&n.push(typeof e.flip=="boolean"?bo():bo(e.flip)),n.push(eN({element:t.arrowRef,padding:t.arrowOffset})),e.inline?n.push(typeof e.inline=="boolean"?Ed():Ed(e.inline)):t.inline&&n.push(Ed()),n}function Qhe(t){var M,T,S;const[e,n]=v.useState(t.defaultOpened),o=typeof t.opened=="boolean"?t.opened:e,s=Khe(),i=Df(),a=v.useCallback(_=>{n(_),_&&k(i)},[i]),{x:l,y:c,context:u,refs:d,update:h,placement:f,middlewareData:{arrow:{x:p,y}={}}}=fu({strategy:t.strategy,placement:t.position,open:o,onOpenChange:a,middleware:Jhe(t)}),{delay:b,currentId:w,setCurrentId:k}=jse(u,{id:i}),{getReferenceProps:x,getFloatingProps:A}=R5([Ose(u,{enabled:(M=t.events)==null?void 0:M.hover,delay:s?b:{open:t.openDelay,close:t.closeDelay},mouseOnly:!((T=t.events)!=null&&T.touch)}),Xse(u,{enabled:(S=t.events)==null?void 0:S.focus,visibleOnly:!0}),Qse(u,{role:"tooltip"}),M5(u,{enabled:typeof t.opened>"u"})]);WV({opened:o,position:t.position,positionDependencies:t.positionDependencies,floating:{refs:d,update:h}}),oa(()=>{var _;(_=t.onPositionChange)==null||_.call(t,f)},[f]);const I=o&&w&&w!==i;return{x:l,y:c,arrowX:p,arrowY:y,reference:d.setReference,floating:d.setFloating,getFloatingProps:A,getReferenceProps:x,isGroupPhase:I,opened:o,placement:f}}const PM={position:"top",refProp:"ref",withinPortal:!0,inline:!1,defaultOpened:!1,arrowSize:4,arrowOffset:5,arrowRadius:0,arrowPosition:"side",offset:5,transitionProps:{duration:100,transition:"fade"},events:{hover:!0,focus:!1,touch:!1},zIndex:Rf("popover"),positionDependencies:[],middlewares:{flip:!0,shift:!0,inline:!1}},Zhe=(t,{radius:e,color:n})=>({tooltip:{"--tooltip-radius":e===void 0?void 0:Fn(e),"--tooltip-bg":n?ts(n,t):void 0,"--tooltip-color":n?"var(--mantine-color-white)":void 0}}),wu=He((t,e)=>{const n=ie("Tooltip",PM,t),{children:r,position:o,refProp:s,label:i,openDelay:a,closeDelay:l,onPositionChange:c,opened:u,defaultOpened:d,withinPortal:h,radius:f,color:p,classNames:y,styles:b,unstyled:w,style:k,className:x,withArrow:A,arrowSize:I,arrowOffset:M,arrowRadius:T,arrowPosition:S,offset:_,transitionProps:R,multiline:D,events:O,zIndex:N,disabled:K,positionDependencies:Q,onClick:ce,onMouseEnter:z,onMouseLeave:W,inline:X,variant:le,keepMounted:te,vars:oe,portalProps:ue,mod:lt,floatingStrategy:Ze,middlewares:De,...Ge}=ie("Tooltip",PM,n),{dir:gt}=Of(),nt=v.useRef(null),ge=Qhe({position:BV(gt,o),closeDelay:l,openDelay:a,onPositionChange:c,opened:u,defaultOpened:d,events:O,arrowRef:nt,arrowOffset:M,offset:typeof _=="number"?_+(A?I/2:0):_,positionDependencies:[...Q,r],inline:X,strategy:Ze,middlewares:De}),Wt=Be({name:"Tooltip",props:n,classes:Hb,className:x,style:k,classNames:y,styles:b,unstyled:w,rootSelector:"tooltip",vars:oe,varsResolver:Zhe});if(!Mf(r))throw new Error("[@mantine/core] Tooltip component children should be an element or a component that accepts ref, fragments, strings, numbers and other primitive values are not supported");const Ot=ti(ge.reference,pS(r),e),Xt=zhe(R,{duration:100,transition:"fade"}),Lt=r.props;return m.jsxs(m.Fragment,{children:[m.jsx(Lf,{...ue,withinPortal:h,children:m.jsx(Vl,{...Xt,keepMounted:te,mounted:!K&&!!ge.opened,duration:ge.isGroupPhase?10:Xt.duration,children:Sn=>m.jsxs(Ce,{...Ge,"data-fixed":Ze==="fixed"||void 0,variant:le,mod:[{multiline:D},lt],...ge.getFloatingProps({ref:ge.floating,className:Wt("tooltip").className,style:{...Wt("tooltip").style,...Sn,zIndex:N,top:ge.y??0,left:ge.x??0}}),children:[i,m.jsx(xS,{ref:nt,arrowX:ge.arrowX,arrowY:ge.arrowY,visible:A,position:ge.placement,arrowSize:I,arrowOffset:M,arrowRadius:T,arrowPosition:S,...Wt("arrow")})]})})}),v.cloneElement(r,ge.getReferenceProps({onClick:ce,onMouseEnter:z,onMouseLeave:W,onMouseMove:n.onMouseMove,onPointerDown:n.onPointerDown,onPointerEnter:n.onPointerEnter,className:ni(x,Lt.className),...Lt,[s]:Ot}))]})});wu.classes=Hb;wu.displayName="@mantine/core/Tooltip";wu.Floating=US;wu.Group=WS;var d9={root:"m_18320242","skeleton-fade":"m_299c329c"};const efe={visible:!0,animate:!0},tfe=(t,{width:e,height:n,radius:r,circle:o})=>({root:{"--skeleton-height":U(n),"--skeleton-width":U(o?n:e),"--skeleton-radius":o?"1000px":r===void 0?void 0:Fn(r)}}),ry=He((t,e)=>{const n=ie("Skeleton",efe,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,width:c,height:u,circle:d,visible:h,radius:f,animate:p,mod:y,...b}=n,w=Be({name:"Skeleton",classes:d9,props:n,className:o,style:s,classNames:r,styles:i,unstyled:a,vars:l,varsResolver:tfe});return m.jsx(Ce,{ref:e,...w("root"),mod:[{visible:h,animate:p},y],...b})});ry.classes=d9;ry.displayName="@mantine/core/Skeleton";var h9={root:"m_6d731127"};const nfe={gap:"md",align:"stretch",justify:"flex-start"},rfe=(t,{gap:e,align:n,justify:r})=>({root:{"--stack-gap":Pf(e),"--stack-align":n,"--stack-justify":r}}),Bf=He((t,e)=>{const n=ie("Stack",nfe,t),{classNames:r,className:o,style:s,styles:i,unstyled:a,vars:l,align:c,justify:u,gap:d,variant:h,...f}=n,p=Be({name:"Stack",props:n,classes:h9,className:o,style:s,classNames:r,styles:i,unstyled:a,vars:l,varsResolver:rfe});return m.jsx(Ce,{ref:e,...p("root"),variant:h,...f})});Bf.classes=h9;Bf.displayName="@mantine/core/Stack";const[ofe,qS]=_b("Tabs component was not found in the tree");var $f={root:"m_89d60db1","list--default":"m_576c9d4",list:"m_89d33d6d",panel:"m_b0c91715",tab:"m_4ec4dce6",tabSection:"m_fc420b1f","tab--default":"m_539e827b","list--outline":"m_6772fbd5","tab--outline":"m_b59ab47c","tab--pills":"m_c3381914"};const sfe={},GS=He((t,e)=>{const n=ie("TabsList",sfe,t),{children:r,className:o,grow:s,justify:i,classNames:a,styles:l,style:c,mod:u,...d}=n,h=qS();return m.jsx(Ce,{...d,...h.getStyles("list",{className:o,style:c,classNames:a,styles:l,props:n,variant:h.variant}),ref:e,role:"tablist",variant:h.variant,mod:[{grow:s,orientation:h.orientation,placement:h.orientation==="vertical"&&h.placement,inverted:h.inverted},u],"aria-orientation":h.orientation,__vars:{"--tabs-justify":i},children:r})});GS.classes=$f;GS.displayName="@mantine/core/TabsList";const ife={},KS=He((t,e)=>{const n=ie("TabsPanel",ife,t),{children:r,className:o,value:s,classNames:i,styles:a,style:l,mod:c,keepMounted:u,...d}=n,h=qS(),f=h.value===s,p=h.keepMounted||u||f?r:null;return m.jsx(Ce,{...d,...h.getStyles("panel",{className:o,classNames:i,styles:a,style:[l,f?void 0:{display:"none"}],props:n}),ref:e,mod:[{orientation:h.orientation},c],role:"tabpanel",id:h.getPanelId(s),"aria-labelledby":h.getTabId(s),children:p})});KS.classes=$f;KS.displayName="@mantine/core/TabsPanel";const afe={},YS=He((t,e)=>{const n=ie("TabsTab",afe,t),{className:r,children:o,rightSection:s,leftSection:i,value:a,onClick:l,onKeyDown:c,disabled:u,color:d,style:h,classNames:f,styles:p,vars:y,mod:b,tabIndex:w,...k}=n,x=Rr(),{dir:A}=Of(),I=qS(),M=a===I.value,T=_=>{I.onChange(I.allowTabDeactivation&&a===I.value?null:a),l==null||l(_)},S={classNames:f,styles:p,props:n};return m.jsxs(Ll,{...k,...I.getStyles("tab",{className:r,style:h,variant:I.variant,...S}),disabled:u,unstyled:I.unstyled,variant:I.variant,mod:[{active:M,disabled:u,orientation:I.orientation,inverted:I.inverted,placement:I.orientation==="vertical"&&I.placement},b],ref:e,role:"tab",id:I.getTabId(a),"aria-selected":M,tabIndex:w!==void 0?w:M||I.value===null?0:-1,"aria-controls":I.getPanelId(a),onClick:T,__vars:{"--tabs-color":d?ts(d,x):void 0},onKeyDown:fV({siblingSelector:'[role="tab"]',parentSelector:'[role="tablist"]',activateOnFocus:I.activateTabWithKeyboard,loop:I.loop,orientation:I.orientation||"horizontal",dir:A,onKeyDown:c}),children:[i&&m.jsx("span",{...I.getStyles("tabSection",S),"data-position":"left",children:i}),o&&m.jsx("span",{...I.getStyles("tabLabel",S),children:o}),s&&m.jsx("span",{...I.getStyles("tabSection",S),"data-position":"right",children:s})]})});YS.classes=$f;YS.displayName="@mantine/core/TabsTab";const DM="Tabs.Tab or Tabs.Panel component was rendered with invalid value or without value",lfe={keepMounted:!0,orientation:"horizontal",loop:!0,activateTabWithKeyboard:!0,allowTabDeactivation:!1,unstyled:!1,inverted:!1,variant:"default",placement:"left"},cfe=(t,{radius:e,color:n,autoContrast:r})=>({root:{"--tabs-radius":Fn(e),"--tabs-color":ts(n,t),"--tabs-text-color":yue(r,t)?SV({color:n,theme:t,autoContrast:r}):void 0}}),Ds=He((t,e)=>{const n=ie("Tabs",lfe,t),{defaultValue:r,value:o,onChange:s,orientation:i,children:a,loop:l,id:c,activateTabWithKeyboard:u,allowTabDeactivation:d,variant:h,color:f,radius:p,inverted:y,placement:b,keepMounted:w,classNames:k,styles:x,unstyled:A,className:I,style:M,vars:T,autoContrast:S,mod:_,...R}=n,D=Df(c),[O,N]=pu({value:o,defaultValue:r,finalValue:null,onChange:s}),K=Be({name:"Tabs",props:n,classes:$f,className:I,style:M,classNames:k,styles:x,unstyled:A,vars:T,varsResolver:cfe});return m.jsx(ofe,{value:{placement:b,value:O,orientation:i,id:D,loop:l,activateTabWithKeyboard:u,getTabId:iM(`${D}-tab`,DM),getPanelId:iM(`${D}-panel`,DM),onChange:N,allowTabDeactivation:d,variant:h,color:f,radius:p,inverted:y,keepMounted:w,unstyled:A,getStyles:K},children:m.jsx(Ce,{ref:e,id:D,variant:h,mod:[{orientation:i,inverted:i==="horizontal"&&y,placement:i==="vertical"&&b},_],...K("root"),...R,children:a})})});Ds.classes=$f;Ds.displayName="@mantine/core/Tabs";Ds.Tab=YS;Ds.Panel=KS;Ds.List=GS;const ufe={},zb=He((t,e)=>{const n=ie("TextInput",ufe,t);return m.jsx(yu,{component:"input",ref:e,...n,__staticSelector:"TextInput"})});zb.classes=yu.classes;zb.displayName="@mantine/core/TextInput";const f9=(t,e,n=!1)=>{const r=[];function o(s,i="--bn"){for(const a in s){const l=a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),c=`${i}-${l}`;typeof s[a]!="object"?(typeof s[a]=="number"&&(s[a]=`${s[a]}px`),n?e.style.removeProperty(c):e.style.setProperty(c,s[a].toString())):o(s[a],c)}}return o(t),r},NM=(t,e)=>f9(t,e),dfe={colors:{editor:{text:void 0,background:void 0},menu:{text:void 0,background:void 0},tooltip:{text:void 0,background:void 0},hovered:{text:void 0,background:void 0},selected:{text:void 0,background:void 0},disabled:{text:void 0,background:void 0},shadow:void 0,border:void 0,sideMenu:void 0,highlights:{gray:{text:void 0,background:void 0},brown:{text:void 0,background:void 0},red:{text:void 0,background:void 0},orange:{text:void 0,background:void 0},yellow:{text:void 0,background:void 0},green:{text:void 0,background:void 0},blue:{text:void 0,background:void 0},purple:{text:void 0,background:void 0},pink:{text:void 0,background:void 0}}},borderRadius:void 0,fontFamily:void 0},hfe=t=>f9(dfe,t,!0),p9=t=>m.jsxs(Bf,{gap:0,className:"bn-tooltip",children:[m.jsx(ns,{size:"sm",lineClamp:5,children:t.mainTooltip}),t.secondaryTooltip&&m.jsx(ns,{size:"xs",lineClamp:5,children:t.secondaryTooltip})]}),r1=v.forwardRef((t,e)=>{const{className:n,children:r,mainTooltip:o,secondaryTooltip:s,icon:i,isSelected:a,isDisabled:l,onClick:c,label:u,variant:d,...h}=t;Ae(h,!1);const[f,p]=v.useState(!1),y=r?m.jsx(Mo,{"aria-label":u,className:n,onMouseDown:b=>{zw()&&b.currentTarget.focus()},onClick:b=>{p(!0),c==null||c(b)},onPointerLeave:()=>p(!1),"aria-pressed":a,"data-selected":a||void 0,"data-test":o?o.slice(0,1).toLowerCase()+o.replace(/\s+/g,"").slice(1):void 0,size:d==="compact"?"compact-xs":"xs",disabled:l||!1,ref:e,...h,children:r}):m.jsx(jl,{className:n,"aria-label":u,onMouseDown:b=>{zw()&&b.currentTarget.focus()},onClick:b=>{p(!0),c==null||c(b)},onPointerLeave:()=>p(!1),"aria-pressed":a,"data-selected":a||void 0,"data-test":o?o.slice(0,1).toLowerCase()+o.replace(/\s+/g,"").slice(1):void 0,size:d==="compact"?20:30,disabled:l||!1,ref:e,...h,children:i});return o?m.jsx(wu,{disabled:f,withinPortal:!1,label:m.jsx(p9,{mainTooltip:o,secondaryTooltip:s}),children:y}):y}),ffe=v.forwardRef((t,e)=>{const{className:n,text:r,icon:o,isSelected:s,mainTooltip:i,secondaryTooltip:a,onClick:l,onMouseEnter:c,...u}=t;Ae(u,!1);const[d,h]=v.useState(!1),f=m.jsxs(Fb,{className:n,checked:s===!0,wrapperProps:{onMouseEnter:c,onMouseLeave:()=>h(!1),onClick:p=>{h(!0),l==null||l(p)}},variant:"light",icon:null,ref:e,children:[m.jsx("span",{children:o}),m.jsx("span",{children:r})]});return!i||d?f:m.jsx(wu,{refProp:"rootRef",withinPortal:!1,label:m.jsx(p9,{mainTooltip:i,secondaryTooltip:a}),children:f})}),pfe=v.forwardRef((t,e)=>{const{className:n,children:r,...o}=t;return Ae(o),m.jsx(bn,{className:n,ref:e,children:r})}),mfe=v.forwardRef((t,e)=>{const{className:n,children:r,headerText:o,selected:s,onFocus:i,onBlur:a,tabIndex:l,...c}=t;Ae(c,!1);const u=v.useRef(null);return v.useEffect(()=>{var d;s&&((d=u.current)==null||d.scrollIntoView({behavior:"smooth",block:"center"}))},[s]),m.jsxs(Vf,{className:dt(n,s?"selected":""),onFocus:i,onBlur:a,tabIndex:l,ref:lS([e,u]),children:[o&&m.jsx(ns,{className:"bn-header-text",children:o}),r]})}),gfe=v.forwardRef((t,e)=>{const{className:n,children:r,...o}=t;return Ae(o,!1),m.jsx(Vf.Section,{className:n,ref:e,children:r})}),yfe=v.forwardRef((t,e)=>{const{className:n,children:r,...o}=t;return Ae(o,!1),m.jsx(LS,{className:n,label:m.jsx(ns,{children:r}),ref:e})}),bfe=v.forwardRef((t,e)=>{const{authorInfo:n,timeString:r,edited:o,...s}=t;return Ae(s,!1),n==="loading"?m.jsxs(bn,{children:[m.jsx(ry,{height:24,width:24}),m.jsx("div",{children:m.jsx(ry,{height:12,width:100})})]}):m.jsxs(bn,{children:[m.jsx(Bb,{src:n.avatarUrl,alt:n.username,radius:"xl",size:"sm",color:"initials"}),m.jsxs(ns,{fz:"sm",fw:"bold",children:[n.username,m.jsxs(ns,{fz:"xs",c:"dimmed",span:!0,ml:"xs",children:[r," ",o&&"(edited)"]})]})]})}),vfe=v.forwardRef((t,e)=>{const{className:n,showActions:r,authorInfo:o,timeString:s,edited:i,actions:a,children:l,...c}=t,{hovered:u,ref:d}=Tce(),{focused:h,ref:f}=vV(),p=lS([e,d]);return Ae(c,!1),m.jsxs(bn,{pos:"relative",ref:p,className:n,children:[a&&(r===!0||r===void 0||r==="hover"&&u||h)?m.jsx(bn,{ref:f,style:{position:"absolute",right:0,top:0,zIndex:10},children:a}):null,m.jsx(bfe,{...t}),l]})}),wfe=v.forwardRef((t,e)=>{const{className:n,autoFocus:r,onFocus:o,onBlur:s,editor:i,editable:a,...l}=t;return Ae(l,!1),m.jsx(v9,{autoFocus:r,className:n,editor:t.editor,sideMenu:!1,slashMenu:!1,tableHandles:!1,filePanel:!1,formattingToolbar:!1,editable:a,ref:e,onFocus:o,onBlur:s,children:m.jsx(nV,{formattingToolbar:Cfe})})}),Cfe=()=>{const t=eV([]).filter(e=>e.key!=="nestBlockButton"&&e.key!=="unnestBlockButton");return m.jsx(tV,{blockTypeSelectItems:[],children:t})},xfe=v.forwardRef((t,e)=>{const{className:n,name:r,label:o,variant:s,icon:i,value:a,autoFocus:l,placeholder:c,disabled:u,onKeyDown:d,onChange:h,onSubmit:f,autoComplete:p,rightSection:y,...b}=t;return Ae(b),m.jsx(zb,{size:"xs",className:dt(n||"",s==="large"?"bn-mt-input-large":""),ref:e,name:r,label:o,leftSection:i,value:a,autoFocus:l,"data-autofocus":l?"true":void 0,rightSection:y,placeholder:c,disabled:u,onKeyDown:d,onChange:h,onSubmit:f,autoComplete:p})});var m9={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},OM=$.createContext&&$.createContext(m9),kfe=["attr","size","title"];function Sfe(t,e){if(t==null)return{};var n=Efe(t,e),r,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)r=s[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Efe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function oy(){return oy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},oy.apply(this,arguments)}function LM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function sy(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?LM(Object(n),!0).forEach(function(r){Tfe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):LM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Tfe(t,e,n){return e=_fe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _fe(t){var e=Afe(t,"string");return typeof e=="symbol"?e:e+""}function Afe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function g9(t){return t&&t.map((e,n)=>$.createElement(e.tag,sy({key:n},e.attr),g9(e.child)))}function y9(t){return e=>$.createElement(Ife,oy({attr:sy({},t.attr)},e),g9(t.child))}function Ife(t){var e=n=>{var{attr:r,size:o,title:s}=t,i=Sfe(t,kfe),a=o||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),$.createElement("svg",oy({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,i,{className:l,style:sy(sy({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),s&&$.createElement("title",null,s),t.children)};return OM!==void 0?$.createElement(OM.Consumer,null,n=>e(n)):e(m9)}function Mfe(t){return y9({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"},child:[]}]})(t)}function Rfe(t){return y9({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"},child:[]}]})(t)}const b9=v.createContext(void 0),Pfe=v.forwardRef((t,e)=>{const{children:n,onOpenChange:r,position:o,sub:s,...i}=t;Ae(i);const[a,l]=v.useState(!1),c=v.useRef(null),u=v.useRef(),d=v.useCallback(()=>{u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{l(!1)},250)},[]),h=v.useCallback(()=>{u.current&&clearTimeout(u.current),l(!0)},[]);return m.jsx(b9.Provider,{value:{onMenuMouseOver:h,onMenuMouseLeave:d},children:m.jsx(At.Item,{className:"bn-menu-item bn-mt-sub-menu-item",ref:Nf(e,c),onMouseOver:h,onMouseLeave:d,children:m.jsx(At,{portalProps:{target:c.current?c.current.parentElement:void 0},middlewares:{flip:!0,shift:!0,inline:!1,size:!0},trigger:"hover",opened:a,onChange:r,position:o,children:n})})})}),Dfe=t=>{const{children:e,onOpenChange:n,position:r,sub:o,...s}=t;return Ae(s),o?m.jsx(Pfe,{...t}):m.jsx(At,{withinPortal:!1,middlewares:{flip:!0,shift:!0,inline:!1,size:!0},onChange:n,position:r,children:e})},Nfe=v.forwardRef((t,e)=>{const{className:n,children:r,icon:o,checked:s,subTrigger:i,onClick:a,...l}=t;return Ae(l,!1),i?m.jsxs("div",{onClick:c=>{c.preventDefault(),c.stopPropagation()},ref:e,...l,children:[r,m.jsx(Rfe,{size:15})]}):m.jsx(At.Item,{className:n,ref:e,leftSection:o,rightSection:s?m.jsx(MS,{size:10}):s===!1?m.jsx("div",{className:"bn-tick-space"}):null,onClick:a,...l,children:r})}),Ofe=t=>{const{children:e,sub:n,...r}=t;return Ae(r),m.jsx(At.Target,{children:e})},Lfe=v.forwardRef((t,e)=>{const{className:n,children:r,sub:o,...s}=t;Ae(s);const i=v.useContext(b9);return m.jsx(At.Dropdown,{className:n,ref:e,onMouseOver:i==null?void 0:i.onMenuMouseOver,onMouseLeave:i==null?void 0:i.onMenuMouseLeave,children:r})}),Vfe=v.forwardRef((t,e)=>{const{className:n,...r}=t;return Ae(r),m.jsx(At.Divider,{className:n,ref:e})}),jfe=v.forwardRef((t,e)=>{const{className:n,children:r,...o}=t;return Ae(o),m.jsx(At.Label,{className:n,ref:e,children:r})}),Bfe=v.forwardRef((t,e)=>{const{className:n,children:r,icon:o,onClick:s,onDragEnd:i,onDragStart:a,draggable:l,label:c,...u}=t;return Ae(u,!1),o?m.jsx(jl,{size:24,className:n,ref:e,onClick:s,onDragEnd:i,onDragStart:a,draggable:l,"aria-label":c,...u,children:o}):m.jsx(Mo,{className:n,ref:e,onClick:s,onDragEnd:i,onDragStart:a,draggable:l,"aria-label":c,...u,children:r})}),$fe=v.forwardRef((t,e)=>{const{className:n,tabs:r,defaultOpenTab:o,openTab:s,setOpenTab:i,loading:a,...l}=t;return Ae(l),m.jsx(bn,{className:n,ref:e,children:m.jsxs(Ds,{value:s,defaultValue:o,onChange:i,children:[a&&m.jsx(BS,{visible:a}),m.jsx(Ds.List,{children:r.map(c=>m.jsx(Ds.Tab,{"data-test":`${c.name.toLowerCase()}-tab`,value:c.name,children:c.name},c.name))}),r.map(c=>m.jsx(Ds.Panel,{value:c.name,children:c.tabPanel},c.name))]})})}),Ffe=v.forwardRef((t,e)=>{const{className:n,children:r,onClick:o,label:s,...i}=t;return Ae(i),m.jsx(Mo,{size:"xs","aria-label":s,className:n,ref:e,onClick:o,...i,children:r})}),Hfe=v.forwardRef((t,e)=>{const{className:n,accept:r,value:o,placeholder:s,onChange:i,...a}=t;return Ae(a),m.jsx(mhe,{size:"xs",className:n,ref:e,accept:r,value:o,placeholder:s,onChange:i,...a})}),zfe=v.forwardRef((t,e)=>{const{className:n,children:r,...o}=t;return Ae(o),m.jsx("div",{className:n,ref:e,children:r})}),Ufe=v.forwardRef((t,e)=>{const{className:n,value:r,placeholder:o,onKeyDown:s,onChange:i,...a}=t;return Ae(a),m.jsx(zb,{size:"xs","data-test":"embed-input",className:n,ref:e,value:r,placeholder:o,onKeyDown:s,onChange:i})}),Wfe=t=>{const{opened:e,position:n,children:r,...o}=t;return Ae(o),m.jsx(Ca,{withinPortal:!1,opened:e,position:n,children:r})},qfe=t=>{const{children:e,...n}=t;return Ae(n),m.jsx(SS,{children:e})},Gfe=v.forwardRef((t,e)=>{const{className:n,children:r,variant:o,...s}=t;return Ae(s),m.jsx(Pb,{className:n,ref:e,children:r})}),Kfe=v.forwardRef((t,e)=>{const{className:n,children:r,...o}=t;return Ae(o,!1),m.jsx(bn,{align:"center",gap:0,className:n,ref:e,...o,children:r})}),Yfe=v.forwardRef((t,e)=>{const{className:n,children:r,icon:o,onClick:s,onDragEnd:i,onDragStart:a,draggable:l,label:c,...u}=t;return Ae(u,!1),o?m.jsx(jl,{size:24,className:n,ref:e,onClick:s,onDragEnd:i,onDragStart:a,draggable:l,"aria-label":c,...u,children:o}):m.jsx(Mo,{className:n,ref:e,onClick:s,onDragEnd:i,onDragStart:a,draggable:l,"aria-label":c,...u,children:r})}),Xfe=v.forwardRef((t,e)=>{const{className:n,children:r,id:o,...s}=t;return Ae(s),m.jsx(Bf,{gap:0,className:n,ref:e,id:o,role:"listbox",children:r})}),Jfe=v.forwardRef((t,e)=>{const{className:n,children:r,...o}=t;return Ae(o),m.jsx(bn,{className:n,ref:e,children:m.jsx(bn,{className:"bn-mt-suggestion-menu-item-title",children:r})})}),Qfe=v.forwardRef((t,e)=>{const{className:n,isSelected:r,onClick:o,item:s,id:i,...a}=t;Ae(a);const l=v.useRef(null);return v.useEffect(()=>{if(!l.current||!r)return;const c=uV(l.current,document.querySelector(".bn-suggestion-menu, #ai-suggestion-menu"));c==="top"?l.current.scrollIntoView(!0):c==="bottom"&&l.current.scrollIntoView(!1)},[r]),m.jsxs(bn,{gap:0,className:n,ref:Nf(e,l),id:i,role:"option",onMouseDown:c=>c.preventDefault(),onClick:o,"aria-selected":r||void 0,children:[s.icon&&m.jsx(bn,{className:"bn-mt-suggestion-menu-item-section","data-position":"left",children:s.icon}),m.jsxs(Bf,{gap:0,className:"bn-mt-suggestion-menu-item-body",children:[m.jsx(ns,{className:"bn-mt-suggestion-menu-item-title",children:s.title}),m.jsx(ns,{className:"bn-mt-suggestion-menu-item-subtitle",children:s.subtext})]}),s.badge&&m.jsx(bn,{"data-position":"right",className:"bn-mt-suggestion-menu-item-section",children:m.jsx(PS,{size:"xs",children:s.badge})})]})}),Zfe=v.forwardRef((t,e)=>{const{className:n,children:r,...o}=t;return Ae(o),m.jsx(bn,{className:n,ref:e,children:r})}),epe=v.forwardRef((t,e)=>{const{className:n,...r}=t;return Ae(r),m.jsx(xa,{className:n,type:"dots",size:16,ref:e})}),tpe=v.forwardRef((t,e)=>{const{className:n,children:r,id:o,columns:s,...i}=t;return Ae(i),m.jsx("div",{className:n,style:{gridTemplateColumns:`repeat(${s}, 1fr)`},ref:e,id:o,role:"grid",children:r})}),npe=v.forwardRef((t,e)=>{const{className:n,children:r,columns:o,...s}=t;return Ae(s),m.jsx(bn,{className:n,style:{gridColumn:`1 / ${o+1}`},ref:e,children:m.jsx(bn,{className:"bn-mt-suggestion-menu-item-title",children:r})})}),rpe=v.forwardRef((t,e)=>{const{className:n,isSelected:r,onClick:o,item:s,id:i,...a}=t;Ae(a);const l=v.useRef(null);return v.useEffect(()=>{if(!l.current||!r)return;const c=uV(l.current,document.querySelector(".bn-grid-suggestion-menu"));c==="top"?l.current.scrollIntoView(!0):c==="bottom"&&l.current.scrollIntoView(!1)},[r]),m.jsx("div",{className:n,ref:Nf(e,l),id:i,role:"option",onClick:o,"aria-selected":r||void 0,children:s.icon})}),ope=v.forwardRef((t,e)=>{const{className:n,children:r,columns:o,...s}=t;return Ae(s),m.jsx(xa,{className:n,style:{gridColumn:`1 / ${o+1}`},type:"dots",ref:e})}),spe=v.forwardRef((t,e)=>{const{children:n,className:r,onMouseDown:o,onClick:s,...i}=t;return Ae(i,!1),m.jsx(Mo,{className:r,ref:e,onMouseDown:o,onClick:s,...i,children:n})}),ipe=v.forwardRef((t,e)=>{const{className:n,children:r,draggable:o,onDragStart:s,onDragEnd:i,style:a,label:l,...c}=t;return Ae(c,!1),m.jsx(Mo,{className:n,ref:e,"aria-label":l,draggable:o,onDragStart:s,onDragEnd:i,style:a,...c,children:r})}),o1=v.forwardRef((t,e)=>{const{className:n,children:r,onMouseEnter:o,onMouseLeave:s,variant:i,...a}=t;Ae(a);const{ref:l,focused:c}=vV(),u=bV(c),d=Nf(e,l,u);return m.jsx(IS,{className:n,ref:d,role:"toolbar",onMouseEnter:o,onMouseLeave:s,gap:i==="action-toolbar"?2:void 0,children:r})}),s1=v.forwardRef((t,e)=>{const{className:n,items:r,isDisabled:o,...s}=t;Ae(s);const i=r.filter(a=>a.isSelected)[0];return i?m.jsxs(At,{withinPortal:!1,transitionProps:{exitDuration:0},disabled:o,middlewares:{flip:!0,shift:!0,inline:!1,size:!0},children:[m.jsx(At.Target,{children:m.jsx(Mo,{onMouseDown:a=>{zw()&&a.currentTarget.focus()},leftSection:i.icon,rightSection:m.jsx(Mfe,{}),size:"xs",variant:"subtle",disabled:o,children:i.text})}),m.jsx(At.Dropdown,{className:n,ref:e,children:r.map(a=>m.jsx(At.Item,{onClick:a.onClick,leftSection:a.icon,rightSection:a.isSelected?m.jsx(MS,{size:10,className:"bn-tick-icon"}):m.jsx("div",{className:"bn-tick-space"}),disabled:a.isDisabled,children:a.text},a.text))})]}):null}),ape={FormattingToolbar:{Root:o1,Button:r1,Select:s1},FilePanel:{Root:$fe,Button:Ffe,FileInput:Hfe,TabPanel:zfe,TextInput:Ufe},GridSuggestionMenu:{Root:tpe,Item:rpe,EmptyItem:npe,Loader:ope},LinkToolbar:{Root:o1,Button:r1,Select:s1},SideMenu:{Root:Kfe,Button:Yfe},SuggestionMenu:{Root:Xfe,Item:Qfe,EmptyItem:Jfe,Label:Zfe,Loader:epe},TableHandle:{Root:ipe,ExtendButton:spe},Generic:{Badge:{Root:ffe,Group:pfe},Form:{Root:t=>m.jsx("div",{children:t.children}),TextInput:xfe},Menu:{Root:Dfe,Trigger:Ofe,Dropdown:Lfe,Divider:Vfe,Label:jfe,Item:Nfe,Button:Bfe},Popover:{Root:Wfe,Trigger:qfe,Content:Gfe},Toolbar:{Root:o1,Button:r1,Select:s1}},Comments:{Comment:vfe,Editor:wfe,Card:mfe,CardSection:gfe,ExpandSectionsPrompt:yfe}},lpe={activeClassName:""},v9=t=>{const{className:e,theme:n,...r}=t,o=fs(),s=iV(),i=(o==null?void 0:o.colorSchemePreference)||s,a=v.useCallback(c=>{if(c&&(hfe(c),typeof n=="object")){if("light"in n&&"dark"in n){NM(n[i==="dark"?"dark":"light"],c);return}NM(n,c);return}},[i,n]),l=typeof n=="string"?n:i!=="no-preference"?i:"light";return m.jsx(V5.Provider,{value:ape,children:m.jsx(_V,{theme:lpe,cssVariablesSelector:".bn-mantine",getRootElement:()=>{},children:m.jsx(Lle,{"data-mantine-color-scheme":l,className:dt("bn-mantine",e||""),theme:typeof n=="object"?void 0:n,...r,ref:a})})})},cpe="_container_1bxwl_2",upe="_editIcon_1bxwl_9",dpe="_saveButton_1bxwl_16",hpe="_editor_1bxwl_23",fpe="_withoutBorder_1bxwl_28",Ql={container:cpe,editIcon:upe,saveButton:dpe,editor:hpe,withoutBorder:fpe};function Lh({value:t,setValue:e,readOnly:n,classes:r,showEditIcon:o,onClickEdit:s,onClickSave:i,shouldShowSaveButton:a,withoutBorder:l}){const c=xb({domAttributes:{editor:{class:Ql.editor}},initialContent:t}),{theme:u}=Hy();return m.jsxs("div",{className:be(Ql.container,r==null?void 0:r.container,l&&Ql.withoutBorder),children:[n&&o&&m.jsx(ae,{onClick:s,className:Ql.editIcon,icon:"solar:pen-new-square-outline",width:24,height:24}),m.jsx(v9,{className:Ql.editor,editable:!n,theme:u===pl.Dark?"dark":"light",editor:c,onChange:()=>e(c.document)}),a&&!n&&m.jsx(Gt,{onClick:i,className:Ql.saveButton,children:"Save"})]})}const ppe="_input_1f9pd_2",mpe="_unit_1f9pd_8",gpe="_footerCenter_1f9pd_13",ype="_submitBtn_1f9pd_19",Yp={input:ppe,unit:mpe,footerCenter:gpe,submitBtn:ype},bpe="checklist_record",Cu=()=>{const[t,e]=Yr(bpe,{});return{addChecklistRecord:s=>{s.records.length&&e(i=>({...i,[s.checklistTemplateId]:[...i[s.checklistTemplateId]||[],...s.records.map(a=>({id:qn(),...a,checklistId:s.checklistId,checklistTemplateId:s.checklistTemplateId,createdAt:s.createdAt}))]}))},getChecklistRecords:(s,{rangeDate:i,type:a="date",fieldIds:l,sortBy:c,sortDirection:u="asc"})=>{const d=s?t[s]||[]:Object.values(t).flat();let h=d;if(i&&(h=d.filter(p=>{const y=new Date(p.createdAt);return y>=new Date(i.from)&&y<=new Date(i.to)})),l&&l.length&&(h=h.filter(p=>l.includes(p.fieldId))),c)switch(c){case"createdAt":{h=h.sort((p,y)=>{const b=new Date(p.createdAt),w=new Date(y.createdAt);return b.getTime()-w.getTime()});break}}return u==="desc"&&(h=h.reverse()),h.reduce((p,y)=>{const b=new Date(y.createdAt),w=a==="date"?UH(b,"yyyy-MM-dd"):b.toISOString();return p[w]||(p[w]=[]),p[w].push(y),p},{})},updateChecklistRecord:(s,{value:i,checklistTemplateId:a,folderId:l})=>{e(c=>{const d=(c[a]||[]).map(h=>h.id===s?{...h,value:i,...l!==void 0&&{folderId:l}}:h);return{...c,[a]:d}})},deleteChecklistRecord:(s,{checklistTemplateId:i})=>{e(a=>{const c=(a[i]||[]).filter(u=>u.id!==s);return{...a,[i]:c}})}}},vpe=({fields:t,checklistTemplate:e,checklist:n,currentDay:r,onSubmit:o})=>{const[s,i]=$.useState(t.reduce((l,{id:c})=>({...l,[c]:void 0}),{})),{addChecklistRecord:a}=Cu();return m.jsxs(m.Fragment,{children:[t.map(l=>{switch(l==null?void 0:l.type){case"metric":return m.jsx(Ft.ItemMeta,{logo:m.jsx(ae,{width:24,icon:l.icon}),title:l.title,rightComponent:m.jsxs(m.Fragment,{children:[m.jsx(jo,{onChange:c=>{i({...s,[l.id]:Number(c.target.value)})},border:"dash",className:Yp.input,type:"number"}),m.jsx(me.Text,{className:Yp.unit,children:l.unit})]})});case"note":return m.jsxs(m.Fragment,{children:[m.jsx(Ft.ItemMeta,{logo:m.jsx(ae,{width:24,icon:l.icon}),title:l.title}),m.jsx(Lh,{withoutBorder:!0,value:s==null?void 0:s[l.id],setValue:c=>{i({...s,[l.id]:c})}})]})}}),m.jsx("div",{className:Yp.footerCenter,children:m.jsx(Gt,{size:"lg",className:Yp.submitBtn,onClick:()=>{if(e){const l=new Date,c=GH(YH(XH(KH(new Date(r),l.getMilliseconds()),l.getSeconds()),l.getMinutes()),l.getHours());a({checklistId:n.id,checklistTemplateId:e.id,createdAt:c.toISOString(),records:Object.entries(s).map(([u,d])=>({fieldId:u,value:d}))}),o==null||o()}},children:"Submit"})})]})},wpe="_iconEdit_1c1sv_6",Cpe="_icon_1c1sv_6",xpe="_successIcon_1c1sv_14",kpe="_input_1c1sv_18",Spe="_editButton_1c1sv_24",Epe="_editIcon_1c1sv_30",Tpe="_highlight_1c1sv_34",so={iconEdit:wpe,icon:Cpe,successIcon:xpe,input:kpe,editButton:Spe,editIcon:Epe,highlight:Tpe},_pe=({record:t,fields:e,setRecord:n})=>{const{updateChecklistRecord:r}=Cu(),o=e.find(l=>l.id===t.fieldId);if(!o)return;const[s,i]=$.useState(),a=$.useRef(null);switch(o.type){case"metric":return m.jsx(m.Fragment,{children:m.jsx(Ft.ItemMeta,{logo:m.jsx(ae,{width:24,icon:o.icon}),title:o.title,rightComponent:(s==null?void 0:s.id)===t.id?m.jsxs(m.Fragment,{children:[m.jsx(jo,{value:s.value,ref:a,autoFocus:!0,border:"dash",className:so.input,onChange:l=>{i({...t,value:Number(l.target.value)})}}),m.jsx(ae,{width:24,className:so.icon,onClick:()=>{i(void 0)},icon:"proicons:cancel"}),m.jsx(ae,{width:24,className:so.icon,onClick:()=>{var l,c;r(t.id,{checklistTemplateId:t.checklistTemplateId,value:Number((l=a.current)==null?void 0:l.value)}),n({...t,value:Number((c=a.current)==null?void 0:c.value)}),i(void 0)},icon:"material-symbols:check"})]}):m.jsxs(m.Fragment,{children:[m.jsxs(me.Text,{children:[" ",t.value]}),m.jsx(ae,{width:24,className:so.iconEdit,onClick:()=>{i(t),setTimeout(()=>{var l;return(l=a==null?void 0:a.current)==null?void 0:l.focus()},100)},icon:"solar:pen-2-line-duotone"})]})})});case"note":default:return m.jsxs("div",{children:[m.jsx(Ft.ItemMeta,{logo:m.jsx(ae,{width:24,icon:o.icon}),title:o.title,rightComponent:(s==null?void 0:s.id)!==t.id?m.jsx(m.Fragment,{children:m.jsxs(Gt,{type:"dash",size:"sm",className:so.editButton,onClick:()=>{i(t)},children:[m.jsx(ae,{icon:"solar:pen-new-square-linear",className:so.editIcon}),"Edit"]})}):m.jsxs(m.Fragment,{children:[m.jsxs(Gt,{type:"dash",size:"sm",className:so.editButton,onClick:()=>{i(void 0)},children:[m.jsx(ae,{width:12,className:so.icon,icon:"proicons:cancel"}),"Cancel"]}),m.jsxs(Gt,{type:"dash",size:"sm",className:be(so.editButton,so.highlight),onClick:()=>{r(t.id,{checklistTemplateId:t.checklistTemplateId,value:s.value}),n({...t,value:s.value}),i(void 0)},children:[m.jsx(ae,{width:12,className:so.successIcon,icon:"material-symbols:check"}),"Save"]})]})}),(s==null?void 0:s.id)===t.id&&m.jsx(Lh,{withoutBorder:!0,value:(s==null?void 0:s.id)!==t.id?t.value:s.value,setValue:l=>{i({...t,value:l})}}),(s==null?void 0:s.id)!==t.id&&m.jsx(Lh,{value:t.value,withoutBorder:!0,readOnly:!0})]})}},Ape="_recordSection_icmxe_2",Ipe="_hr_icmxe_6",Mpe="_hrSide_icmxe_13",Rpe="_hrContainer_icmxe_18",Ppe="_dateText_icmxe_28",Dpe="_deleteButton_icmxe_36",Npe="_deleteIcon_icmxe_43",io={recordSection:Ape,hr:Ipe,hrSide:Mpe,hrContainer:Rpe,dateText:Ppe,deleteButton:Dpe,deleteIcon:Npe},Ope=({checklistTemplate:t,fields:e})=>{const{getChecklistRecords:n,deleteChecklistRecord:r}=Cu(),[o,s]=$.useState({});return $.useEffect(()=>{const i=n(t.id,{rangeDate:{from:SN(new Date).toISOString(),to:kN(new Date).toISOString()},type:"time",fieldIds:e.map(a=>a.id),sortDirection:"desc"});s(i)},[]),m.jsx("div",{className:io.recordSection,children:Object.entries(o).map(([i,a],l)=>m.jsxs("div",{children:[m.jsxs("div",{className:io.hrContainer,children:[m.jsx("div",{className:be(io.hrSide,l===0&&io.noHr)}),m.jsx(me.Text,{className:io.dateText,children:new Date(i).toLocaleString()}),m.jsx("div",{className:be(io.hr,l===0&&io.noHr)}),m.jsxs(Gt,{type:"dash",size:"sm",className:io.deleteButton,onClick:()=>{a.forEach(u=>{r(u.id,{checklistTemplateId:u.checklistTemplateId})});const c={...o};delete c[i],s(c)},children:[m.jsx(ae,{icon:"solar:trash-bin-trash-outline",className:io.deleteIcon}),"Delete"]}),m.jsx("div",{className:be(io.hrSide,l===0&&io.noHr)})]}),a.map(c=>m.jsx(_pe,{record:c,setRecord:u=>{s({...o,[i]:o[i].map(d=>d.id===u.id?u:d)})},fields:e}))]}))})},Lpe="_container_3gh2y_2",Vpe="_iconSuccess_3gh2y_7",jpe="_emptyContainer_3gh2y_13",Bpe="_iconEmpty_3gh2y_22",$pe="_itemEmptyContainer_3gh2y_26",od={container:Lpe,iconSuccess:Vpe,emptyContainer:jpe,iconEmpty:Bpe,itemEmptyContainer:$pe},Fpe=t=>t.reduce((e,n)=>e+n,0),Hpe=({checklistTemplate:t,fields:e,currentDay:n})=>{const r=kn(),{getChecklistRecords:o}=Cu(),[s,i]=$.useState([]),a=()=>{const l=o(t.id,{rangeDate:{from:new Date(new Date(n).setHours(0,0,0,0)).toISOString(),to:new Date(new Date(n).setHours(23,59,59,999)).toISOString()},fieldIds:e.map(c=>c.id),sortDirection:"desc"});return i(Object.values(l)),l};return $.useEffect(()=>{a()},[]),s.length===0?m.jsxs("div",{children:[e.map(l=>m.jsx("div",{className:od.itemEmptyContainer,children:m.jsx(Ft.ItemMeta,{logo:m.jsx(ae,{width:24,icon:l.icon}),title:l.title})})),m.jsxs("div",{className:od.emptyContainer,children:[m.jsx(ae,{width:80,icon:"clarity:sad-face-line",className:od.iconEmpty}),m.jsx(me.Title,{level:3,noMargin:!0,children:r.formatMessage({id:"ChecklistFieldGroupView.noRecord",defaultMessage:"No record found"})}),m.jsx(me.Paragraph,{noMargin:!0,children:r.formatMessage({id:"ChecklistFieldGroupView.noRecordDescription",defaultMessage:"Submit your record to keep track of your progress"})})]})]}):m.jsxs("div",{className:od.container,children:[m.jsx(ae,{width:100,color:"rgba(16,154,0,0.16)",icon:"ion:checkmark-done-circle-outline",className:od.iconSuccess}),e.map(l=>{if(l.type==="metric"){const c=Object.values(s).flat().filter(d=>d.fieldId===l.id),u=Fpe(c.map(d=>d.value));return m.jsx(Ft.ItemMeta,{logo:m.jsx(ae,{width:24,icon:l.icon}),title:l.title,rightComponent:m.jsx(m.Fragment,{children:m.jsxs(me.Text,{children:[u," ",l.unit]})})})}else{const c=Object.values(s).flat().find(u=>u.fieldId===l.id);return c?m.jsxs(m.Fragment,{children:[m.jsx(Ft.ItemMeta,{logo:m.jsx(ae,{width:24,icon:l.icon}),title:l.title}),m.jsx(Lh,{value:c.value,readOnly:!0,withoutBorder:!0})]}):null}})]})},zpe=t=>t.reduce((e,n)=>e+n,0),Upe=({checklistTemplateId:t,fields:e})=>{const{theme:n}=Hy(),{getChecklistRecords:r}=Cu(),[o,s]=$.useState({});$.useEffect(()=>{const l=r(t,{rangeDate:{from:SN(new Date).toISOString(),to:kN(new Date).toISOString()},sortBy:"createdAt",fieldIds:e.filter(h=>h.type==="metric").map(h=>h.id)}),c=Object.keys(l),u=Object.values(l),d=e.reduce((h,f,p)=>{const y=u.map(b=>{const w=b.filter(k=>k.fieldId===f.id).map(k=>k.value);return zpe(w)});return{...h,[f.id]:y}},{});s({categories:c,seriesValues:d})},[]);const i=e.map(l=>{var c;return{name:l.title,data:(c=o==null?void 0:o.seriesValues)==null?void 0:c[l.id]}}),a={...n===pl.Dark?{theme:{mode:"dark"},chart:{background:"#162033"}}:{},xaxis:{categories:o.categories}};return{series:i,options:a}};var Wpe=P$();const w9=D$(Wpe),qpe=({checklistTemplateId:t,fields:e})=>{const{options:n,series:r}=Upe({checklistTemplateId:t,fields:e});return m.jsx(w9,{options:n,series:r,type:"bar"})},Gpe=({checklist:t,checklistTemplate:e,fields:n,currentDay:r})=>{const o=qH(r),{updateChecklist:s}=Fy(),[i,a]=$.useState(e.fieldGroups.reduce((u,d)=>({...u,[d.id]:Wn.Home}),{})),l=u=>({[Wn.Home]:`${o?"Today":new Date(r).toLocaleDateString()}`,[Wn.History]:"Record History",[Wn.Add]:"Add Record",[Wn.Metric]:"Metric"})[i[u.id]],c=({fieldGroup:u,fieldDetails:d})=>{switch(i[u.id]){case Wn.Home:return m.jsx(Hpe,{fields:d,checklistTemplate:e,checklist:t,currentDay:r});case Wn.History:return m.jsx(Ope,{fields:d,checklistTemplate:e});case Wn.Metric:return m.jsx(qpe,{fields:n,checklistTemplateId:e.id});case Wn.Add:return m.jsx(vpe,{fields:d,checklistTemplate:e,checklist:t,currentDay:r,onSubmit:()=>{a({...i,[u.id]:Wn.Home}),s({id:t.id,completedAt:new Date().toISOString()})}})}};return e.fieldGroups.map(u=>{const d=u.fields.map(h=>n.find(f=>f.id===h));return m.jsxs(Xr,{className:qU.cardContainer,children:[m.jsx(UU,{activeTab:i[u.id],onClickHome:()=>a({...i,[u.id]:Wn.Home}),onClickHistory:()=>a({...i,[u.id]:Wn.History}),onClickAdd:()=>a({...i,[u.id]:Wn.Add}),onClickMetric:()=>a({...i,[u.id]:Wn.Metric}),renderTitle:()=>l(u)}),c({fieldGroup:u,fieldDetails:d})]})})},Kpe=()=>{const{id:t}=uN(),[e,n]=vN(),{getChecklistTemplate:r}=Xi(),{addChecklist:o,getChecklistDetail:s}=Fy(),{getRecordFields:i}=Uy(),a=e.get("checklistId"),l=e.get("currentDay"),[c,u]=$.useState(),[d,h]=$.useState(),[f,p]=$.useState([]);if(!t||!l)return;$.useEffect(()=>{var k;const b=r(t);if(u(b),!b)return;const w=i((k=b.fieldGroups)==null?void 0:k.map(x=>x.fields).flat());if(p(w),a){const x=s(a);h(x)}else{const x=o({title:b.title,checklistTemplateId:t,startedAt:new Date(l).toISOString(),endedAt:new Date(l).toISOString()});n({...Object.fromEntries(e),checklistId:x.id}),h(x)}},[a]);const y=Ao();return!a||!d||!c?null:m.jsxs(m.Fragment,{children:[m.jsx(ou,{renderLeftComponent:()=>m.jsx("div",{children:c==null?void 0:c.title}),renderRightComponent:()=>m.jsx(ae,{onClick:()=>{y(`/edit-checklist/${t}`)},width:24,icon:"solar:pen-new-square-linear"}),onClickLeftButton:()=>y("/")}),m.jsx(Gpe,{checklist:d,checklistTemplate:c,fields:f,currentDay:l})]})},Ype="_input_1t6d7_1",Xpe={input:Ype},Jpe=t=>{const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`},C9=({value:t,onChange:e,className:n})=>m.jsx("input",{className:be(Xpe.input,n),type:"date",value:t?Jpe(new Date(t)):"",onChange:e}),Qpe="_container_1ew1v_1",Zpe="_lg_1ew1v_6",VM={container:Qpe,lg:Zpe};function XS({size:t,className:e,disabled:n,...r}){return m.jsx("input",{className:be(VM.container,t==="lg"&&VM.lg,e),type:"checkbox",disabled:n,...r})}const eme="_container_a6kby_1",tme="_label_a6kby_7",nme="_card_a6kby_16",rme="_datePicker_a6kby_21",ome="_datePickerContainer_a6kby_27",sme="_checklistItem_a6kby_34",ime="_checklistBody_a6kby_40",ame="_checkbox_a6kby_45",lme="_footer_a6kby_50",ao={container:eme,label:tme,card:nme,datePicker:rme,datePickerContainer:ome,checklistItem:sme,checklistBody:ime,checkbox:ame,footer:lme},cme=()=>{var u;const[t,e]=Yr("user_new",!1),n=kn(),{baby:r,setBaby:o,calculateStartDateFromDueDate:s}=QH(),{getRecommendChecklistTemplates:i,selectedChecklistTemplates:a,updateSelectedChecklistTemplate:l}=Xi(),c=()=>{e(!1),window.location.reload()};return m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:ao.container,children:[m.jsx(Xr,{className:ao.card,children:m.jsxs(m.Fragment,{children:[m.jsx("p",{className:ao.label,children:n.formatMessage({id:"PregnantIntro.label-enter-the-due-date",defaultMessage:"When's the little one's due date?"})}),m.jsx("div",{className:ao.datePickerContainer,children:m.jsx(C9,{value:((u=r==null?void 0:r.dueDate)==null?void 0:u.split("T")[0])||new Date(new Date().getTime()+40*7*24*60*60*1e3).toISOString().split("T")[0],onChange:d=>o({...r,dueDate:d.target.value,startDate:s(d.target.value)}),className:ao.datePicker})})]})}),m.jsx(Xr,{className:ao.card,children:m.jsxs(m.Fragment,{children:[m.jsx("p",{className:ao.label,children:n.formatMessage({id:"PregnantIntro.checklists",defaultMessage:"Pick the tasks you'd love to do every day!"})}),i().map(({id:d,title:h,avatar:f})=>m.jsxs("div",{className:ao.checklistItem,children:[m.jsx(ae,{color:f.color||"#8A8A8A",width:32,height:32,icon:f.name}),m.jsx("p",{className:ao.checklistBody,children:h}),m.jsx(XS,{checked:a.includes(d),onChange:p=>{const y=p.target.checked;l(y?[...a,d]:a.filter(b=>b!==d))},className:ao.checkbox})]},d))]})})]}),m.jsx("div",{className:ao.footer,onClick:c,children:m.jsx(Gt,{size:"lg",children:"Submit"})})]})},ume="_input_k71ix_2",dme={input:ume},hme=({date:t,setDate:e})=>{const n=kn();return m.jsx("div",{children:m.jsx(Ft.ItemMeta,{logo:m.jsx(ae,{width:24,icon:"solar:calendar-date-line-duotone"}),title:n.formatMessage({defaultMessage:"Start Day",id:"label-start-day.label"}),description:n.formatMessage({defaultMessage:"Select the first day",id:"label-start-day.description"}),rightComponent:m.jsx(C9,{value:t,onChange:r=>e(r.target.value),className:dme.input})})})};function fme({className:t,...e}){return m.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"#00000075",className:be(pf.icon,t),...e,children:m.jsx("g",{id:"done_24px",children:m.jsx("path",{id:"icon/action/done_24px",d:"M8.80004 15.905L5.30004 12.405C5.11519 12.2178 4.86309 12.1125 4.60004 12.1125C4.33699 12.1125 4.0849 12.2178 3.90004 12.405C3.51004 12.795 3.51004 13.415 3.90004 13.805L8.09004 17.995C8.48004 18.385 9.11004 18.385 9.50004 17.995L20.1 7.40499C20.49 7.01499 20.49 6.39499 20.1 6.00499C19.9152 5.81784 19.6631 5.71251 19.4 5.71251C19.137 5.71251 18.8849 5.81784 18.7 6.00499L8.80004 15.905Z"})})})}const pme="_container_sb3l2_2",mme="_button_sb3l2_10",gme="_icon_sb3l2_18",yme="_activeIcon_sb3l2_24",bme="_activeButton_sb3l2_28",sd={container:pme,button:mme,icon:gme,activeIcon:yme,activeButton:bme};function vme({options:t,values:e=[],setValues:n=()=>{}}){return m.jsx("div",{className:sd.container,children:t.map(r=>{const o=e.includes(r.value);return m.jsxs(Gt,{type:"ghost",className:be(sd.button,o&&sd.activeButton),onClick:()=>{n(o?e.filter(s=>s!==r.value):[...e,r.value])},children:[m.jsx(fme,{className:be(sd.icon,o&&sd.activeIcon)}),r.label]},`${r.label}-${r.value}`)})})}var JS=Hf(),Ee=t=>Ff(t,JS),QS=Hf();Ee.write=t=>Ff(t,QS);var Ub=Hf();Ee.onStart=t=>Ff(t,Ub);var ZS=Hf();Ee.onFrame=t=>Ff(t,ZS);var eE=Hf();Ee.onFinish=t=>Ff(t,eE);var Tc=[];Ee.setTimeout=(t,e)=>{const n=Ee.now()+e,r=()=>{const s=Tc.findIndex(i=>i.cancel==r);~s&&Tc.splice(s,1),Bi-=~s?1:0},o={time:n,handler:t,cancel:r};return Tc.splice(x9(n),0,o),Bi+=1,k9(),o};var x9=t=>~(~Tc.findIndex(e=>e.time>t)||~Tc.length);Ee.cancel=t=>{Ub.delete(t),ZS.delete(t),eE.delete(t),JS.delete(t),QS.delete(t)};Ee.sync=t=>{pC=!0,Ee.batchedUpdates(t),pC=!1};Ee.throttle=t=>{let e;function n(){try{t(...e)}finally{e=null}}function r(...o){e=o,Ee.onStart(n)}return r.handler=t,r.cancel=()=>{Ub.delete(n),e=null},r};var tE=typeof window<"u"?window.requestAnimationFrame:()=>{};Ee.use=t=>tE=t;Ee.now=typeof performance<"u"?()=>performance.now():Date.now;Ee.batchedUpdates=t=>t();Ee.catch=console.error;Ee.frameLoop="always";Ee.advance=()=>{Ee.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):E9()};var ji=-1,Bi=0,pC=!1;function Ff(t,e){pC?(e.delete(t),t(0)):(e.add(t),k9())}function k9(){ji<0&&(ji=0,Ee.frameLoop!=="demand"&&tE(S9))}function wme(){ji=-1}function S9(){~ji&&(tE(S9),Ee.batchedUpdates(E9))}function E9(){const t=ji;ji=Ee.now();const e=x9(ji);if(e&&(T9(Tc.splice(0,e),n=>n.handler()),Bi-=e),!Bi){wme();return}Ub.flush(),JS.flush(t?Math.min(64,ji-t):16.667),ZS.flush(),QS.flush(),eE.flush()}function Hf(){let t=new Set,e=t;return{add(n){Bi+=e==t&&!t.has(n)?1:0,t.add(n)},delete(n){return Bi-=e==t&&t.has(n)?1:0,t.delete(n)},flush(n){e.size&&(t=new Set,Bi-=e.size,T9(e,r=>r(n)&&t.add(r)),Bi+=t.size,e=t)}}}function T9(t,e){t.forEach(n=>{try{e(n)}catch(r){Ee.catch(r)}})}var Cme=Object.defineProperty,xme=(t,e)=>{for(var n in e)Cme(t,n,{get:e[n],enumerable:!0})},So={};xme(So,{assign:()=>Sme,colors:()=>Ui,createStringInterpolator:()=>rE,skipAnimation:()=>A9,to:()=>_9,willAdvance:()=>oE});function mC(){}var kme=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),Y={arr:Array.isArray,obj:t=>!!t&&t.constructor.name==="Object",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",und:t=>t===void 0};function As(t,e){if(Y.arr(t)){if(!Y.arr(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return t===e}var je=(t,e)=>t.forEach(e);function rs(t,e,n){if(Y.arr(t)){for(let r=0;r<t.length;r++)e.call(n,t[r],`${r}`);return}for(const r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r)}var kr=t=>Y.und(t)?[]:Y.arr(t)?t:[t];function $d(t,e){if(t.size){const n=Array.from(t);t.clear(),je(n,e)}}var wd=(t,...e)=>$d(t,n=>n(...e)),nE=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),rE,_9,Ui=null,A9=!1,oE=mC,Sme=t=>{t.to&&(_9=t.to),t.now&&(Ee.now=t.now),t.colors!==void 0&&(Ui=t.colors),t.skipAnimation!=null&&(A9=t.skipAnimation),t.createStringInterpolator&&(rE=t.createStringInterpolator),t.requestAnimationFrame&&Ee.use(t.requestAnimationFrame),t.batchedUpdates&&(Ee.batchedUpdates=t.batchedUpdates),t.willAdvance&&(oE=t.willAdvance),t.frameLoop&&(Ee.frameLoop=t.frameLoop)},Fd=new Set,Wr=[],i1=[],iy=0,Wb={get idle(){return!Fd.size&&!Wr.length},start(t){iy>t.priority?(Fd.add(t),Ee.onStart(Eme)):(I9(t),Ee(gC))},advance:gC,sort(t){if(iy)Ee.onFrame(()=>Wb.sort(t));else{const e=Wr.indexOf(t);~e&&(Wr.splice(e,1),M9(t))}},clear(){Wr=[],Fd.clear()}};function Eme(){Fd.forEach(I9),Fd.clear(),Ee(gC)}function I9(t){Wr.includes(t)||M9(t)}function M9(t){Wr.splice(Tme(Wr,e=>e.priority>t.priority),0,t)}function gC(t){const e=i1;for(let n=0;n<Wr.length;n++){const r=Wr[n];iy=r.priority,r.idle||(oE(r),r.advance(t),r.idle||e.push(r))}return iy=0,i1=Wr,i1.length=0,Wr=e,Wr.length>0}function Tme(t,e){const n=t.findIndex(e);return n<0?t.length:n}var _me={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},go="[-+]?\\d*\\.?\\d+",ay=go+"%";function qb(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}var Ame=new RegExp("rgb"+qb(go,go,go)),Ime=new RegExp("rgba"+qb(go,go,go,go)),Mme=new RegExp("hsl"+qb(go,ay,ay)),Rme=new RegExp("hsla"+qb(go,ay,ay,go)),Pme=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Dme=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Nme=/^#([0-9a-fA-F]{6})$/,Ome=/^#([0-9a-fA-F]{8})$/;function Lme(t){let e;return typeof t=="number"?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=Nme.exec(t))?parseInt(e[1]+"ff",16)>>>0:Ui&&Ui[t]!==void 0?Ui[t]:(e=Ame.exec(t))?(Zl(e[1])<<24|Zl(e[2])<<16|Zl(e[3])<<8|255)>>>0:(e=Ime.exec(t))?(Zl(e[1])<<24|Zl(e[2])<<16|Zl(e[3])<<8|$M(e[4]))>>>0:(e=Pme.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=Ome.exec(t))?parseInt(e[1],16)>>>0:(e=Dme.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=Mme.exec(t))?(jM(BM(e[1]),Xp(e[2]),Xp(e[3]))|255)>>>0:(e=Rme.exec(t))?(jM(BM(e[1]),Xp(e[2]),Xp(e[3]))|$M(e[4]))>>>0:null}function a1(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function jM(t,e,n){const r=n<.5?n*(1+e):n+e-n*e,o=2*n-r,s=a1(o,r,t+1/3),i=a1(o,r,t),a=a1(o,r,t-1/3);return Math.round(s*255)<<24|Math.round(i*255)<<16|Math.round(a*255)<<8}function Zl(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function BM(t){return(parseFloat(t)%360+360)%360/360}function $M(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(e*255)}function Xp(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function FM(t){let e=Lme(t);if(e===null)return t;e=e||0;const n=(e&4278190080)>>>24,r=(e&16711680)>>>16,o=(e&65280)>>>8,s=(e&255)/255;return`rgba(${n}, ${r}, ${o}, ${s})`}var Vh=(t,e,n)=>{if(Y.fun(t))return t;if(Y.arr(t))return Vh({range:t,output:e,extrapolate:n});if(Y.str(t.output[0]))return rE(t);const r=t,o=r.output,s=r.range||[0,1],i=r.extrapolateLeft||r.extrapolate||"extend",a=r.extrapolateRight||r.extrapolate||"extend",l=r.easing||(c=>c);return c=>{const u=jme(c,s);return Vme(c,s[u],s[u+1],o[u],o[u+1],l,i,a,r.map)}};function Vme(t,e,n,r,o,s,i,a,l){let c=l?l(t):t;if(c<e){if(i==="identity")return c;i==="clamp"&&(c=e)}if(c>n){if(a==="identity")return c;a==="clamp"&&(c=n)}return r===o?r:e===n?t<=e?r:o:(e===-1/0?c=-c:n===1/0?c=c-e:c=(c-e)/(n-e),c=s(c),r===-1/0?c=-c:o===1/0?c=c+r:c=c*(o-r)+r,c)}function jme(t,e){for(var n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}var Bme={linear:t=>t},jh=Symbol.for("FluidValue.get"),Wc=Symbol.for("FluidValue.observers"),Fr=t=>!!(t&&t[jh]),ar=t=>t&&t[jh]?t[jh]():t,HM=t=>t[Wc]||null;function $me(t,e){t.eventObserved?t.eventObserved(e):t(e)}function Bh(t,e){const n=t[Wc];n&&n.forEach(r=>{$me(r,e)})}var R9=class{constructor(t){if(!t&&!(t=this.get))throw Error("Unknown getter");Fme(this,t)}},Fme=(t,e)=>P9(t,jh,e);function xu(t,e){if(t[jh]){let n=t[Wc];n||P9(t,Wc,n=new Set),n.has(e)||(n.add(e),t.observerAdded&&t.observerAdded(n.size,e))}return e}function $h(t,e){const n=t[Wc];if(n&&n.has(e)){const r=n.size-1;r?n.delete(e):t[Wc]=null,t.observerRemoved&&t.observerRemoved(r,e)}}var P9=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),Rm=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Hme=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,zM=new RegExp(`(${Rm.source})(%|[a-z]+)`,"i"),zme=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,Gb=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,D9=t=>{const[e,n]=Ume(t);if(!e||nE())return t;const r=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(r)return r.trim();if(n&&n.startsWith("--")){const o=window.getComputedStyle(document.documentElement).getPropertyValue(n);return o||t}else{if(n&&Gb.test(n))return D9(n);if(n)return n}return t},Ume=t=>{const e=Gb.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]},l1,Wme=(t,e,n,r,o)=>`rgba(${Math.round(e)}, ${Math.round(n)}, ${Math.round(r)}, ${o})`,N9=t=>{l1||(l1=Ui?new RegExp(`(${Object.keys(Ui).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map(s=>ar(s).replace(Gb,D9).replace(Hme,FM).replace(l1,FM)),n=e.map(s=>s.match(Rm).map(Number)),o=n[0].map((s,i)=>n.map(a=>{if(!(i in a))throw Error('The arity of each "output" value must be equal');return a[i]})).map(s=>Vh({...t,output:s}));return s=>{var l;const i=!zM.test(e[0])&&((l=e.find(c=>zM.test(c)))==null?void 0:l.replace(Rm,""));let a=0;return e[0].replace(Rm,()=>`${o[a++](s)}${i||""}`).replace(zme,Wme)}},sE="react-spring: ",O9=t=>{const e=t;let n=!1;if(typeof e!="function")throw new TypeError(`${sE}once requires a function parameter`);return(...r)=>{n||(e(...r),n=!0)}},qme=O9(console.warn);function Gme(){qme(`${sE}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var Kme=O9(console.warn);function Yme(){Kme(`${sE}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function Kb(t){return Y.str(t)&&(t[0]=="#"||/\d/.test(t)||!nE()&&Gb.test(t)||t in(Ui||{}))}var iE=nE()?v.useEffect:v.useLayoutEffect,Xme=()=>{const t=v.useRef(!1);return iE(()=>(t.current=!0,()=>{t.current=!1}),[]),t};function L9(){const t=v.useState()[1],e=Xme();return()=>{e.current&&t(Math.random())}}var V9=t=>v.useEffect(t,Jme),Jme=[];function UM(t){const e=v.useRef(void 0);return v.useEffect(()=>{e.current=t}),e.current}var Fh=Symbol.for("Animated:node"),Qme=t=>!!t&&t[Fh]===t,Lo=t=>t&&t[Fh],aE=(t,e)=>kme(t,Fh,e),Yb=t=>t&&t[Fh]&&t[Fh].getPayload(),j9=class{constructor(){aE(this,this)}getPayload(){return this.payload||[]}},Xb=class B9 extends j9{constructor(e){super(),this._value=e,this.done=!0,this.durationProgress=0,Y.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new B9(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,n){return Y.num(e)&&(this.lastPosition=e,n&&(e=Math.round(e/n)*n,this.done&&(this.lastPosition=e))),this._value===e?!1:(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,Y.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}},ly=class $9 extends Xb{constructor(e){super(0),this._string=null,this._toString=Vh({output:[e,e]})}static create(e){return new $9(e)}getValue(){const e=this._string;return e??(this._string=this._toString(this._value))}setValue(e){if(Y.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else if(super.setValue(e))this._string=null;else return!1;return!0}reset(e){e&&(this._toString=Vh({output:[this.getValue(),e]})),this._value=0,super.reset()}},cy={dependencies:null},Jb=class extends j9{constructor(t){super(),this.source=t,this.setValue(t)}getValue(t){const e={};return rs(this.source,(n,r)=>{Qme(n)?e[r]=n.getValue(t):Fr(n)?e[r]=ar(n):t||(e[r]=n)}),e}setValue(t){this.source=t,this.payload=this._makePayload(t)}reset(){this.payload&&je(this.payload,t=>t.reset())}_makePayload(t){if(t){const e=new Set;return rs(t,this._addToPayload,e),Array.from(e)}}_addToPayload(t){cy.dependencies&&Fr(t)&&cy.dependencies.add(t);const e=Yb(t);e&&je(e,n=>this.add(n))}},Zme=class F9 extends Jb{constructor(e){super(e)}static create(e){return new F9(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){const n=this.getPayload();return e.length==n.length?n.map((r,o)=>r.setValue(e[o])).some(Boolean):(super.setValue(e.map(ege)),!0)}};function ege(t){return(Kb(t)?ly:Xb).create(t)}function yC(t){const e=Lo(t);return e?e.constructor:Y.arr(t)?Zme:Kb(t)?ly:Xb}var WM=(t,e)=>{const n=!Y.fun(t)||t.prototype&&t.prototype.isReactComponent;return v.forwardRef((r,o)=>{const s=v.useRef(null),i=n&&v.useCallback(p=>{s.current=rge(o,p)},[o]),[a,l]=nge(r,e),c=L9(),u=()=>{const p=s.current;if(n&&!p)return;(p?e.applyAnimatedValues(p,a.getValue(!0)):!1)===!1&&c()},d=new tge(u,l),h=v.useRef(void 0);iE(()=>(h.current=d,je(l,p=>xu(p,d)),()=>{h.current&&(je(h.current.deps,p=>$h(p,h.current)),Ee.cancel(h.current.update))})),v.useEffect(u,[]),V9(()=>()=>{const p=h.current;je(p.deps,y=>$h(y,p))});const f=e.getComponentProps(a.getValue());return v.createElement(t,{...f,ref:i})})},tge=class{constructor(t,e){this.update=t,this.deps=e}eventObserved(t){t.type=="change"&&Ee.write(this.update)}};function nge(t,e){const n=new Set;return cy.dependencies=n,t.style&&(t={...t,style:e.createAnimatedStyle(t.style)}),t=new Jb(t),cy.dependencies=null,[t,n]}function rge(t,e){return t&&(Y.fun(t)?t(e):t.current=e),e}var qM=Symbol.for("AnimatedComponent"),oge=(t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:n=o=>new Jb(o),getComponentProps:r=o=>o}={})=>{const o={applyAnimatedValues:e,createAnimatedStyle:n,getComponentProps:r},s=i=>{const a=GM(i)||"Anonymous";return Y.str(i)?i=s[i]||(s[i]=WM(i,o)):i=i[qM]||(i[qM]=WM(i,o)),i.displayName=`Animated(${a})`,i};return rs(t,(i,a)=>{Y.arr(t)&&(a=GM(i)),s[a]=s(i)}),{animated:s}},GM=t=>Y.str(t)?t:t&&Y.str(t.displayName)?t.displayName:Y.fun(t)&&t.name||null;function Ka(t,...e){return Y.fun(t)?t(...e):t}var Hd=(t,e)=>t===!0||!!(e&&t&&(Y.fun(t)?t(e):kr(t).includes(e))),H9=(t,e)=>Y.obj(t)?e&&t[e]:t,z9=(t,e)=>t.default===!0?t[e]:t.default?t.default[e]:void 0,sge=t=>t,lE=(t,e=sge)=>{let n=ige;t.default&&t.default!==!0&&(t=t.default,n=Object.keys(t));const r={};for(const o of n){const s=e(t[o],o);Y.und(s)||(r[o]=s)}return r},ige=["config","onProps","onStart","onChange","onPause","onResume","onRest"],age={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function lge(t){const e={};let n=0;if(rs(t,(r,o)=>{age[o]||(e[o]=r,n++)}),n)return e}function U9(t){const e=lge(t);if(e){const n={to:e};return rs(t,(r,o)=>o in e||(n[o]=r)),n}return{...t}}function Hh(t){return t=ar(t),Y.arr(t)?t.map(Hh):Kb(t)?So.createStringInterpolator({range:[0,1],output:[t,t]})(1):t}function cge(t){for(const e in t)return!0;return!1}function bC(t){return Y.fun(t)||Y.arr(t)&&Y.obj(t[0])}function uge(t,e){var n;(n=t.ref)==null||n.delete(t),e==null||e.delete(t)}function dge(t,e){var n;e&&t.ref!==e&&((n=t.ref)==null||n.delete(t),e.add(t),t.ref=e)}var hge={default:{tension:170,friction:26}},vC={...hge.default,mass:1,damping:1,easing:Bme.linear,clamp:!1},fge=class{constructor(){this.velocity=0,Object.assign(this,vC)}};function pge(t,e,n){n&&(n={...n},KM(n,e),e={...n,...e}),KM(t,e),Object.assign(t,e);for(const i in vC)t[i]==null&&(t[i]=vC[i]);let{frequency:r,damping:o}=t;const{mass:s}=t;return Y.und(r)||(r<.01&&(r=.01),o<0&&(o=0),t.tension=Math.pow(2*Math.PI/r,2)*s,t.friction=4*Math.PI*o*s/r),t}function KM(t,e){if(!Y.und(e.decay))t.duration=void 0;else{const n=!Y.und(e.tension)||!Y.und(e.friction);(n||!Y.und(e.frequency)||!Y.und(e.damping)||!Y.und(e.mass))&&(t.duration=void 0,t.decay=void 0),n&&(t.frequency=void 0)}}var YM=[],mge=class{constructor(){this.changed=!1,this.values=YM,this.toValues=null,this.fromValues=YM,this.config=new fge,this.immediate=!1}};function W9(t,{key:e,props:n,defaultProps:r,state:o,actions:s}){return new Promise((i,a)=>{let l,c,u=Hd(n.cancel??(r==null?void 0:r.cancel),e);if(u)f();else{Y.und(n.pause)||(o.paused=Hd(n.pause,e));let p=r==null?void 0:r.pause;p!==!0&&(p=o.paused||Hd(p,e)),l=Ka(n.delay||0,e),p?(o.resumeQueue.add(h),s.pause()):(s.resume(),h())}function d(){o.resumeQueue.add(h),o.timeouts.delete(c),c.cancel(),l=c.time-Ee.now()}function h(){l>0&&!So.skipAnimation?(o.delayed=!0,c=Ee.setTimeout(f,l),o.pauseQueue.add(d),o.timeouts.add(c)):f()}function f(){o.delayed&&(o.delayed=!1),o.pauseQueue.delete(d),o.timeouts.delete(c),t<=(o.cancelId||0)&&(u=!0);try{s.start({...n,callId:t,cancel:u},i)}catch(p){a(p)}}})}var cE=(t,e)=>e.length==1?e[0]:e.some(n=>n.cancelled)?_c(t.get()):e.every(n=>n.noop)?q9(t.get()):ho(t.get(),e.every(n=>n.finished)),q9=t=>({value:t,noop:!0,finished:!0,cancelled:!1}),ho=(t,e,n=!1)=>({value:t,finished:e,cancelled:n}),_c=t=>({value:t,cancelled:!0,finished:!1});function G9(t,e,n,r){const{callId:o,parentId:s,onRest:i}=e,{asyncTo:a,promise:l}=n;return!s&&t===a&&!e.reset?l:n.promise=(async()=>{n.asyncId=o,n.asyncTo=t;const c=lE(e,(b,w)=>w==="onRest"?void 0:b);let u,d;const h=new Promise((b,w)=>(u=b,d=w)),f=b=>{const w=o<=(n.cancelId||0)&&_c(r)||o!==n.asyncId&&ho(r,!1);if(w)throw b.result=w,d(b),b},p=(b,w)=>{const k=new XM,x=new JM;return(async()=>{if(So.skipAnimation)throw zh(n),x.result=ho(r,!1),d(x),x;f(k);const A=Y.obj(b)?{...b}:{...w,to:b};A.parentId=o,rs(c,(M,T)=>{Y.und(A[T])&&(A[T]=M)});const I=await r.start(A);return f(k),n.paused&&await new Promise(M=>{n.resumeQueue.add(M)}),I})()};let y;if(So.skipAnimation)return zh(n),ho(r,!1);try{let b;Y.arr(t)?b=(async w=>{for(const k of w)await p(k)})(t):b=Promise.resolve(t(p,r.stop.bind(r))),await Promise.all([b.then(u),h]),y=ho(r.get(),!0,!1)}catch(b){if(b instanceof XM)y=b.result;else if(b instanceof JM)y=b.result;else throw b}finally{o==n.asyncId&&(n.asyncId=s,n.asyncTo=s?a:void 0,n.promise=s?l:void 0)}return Y.fun(i)&&Ee.batchedUpdates(()=>{i(y,r,r.item)}),y})()}function zh(t,e){$d(t.timeouts,n=>n.cancel()),t.pauseQueue.clear(),t.resumeQueue.clear(),t.asyncId=t.asyncTo=t.promise=void 0,e&&(t.cancelId=e)}var XM=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},JM=class extends Error{constructor(){super("SkipAnimationSignal")}},wC=t=>t instanceof uE,gge=1,uE=class extends R9{constructor(){super(...arguments),this.id=gge++,this._priority=0}get priority(){return this._priority}set priority(t){this._priority!=t&&(this._priority=t,this._onPriorityChange(t))}get(){const t=Lo(this);return t&&t.getValue()}to(...t){return So.to(this,t)}interpolate(...t){return Gme(),So.to(this,t)}toJSON(){return this.get()}observerAdded(t){t==1&&this._attach()}observerRemoved(t){t==0&&this._detach()}_attach(){}_detach(){}_onChange(t,e=!1){Bh(this,{type:"change",parent:this,value:t,idle:e})}_onPriorityChange(t){this.idle||Wb.sort(this),Bh(this,{type:"priority",parent:this,priority:t})}},Il=Symbol.for("SpringPhase"),K9=1,Y9=2,X9=4,c1=t=>(t[Il]&K9)>0,vi=t=>(t[Il]&Y9)>0,id=t=>(t[Il]&X9)>0,QM=(t,e)=>e?t[Il]|=Y9|K9:t[Il]&=-3,ZM=(t,e)=>e?t[Il]|=X9:t[Il]&=-5,yge=class extends uE{constructor(t,e){if(super(),this.animation=new mge,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!Y.und(t)||!Y.und(e)){const n=Y.obj(t)?{...t}:{...e,from:t};Y.und(n.default)&&(n.default=!0),this.start(n)}}get idle(){return!(vi(this)||this._state.asyncTo)||id(this)}get goal(){return ar(this.animation.to)}get velocity(){const t=Lo(this);return t instanceof Xb?t.lastVelocity||0:t.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return c1(this)}get isAnimating(){return vi(this)}get isPaused(){return id(this)}get isDelayed(){return this._state.delayed}advance(t){let e=!0,n=!1;const r=this.animation;let{toValues:o}=r;const{config:s}=r,i=Yb(r.to);!i&&Fr(r.to)&&(o=kr(ar(r.to))),r.values.forEach((c,u)=>{if(c.done)return;const d=c.constructor==ly?1:i?i[u].lastPosition:o[u];let h=r.immediate,f=d;if(!h){if(f=c.lastPosition,s.tension<=0){c.done=!0;return}let p=c.elapsedTime+=t;const y=r.fromValues[u],b=c.v0!=null?c.v0:c.v0=Y.arr(s.velocity)?s.velocity[u]:s.velocity;let w;const k=s.precision||(y==d?.005:Math.min(1,Math.abs(d-y)*.001));if(Y.und(s.duration))if(s.decay){const x=s.decay===!0?.998:s.decay,A=Math.exp(-(1-x)*p);f=y+b/(1-x)*(1-A),h=Math.abs(c.lastPosition-f)<=k,w=b*A}else{w=c.lastVelocity==null?b:c.lastVelocity;const x=s.restVelocity||k/10,A=s.clamp?0:s.bounce,I=!Y.und(A),M=y==d?c.v0>0:y<d;let T,S=!1;const _=1,R=Math.ceil(t/_);for(let D=0;D<R&&(T=Math.abs(w)>x,!(!T&&(h=Math.abs(d-f)<=k,h)));++D){I&&(S=f==d||f>d==M,S&&(w=-w*A,f=d));const O=-s.tension*1e-6*(f-d),N=-s.friction*.001*w,K=(O+N)/s.mass;w=w+K*_,f=f+w*_}}else{let x=1;s.duration>0&&(this._memoizedDuration!==s.duration&&(this._memoizedDuration=s.duration,c.durationProgress>0&&(c.elapsedTime=s.duration*c.durationProgress,p=c.elapsedTime+=t)),x=(s.progress||0)+p/this._memoizedDuration,x=x>1?1:x<0?0:x,c.durationProgress=x),f=y+s.easing(x)*(d-y),w=(f-c.lastPosition)/t,h=x==1}c.lastVelocity=w,Number.isNaN(f)&&(console.warn("Got NaN while animating:",this),h=!0)}i&&!i[u].done&&(h=!1),h?c.done=!0:e=!1,c.setValue(f,s.round)&&(n=!0)});const a=Lo(this),l=a.getValue();if(e){const c=ar(r.to);(l!==c||n)&&!s.decay?(a.setValue(c),this._onChange(c)):n&&s.decay&&this._onChange(l),this._stop()}else n&&this._onChange(l)}set(t){return Ee.batchedUpdates(()=>{this._stop(),this._focus(t),this._set(t)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(vi(this)){const{to:t,config:e}=this.animation;Ee.batchedUpdates(()=>{this._onStart(),e.decay||this._set(t,!1),this._stop()})}return this}update(t){return(this.queue||(this.queue=[])).push(t),this}start(t,e){let n;return Y.und(t)?(n=this.queue||[],this.queue=[]):n=[Y.obj(t)?t:{...e,to:t}],Promise.all(n.map(r=>this._update(r))).then(r=>cE(this,r))}stop(t){const{to:e}=this.animation;return this._focus(this.get()),zh(this._state,t&&this._lastCallId),Ee.batchedUpdates(()=>this._stop(e,t)),this}reset(){this._update({reset:!0})}eventObserved(t){t.type=="change"?this._start():t.type=="priority"&&(this.priority=t.priority+1)}_prepareNode(t){const e=this.key||"";let{to:n,from:r}=t;n=Y.obj(n)?n[e]:n,(n==null||bC(n))&&(n=void 0),r=Y.obj(r)?r[e]:r,r==null&&(r=void 0);const o={to:n,from:r};return c1(this)||(t.reverse&&([n,r]=[r,n]),r=ar(r),Y.und(r)?Lo(this)||this._set(n):this._set(r)),o}_update({...t},e){const{key:n,defaultProps:r}=this;t.default&&Object.assign(r,lE(t,(i,a)=>/^on/.test(a)?H9(i,n):i)),tR(this,t,"onProps"),ld(this,"onProps",t,this);const o=this._prepareNode(t);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const s=this._state;return W9(++this._lastCallId,{key:n,props:t,defaultProps:r,state:s,actions:{pause:()=>{id(this)||(ZM(this,!0),wd(s.pauseQueue),ld(this,"onPause",ho(this,ad(this,this.animation.to)),this))},resume:()=>{id(this)&&(ZM(this,!1),vi(this)&&this._resume(),wd(s.resumeQueue),ld(this,"onResume",ho(this,ad(this,this.animation.to)),this))},start:this._merge.bind(this,o)}}).then(i=>{if(t.loop&&i.finished&&!(e&&i.noop)){const a=J9(t);if(a)return this._update(a,!0)}return i})}_merge(t,e,n){if(e.cancel)return this.stop(!0),n(_c(this));const r=!Y.und(t.to),o=!Y.und(t.from);if(r||o)if(e.callId>this._lastToId)this._lastToId=e.callId;else return n(_c(this));const{key:s,defaultProps:i,animation:a}=this,{to:l,from:c}=a;let{to:u=l,from:d=c}=t;o&&!r&&(!e.default||Y.und(u))&&(u=d),e.reverse&&([u,d]=[d,u]);const h=!As(d,c);h&&(a.from=d),d=ar(d);const f=!As(u,l);f&&this._focus(u);const p=bC(e.to),{config:y}=a,{decay:b,velocity:w}=y;(r||o)&&(y.velocity=0),e.config&&!p&&pge(y,Ka(e.config,s),e.config!==i.config?Ka(i.config,s):void 0);let k=Lo(this);if(!k||Y.und(u))return n(ho(this,!0));const x=Y.und(e.reset)?o&&!e.default:!Y.und(d)&&Hd(e.reset,s),A=x?d:this.get(),I=Hh(u),M=Y.num(I)||Y.arr(I)||Kb(I),T=!p&&(!M||Hd(i.immediate||e.immediate,s));if(f){const D=yC(u);if(D!==k.constructor)if(T)k=this._set(I);else throw Error(`Cannot animate between ${k.constructor.name} and ${D.name}, as the "to" prop suggests`)}const S=k.constructor;let _=Fr(u),R=!1;if(!_){const D=x||!c1(this)&&h;(f||D)&&(R=As(Hh(A),I),_=!R),(!As(a.immediate,T)&&!T||!As(y.decay,b)||!As(y.velocity,w))&&(_=!0)}if(R&&vi(this)&&(a.changed&&!x?_=!0:_||this._stop(l)),!p&&((_||Fr(l))&&(a.values=k.getPayload(),a.toValues=Fr(u)?null:S==ly?[1]:kr(I)),a.immediate!=T&&(a.immediate=T,!T&&!x&&this._set(l)),_)){const{onRest:D}=a;je(vge,N=>tR(this,e,N));const O=ho(this,ad(this,l));wd(this._pendingCalls,O),this._pendingCalls.add(n),a.changed&&Ee.batchedUpdates(()=>{var N;a.changed=!x,D==null||D(O,this),x?Ka(i.onRest,O):(N=a.onStart)==null||N.call(a,O,this)})}x&&this._set(A),p?n(G9(e.to,e,this._state,this)):_?this._start():vi(this)&&!f?this._pendingCalls.add(n):n(q9(A))}_focus(t){const e=this.animation;t!==e.to&&(HM(this)&&this._detach(),e.to=t,HM(this)&&this._attach())}_attach(){let t=0;const{to:e}=this.animation;Fr(e)&&(xu(e,this),wC(e)&&(t=e.priority+1)),this.priority=t}_detach(){const{to:t}=this.animation;Fr(t)&&$h(t,this)}_set(t,e=!0){const n=ar(t);if(!Y.und(n)){const r=Lo(this);if(!r||!As(n,r.getValue())){const o=yC(n);!r||r.constructor!=o?aE(this,o.create(n)):r.setValue(n),r&&Ee.batchedUpdates(()=>{this._onChange(n,e)})}}return Lo(this)}_onStart(){const t=this.animation;t.changed||(t.changed=!0,ld(this,"onStart",ho(this,ad(this,t.to)),this))}_onChange(t,e){e||(this._onStart(),Ka(this.animation.onChange,t,this)),Ka(this.defaultProps.onChange,t,this),super._onChange(t,e)}_start(){const t=this.animation;Lo(this).reset(ar(t.to)),t.immediate||(t.fromValues=t.values.map(e=>e.lastPosition)),vi(this)||(QM(this,!0),id(this)||this._resume())}_resume(){So.skipAnimation?this.finish():Wb.start(this)}_stop(t,e){if(vi(this)){QM(this,!1);const n=this.animation;je(n.values,o=>{o.done=!0}),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),Bh(this,{type:"idle",parent:this});const r=e?_c(this.get()):ho(this.get(),ad(this,t??n.to));wd(this._pendingCalls,r),n.changed&&(n.changed=!1,ld(this,"onRest",r,this))}}};function ad(t,e){const n=Hh(e),r=Hh(t.get());return As(r,n)}function J9(t,e=t.loop,n=t.to){const r=Ka(e);if(r){const o=r!==!0&&U9(r),s=(o||t).reverse,i=!o||o.reset;return Uh({...t,loop:e,default:!1,pause:void 0,to:!s||bC(n)?n:void 0,from:i?t.from:void 0,reset:i,...o})}}function Uh(t){const{to:e,from:n}=t=U9(t),r=new Set;return Y.obj(e)&&eR(e,r),Y.obj(n)&&eR(n,r),t.keys=r.size?Array.from(r):null,t}function bge(t){const e=Uh(t);return Y.und(e.default)&&(e.default=lE(e)),e}function eR(t,e){rs(t,(n,r)=>n!=null&&e.add(r))}var vge=["onStart","onRest","onChange","onPause","onResume"];function tR(t,e,n){t.animation[n]=e[n]!==z9(e,n)?H9(e[n],t.key):void 0}function ld(t,e,...n){var r,o,s,i;(o=(r=t.animation)[e])==null||o.call(r,...n),(i=(s=t.defaultProps)[e])==null||i.call(s,...n)}var wge=["onStart","onChange","onRest"],Cge=1,xge=class{constructor(t,e){this.id=Cge++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),e&&(this._flush=e),t&&this.start({default:!0,...t})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(t=>t.idle&&!t.isDelayed&&!t.isPaused)}get item(){return this._item}set item(t){this._item=t}get(){const t={};return this.each((e,n)=>t[n]=e.get()),t}set(t){for(const e in t){const n=t[e];Y.und(n)||this.springs[e].set(n)}}update(t){return t&&this.queue.push(Uh(t)),this}start(t){let{queue:e}=this;return t?e=kr(t).map(Uh):this.queue=[],this._flush?this._flush(this,e):(nj(this,e),CC(this,e))}stop(t,e){if(t!==!!t&&(e=t),e){const n=this.springs;je(kr(e),r=>n[r].stop(!!t))}else zh(this._state,this._lastAsyncId),this.each(n=>n.stop(!!t));return this}pause(t){if(Y.und(t))this.start({pause:!0});else{const e=this.springs;je(kr(t),n=>e[n].pause())}return this}resume(t){if(Y.und(t))this.start({pause:!1});else{const e=this.springs;je(kr(t),n=>e[n].resume())}return this}each(t){rs(this.springs,t)}_onFrame(){const{onStart:t,onChange:e,onRest:n}=this._events,r=this._active.size>0,o=this._changed.size>0;(r&&!this._started||o&&!this._started)&&(this._started=!0,$d(t,([a,l])=>{l.value=this.get(),a(l,this,this._item)}));const s=!r&&this._started,i=o||s&&n.size?this.get():null;o&&e.size&&$d(e,([a,l])=>{l.value=i,a(l,this,this._item)}),s&&(this._started=!1,$d(n,([a,l])=>{l.value=i,a(l,this,this._item)}))}eventObserved(t){if(t.type=="change")this._changed.add(t.parent),t.idle||this._active.add(t.parent);else if(t.type=="idle")this._active.delete(t.parent);else return;Ee.onFrame(this._onFrame)}};function CC(t,e){return Promise.all(e.map(n=>Q9(t,n))).then(n=>cE(t,n))}async function Q9(t,e,n){const{keys:r,to:o,from:s,loop:i,onRest:a,onResolve:l}=e,c=Y.obj(e.default)&&e.default;i&&(e.loop=!1),o===!1&&(e.to=null),s===!1&&(e.from=null);const u=Y.arr(o)||Y.fun(o)?o:void 0;u?(e.to=void 0,e.onRest=void 0,c&&(c.onRest=void 0)):je(wge,y=>{const b=e[y];if(Y.fun(b)){const w=t._events[y];e[y]=({finished:k,cancelled:x})=>{const A=w.get(b);A?(k||(A.finished=!1),x&&(A.cancelled=!0)):w.set(b,{value:null,finished:k||!1,cancelled:x||!1})},c&&(c[y]=e[y])}});const d=t._state;e.pause===!d.paused?(d.paused=e.pause,wd(e.pause?d.pauseQueue:d.resumeQueue)):d.paused&&(e.pause=!0);const h=(r||Object.keys(t.springs)).map(y=>t.springs[y].start(e)),f=e.cancel===!0||z9(e,"cancel")===!0;(u||f&&d.asyncId)&&h.push(W9(++t._lastAsyncId,{props:e,state:d,actions:{pause:mC,resume:mC,start(y,b){f?(zh(d,t._lastAsyncId),b(_c(t))):(y.onRest=a,b(G9(u,y,d,t)))}}})),d.paused&&await new Promise(y=>{d.resumeQueue.add(y)});const p=cE(t,await Promise.all(h));if(i&&p.finished&&!(n&&p.noop)){const y=J9(e,i,o);if(y)return nj(t,[y]),Q9(t,y,!0)}return l&&Ee.batchedUpdates(()=>l(p,t,t.item)),p}function nR(t,e){const n={...t.springs};return e&&je(kr(e),r=>{Y.und(r.keys)&&(r=Uh(r)),Y.obj(r.to)||(r={...r,to:void 0}),tj(n,r,o=>ej(o))}),Z9(t,n),n}function Z9(t,e){rs(e,(n,r)=>{t.springs[r]||(t.springs[r]=n,xu(n,t))})}function ej(t,e){const n=new yge;return n.key=t,e&&xu(n,e),n}function tj(t,e,n){e.keys&&je(e.keys,r=>{(t[r]||(t[r]=n(r)))._prepareNode(e)})}function nj(t,e){je(e,n=>{tj(t.springs,n,r=>ej(r,t))})}var kge=v.createContext({pause:!1,immediate:!1}),Sge=()=>{const t=[],e=function(r){Yme();const o=[];return je(t,(s,i)=>{if(Y.und(r))o.push(s.start());else{const a=n(r,s,i);a&&o.push(s.start(a))}}),o};e.current=t,e.add=function(r){t.includes(r)||t.push(r)},e.delete=function(r){const o=t.indexOf(r);~o&&t.splice(o,1)},e.pause=function(){return je(t,r=>r.pause(...arguments)),this},e.resume=function(){return je(t,r=>r.resume(...arguments)),this},e.set=function(r){je(t,(o,s)=>{const i=Y.fun(r)?r(s,o):r;i&&o.set(i)})},e.start=function(r){const o=[];return je(t,(s,i)=>{if(Y.und(r))o.push(s.start());else{const a=this._getProps(r,s,i);a&&o.push(s.start(a))}}),o},e.stop=function(){return je(t,r=>r.stop(...arguments)),this},e.update=function(r){return je(t,(o,s)=>o.update(this._getProps(r,o,s))),this};const n=function(r,o,s){return Y.fun(r)?r(s,o):r};return e._getProps=n,e};function Ege(t,e,n){const r=Y.fun(e)&&e;r&&!n&&(n=[]);const o=v.useMemo(()=>r||arguments.length==3?Sge():void 0,[]),s=v.useRef(0),i=L9(),a=v.useMemo(()=>({ctrls:[],queue:[],flush(w,k){const x=nR(w,k);return s.current>0&&!a.queue.length&&!Object.keys(x).some(I=>!w.springs[I])?CC(w,k):new Promise(I=>{Z9(w,x),a.queue.push(()=>{I(CC(w,k))}),i()})}}),[]),l=v.useRef([...a.ctrls]),c=v.useRef([]);c.current??(c.current=[]);const u=UM(t)||0;v.useMemo(()=>{je(l.current.slice(t,u),w=>{uge(w,o),w.stop(!0)}),l.current.length=t,d(u,t)},[t]),v.useMemo(()=>{d(0,Math.min(u,t))},n);function d(w,k){for(let x=w;x<k;x++){const A=l.current[x]||(l.current[x]=new xge(null,a.flush)),I=r?r(x,A):e[x];I&&(c.current[x]=bge(I))}}const h=l.current.map((w,k)=>nR(w,c.current[k])),f=v.useContext(kge),p=UM(f),y=f!==p&&cge(f);iE(()=>{s.current++,a.ctrls=l.current;const{queue:w}=a;w.length&&(a.queue=[],je(w,k=>k())),je(l.current,(k,x)=>{o==null||o.add(k),y&&k.start({default:f});const A=c.current[x];A&&(dge(k,A.ref),k.ref?k.queue.push(A):k.start(A)),c.current[x]=null})}),V9(()=>()=>{je(a.ctrls,w=>w.stop(!0))});const b=h.map(w=>({...w}));return o?[b,o]:b}function Qb(t,e){const n=Y.fun(t),[[r],o]=Ege(1,n?t:[t],n?[]:e);return n||arguments.length==2?[r,o]:r}var Tge=class extends uE{constructor(t,e){super(),this.source=t,this.idle=!0,this._active=new Set,this.calc=Vh(...e);const n=this._get(),r=yC(n);aE(this,r.create(n))}advance(t){const e=this._get(),n=this.get();As(e,n)||(Lo(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&rR(this._active)&&u1(this)}_get(){const t=Y.arr(this.source)?this.source.map(ar):kr(ar(this.source));return this.calc(...t)}_start(){this.idle&&!rR(this._active)&&(this.idle=!1,je(Yb(this),t=>{t.done=!1}),So.skipAnimation?(Ee.batchedUpdates(()=>this.advance()),u1(this)):Wb.start(this))}_attach(){let t=1;je(kr(this.source),e=>{Fr(e)&&xu(e,this),wC(e)&&(e.idle||this._active.add(e),t=Math.max(t,e.priority+1))}),this.priority=t,this._start()}_detach(){je(kr(this.source),t=>{Fr(t)&&$h(t,this)}),this._active.clear(),u1(this)}eventObserved(t){t.type=="change"?t.idle?this.advance():(this._active.add(t.parent),this._start()):t.type=="idle"?this._active.delete(t.parent):t.type=="priority"&&(this.priority=kr(this.source).reduce((e,n)=>Math.max(e,(wC(n)?n.priority:0)+1),0))}};function _ge(t){return t.idle!==!1}function rR(t){return!t.size||Array.from(t).every(_ge)}function u1(t){t.idle||(t.idle=!0,je(Yb(t),e=>{e.done=!0}),Bh(t,{type:"idle",parent:t}))}So.assign({createStringInterpolator:N9,to:(t,e)=>new Tge(t,e)});var rj=/^--/;function Age(t,e){return e==null||typeof e=="boolean"||e===""?"":typeof e=="number"&&e!==0&&!rj.test(t)&&!(zd.hasOwnProperty(t)&&zd[t])?e+"px":(""+e).trim()}var oR={};function Ige(t,e){if(!t.nodeType||!t.setAttribute)return!1;const n=t.nodeName==="filter"||t.parentNode&&t.parentNode.nodeName==="filter",{className:r,style:o,children:s,scrollTop:i,scrollLeft:a,viewBox:l,...c}=e,u=Object.values(c),d=Object.keys(c).map(h=>n||t.hasAttribute(h)?h:oR[h]||(oR[h]=h.replace(/([A-Z])/g,f=>"-"+f.toLowerCase())));s!==void 0&&(t.textContent=s);for(const h in o)if(o.hasOwnProperty(h)){const f=Age(h,o[h]);rj.test(h)?t.style.setProperty(h,f):t.style[h]=f}d.forEach((h,f)=>{t.setAttribute(h,u[f])}),r!==void 0&&(t.className=r),i!==void 0&&(t.scrollTop=i),a!==void 0&&(t.scrollLeft=a),l!==void 0&&t.setAttribute("viewBox",l)}var zd={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mge=(t,e)=>t+e.charAt(0).toUpperCase()+e.substring(1),Rge=["Webkit","Ms","Moz","O"];zd=Object.keys(zd).reduce((t,e)=>(Rge.forEach(n=>t[Mge(n,e)]=t[e]),t),zd);var Pge=/^(matrix|translate|scale|rotate|skew)/,Dge=/^(translate)/,Nge=/^(rotate|skew)/,d1=(t,e)=>Y.num(t)&&t!==0?t+e:t,Pm=(t,e)=>Y.arr(t)?t.every(n=>Pm(n,e)):Y.num(t)?t===e:parseFloat(t)===e,Oge=class extends Jb{constructor({x:t,y:e,z:n,...r}){const o=[],s=[];(t||e||n)&&(o.push([t||0,e||0,n||0]),s.push(i=>[`translate3d(${i.map(a=>d1(a,"px")).join(",")})`,Pm(i,0)])),rs(r,(i,a)=>{if(a==="transform")o.push([i||""]),s.push(l=>[l,l===""]);else if(Pge.test(a)){if(delete r[a],Y.und(i))return;const l=Dge.test(a)?"px":Nge.test(a)?"deg":"";o.push(kr(i)),s.push(a==="rotate3d"?([c,u,d,h])=>[`rotate3d(${c},${u},${d},${d1(h,l)})`,Pm(h,0)]:c=>[`${a}(${c.map(u=>d1(u,l)).join(",")})`,Pm(c,a.startsWith("scale")?1:0)])}}),o.length&&(r.transform=new Lge(o,s)),super(r)}},Lge=class extends R9{constructor(t,e){super(),this.inputs=t,this.transforms=e,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let t="",e=!0;return je(this.inputs,(n,r)=>{const o=ar(n[0]),[s,i]=this.transforms[r](Y.arr(o)?o:n.map(ar));t+=" "+s,e=e&&i}),e?"none":t}observerAdded(t){t==1&&je(this.inputs,e=>je(e,n=>Fr(n)&&xu(n,this)))}observerRemoved(t){t==0&&je(this.inputs,e=>je(e,n=>Fr(n)&&$h(n,this)))}eventObserved(t){t.type=="change"&&(this._value=null),Bh(this,t)}},Vge=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];So.assign({batchedUpdates:gn.unstable_batchedUpdates,createStringInterpolator:N9,colors:_me});var jge=oge(Vge,{applyAnimatedValues:Ige,createAnimatedStyle:t=>new Oge(t),getComponentProps:({scrollTop:t,scrollLeft:e,...n})=>n}),Wh=jge.animated;const Bge="_container_32ncs_1",$ge="_checkedContainer_32ncs_14",Fge="_handle_32ncs_18",h1={container:Bge,checkedContainer:$ge,handle:Fge},Hge=26;function zge({checked:t,onChange:e}){const n=Qb({translateX:t?Hge:0});return m.jsx("div",{className:be(h1.container,t&&h1.checkedContainer),onClick:()=>e(!t),children:m.jsx(Wh.div,{style:{transform:n.translateX.to(r=>`translateX(${r}px)`)},className:h1.handle})})}function Uge(t){return m.jsx("svg",{width:"24",height:"24",fill:"#00000075",viewBox:"0 0 448 512",className:pf.icon,...t,children:m.jsx("path",{d:"M224 232C237.3 232 248 242.7 248 256V304H296C309.3 304 320 314.7 320 328C320 341.3 309.3 352 296 352H248V400C248 413.3 237.3 424 224 424C210.7 424 200 413.3 200 400V352H152C138.7 352 128 341.3 128 328C128 314.7 138.7 304 152 304H200V256C200 242.7 210.7 232 224 232zM152 64H296V24C296 10.75 306.7 0 320 0C333.3 0 344 10.75 344 24V64H384C419.3 64 448 92.65 448 128V448C448 483.3 419.3 512 384 512H64C28.65 512 0 483.3 0 448V128C0 92.65 28.65 64 64 64H104V24C104 10.75 114.7 0 128 0C141.3 0 152 10.75 152 24V64zM48 448C48 456.8 55.16 464 64 464H384C392.8 464 400 456.8 400 448V192H48V448z"})})}const Wge="_container_16drl_1",qge={container:Wge};var xe=(t=>(t.Mon="mon",t.Tue="tue",t.Thu="thu",t.Wed="wed",t.Fri="fri",t.Sat="sat",t.Sun="sun",t))(xe||{});$.createContext({createTask:()=>{},changeTaskStatus:()=>{},deleteTask:()=>{},updateTask:()=>{},currentTaskIds:[],setCurrentTaskIds:()=>{},getTaskDetail:()=>{},cancelProcessingTask:()=>{},createTaskFromWeeklyHobby:()=>{},getRecommendedTasks:()=>[],filter:{showDoneTask:!1,disableAddProgressTaskAtTop:!1,showAllTask:!1},setFilter:()=>{}});xe.Mon,xe.Tue,xe.Thu,xe.Wed,xe.Fri,xe.Sat,xe.Sun;const Gge=({className:t,values:e,setValues:n})=>{const r=kn(),o=Qb({maxHeight:!e||e.length===0?0:80});return m.jsxs(m.Fragment,{children:[m.jsx(Ft.ItemMeta,{className:t,logo:m.jsx(Uge,{}),title:r.formatMessage({defaultMessage:"Build Hobby",id:"label-build-Hobby"}),description:r.formatMessage({defaultMessage:"Select days to achieve a good hobby",id:"build-weekly-hobby-subtitle"}),rightComponent:m.jsx(zge,{checked:e?e.length!==0:!1,onChange:s=>{n(s?[xe.Mon]:[])}})}),m.jsx(Wh.div,{className:qge.container,style:{maxHeight:o.maxHeight},children:m.jsx(vme,{values:e,setValues:n,options:[{label:"Mon",value:xe.Mon},{label:"Tue",value:xe.Tue},{label:"Thu",value:xe.Thu},{label:"Wed",value:xe.Wed},{label:"Fri",value:xe.Fri},{label:"Sat",value:xe.Sat},{label:"Sun",value:xe.Sun}]})})]})},Kge="_color_11daa_2",Yge="_selected_11daa_8",Xge="_container_11daa_14",Ud={color:Kge,selected:Yge,container:Xge},Jge=({value:t,onClick:e,className:n})=>m.jsx("div",{onClick:e,className:be(Ud.color,Ud.selected,n),style:{backgroundColor:t}}),Qge=({value:t,setValue:e,className:n})=>{const r=["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#607d8b"];return m.jsx("div",{className:be(Ud.container,n),children:r.map((o,s)=>m.jsx("div",{className:be(Ud.color,t===o&&Ud.selected),style:{backgroundColor:o},onClick:()=>e(o)},s))})},Zge="_iconSearchInput_yvqsm_2",eye="_inputContainer_yvqsm_9",tye="_container_yvqsm_14",nye="_rightContainer_yvqsm_24",rye="_colorView_yvqsm_29",oye="_colorPicker_yvqsm_49",ec={iconSearchInput:Zge,inputContainer:eye,container:tye,rightContainer:nye,colorView:rye,colorPicker:oye},oj=({selectedIcon:t,setSelectedIcon:e,className:n,selectedColor:r,setSelectedColor:o})=>{const[s,i]=v.useState(""),[a,l]=v.useState([]),[c,u]=v.useState(2),d=kn(),h=async p=>{var w;const b=await(await fetch(`https://api.iconify.design/search?query=${p}`)).json();((w=b==null?void 0:b.icons)==null?void 0:w.length)>0&&l(b.icons)},f=p=>{e(p),u(2)};return m.jsxs("div",{className:be(n,ec.container),children:[m.jsx(Ft.ItemMeta,{logo:m.jsx(ae,{width:24,icon:"tdesign:icon"}),title:d.formatMessage({defaultMessage:"Icons",id:"icon-picker.title"}),rightComponent:m.jsx("div",{className:ec.rightContainer,children:m.jsx(ae,{width:24,icon:t,color:r})})}),m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:ec.inputContainer,children:[m.jsx(jo,{placeholder:"Search icons",border:"dash",value:s,onChange:p=>{i(p.target.value),h(p.target.value),c!==1&&u(1)},className:ec.iconSearchInput}),m.jsx(Jge,{value:r,className:ec.colorView,onClick:()=>{u(0)}})]}),c===1&&m.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px",maxHeight:"300px",overflowY:"scroll"},children:a.map(p=>m.jsx("div",{onClick:()=>f(p),style:{padding:"10px",border:"2px solid transparent",cursor:"pointer"},children:m.jsx(ae,{icon:p,width:"24",height:"24",color:r})},p))}),c===0&&m.jsx(Qge,{value:r,setValue:p=>{o(p),u(2)},className:ec.colorPicker})]})]})},sye="_selectWrapper_13269_1",iye="_selectLabel_13269_5",aye="_selectElement_13269_9",lye="_open_13269_22",cye="_selectedValue_13269_26",uye="_optionsList_13269_35",dye="_option_13269_35",Va={selectWrapper:sye,selectLabel:iye,selectElement:aye,open:lye,selectedValue:cye,optionsList:uye,option:dye},hye=({options:t,onChange:e,disabled:n=!1,label:r,renderOption:o,renderLabel:s,renderInput:i,renderOptionFooter:a,classes:l={}})=>{const[c,u]=v.useState(!1),d=v.useRef(null),h=()=>u(!1);return v.useEffect(()=>{const f=p=>{d.current&&!d.current.contains(p.target)&&h()};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]),m.jsxs("div",{className:be(Va.selectWrapper,l.container),ref:d,children:[s?s():r&&m.jsx("label",{className:Va.selectLabel,children:r}),m.jsxs("div",{className:`${Va.selectElement} ${c?Va.open:""}`,role:"button",tabIndex:0,children:[m.jsx("div",{className:Va.selectedValue,onClick:()=>!n&&u(!0),children:i?i():"Select..."}),c&&m.jsxs("div",{className:Va.optionsList,children:[t.map(f=>m.jsx("div",{className:Va.option,onClick:()=>{e(f,{close:h})},children:o?o(f,{close:h}):f.label},f.value)),a&&a({close:h})]})]})]})};function fye(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return v.useMemo(()=>r=>{e.forEach(o=>o(r))},e)}const Zb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ku(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function dE(t){return"nodeType"in t}function tr(t){var e,n;return t?ku(t)?t:dE(t)&&(e=(n=t.ownerDocument)==null?void 0:n.defaultView)!=null?e:window:window}function hE(t){const{Document:e}=tr(t);return t instanceof e}function zf(t){return ku(t)?!1:t instanceof tr(t).HTMLElement}function sj(t){return t instanceof tr(t).SVGElement}function Su(t){return t?ku(t)?t.document:dE(t)?hE(t)?t:zf(t)||sj(t)?t.ownerDocument:document:document:document}const Eo=Zb?v.useLayoutEffect:v.useEffect;function e0(t){const e=v.useRef(t);return Eo(()=>{e.current=t}),v.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e.current==null?void 0:e.current(...r)},[])}function pye(){const t=v.useRef(null),e=v.useCallback((r,o)=>{t.current=setInterval(r,o)},[]),n=v.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,n]}function qh(t,e){e===void 0&&(e=[t]);const n=v.useRef(t);return Eo(()=>{n.current!==t&&(n.current=t)},e),n}function Uf(t,e){const n=v.useRef();return v.useMemo(()=>{const r=t(n.current);return n.current=r,r},[...e])}function uy(t){const e=e0(t),n=v.useRef(null),r=v.useCallback(o=>{o!==n.current&&(e==null||e(o,n.current)),n.current=o},[]);return[n,r]}function dy(t){const e=v.useRef();return v.useEffect(()=>{e.current=t},[t]),e.current}let f1={};function Wf(t,e){return v.useMemo(()=>{if(e)return e;const n=f1[t]==null?0:f1[t]+1;return f1[t]=n,t+"-"+n},[t,e])}function ij(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((s,i)=>{const a=Object.entries(i);for(const[l,c]of a){const u=s[l];u!=null&&(s[l]=u+t*c)}return s},{...e})}}const Ac=ij(1),Gh=ij(-1);function mye(t){return"clientX"in t&&"clientY"in t}function t0(t){if(!t)return!1;const{KeyboardEvent:e}=tr(t.target);return e&&t instanceof e}function gye(t){if(!t)return!1;const{TouchEvent:e}=tr(t.target);return e&&t instanceof e}function hy(t){if(gye(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:n}=t.touches[0];return{x:e,y:n}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:n}=t.changedTouches[0];return{x:e,y:n}}}return mye(t)?{x:t.clientX,y:t.clientY}:null}const sa=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:n}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:n}=t;return"scaleX("+e+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[sa.Translate.toString(t),sa.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:n,easing:r}=t;return e+" "+n+"ms "+r}}}),sR="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function yye(t){return t.matches(sR)?t:t.querySelector(sR)}const bye={display:"none"};function vye(t){let{id:e,value:n}=t;return $.createElement("div",{id:e,style:bye},n)}function wye(t){let{id:e,announcement:n,ariaLiveType:r="assertive"}=t;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return $.createElement("div",{id:e,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function Cye(){const[t,e]=v.useState("");return{announce:v.useCallback(r=>{r!=null&&e(r)},[]),announcement:t}}const aj=v.createContext(null);function xye(t){const e=v.useContext(aj);v.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function kye(){const[t]=v.useState(()=>new Set),e=v.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[v.useCallback(r=>{let{type:o,event:s}=r;t.forEach(i=>{var a;return(a=i[o])==null?void 0:a.call(i,s)})},[t]),e]}const Sye={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Eye={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was moved over droppable area "+n.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was dropped over droppable area "+n.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function Tye(t){let{announcements:e=Eye,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=Sye}=t;const{announce:s,announcement:i}=Cye(),a=Wf("DndLiveRegion"),[l,c]=v.useState(!1);if(v.useEffect(()=>{c(!0)},[]),xye(v.useMemo(()=>({onDragStart(d){let{active:h}=d;s(e.onDragStart({active:h}))},onDragMove(d){let{active:h,over:f}=d;e.onDragMove&&s(e.onDragMove({active:h,over:f}))},onDragOver(d){let{active:h,over:f}=d;s(e.onDragOver({active:h,over:f}))},onDragEnd(d){let{active:h,over:f}=d;s(e.onDragEnd({active:h,over:f}))},onDragCancel(d){let{active:h,over:f}=d;s(e.onDragCancel({active:h,over:f}))}}),[s,e])),!l)return null;const u=$.createElement($.Fragment,null,$.createElement(vye,{id:r,value:o.draggable}),$.createElement(wye,{id:a,announcement:i}));return n?gn.createPortal(u,n):u}var qt;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(qt||(qt={}));function fy(){}function iR(t,e){return v.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function _ye(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return v.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const To=Object.freeze({x:0,y:0});function lj(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Aye(t,e){const n=hy(t);if(!n)return"0 0";const r={x:(n.x-e.left)/e.width*100,y:(n.y-e.top)/e.height*100};return r.x+"% "+r.y+"%"}function cj(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return n-r}function Iye(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return r-n}function aR(t){let{left:e,top:n,height:r,width:o}=t;return[{x:e,y:n},{x:e+o,y:n},{x:e,y:n+r},{x:e+o,y:n+r}]}function uj(t,e){if(!t||t.length===0)return null;const[n]=t;return n[e]}function lR(t,e,n){return e===void 0&&(e=t.left),n===void 0&&(n=t.top),{x:e+t.width*.5,y:n+t.height*.5}}const Mye=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const o=lR(e,e.left,e.top),s=[];for(const i of r){const{id:a}=i,l=n.get(a);if(l){const c=lj(lR(l),o);s.push({id:a,data:{droppableContainer:i,value:c}})}}return s.sort(cj)},Rye=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const o=aR(e),s=[];for(const i of r){const{id:a}=i,l=n.get(a);if(l){const c=aR(l),u=o.reduce((h,f,p)=>h+lj(c[p],f),0),d=Number((u/4).toFixed(4));s.push({id:a,data:{droppableContainer:i,value:d}})}}return s.sort(cj)};function Pye(t,e){const n=Math.max(e.top,t.top),r=Math.max(e.left,t.left),o=Math.min(e.left+e.width,t.left+t.width),s=Math.min(e.top+e.height,t.top+t.height),i=o-r,a=s-n;if(r<o&&n<s){const l=e.width*e.height,c=t.width*t.height,u=i*a,d=u/(l+c-u);return Number(d.toFixed(4))}return 0}const Dye=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const o=[];for(const s of r){const{id:i}=s,a=n.get(i);if(a){const l=Pye(a,e);l>0&&o.push({id:i,data:{droppableContainer:s,value:l}})}}return o.sort(Iye)};function Nye(t,e,n){return{...t,scaleX:e&&n?e.width/n.width:1,scaleY:e&&n?e.height/n.height:1}}function dj(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:To}function Oye(t){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return o.reduce((i,a)=>({...i,top:i.top+t*a.y,bottom:i.bottom+t*a.y,left:i.left+t*a.x,right:i.right+t*a.x}),{...n})}}const Lye=Oye(1);function hj(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function Vye(t,e,n){const r=hj(e);if(!r)return t;const{scaleX:o,scaleY:s,x:i,y:a}=r,l=t.left-i-(1-o)*parseFloat(n),c=t.top-a-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),u=o?t.width/o:t.width,d=s?t.height/s:t.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}const jye={ignoreTransform:!1};function Eu(t,e){e===void 0&&(e=jye);let n=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:c,transformOrigin:u}=tr(t).getComputedStyle(t);c&&(n=Vye(n,c,u))}const{top:r,left:o,width:s,height:i,bottom:a,right:l}=n;return{top:r,left:o,width:s,height:i,bottom:a,right:l}}function cR(t){return Eu(t,{ignoreTransform:!0})}function Bye(t){const e=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:e,bottom:n,width:e,height:n}}function $ye(t,e){return e===void 0&&(e=tr(t).getComputedStyle(t)),e.position==="fixed"}function Fye(t,e){e===void 0&&(e=tr(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const s=e[o];return typeof s=="string"?n.test(s):!1})}function n0(t,e){const n=[];function r(o){if(e!=null&&n.length>=e||!o)return n;if(hE(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!zf(o)||sj(o)||n.includes(o))return n;const s=tr(t).getComputedStyle(o);return o!==t&&Fye(o,s)&&n.push(o),$ye(o,s)?n:r(o.parentNode)}return t?r(t):n}function fj(t){const[e]=n0(t,1);return e??null}function p1(t){return!Zb||!t?null:ku(t)?t:dE(t)?hE(t)||t===Su(t).scrollingElement?window:zf(t)?t:null:null}function pj(t){return ku(t)?t.scrollX:t.scrollLeft}function mj(t){return ku(t)?t.scrollY:t.scrollTop}function xC(t){return{x:pj(t),y:mj(t)}}var Zt;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Zt||(Zt={}));function gj(t){return!Zb||!t?!1:t===document.scrollingElement}function yj(t){const e={x:0,y:0},n=gj(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height},o=t.scrollTop<=e.y,s=t.scrollLeft<=e.x,i=t.scrollTop>=r.y,a=t.scrollLeft>=r.x;return{isTop:o,isLeft:s,isBottom:i,isRight:a,maxScroll:r,minScroll:e}}const Hye={x:.2,y:.2};function zye(t,e,n,r,o){let{top:s,left:i,right:a,bottom:l}=n;r===void 0&&(r=10),o===void 0&&(o=Hye);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=yj(t),f={x:0,y:0},p={x:0,y:0},y={height:e.height*o.y,width:e.width*o.x};return!c&&s<=e.top+y.height?(f.y=Zt.Backward,p.y=r*Math.abs((e.top+y.height-s)/y.height)):!u&&l>=e.bottom-y.height&&(f.y=Zt.Forward,p.y=r*Math.abs((e.bottom-y.height-l)/y.height)),!h&&a>=e.right-y.width?(f.x=Zt.Forward,p.x=r*Math.abs((e.right-y.width-a)/y.width)):!d&&i<=e.left+y.width&&(f.x=Zt.Backward,p.x=r*Math.abs((e.left+y.width-i)/y.width)),{direction:f,speed:p}}function Uye(t){if(t===document.scrollingElement){const{innerWidth:s,innerHeight:i}=window;return{top:0,left:0,right:s,bottom:i,width:s,height:i}}const{top:e,left:n,right:r,bottom:o}=t.getBoundingClientRect();return{top:e,left:n,right:r,bottom:o,width:t.clientWidth,height:t.clientHeight}}function bj(t){return t.reduce((e,n)=>Ac(e,xC(n)),To)}function Wye(t){return t.reduce((e,n)=>e+pj(n),0)}function qye(t){return t.reduce((e,n)=>e+mj(n),0)}function vj(t,e){if(e===void 0&&(e=Eu),!t)return;const{top:n,left:r,bottom:o,right:s}=e(t);fj(t)&&(o<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const Gye=[["x",["left","right"],Wye],["y",["top","bottom"],qye]];class fE{constructor(e,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=n0(n),o=bj(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[s,i,a]of Gye)for(const l of i)Object.defineProperty(this,l,{get:()=>{const c=a(r),u=o[s]-c;return this.rect[l]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Wd{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=e}add(e,n,r){var o;(o=this.target)==null||o.addEventListener(e,n,r),this.listeners.push([e,n,r])}}function Kye(t){const{EventTarget:e}=tr(t);return t instanceof e?t:Su(t)}function m1(t,e){const n=Math.abs(t.x),r=Math.abs(t.y);return typeof e=="number"?Math.sqrt(n**2+r**2)>e:"x"in e&&"y"in e?n>e.x&&r>e.y:"x"in e?n>e.x:"y"in e?r>e.y:!1}var $r;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})($r||($r={}));function uR(t){t.preventDefault()}function Yye(t){t.stopPropagation()}var Ve;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(Ve||(Ve={}));const wj={start:[Ve.Space,Ve.Enter],cancel:[Ve.Esc],end:[Ve.Space,Ve.Enter,Ve.Tab]},Xye=(t,e)=>{let{currentCoordinates:n}=e;switch(t.code){case Ve.Right:return{...n,x:n.x+25};case Ve.Left:return{...n,x:n.x-25};case Ve.Down:return{...n,y:n.y+25};case Ve.Up:return{...n,y:n.y-25}}};class pE{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:n}}=e;this.props=e,this.listeners=new Wd(Su(n)),this.windowListeners=new Wd(tr(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add($r.Resize,this.handleCancel),this.windowListeners.add($r.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add($r.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:n}=this.props,r=e.node.current;r&&vj(r),n(To)}handleKeyDown(e){if(t0(e)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:s=wj,coordinateGetter:i=Xye,scrollBehavior:a="smooth"}=o,{code:l}=e;if(s.end.includes(l)){this.handleEnd(e);return}if(s.cancel.includes(l)){this.handleCancel(e);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:To;this.referenceCoordinates||(this.referenceCoordinates=u);const d=i(e,{active:n,context:r.current,currentCoordinates:u});if(d){const h=Gh(d,u),f={x:0,y:0},{scrollableAncestors:p}=r.current;for(const y of p){const b=e.code,{isTop:w,isRight:k,isLeft:x,isBottom:A,maxScroll:I,minScroll:M}=yj(y),T=Uye(y),S={x:Math.min(b===Ve.Right?T.right-T.width/2:T.right,Math.max(b===Ve.Right?T.left:T.left+T.width/2,d.x)),y:Math.min(b===Ve.Down?T.bottom-T.height/2:T.bottom,Math.max(b===Ve.Down?T.top:T.top+T.height/2,d.y))},_=b===Ve.Right&&!k||b===Ve.Left&&!x,R=b===Ve.Down&&!A||b===Ve.Up&&!w;if(_&&S.x!==d.x){const D=y.scrollLeft+h.x,O=b===Ve.Right&&D<=I.x||b===Ve.Left&&D>=M.x;if(O&&!h.y){y.scrollTo({left:D,behavior:a});return}O?f.x=y.scrollLeft-D:f.x=b===Ve.Right?y.scrollLeft-I.x:y.scrollLeft-M.x,f.x&&y.scrollBy({left:-f.x,behavior:a});break}else if(R&&S.y!==d.y){const D=y.scrollTop+h.y,O=b===Ve.Down&&D<=I.y||b===Ve.Up&&D>=M.y;if(O&&!h.x){y.scrollTo({top:D,behavior:a});return}O?f.y=y.scrollTop-D:f.y=b===Ve.Down?y.scrollTop-I.y:y.scrollTop-M.y,f.y&&y.scrollBy({top:-f.y,behavior:a});break}}this.handleMove(e,Ac(Gh(d,this.referenceCoordinates),f))}}}handleMove(e,n){const{onMove:r}=this.props;e.preventDefault(),r(n)}handleEnd(e){const{onEnd:n}=this.props;e.preventDefault(),this.detach(),n()}handleCancel(e){const{onCancel:n}=this.props;e.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}pE.activators=[{eventName:"onKeyDown",handler:(t,e,n)=>{let{keyboardCodes:r=wj,onActivation:o}=e,{active:s}=n;const{code:i}=t.nativeEvent;if(r.start.includes(i)){const a=s.activatorNode.current;return a&&t.target!==a?!1:(t.preventDefault(),o==null||o({event:t.nativeEvent}),!0)}return!1}}];function dR(t){return!!(t&&"distance"in t)}function hR(t){return!!(t&&"delay"in t)}class mE{constructor(e,n,r){var o;r===void 0&&(r=Kye(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=n;const{event:s}=e,{target:i}=s;this.props=e,this.events=n,this.document=Su(i),this.documentListeners=new Wd(this.document),this.listeners=new Wd(r),this.windowListeners=new Wd(tr(i)),this.initialCoordinates=(o=hy(s))!=null?o:To,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add($r.Resize,this.handleCancel),this.windowListeners.add($r.DragStart,uR),this.windowListeners.add($r.VisibilityChange,this.handleCancel),this.windowListeners.add($r.ContextMenu,uR),this.documentListeners.add($r.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(hR(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(dR(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,n){const{active:r,onPending:o}=this.props;o(r,e,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:e}=this,{onStart:n}=this.props;e&&(this.activated=!0,this.documentListeners.add($r.Click,Yye,{capture:!0}),this.removeTextSelection(),this.documentListeners.add($r.SelectionChange,this.removeTextSelection),n(e))}handleMove(e){var n;const{activated:r,initialCoordinates:o,props:s}=this,{onMove:i,options:{activationConstraint:a}}=s;if(!o)return;const l=(n=hy(e))!=null?n:To,c=Gh(o,l);if(!r&&a){if(dR(a)){if(a.tolerance!=null&&m1(c,a.tolerance))return this.handleCancel();if(m1(c,a.distance))return this.handleStart()}if(hR(a)&&m1(c,a.tolerance))return this.handleCancel();this.handlePending(a,c);return}e.cancelable&&e.preventDefault(),i(l)}handleEnd(){const{onAbort:e,onEnd:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleCancel(){const{onAbort:e,onCancel:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleKeydown(e){e.code===Ve.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const Jye={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class gE extends mE{constructor(e){const{event:n}=e,r=Su(n.target);super(e,Jye,r)}}gE.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Qye={move:{name:"mousemove"},end:{name:"mouseup"}};var kC;(function(t){t[t.RightClick=2]="RightClick"})(kC||(kC={}));class Zye extends mE{constructor(e){super(e,Qye,Su(e.event.target))}}Zye.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return n.button===kC.RightClick?!1:(r==null||r({event:n}),!0)}}];const g1={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class ebe extends mE{constructor(e){super(e,g1)}static setup(){return window.addEventListener(g1.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(g1.move.name,e)};function e(){}}}ebe.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;const{touches:o}=n;return o.length>1?!1:(r==null||r({event:n}),!0)}}];var qd;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(qd||(qd={}));var py;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(py||(py={}));function tbe(t){let{acceleration:e,activator:n=qd.Pointer,canScroll:r,draggingRect:o,enabled:s,interval:i=5,order:a=py.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:d,threshold:h}=t;const f=rbe({delta:d,disabled:!s}),[p,y]=pye(),b=v.useRef({x:0,y:0}),w=v.useRef({x:0,y:0}),k=v.useMemo(()=>{switch(n){case qd.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case qd.DraggableRect:return o}},[n,o,l]),x=v.useRef(null),A=v.useCallback(()=>{const M=x.current;if(!M)return;const T=b.current.x*w.current.x,S=b.current.y*w.current.y;M.scrollBy(T,S)},[]),I=v.useMemo(()=>a===py.TreeOrder?[...c].reverse():c,[a,c]);v.useEffect(()=>{if(!s||!c.length||!k){y();return}for(const M of I){if((r==null?void 0:r(M))===!1)continue;const T=c.indexOf(M),S=u[T];if(!S)continue;const{direction:_,speed:R}=zye(M,S,k,e,h);for(const D of["x","y"])f[D][_[D]]||(R[D]=0,_[D]=0);if(R.x>0||R.y>0){y(),x.current=M,p(A,i),b.current=R,w.current=_;return}}b.current={x:0,y:0},w.current={x:0,y:0},y()},[e,A,r,y,s,i,JSON.stringify(k),JSON.stringify(f),p,c,I,u,JSON.stringify(h)])}const nbe={x:{[Zt.Backward]:!1,[Zt.Forward]:!1},y:{[Zt.Backward]:!1,[Zt.Forward]:!1}};function rbe(t){let{delta:e,disabled:n}=t;const r=dy(e);return Uf(o=>{if(n||!r||!o)return nbe;const s={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[Zt.Backward]:o.x[Zt.Backward]||s.x===-1,[Zt.Forward]:o.x[Zt.Forward]||s.x===1},y:{[Zt.Backward]:o.y[Zt.Backward]||s.y===-1,[Zt.Forward]:o.y[Zt.Forward]||s.y===1}}},[n,e,r])}function obe(t,e){const n=e!=null?t.get(e):void 0,r=n?n.node.current:null;return Uf(o=>{var s;return e==null?null:(s=r??o)!=null?s:null},[r,e])}function sbe(t,e){return v.useMemo(()=>t.reduce((n,r)=>{const{sensor:o}=r,s=o.activators.map(i=>({eventName:i.eventName,handler:e(i.handler,r)}));return[...n,...s]},[]),[t,e])}var Kh;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Kh||(Kh={}));var SC;(function(t){t.Optimized="optimized"})(SC||(SC={}));const fR=new Map;function ibe(t,e){let{dragging:n,dependencies:r,config:o}=e;const[s,i]=v.useState(null),{frequency:a,measure:l,strategy:c}=o,u=v.useRef(t),d=b(),h=qh(d),f=v.useCallback(function(w){w===void 0&&(w=[]),!h.current&&i(k=>k===null?w:k.concat(w.filter(x=>!k.includes(x))))},[h]),p=v.useRef(null),y=Uf(w=>{if(d&&!n)return fR;if(!w||w===fR||u.current!==t||s!=null){const k=new Map;for(let x of t){if(!x)continue;if(s&&s.length>0&&!s.includes(x.id)&&x.rect.current){k.set(x.id,x.rect.current);continue}const A=x.node.current,I=A?new fE(l(A),A):null;x.rect.current=I,I&&k.set(x.id,I)}return k}return w},[t,s,n,d,l]);return v.useEffect(()=>{u.current=t},[t]),v.useEffect(()=>{d||f()},[n,d]),v.useEffect(()=>{s&&s.length>0&&i(null)},[JSON.stringify(s)]),v.useEffect(()=>{d||typeof a!="number"||p.current!==null||(p.current=setTimeout(()=>{f(),p.current=null},a))},[a,d,f,...r]),{droppableRects:y,measureDroppableContainers:f,measuringScheduled:s!=null};function b(){switch(c){case Kh.Always:return!1;case Kh.BeforeDragging:return n;default:return!n}}}function yE(t,e){return Uf(n=>t?n||(typeof e=="function"?e(t):t):null,[e,t])}function abe(t,e){return yE(t,e)}function lbe(t){let{callback:e,disabled:n}=t;const r=e0(e),o=v.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return v.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function r0(t){let{callback:e,disabled:n}=t;const r=e0(e),o=v.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return v.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function cbe(t){return new fE(Eu(t),t)}function pR(t,e,n){e===void 0&&(e=cbe);const[r,o]=v.useState(null);function s(){o(l=>{if(!t)return null;if(t.isConnected===!1){var c;return(c=l??n)!=null?c:null}const u=e(t);return JSON.stringify(l)===JSON.stringify(u)?l:u})}const i=lbe({callback(l){if(t)for(const c of l){const{type:u,target:d}=c;if(u==="childList"&&d instanceof HTMLElement&&d.contains(t)){s();break}}}}),a=r0({callback:s});return Eo(()=>{s(),t?(a==null||a.observe(t),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),i==null||i.disconnect())},[t]),r}function ube(t){const e=yE(t);return dj(t,e)}const mR=[];function dbe(t){const e=v.useRef(t),n=Uf(r=>t?r&&r!==mR&&t&&e.current&&t.parentNode===e.current.parentNode?r:n0(t):mR,[t]);return v.useEffect(()=>{e.current=t},[t]),n}function hbe(t){const[e,n]=v.useState(null),r=v.useRef(t),o=v.useCallback(s=>{const i=p1(s.target);i&&n(a=>a?(a.set(i,xC(i)),new Map(a)):null)},[]);return v.useEffect(()=>{const s=r.current;if(t!==s){i(s);const a=t.map(l=>{const c=p1(l);return c?(c.addEventListener("scroll",o,{passive:!0}),[c,xC(c)]):null}).filter(l=>l!=null);n(a.length?new Map(a):null),r.current=t}return()=>{i(t),i(s)};function i(a){a.forEach(l=>{const c=p1(l);c==null||c.removeEventListener("scroll",o)})}},[o,t]),v.useMemo(()=>t.length?e?Array.from(e.values()).reduce((s,i)=>Ac(s,i),To):bj(t):To,[t,e])}function gR(t,e){e===void 0&&(e=[]);const n=v.useRef(null);return v.useEffect(()=>{n.current=null},e),v.useEffect(()=>{const r=t!==To;r&&!n.current&&(n.current=t),!r&&n.current&&(n.current=null)},[t]),n.current?Gh(t,n.current):To}function fbe(t){v.useEffect(()=>{if(!Zb)return;const e=t.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of e)n==null||n()}},t.map(e=>{let{sensor:n}=e;return n}))}function pbe(t,e){return v.useMemo(()=>t.reduce((n,r)=>{let{eventName:o,handler:s}=r;return n[o]=i=>{s(i,e)},n},{}),[t,e])}function Cj(t){return v.useMemo(()=>t?Bye(t):null,[t])}const yR=[];function mbe(t,e){e===void 0&&(e=Eu);const[n]=t,r=Cj(n?tr(n):null),[o,s]=v.useState(yR);function i(){s(()=>t.length?t.map(l=>gj(l)?r:new fE(e(l),l)):yR)}const a=r0({callback:i});return Eo(()=>{a==null||a.disconnect(),i(),t.forEach(l=>a==null?void 0:a.observe(l))},[t]),o}function xj(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return zf(e)?e:t}function gbe(t){let{measure:e}=t;const[n,r]=v.useState(null),o=v.useCallback(c=>{for(const{target:u}of c)if(zf(u)){r(d=>{const h=e(u);return d?{...d,width:h.width,height:h.height}:h});break}},[e]),s=r0({callback:o}),i=v.useCallback(c=>{const u=xj(c);s==null||s.disconnect(),u&&(s==null||s.observe(u)),r(u?e(u):null)},[e,s]),[a,l]=uy(i);return v.useMemo(()=>({nodeRef:a,rect:n,setRef:l}),[n,a,l])}const ybe=[{sensor:gE,options:{}},{sensor:pE,options:{}}],bbe={current:{}},Dm={draggable:{measure:cR},droppable:{measure:cR,strategy:Kh.WhileDragging,frequency:SC.Optimized},dragOverlay:{measure:Eu}};class Gd extends Map{get(e){var n;return e!=null&&(n=super.get(e))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:n}=e;return!n})}getNodeFor(e){var n,r;return(n=(r=this.get(e))==null?void 0:r.node.current)!=null?n:void 0}}const vbe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Gd,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:fy},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Dm,measureDroppableContainers:fy,windowRect:null,measuringScheduled:!1},kj={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:fy,draggableNodes:new Map,over:null,measureDroppableContainers:fy},qf=v.createContext(kj),Sj=v.createContext(vbe);function wbe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Gd}}}function Cbe(t,e){switch(e.type){case qt.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case qt.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case qt.DragEnd:case qt.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case qt.RegisterDroppable:{const{element:n}=e,{id:r}=n,o=new Gd(t.droppable.containers);return o.set(r,n),{...t,droppable:{...t.droppable,containers:o}}}case qt.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=e,s=t.droppable.containers.get(n);if(!s||r!==s.key)return t;const i=new Gd(t.droppable.containers);return i.set(n,{...s,disabled:o}),{...t,droppable:{...t.droppable,containers:i}}}case qt.UnregisterDroppable:{const{id:n,key:r}=e,o=t.droppable.containers.get(n);if(!o||r!==o.key)return t;const s=new Gd(t.droppable.containers);return s.delete(n),{...t,droppable:{...t.droppable,containers:s}}}default:return t}}function xbe(t){let{disabled:e}=t;const{active:n,activatorEvent:r,draggableNodes:o}=v.useContext(qf),s=dy(r),i=dy(n==null?void 0:n.id);return v.useEffect(()=>{if(!e&&!r&&s&&i!=null){if(!t0(s)||document.activeElement===s.target)return;const a=o.get(i);if(!a)return;const{activatorNode:l,node:c}=a;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[l.current,c.current]){if(!u)continue;const d=yye(u);if(d){d.focus();break}}})}},[r,e,o,i,s]),null}function Ej(t,e){let{transform:n,...r}=e;return t!=null&&t.length?t.reduce((o,s)=>s({transform:o,...r}),n):n}function kbe(t){return v.useMemo(()=>({draggable:{...Dm.draggable,...t==null?void 0:t.draggable},droppable:{...Dm.droppable,...t==null?void 0:t.droppable},dragOverlay:{...Dm.dragOverlay,...t==null?void 0:t.dragOverlay}}),[t==null?void 0:t.draggable,t==null?void 0:t.droppable,t==null?void 0:t.dragOverlay])}function Sbe(t){let{activeNode:e,measure:n,initialRect:r,config:o=!0}=t;const s=v.useRef(!1),{x:i,y:a}=typeof o=="boolean"?{x:o,y:o}:o;Eo(()=>{if(!i&&!a||!e){s.current=!1;return}if(s.current||!r)return;const c=e==null?void 0:e.node.current;if(!c||c.isConnected===!1)return;const u=n(c),d=dj(u,r);if(i||(d.x=0),a||(d.y=0),s.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const h=fj(c);h&&h.scrollBy({top:d.y,left:d.x})}},[e,i,a,r,n])}const o0=v.createContext({...To,scaleX:1,scaleY:1});var _i;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(_i||(_i={}));const Ebe=v.memo(function(e){var n,r,o,s;let{id:i,accessibility:a,autoScroll:l=!0,children:c,sensors:u=ybe,collisionDetection:d=Dye,measuring:h,modifiers:f,...p}=e;const y=v.useReducer(Cbe,void 0,wbe),[b,w]=y,[k,x]=kye(),[A,I]=v.useState(_i.Uninitialized),M=A===_i.Initialized,{draggable:{active:T,nodes:S,translate:_},droppable:{containers:R}}=b,D=T!=null?S.get(T):null,O=v.useRef({initial:null,translated:null}),N=v.useMemo(()=>{var Vt;return T!=null?{id:T,data:(Vt=D==null?void 0:D.data)!=null?Vt:bbe,rect:O}:null},[T,D]),K=v.useRef(null),[Q,ce]=v.useState(null),[z,W]=v.useState(null),X=qh(p,Object.values(p)),le=Wf("DndDescribedBy",i),te=v.useMemo(()=>R.getEnabled(),[R]),oe=kbe(h),{droppableRects:ue,measureDroppableContainers:lt,measuringScheduled:Ze}=ibe(te,{dragging:M,dependencies:[_.x,_.y],config:oe.droppable}),De=obe(S,T),Ge=v.useMemo(()=>z?hy(z):null,[z]),gt=Aa(),nt=abe(De,oe.draggable.measure);Sbe({activeNode:T!=null?S.get(T):null,config:gt.layoutShiftCompensation,initialRect:nt,measure:oe.draggable.measure});const ge=pR(De,oe.draggable.measure,nt),Wt=pR(De?De.parentElement:null),Ot=v.useRef({activatorEvent:null,active:null,activeNode:De,collisionRect:null,collisions:null,droppableRects:ue,draggableNodes:S,draggingNode:null,draggingNodeRect:null,droppableContainers:R,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Xt=R.getNodeFor((n=Ot.current.over)==null?void 0:n.id),Lt=gbe({measure:oe.dragOverlay.measure}),Sn=(r=Lt.nodeRef.current)!=null?r:De,gr=M?(o=Lt.rect)!=null?o:ge:null,ri=!!(Lt.nodeRef.current&&Lt.rect),oi=ube(ri?null:ge),eo=Cj(Sn?tr(Sn):null),Xe=dbe(M?Xt??De:null),ps=mbe(Xe),si=Ej(f,{transform:{x:_.x-oi.x,y:_.y-oi.y,scaleX:1,scaleY:1},activatorEvent:z,active:N,activeNodeRect:ge,containerNodeRect:Wt,draggingNodeRect:gr,over:Ot.current.over,overlayNodeRect:Lt.rect,scrollableAncestors:Xe,scrollableAncestorRects:ps,windowRect:eo}),ii=Ge?Ac(Ge,_):null,ai=hbe(Xe),Ta=gR(ai),It=gR(ai,[ge]),ht=Ac(si,Ta),nr=gr?Lye(gr,si):null,to=N&&nr?d({active:N,collisionRect:nr,droppableRects:ue,droppableContainers:te,pointerCoordinates:ii}):null,li=uj(to,"id"),[yt,ci]=v.useState(null),rp=ri?si:Ac(si,It),op=Nye(rp,(s=yt==null?void 0:yt.rect)!=null?s:null,ge),_a=v.useRef(null),sp=v.useCallback((Vt,on)=>{let{sensor:Mt,options:no}=on;if(K.current==null)return;const sn=S.get(K.current);if(!sn)return;const En=Vt.nativeEvent,Tn=new Mt({active:K.current,activeNode:sn,event:En,options:no,context:Ot,onAbort(ze){if(!S.get(ze))return;const{onDragAbort:_n}=X.current,Hn={id:ze};_n==null||_n(Hn),k({type:"onDragAbort",event:Hn})},onPending(ze,ro,_n,Hn){if(!S.get(ze))return;const{onDragPending:Ma}=X.current,zn={id:ze,constraint:ro,initialCoordinates:_n,offset:Hn};Ma==null||Ma(zn),k({type:"onDragPending",event:zn})},onStart(ze){const ro=K.current;if(ro==null)return;const _n=S.get(ro);if(!_n)return;const{onDragStart:Hn}=X.current,Ia={activatorEvent:En,active:{id:ro,data:_n.data,rect:O}};gn.unstable_batchedUpdates(()=>{Hn==null||Hn(Ia),I(_i.Initializing),w({type:qt.DragStart,initialCoordinates:ze,active:ro}),k({type:"onDragStart",event:Ia}),ce(_a.current),W(En)})},onMove(ze){w({type:qt.DragMove,coordinates:ze})},onEnd:ms(qt.DragEnd),onCancel:ms(qt.DragCancel)});_a.current=Tn;function ms(ze){return async function(){const{active:_n,collisions:Hn,over:Ia,scrollAdjustedTranslate:Ma}=Ot.current;let zn=null;if(_n&&Ma){const{cancelDrop:Ra}=X.current;zn={activatorEvent:En,active:_n,collisions:Hn,delta:Ma,over:Ia},ze===qt.DragEnd&&typeof Ra=="function"&&await Promise.resolve(Ra(zn))&&(ze=qt.DragCancel)}K.current=null,gn.unstable_batchedUpdates(()=>{w({type:ze}),I(_i.Uninitialized),ci(null),ce(null),W(null),_a.current=null;const Ra=ze===qt.DragEnd?"onDragEnd":"onDragCancel";if(zn){const Ou=X.current[Ra];Ou==null||Ou(zn),k({type:Ra,event:zn})}})}}},[S]),T0=v.useCallback((Vt,on)=>(Mt,no)=>{const sn=Mt.nativeEvent,En=S.get(no);if(K.current!==null||!En||sn.dndKit||sn.defaultPrevented)return;const Tn={active:En};Vt(Mt,on.options,Tn)===!0&&(sn.dndKit={capturedBy:on.sensor},K.current=no,sp(Mt,on))},[S,sp]),Fl=sbe(u,T0);fbe(u),Eo(()=>{ge&&A===_i.Initializing&&I(_i.Initialized)},[ge,A]),v.useEffect(()=>{const{onDragMove:Vt}=X.current,{active:on,activatorEvent:Mt,collisions:no,over:sn}=Ot.current;if(!on||!Mt)return;const En={active:on,activatorEvent:Mt,collisions:no,delta:{x:ht.x,y:ht.y},over:sn};gn.unstable_batchedUpdates(()=>{Vt==null||Vt(En),k({type:"onDragMove",event:En})})},[ht.x,ht.y]),v.useEffect(()=>{const{active:Vt,activatorEvent:on,collisions:Mt,droppableContainers:no,scrollAdjustedTranslate:sn}=Ot.current;if(!Vt||K.current==null||!on||!sn)return;const{onDragOver:En}=X.current,Tn=no.get(li),ms=Tn&&Tn.rect.current?{id:Tn.id,rect:Tn.rect.current,data:Tn.data,disabled:Tn.disabled}:null,ze={active:Vt,activatorEvent:on,collisions:Mt,delta:{x:sn.x,y:sn.y},over:ms};gn.unstable_batchedUpdates(()=>{ci(ms),En==null||En(ze),k({type:"onDragOver",event:ze})})},[li]),Eo(()=>{Ot.current={activatorEvent:z,active:N,activeNode:De,collisionRect:nr,collisions:to,droppableRects:ue,draggableNodes:S,draggingNode:Sn,draggingNodeRect:gr,droppableContainers:R,over:yt,scrollableAncestors:Xe,scrollAdjustedTranslate:ht},O.current={initial:gr,translated:nr}},[N,De,to,nr,S,Sn,gr,ue,R,yt,Xe,ht]),tbe({...gt,delta:_,draggingRect:nr,pointerCoordinates:ii,scrollableAncestors:Xe,scrollableAncestorRects:ps});const ip=v.useMemo(()=>({active:N,activeNode:De,activeNodeRect:ge,activatorEvent:z,collisions:to,containerNodeRect:Wt,dragOverlay:Lt,draggableNodes:S,droppableContainers:R,droppableRects:ue,over:yt,measureDroppableContainers:lt,scrollableAncestors:Xe,scrollableAncestorRects:ps,measuringConfiguration:oe,measuringScheduled:Ze,windowRect:eo}),[N,De,ge,z,to,Wt,Lt,S,R,ue,yt,lt,Xe,ps,oe,Ze,eo]),ap=v.useMemo(()=>({activatorEvent:z,activators:Fl,active:N,activeNodeRect:ge,ariaDescribedById:{draggable:le},dispatch:w,draggableNodes:S,over:yt,measureDroppableContainers:lt}),[z,Fl,N,ge,w,le,S,yt,lt]);return $.createElement(aj.Provider,{value:x},$.createElement(qf.Provider,{value:ap},$.createElement(Sj.Provider,{value:ip},$.createElement(o0.Provider,{value:op},c)),$.createElement(xbe,{disabled:(a==null?void 0:a.restoreFocus)===!1})),$.createElement(Tye,{...a,hiddenTextDescribedById:le}));function Aa(){const Vt=(Q==null?void 0:Q.autoScrollEnabled)===!1,on=typeof l=="object"?l.enabled===!1:l===!1,Mt=M&&!Vt&&!on;return typeof l=="object"?{...l,enabled:Mt}:{enabled:Mt}}}),Tbe=v.createContext(null),bR="button",_be="Draggable";function Abe(t){let{id:e,data:n,disabled:r=!1,attributes:o}=t;const s=Wf(_be),{activators:i,activatorEvent:a,active:l,activeNodeRect:c,ariaDescribedById:u,draggableNodes:d,over:h}=v.useContext(qf),{role:f=bR,roleDescription:p="draggable",tabIndex:y=0}=o??{},b=(l==null?void 0:l.id)===e,w=v.useContext(b?o0:Tbe),[k,x]=uy(),[A,I]=uy(),M=pbe(i,e),T=qh(n);Eo(()=>(d.set(e,{id:e,key:s,node:k,activatorNode:A,data:T}),()=>{const _=d.get(e);_&&_.key===s&&d.delete(e)}),[d,e]);const S=v.useMemo(()=>({role:f,tabIndex:y,"aria-disabled":r,"aria-pressed":b&&f===bR?!0:void 0,"aria-roledescription":p,"aria-describedby":u.draggable}),[r,f,y,b,p,u.draggable]);return{active:l,activatorEvent:a,activeNodeRect:c,attributes:S,isDragging:b,listeners:r?void 0:M,node:k,over:h,setNodeRef:x,setActivatorNodeRef:I,transform:w}}function Tj(){return v.useContext(Sj)}const Ibe="Droppable",Mbe={timeout:25};function _j(t){let{data:e,disabled:n=!1,id:r,resizeObserverConfig:o}=t;const s=Wf(Ibe),{active:i,dispatch:a,over:l,measureDroppableContainers:c}=v.useContext(qf),u=v.useRef({disabled:n}),d=v.useRef(!1),h=v.useRef(null),f=v.useRef(null),{disabled:p,updateMeasurementsFor:y,timeout:b}={...Mbe,...o},w=qh(y??r),k=v.useCallback(()=>{if(!d.current){d.current=!0;return}f.current!=null&&clearTimeout(f.current),f.current=setTimeout(()=>{c(Array.isArray(w.current)?w.current:[w.current]),f.current=null},b)},[b]),x=r0({callback:k,disabled:p||!i}),A=v.useCallback((S,_)=>{x&&(_&&(x.unobserve(_),d.current=!1),S&&x.observe(S))},[x]),[I,M]=uy(A),T=qh(e);return v.useEffect(()=>{!x||!I.current||(x.disconnect(),d.current=!1,x.observe(I.current))},[I,x]),v.useEffect(()=>(a({type:qt.RegisterDroppable,element:{id:r,key:s,disabled:n,node:I,rect:h,data:T}}),()=>a({type:qt.UnregisterDroppable,key:s,id:r})),[r]),v.useEffect(()=>{n!==u.current.disabled&&(a({type:qt.SetDroppableDisabled,id:r,key:s,disabled:n}),u.current.disabled=n)},[r,s,n,a]),{active:i,rect:h,isOver:(l==null?void 0:l.id)===r,node:I,over:l,setNodeRef:M}}function Rbe(t){let{animation:e,children:n}=t;const[r,o]=v.useState(null),[s,i]=v.useState(null),a=dy(n);return!n&&!r&&a&&o(a),Eo(()=>{if(!s)return;const l=r==null?void 0:r.key,c=r==null?void 0:r.props.id;if(l==null||c==null){o(null);return}Promise.resolve(e(c,s)).then(()=>{o(null)})},[e,r,s]),$.createElement($.Fragment,null,n,r?v.cloneElement(r,{ref:i}):null)}const Pbe={x:0,y:0,scaleX:1,scaleY:1};function Dbe(t){let{children:e}=t;return $.createElement(qf.Provider,{value:kj},$.createElement(o0.Provider,{value:Pbe},e))}const Nbe={position:"fixed",touchAction:"none"},Obe=t=>t0(t)?"transform 250ms ease":void 0,Lbe=v.forwardRef((t,e)=>{let{as:n,activatorEvent:r,adjustScale:o,children:s,className:i,rect:a,style:l,transform:c,transition:u=Obe}=t;if(!a)return null;const d=o?c:{...c,scaleX:1,scaleY:1},h={...Nbe,width:a.width,height:a.height,top:a.top,left:a.left,transform:sa.Transform.toString(d),transformOrigin:o&&r?Aye(r,a):void 0,transition:typeof u=="function"?u(r):u,...l};return $.createElement(n,{className:i,style:h,ref:e},s)}),Vbe=t=>e=>{let{active:n,dragOverlay:r}=e;const o={},{styles:s,className:i}=t;if(s!=null&&s.active)for(const[a,l]of Object.entries(s.active))l!==void 0&&(o[a]=n.node.style.getPropertyValue(a),n.node.style.setProperty(a,l));if(s!=null&&s.dragOverlay)for(const[a,l]of Object.entries(s.dragOverlay))l!==void 0&&r.node.style.setProperty(a,l);return i!=null&&i.active&&n.node.classList.add(i.active),i!=null&&i.dragOverlay&&r.node.classList.add(i.dragOverlay),function(){for(const[l,c]of Object.entries(o))n.node.style.setProperty(l,c);i!=null&&i.active&&n.node.classList.remove(i.active)}},jbe=t=>{let{transform:{initial:e,final:n}}=t;return[{transform:sa.Transform.toString(e)},{transform:sa.Transform.toString(n)}]},Bbe={duration:250,easing:"ease",keyframes:jbe,sideEffects:Vbe({styles:{active:{opacity:"0"}}})};function $be(t){let{config:e,draggableNodes:n,droppableContainers:r,measuringConfiguration:o}=t;return e0((s,i)=>{if(e===null)return;const a=n.get(s);if(!a)return;const l=a.node.current;if(!l)return;const c=xj(i);if(!c)return;const{transform:u}=tr(i).getComputedStyle(i),d=hj(u);if(!d)return;const h=typeof e=="function"?e:Fbe(e);return vj(l,o.draggable.measure),h({active:{id:s,data:a.data,node:l,rect:o.draggable.measure(l)},draggableNodes:n,dragOverlay:{node:i,rect:o.dragOverlay.measure(c)},droppableContainers:r,measuringConfiguration:o,transform:d})})}function Fbe(t){const{duration:e,easing:n,sideEffects:r,keyframes:o}={...Bbe,...t};return s=>{let{active:i,dragOverlay:a,transform:l,...c}=s;if(!e)return;const u={x:a.rect.left-i.rect.left,y:a.rect.top-i.rect.top},d={scaleX:l.scaleX!==1?i.rect.width*l.scaleX/a.rect.width:1,scaleY:l.scaleY!==1?i.rect.height*l.scaleY/a.rect.height:1},h={x:l.x-u.x,y:l.y-u.y,...d},f=o({...c,active:i,dragOverlay:a,transform:{initial:l,final:h}}),[p]=f,y=f[f.length-1];if(JSON.stringify(p)===JSON.stringify(y))return;const b=r==null?void 0:r({active:i,dragOverlay:a,...c}),w=a.node.animate(f,{duration:e,easing:n,fill:"forwards"});return new Promise(k=>{w.onfinish=()=>{b==null||b(),k()}})}}let vR=0;function Hbe(t){return v.useMemo(()=>{if(t!=null)return vR++,vR},[t])}const zbe=$.memo(t=>{let{adjustScale:e=!1,children:n,dropAnimation:r,style:o,transition:s,modifiers:i,wrapperElement:a="div",className:l,zIndex:c=999}=t;const{activatorEvent:u,active:d,activeNodeRect:h,containerNodeRect:f,draggableNodes:p,droppableContainers:y,dragOverlay:b,over:w,measuringConfiguration:k,scrollableAncestors:x,scrollableAncestorRects:A,windowRect:I}=Tj(),M=v.useContext(o0),T=Hbe(d==null?void 0:d.id),S=Ej(i,{activatorEvent:u,active:d,activeNodeRect:h,containerNodeRect:f,draggingNodeRect:b.rect,over:w,overlayNodeRect:b.rect,scrollableAncestors:x,scrollableAncestorRects:A,transform:M,windowRect:I}),_=yE(h),R=$be({config:r,draggableNodes:p,droppableContainers:y,measuringConfiguration:k}),D=_?b.setRef:void 0;return $.createElement(Dbe,null,$.createElement(Rbe,{animation:R},d&&T?$.createElement(Lbe,{key:T,id:d.id,ref:D,as:a,activatorEvent:u,adjustScale:e,className:l,transition:s,rect:_,style:{zIndex:c,...o},transform:S},n):null))});function bE(t,e,n){const r=t.slice();return r.splice(n<0?r.length+n:n,0,r.splice(e,1)[0]),r}function Ube(t,e){return t.reduce((n,r,o)=>{const s=e.get(r);return s&&(n[o]=s),n},Array(t.length))}function Jp(t){return t!==null&&t>=0}function Wbe(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function qbe(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const Aj=t=>{let{rects:e,activeIndex:n,overIndex:r,index:o}=t;const s=bE(e,r,n),i=e[o],a=s[o];return!a||!i?null:{x:a.left-i.left,y:a.top-i.top,scaleX:a.width/i.width,scaleY:a.height/i.height}},Qp={scaleX:1,scaleY:1},Gbe=t=>{var e;let{activeIndex:n,activeNodeRect:r,index:o,rects:s,overIndex:i}=t;const a=(e=s[n])!=null?e:r;if(!a)return null;if(o===n){const c=s[i];return c?{x:0,y:n<i?c.top+c.height-(a.top+a.height):c.top-a.top,...Qp}:null}const l=Kbe(s,o,n);return o>n&&o<=i?{x:0,y:-a.height-l,...Qp}:o<n&&o>=i?{x:0,y:a.height+l,...Qp}:{x:0,y:0,...Qp}};function Kbe(t,e,n){const r=t[e],o=t[e-1],s=t[e+1];return r?n<e?o?r.top-(o.top+o.height):s?s.top-(r.top+r.height):0:s?s.top-(r.top+r.height):o?r.top-(o.top+o.height):0:0}const Ij="Sortable",Mj=$.createContext({activeIndex:-1,containerId:Ij,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Aj,disabled:{draggable:!1,droppable:!1}});function Ybe(t){let{children:e,id:n,items:r,strategy:o=Aj,disabled:s=!1}=t;const{active:i,dragOverlay:a,droppableRects:l,over:c,measureDroppableContainers:u}=Tj(),d=Wf(Ij,n),h=a.rect!==null,f=v.useMemo(()=>r.map(M=>typeof M=="object"&&"id"in M?M.id:M),[r]),p=i!=null,y=i?f.indexOf(i.id):-1,b=c?f.indexOf(c.id):-1,w=v.useRef(f),k=!Wbe(f,w.current),x=b!==-1&&y===-1||k,A=qbe(s);Eo(()=>{k&&p&&u(f)},[k,f,p,u]),v.useEffect(()=>{w.current=f},[f]);const I=v.useMemo(()=>({activeIndex:y,containerId:d,disabled:A,disableTransforms:x,items:f,overIndex:b,useDragOverlay:h,sortedRects:Ube(f,l),strategy:o}),[y,d,A.draggable,A.droppable,x,f,b,l,h,o]);return $.createElement(Mj.Provider,{value:I},e)}const Xbe=t=>{let{id:e,items:n,activeIndex:r,overIndex:o}=t;return bE(n,r,o).indexOf(e)},Jbe=t=>{let{containerId:e,isSorting:n,wasDragging:r,index:o,items:s,newIndex:i,previousItems:a,previousContainerId:l,transition:c}=t;return!c||!r||a!==s&&o===i?!1:n?!0:i!==o&&e===l},Qbe={duration:200,easing:"ease"},Rj="transform",Zbe=sa.Transition.toString({property:Rj,duration:0,easing:"linear"}),e0e={roleDescription:"sortable"};function t0e(t){let{disabled:e,index:n,node:r,rect:o}=t;const[s,i]=v.useState(null),a=v.useRef(n);return Eo(()=>{if(!e&&n!==a.current&&r.current){const l=o.current;if(l){const c=Eu(r.current,{ignoreTransform:!0}),u={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(u.x||u.y)&&i(u)}}n!==a.current&&(a.current=n)},[e,n,r,o]),v.useEffect(()=>{s&&i(null)},[s]),s}function n0e(t){let{animateLayoutChanges:e=Jbe,attributes:n,disabled:r,data:o,getNewIndex:s=Xbe,id:i,strategy:a,resizeObserverConfig:l,transition:c=Qbe}=t;const{items:u,containerId:d,activeIndex:h,disabled:f,disableTransforms:p,sortedRects:y,overIndex:b,useDragOverlay:w,strategy:k}=v.useContext(Mj),x=r0e(r,f),A=u.indexOf(i),I=v.useMemo(()=>({sortable:{containerId:d,index:A,items:u},...o}),[d,o,A,u]),M=v.useMemo(()=>u.slice(u.indexOf(i)),[u,i]),{rect:T,node:S,isOver:_,setNodeRef:R}=_j({id:i,data:I,disabled:x.droppable,resizeObserverConfig:{updateMeasurementsFor:M,...l}}),{active:D,activatorEvent:O,activeNodeRect:N,attributes:K,setNodeRef:Q,listeners:ce,isDragging:z,over:W,setActivatorNodeRef:X,transform:le}=Abe({id:i,data:I,attributes:{...e0e,...n},disabled:x.draggable}),te=fye(R,Q),oe=!!D,ue=oe&&!p&&Jp(h)&&Jp(b),lt=!w&&z,Ze=lt&&ue?le:null,Ge=ue?Ze??(a??k)({rects:y,activeNodeRect:N,activeIndex:h,overIndex:b,index:A}):null,gt=Jp(h)&&Jp(b)?s({id:i,items:u,activeIndex:h,overIndex:b}):A,nt=D==null?void 0:D.id,ge=v.useRef({activeId:nt,items:u,newIndex:gt,containerId:d}),Wt=u!==ge.current.items,Ot=e({active:D,containerId:d,isDragging:z,isSorting:oe,id:i,index:A,items:u,newIndex:ge.current.newIndex,previousItems:ge.current.items,previousContainerId:ge.current.containerId,transition:c,wasDragging:ge.current.activeId!=null}),Xt=t0e({disabled:!Ot,index:A,node:S,rect:T});return v.useEffect(()=>{oe&&ge.current.newIndex!==gt&&(ge.current.newIndex=gt),d!==ge.current.containerId&&(ge.current.containerId=d),u!==ge.current.items&&(ge.current.items=u)},[oe,gt,d,u]),v.useEffect(()=>{if(nt===ge.current.activeId)return;if(nt!=null&&ge.current.activeId==null){ge.current.activeId=nt;return}const Sn=setTimeout(()=>{ge.current.activeId=nt},50);return()=>clearTimeout(Sn)},[nt]),{active:D,activeIndex:h,attributes:K,data:I,rect:T,index:A,newIndex:gt,items:u,isOver:_,isSorting:oe,isDragging:z,listeners:ce,node:S,overIndex:b,over:W,setNodeRef:te,setActivatorNodeRef:X,setDroppableNodeRef:R,setDraggableNodeRef:Q,transform:Xt??Ge,transition:Lt()};function Lt(){if(Xt||Wt&&ge.current.newIndex===A)return Zbe;if(!(lt&&!t0(O)||!c)&&(oe||Ot))return sa.Transition.toString({...c,property:Rj})}}function r0e(t,e){var n,r;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(n=t==null?void 0:t.draggable)!=null?n:e.draggable,droppable:(r=t==null?void 0:t.droppable)!=null?r:e.droppable}}function my(t){if(!t)return!1;const e=t.data.current;return!!(e&&"sortable"in e&&typeof e.sortable=="object"&&"containerId"in e.sortable&&"items"in e.sortable&&"index"in e.sortable)}const o0e=[Ve.Down,Ve.Right,Ve.Up,Ve.Left],s0e=(t,e)=>{let{context:{active:n,collisionRect:r,droppableRects:o,droppableContainers:s,over:i,scrollableAncestors:a}}=e;if(o0e.includes(t.code)){if(t.preventDefault(),!n||!r)return;const l=[];s.getEnabled().forEach(d=>{if(!d||d!=null&&d.disabled)return;const h=o.get(d.id);if(h)switch(t.code){case Ve.Down:r.top<h.top&&l.push(d);break;case Ve.Up:r.top>h.top&&l.push(d);break;case Ve.Left:r.left>h.left&&l.push(d);break;case Ve.Right:r.left<h.left&&l.push(d);break}});const c=Rye({collisionRect:r,droppableRects:o,droppableContainers:l});let u=uj(c,"id");if(u===(i==null?void 0:i.id)&&c.length>1&&(u=c[1].id),u!=null){const d=s.get(n.id),h=s.get(u),f=h?o.get(h.id):null,p=h==null?void 0:h.node.current;if(p&&f&&d&&h){const b=n0(p).some((M,T)=>a[T]!==M),w=Pj(d,h),k=i0e(d,h),x=b||!w?{x:0,y:0}:{x:k?r.width-f.width:0,y:k?r.height-f.height:0},A={x:f.left,y:f.top};return x.x&&x.y?A:Gh(A,x)}}}};function Pj(t,e){return!my(t)||!my(e)?!1:t.data.current.sortable.containerId===e.data.current.sortable.containerId}function i0e(t,e){return!my(t)||!my(e)||!Pj(t,e)?!1:t.data.current.sortable.index<e.data.current.sortable.index}const a0e="_selectorCard_1t620_2",l0e="_selected_1t620_6",c0e="_closeIcon_1t620_16",u0e="_resultInput_1t620_20",d0e="_addCustomField_1t620_24",h0e="_selector_1t620_2",f0e="_listItemMeta_1t620_35",p0e="_item_1t620_42",xs={selectorCard:a0e,selected:l0e,closeIcon:c0e,resultInput:u0e,addCustomField:d0e,selector:h0e,listItemMeta:f0e,item:p0e},m0e="_blurContainer_dfxrr_2",g0e="_visible_dfxrr_18",y0e="_container_dfxrr_22",y1={blurContainer:m0e,visible:g0e,container:y0e};function Dj({children:t,visible:e,className:n,onBlur:r}){const[o,s]=v.useState(e);v.useEffect(()=>{e&&s(!0)},[e]);const i=Qb({translateX:e?-100:0,opacity:e?1:0,onRest:()=>{e||s(!1)}});return!e&&!o?null:gn.createPortal(m.jsx(Wh.div,{className:be(y1.blurContainer,e&&y1.visible),onClick:r,style:{visibility:o?"visible":"hidden",opacity:i.opacity},children:m.jsx(Wh.div,{className:be(y1.container,n),onClick:a=>a.stopPropagation(),style:{transform:i.translateX.to(a=>`translateY(${a}%)`),opacity:i.opacity},children:t})}),document.getElementById("drawer-global-root"))}const b0e="_customeFieldInput_1ehjn_2",v0e="_addFieldButtonContainer_1ehjn_12",w0e="_descriptionInput_1ehjn_21",C0e="_descriptionContainer_1ehjn_25",x0e="_marginBottom_1ehjn_31",wi={customeFieldInput:b0e,addFieldButtonContainer:v0e,descriptionInput:w0e,descriptionContainer:C0e,marginBottom:x0e},k0e=({className:t,onSubmit:e})=>{const n=kn(),[r,o]=$.useState({icon:"octicon:goal-24",selectedIconColor:"#607d8b",type:"metric",title:"",unit:"",description:""}),{addRecordField:s}=Uy();return m.jsxs("div",{className:be(t),children:[m.jsx(Ft.ItemMeta,{className:wi.marginBottom,logo:m.jsx(ae,{width:24,icon:"solar:text-field-linear"}),title:n.formatMessage({defaultMessage:"Field Name",id:"label-record-custom.name.label"}),description:n.formatMessage({defaultMessage:"Ex: Push-ups, Squats",id:"label-record-custom.name.description"}),rightComponent:m.jsx(jo,{value:r.title,onChange:i=>o({...r,title:i.target.value}),border:"dash",className:wi.customeFieldInput})}),m.jsxs("div",{className:wi.descriptionContainer,children:[m.jsx(Ft.ItemMeta,{logo:m.jsx(ae,{value:r.unit,width:24,icon:"solar:info-circle-bold"}),title:n.formatMessage({defaultMessage:"Description",id:"label-record-custom.description.label"})}),m.jsx(jo,{border:"dash",placeholder:"More information of the field",className:wi.descriptionInput,onChange:i=>o({...r,description:i.target.value})})]}),m.jsx(Ft.ItemMeta,{className:wi.marginBottom,logo:m.jsx(ae,{value:r.unit,width:24,icon:"lsicon:number-filled"}),title:n.formatMessage({defaultMessage:"Field Unit",id:"label-record-custom.unit.label"}),description:n.formatMessage({defaultMessage:"Ex: minutes, hours, reps, kg",id:"label-record-custom.unit.description"}),rightComponent:m.jsx(jo,{border:"dash",onChange:i=>o({...r,unit:i.target.value}),className:wi.customeFieldInput})}),m.jsx(Ft.ItemMeta,{className:wi.marginBottom,logo:m.jsx(ae,{width:24,icon:"solar:box-minimalistic-outline"}),title:n.formatMessage({defaultMessage:"Type",id:"label-record-custom.type.label"}),rightComponent:m.jsx(U1,{isButton:!0,value:r.type,onChangeValue:i=>o({...r,type:i}),options:[{label:"Metric",value:"metric"},{label:"Note",value:"note"}]})}),m.jsx(oj,{selectedIcon:r.icon,setSelectedIcon:i=>o({...r,icon:i}),selectedColor:r.selectedIconColor,setSelectedColor:i=>o({...r,selectedIconColor:i})}),m.jsx("div",{className:wi.addFieldButtonContainer,children:m.jsx(Gt,{block:!0,size:"lg",type:"primary",onClick:()=>{const i=s(r);e==null||e(i)},children:n.formatMessage({defaultMessage:"Save",id:"label-record-custom.save"})})})]})},S0e="_container_1bkp1_2",E0e="_drawer_1bkp1_6",T0e="_header_1bkp1_14",b1={container:S0e,drawer:E0e,header:T0e},_0e=({visible:t,onClose:e,onSubmit:n})=>{const r=kn();return m.jsxs(Dj,{className:b1.drawer,visible:t,onBlur:e,children:[m.jsxs("div",{className:b1.header,children:[m.jsx(me.Title,{noMargin:!0,level:3,children:r.formatMessage({defaultMessage:"Add more field to record",id:"label-record-custom.title"})}),m.jsx(ae,{width:32,icon:"material-symbols:close-rounded",onClick:e})]}),m.jsx(k0e,{className:b1.container,onSubmit:n})]})},A0e="_groupContainer_n258c_2",I0e="_groupOver_n258c_12",M0e="_groupTitle_n258c_17",v1={groupContainer:A0e,groupOver:I0e,groupTitle:M0e},R0e=({id:t,title:e,items:n,children:r})=>{const{setNodeRef:o,isOver:s}=_j({id:t,data:{type:"Group",items:n}});return m.jsxs("div",{ref:o,className:be(v1.groupContainer,s&&v1.groupOver),children:[m.jsx(me.Title,{noMargin:!0,level:4,className:v1.groupTitle,children:e}),m.jsx(Ybe,{items:n,strategy:Gbe,children:r})]})},P0e=({id:t,children:e,isDragging:n})=>{const{attributes:r,listeners:o,setNodeRef:s,transform:i,transition:a}=n0e({id:t}),l={transform:sa.Transform.toString(i),transition:a,opacity:n?0:1};return m.jsx("div",{ref:s,style:l,...r,...o,children:e})},D0e=({selectedRecords:t=[],setSelectedRecords:e,fieldGroups:n,setFieldGroups:r})=>{const{getAllRecordFields:o}=Uy(),s=kn(),[i,a]=$.useState(!1),[l,c]=$.useState(o()),[u,d]=$.useState(null);$.useEffect(()=>{c(o())},[]);const h=_ye(iR(gE),iR(pE,{coordinateGetter:s0e})),f=A=>{if(A in n)return A;for(const I of n)if(I.fields.includes(A))return I.id;return null},p=A=>l.find(I=>I.id===A),y=A=>{d(A.active.id)},b=A=>{var _,R;const{active:I,over:M}=A;if(d(null),!M)return;const T=f(I.id),S=f(M.id);if(T&&S&&T===S){const D=[...n],O=D.findIndex(N=>N.id===T);if(O!==-1){const N=D[O].fields.indexOf(I.id),K=D[O].fields.indexOf(M.id);D[O].fields=bE(D[O].fields,N,K)}r(D)}else if(T&&S&&T!==S){const D=[...n],O=D.findIndex(K=>K.id===T),N=D.findIndex(K=>K.id===S);if(O!==-1&&N!==-1){const[K]=D[O].fields.splice(D[O].fields.indexOf(I.id),1),Q=D[N].fields.indexOf(M.id);Q!==-1?D[N].fields.splice(Q,0,K):D[N].fields.push(K)}r(D)}else if(T&&((R=(_=M.data)==null?void 0:_.current)==null?void 0:R.type)==="Group"&&T!==M.id){const D=[...n],O=D.findIndex(K=>K.id===T),N=D.findIndex(K=>K.id===M.id);if(O!==-1&&N!==-1){const[K]=D[O].fields.splice(D[O].fields.indexOf(I.id),1);D[N].fields.push(K)}r(D)}},w=({id:A})=>{const I=new Set([...t,A]);e([...I]);const M=[...n];M.some(S=>S.fields.includes(A))||r([...M,{id:qn(),title:s.formatMessage({id:"label-group",defaultMessage:"Group"})+` ${M.length+1}`,fields:[A]}])},k=A=>{e(t.filter(M=>M!==A));const I=n.map(M=>({...M,fields:M.fields.filter(T=>T!==A)})).filter(M=>M.fields.length>0);r(I)},x=u?p(u):null;return console.log({recordFields:l}),m.jsxs("div",{children:[m.jsx(_0e,{visible:i,onSubmit:A=>{a(!1),c([...l,A]),w({id:A.id})},onClose:()=>a(!1)}),m.jsx(hye,{options:l.map(A=>({...A,label:A.title,value:A.id})),classes:{container:xs.selector},renderInput:()=>t.length===0?m.jsx(me.Text,{children:"Record & Metric"}):m.jsx("div",{className:xs.resultInput,children:t.map(A=>{const I=l.find(M=>M.id===A);return m.jsxs("div",{className:xs.selected,children:[m.jsx(me.Text,{children:I==null?void 0:I.title}),m.jsx(ae,{icon:"material-symbols:close-rounded",width:16,height:16,className:xs.closeIcon,onClick:()=>k(A)})]},A)})}),renderOptionFooter:({close:A})=>m.jsx("div",{onClick:()=>{a(!0),A()},className:xs.addCustomField,children:m.jsx(me.Text,{children:s.formatMessage({id:"label-add-custom-field",defaultMessage:"Add custom field"})})}),onChange:({id:A},{close:I})=>{I(),w({id:A})},renderOption:A=>m.jsx(Ft.ItemMeta,{className:xs.selectorCard,logo:m.jsx(ae,{width:24,icon:A.icon}),title:A.title,description:A.description})}),m.jsxs(Ebe,{sensors:h,collisionDetection:Mye,onDragStart:y,onDragEnd:b,children:[m.jsx("div",{className:xs.groupsContainer,children:n.map(A=>m.jsx(R0e,{id:A.id,title:A.title,items:A.fields,children:A.fields.map(I=>{const M=p(I);return M?m.jsx(P0e,{id:I,children:m.jsx(Ft.ItemMeta,{logo:m.jsx(ae,{width:24,icon:"ci:drag-vertical"}),className:xs.item,title:M.title,description:M.description})},I):null})},A.id))}),m.jsx(zbe,{children:u&&x?m.jsx(Ft.ItemMeta,{className:xs.listItemMeta,logo:m.jsx(ae,{width:24,icon:"ci:drag-vertical"}),title:x.title,description:x.description,style:{backgroundColor:"#fff",borderRadius:"8px",boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.15)",padding:"15px",width:"300px"}}):null})]})]})},N0e="_menu_13t4o_2",O0e="_input_13t4o_7",L0e="_container_13t4o_27",V0e="_submitButton_13t4o_31",j0e="_deleteButton_13t4o_48",B0e="_footer_13t4o_63",$0e="_footerCenter_13t4o_74",Ci={menu:N0e,input:O0e,container:L0e,submitButton:V0e,deleteButton:j0e,footer:B0e,footerCenter:$0e},Nj=({initialValues:t,onSubmit:e,onClickDeleteButton:n})=>{const[r,o]=$.useState(t),{selectedRecords:s,checklistText:i,weeklyHobbies:a,startedAt:l,selectedIcon:c,selectedColor:u,fieldGroups:d}=r,h=A=>{o(I=>({...I,selectedRecords:A}))},f=A=>{o(I=>({...I,checklistText:A}))},p=A=>{o(I=>({...I,weeklyHobbies:A}))},y=A=>{o(I=>({...I,startedAt:A}))},b=A=>{o(I=>({...I,selectedIcon:A}))},w=A=>{o(I=>({...I,selectedColor:A}))},k=A=>{o(I=>({...I,fieldGroups:A}))},x=kn();return m.jsxs("div",{className:Ci.container,children:[m.jsxs(Xr,{className:Ci.container,children:[m.jsx("div",{className:Ci.menu}),m.jsx(Dhe,{placeholder:x.formatMessage({id:"CreateChecklist.label-create-checklist-input-placeholder",defaultMessage:"Write your task here"}),className:Ci.input,maxRows:3,autoFocus:!0,onChange:A=>{f(A.currentTarget.value)},value:i}),m.jsx(Gge,{values:a,setValues:p}),m.jsx(_d,{}),m.jsx(oj,{selectedIcon:c,setSelectedIcon:b,selectedColor:u,setSelectedColor:w}),m.jsx(_d,{}),m.jsx(hme,{date:l,setDate:y}),m.jsx(_d,{}),m.jsx(D0e,{selectedRecords:s,setSelectedRecords:h,fieldGroups:d,setFieldGroups:k})]}),m.jsx("div",{className:Ci.footer,children:m.jsxs("div",{className:Ci.footerCenter,children:[n&&m.jsx(Gt,{onClick:n,className:Ci.deleteButton,children:x.formatMessage({id:"CreateChecklist.label-delete",defaultMessage:"DELETE"})}),m.jsx(Gt,{type:"primary",className:Ci.submitButton,onClick:()=>{const A=d.filter(I=>I.fields.length>0);e({...r,fieldGroups:A})},children:x.formatMessage({id:"CreateChecklist.label-submit",defaultMessage:"SUBMIT"})})]})})]})},Oj=({weeklyHobbies:t})=>{if(!(!t||t.length===0))return t.length===7?{startedAt:new Date().toISOString(),dayOfWeek:"*",minute:"0",hour:"8",dayOfMonth:"*",month:"*"}:{startedAt:new Date().toISOString(),minute:"0",hour:"8",dayOfMonth:"*",month:"*",dayOfWeek:t.map(e=>{switch(e){case xe.Mon:return"1";case xe.Tue:return"2";case xe.Wed:return"3";case xe.Thu:return"4";case xe.Fri:return"5";case xe.Sat:return"6";case xe.Sun:return"0"}}).join(",")}},F0e=()=>{const t=new Date;return[xe.Sun,xe.Mon,xe.Tue,xe.Wed,xe.Thu,xe.Fri,xe.Sat][t.getDay()]},H0e=()=>{const{addChecklistTemplate:t}=Xi(),{addChecklist:e}=Fy(),n=Ao(),r=({startedAt:o,selectedRecords:s,selectedColor:i,selectedIcon:a,checklistText:l,weeklyHobbies:c,fieldGroups:u})=>{const d=Oj({weeklyHobbies:c}),{id:h}=t({title:l,repeat:d,avatar:{type:"icon",name:a,color:i},records:s,fieldGroups:u});d||e({title:l,checklistTemplateId:h,startedAt:o,endedAt:new Date(new Date(o).setHours(23,59,59,999)).toISOString()}),n("/")};return m.jsxs(m.Fragment,{children:[m.jsx(ou,{renderLeftComponent:()=>m.jsx(m.Fragment,{children:"Create Task"}),onClickLeftButton:()=>n("/")}),m.jsx(Nj,{onSubmit:r,initialValues:{selectedRecords:[],checklistText:"",weeklyHobbies:[F0e()],startedAt:new Date().toISOString().split("T")[0],selectedIcon:"material-symbols:checklist",selectedColor:"#607d8b",fieldGroups:[]}})]})};function z0e(t){return m.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",...t,children:m.jsx("g",{id:"warning_amber_24px",children:m.jsx("path",{id:"icon/alert/warning_amber_24px",fillRule:"evenodd",clipRule:"evenodd",d:"M4.46999 20.5037C2.93001 20.5037 1.96999 18.8337 2.74001 17.5037L10.27 4.49374C11.04 3.16375 12.96 3.16375 13.73 4.49374L21.26 17.5037C22.03 18.8337 21.07 20.5037 19.53 20.5037H4.46999ZM19.53 18.5037L12 5.49374L4.46999 18.5037H19.53ZM11 10.5037V12.5037C11 13.0537 11.45 13.5037 12 13.5037C12.55 13.5037 13 13.0537 13 12.5037V10.5037C13 9.95376 12.55 9.50375 12 9.50375C11.45 9.50375 11 9.95376 11 10.5037ZM13 17.5037V15.5037H11V17.5037H13Z"})})})}const U0e="_container_1avzj_1",W0e={container:U0e};function q0e(){return m.jsx("hr",{className:W0e.container})}const G0e="_overlay_1ach8_2",K0e="_container_1ach8_17",Y0e="_content_1ach8_29",X0e="_footer_1ach8_34",J0e="_header_1ach8_44",Q0e="_logo_1ach8_49",Z0e="_icon_1ach8_64",eve="_title_1ach8_70",tve="_primaryButton_1ach8_74",nve="_secondaryButton_1ach8_81",Po={overlay:G0e,container:K0e,content:Y0e,footer:X0e,header:J0e,logo:Q0e,icon:Z0e,title:eve,primaryButton:tve,secondaryButton:nve};function Lj({visible:t,primaryButtonText:e,secondaryButtonText:n,primaryButtonOnClick:r,secondaryButtonClick:o,content:s,title:i}){return t?m.jsx("div",{className:Po.overlay,children:m.jsxs("div",{className:Po.container,children:[m.jsxs("div",{className:Po.header,children:[m.jsx("div",{className:Po.logo,children:m.jsx(z0e,{className:Po.icon})}),m.jsx(me.Title,{className:Po.title,level:3,noMargin:!0,children:i})]}),m.jsx(q0e,{}),m.jsx("div",{className:Po.content,children:s}),m.jsxs("div",{className:Po.footer,children:[m.jsx(Gt,{size:"lg",type:"ghost",className:Po.secondaryButton,onClick:o,children:n}),m.jsx(Gt,{onClick:r,size:"lg",className:Po.primaryButton,children:e})]})]})}):null}const rve=t=>t!=null&&t.dayOfWeek?t.dayOfWeek==="*"?[xe.Sun,xe.Mon,xe.Tue,xe.Wed,xe.Thu,xe.Fri,xe.Sat]:t.dayOfWeek.split(",").map(e=>{switch(e){case"0":return xe.Sun;case"1":return xe.Mon;case"2":return xe.Tue;case"3":return xe.Wed;case"4":return xe.Thu;case"5":return xe.Fri;case"6":return xe.Sat;default:return xe.Sun}}):[new Date().getDay()],ove=()=>{var f,p,y;const{checklistTemplate:t,deleteChecklistTemplate:e}=Xi(),{id:n}=uN(),r=t[n||""],{updateChecklistTemplate:o}=Xi(),s=Ao(),i=kn(),a=({startedAt:b,selectedRecords:w,selectedColor:k,selectedIcon:x,checklistText:A,weeklyHobbies:I,fieldGroups:M})=>{const T=Oj({weeklyHobbies:I});o({id:r.id,records:w,title:A,repeat:T,avatar:{type:"icon",name:x,color:k},fieldGroups:M}),s("/")},[l,c]=$.useState(!1),u=()=>{c(!0)},d=()=>{n&&(e(n),c(!1),s("/"))},h=()=>{c(!1)};return r?m.jsxs(m.Fragment,{children:[m.jsx(ou,{renderLeftComponent:()=>m.jsx(m.Fragment,{children:"Edit Task"}),onClickLeftButton:()=>s("/")}),m.jsx(Lj,{visible:l,title:i.formatMessage({id:"EditChecklistTemplate.delete-confirm-title",defaultMessage:"Delete Checklist Template"}),primaryButtonText:i.formatMessage({id:"EditChecklistTemplate..delete-confirm-ok",defaultMessage:"Delete"}),primaryButtonOnClick:d,secondaryButtonText:i.formatMessage({id:"EditChecklistTemplate..delete-confirm-cancel",defaultMessage:"Cancel"}),secondaryButtonClick:h,content:m.jsx(me.Text,{children:i.formatMessage({id:"ChecklistTemplate.delete-confirm-message",defaultMessage:"Are you sure you want to delete this checklist template? This action cannot be undone."})})}),m.jsx(Nj,{onClickDeleteButton:u,onSubmit:a,initialValues:{selectedRecords:r.records,checklistText:r.title,weeklyHobbies:rve(r.repeat),startedAt:(f=r==null?void 0:r.repeat)!=null&&f.startedAt?new Date(r.repeat.startedAt).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],selectedIcon:(p=r==null?void 0:r.avatar)==null?void 0:p.name,selectedColor:((y=r==null?void 0:r.avatar)==null?void 0:y.color)||"#607d8b",fieldGroups:r.fieldGroups}})]}):null},sve="_container_1czko_1",ive={container:sve},ave=()=>{const{chartData:t,updateChartDate:e}=Cx();$.useEffect(()=>{e()},[]);const n={stroke:{curve:"smooth"},fill:{type:"gradient"},xaxis:{categories:t==null?void 0:t.categories}},r=[{name:"weight",data:t==null?void 0:t.weights},{name:"belly's size",data:t==null?void 0:t.bellySizes}];return!t||!t.categories||(t==null?void 0:t.categories.length)===0||(t==null?void 0:t.weights.length)===0||(t==null?void 0:t.bellySizes.length)===0?null:m.jsxs(Xr,{className:ive.container,children:[m.jsx(me.Title,{level:3,noMargin:!0,children:"Timeline"}),m.jsx(w9,{options:n,series:r,type:"line"})]})},lve="_header_1oykc_1",cve="_iconSuccess_1oykc_7",uve="_numberInput_1oykc_13",dve="_kgText_1oykc_21",hve="_titleAnswer_1oykc_27",fve="_iconAnswerContainer_1oykc_33",pve="_inputContainer_1oykc_37",mve="_questionTitle_1oykc_44",gve="_divider_1oykc_48",yve="_editFooter_1oykc_54",ot={header:lve,iconSuccess:cve,numberInput:uve,kgText:dve,titleAnswer:hve,iconAnswerContainer:fve,inputContainer:pve,questionTitle:mve,divider:gve,editFooter:yve},bve="_player_109l2_14",vve="_currentContainer_109l2_19",wve="_icon_109l2_33",Zp={player:bve,currentContainer:vve,icon:wve},Cve=t=>new Date(t.getTime()-24*60*60*1e3),xve=t=>new Date(t.getTime()+24*60*60*1e3),kve=({date:t,onDateChange:e,getText:n})=>{const r=new Date(t).toLocaleDateString()===new Date().toLocaleDateString();return m.jsxs("div",{className:Zp.player,children:[m.jsx(ae,{onClick:()=>e(Cve(t)),width:30,icon:"basil:skip-prev-outline",className:Zp.icon}),m.jsx("div",{className:Zp.currentContainer,onClick:()=>e(new Date),children:n({isToday:r})}),m.jsx(ae,{onClick:()=>e(xve(t)),width:30,icon:"basil:skip-next-outline",className:Zp.icon})]})},Sve="_container_fgz2s_1",Eve={container:Sve},wR=()=>{const[t,e]=$.useState(new Date),{updateCurrentBodyMetric:n}=Cx(),r=o=>{e(o),n({date:o})};return m.jsx("div",{className:Eve.container,children:m.jsx(kve,{date:t,onDateChange:r,getText:({isToday:o})=>o?"Today":new Date(t).toLocaleDateString()})})},Tve=()=>{const[t,e]=$.useState(40),[n,r]=$.useState(50),{addBodyMetric:o,currentBodyMetric:s,currentDay:i}=Cx(),[a,l]=$.useState(!!s);$.useEffect(()=>{l(!!s)},[s]),$.useEffect(()=>{s&&(e(s.weight),r(s.bellySize))},[s]);const c=kn();return a&&s?m.jsxs(Xr,{children:[m.jsx(wR,{}),m.jsxs("div",{className:ot.header,children:[m.jsx(ae,{width:100,color:"rgba(16,154,0,0.16)",icon:"ion:checkmark-done-circle-outline",className:ot.iconSuccess}),m.jsx(me.Title,{level:3,className:ot.questionTitle,children:c.formatMessage({id:"pregnant-weight-record.label-recorded",defaultMessage:"You've already recorded your weight and belly's size."})})]}),m.jsx("div",{className:ot.divider}),m.jsxs("div",{className:ot.inputContainer,children:[m.jsxs("div",{className:ot.iconAnswerContainer,children:[m.jsx(ae,{width:24,icon:"icon-park-outline:industrial-scales"}),m.jsx(me.Text,{className:ot.titleAnswer,children:"Weight"})]}),m.jsx(jo,{type:"number",readOnly:!0,className:ot.numberInput,value:s.weight,step:"0.01",min:20,max:120}),m.jsx(me.Text,{className:ot.kgText,children:"Kg"})]}),m.jsxs("div",{className:ot.inputContainer,children:[m.jsxs("div",{className:ot.iconAnswerContainer,children:[m.jsx(ae,{width:24,icon:"twemoji:straight-ruler"}),m.jsx(me.Text,{className:ot.titleAnswer,children:"Belly's Size"})]}),m.jsx(jo,{type:"number",readOnly:!0,className:ot.numberInput,value:s.bellySize,step:"0.01",min:20,max:120}),m.jsx(me.Text,{className:ot.kgText,children:"Cm"})]}),m.jsx("div",{className:ot.editFooter,children:m.jsx(Gt,{onClick:()=>{l(!1)},children:"EDIT"})})]}):m.jsxs(Xr,{children:[m.jsx(wR,{}),m.jsx("div",{children:m.jsx(me.Title,{level:3,className:ot.questionTitle,children:c.formatMessage({id:"pregnant-weight-record.label-pregnant-weight",defaultMessage:"What's your weight {{day}}? And how's your belly growing, mama?"},{day:new Date(i).toLocaleDateString()===new Date().toLocaleDateString()?"today":new Date(i).toLocaleDateString()})})}),m.jsx("div",{className:ot.divider}),m.jsxs("div",{className:ot.inputContainer,children:[m.jsxs("div",{className:ot.iconAnswerContainer,children:[m.jsx(ae,{width:24,icon:"icon-park-outline:industrial-scales"}),m.jsx(me.Text,{className:ot.titleAnswer,children:"Weight"})]}),m.jsx(jo,{type:"number",border:"dash",className:ot.numberInput,onChange:u=>e(Number(u.target.value)),value:t,step:"0.01",min:20,max:120}),m.jsx(me.Text,{className:ot.kgText,children:"Kg"})]}),m.jsxs("div",{className:ot.inputContainer,children:[m.jsxs("div",{className:ot.iconAnswerContainer,children:[m.jsx(ae,{width:24,icon:"twemoji:straight-ruler"}),m.jsx(me.Text,{className:ot.titleAnswer,children:"Belly's Size"})]}),m.jsx(jo,{type:"number",border:"dash",className:ot.numberInput,value:n,onChange:u=>r(Number(u.target.value)),step:"0.01",min:20,max:120}),m.jsx(me.Text,{className:ot.kgText,children:"Cm"})]}),m.jsx(Gt,{onClick:()=>{o({weight:t,bellySize:n,createdAt:i.toISOString()}),l(!0)},children:"SUBMIT"})]})},_ve=()=>m.jsxs("div",{children:[m.jsx(Tve,{}),m.jsx(ave,{})]}),Ave="_card_1reeb_1",Ive="_checklistItem_1reeb_6",Mve="_checklistTemplateContainer_1reeb_11",Rve="_checklistBody_1reeb_16",Pve="_text_1reeb_21",Dve="_checkbox_1reeb_26",Nve="_label_1reeb_31",Ove="_enabled_1reeb_40",Lve="_footer_1reeb_45",Vve="_editIcon_1reeb_49",jve="_deleteIcon_1reeb_60",Dr={card:Ave,checklistItem:Ive,checklistTemplateContainer:Mve,checklistBody:Rve,text:Pve,checkbox:Dve,label:Nve,enabled:Ove,footer:Lve,editIcon:Vve,deleteIcon:jve},Bve=()=>{const{getRecommendChecklistTemplates:t,selectedChecklistTemplates:e,updateSelectedChecklistTemplate:n,deleteChecklistTemplate:r}=Xi(),o=kn(),s=Ao(),[i,a]=$.useState(!1),[l,c]=$.useState(null),u=p=>{var w;const y=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],b=((w=p==null?void 0:p.dayOfWeek)==null?void 0:w.split(","))||[];return b.includes("*")?[{enabled:!0,text:o.formatMessage({id:"PregnantIntro.repeat.everyday",defaultMessage:"Every day"})}]:[0,1,2,3,4,5,6].map(k=>({day:k,enabled:b.includes(k.toString())||b.includes("*"),text:o.formatMessage({id:`PregnantIntro.repeat.${k}`,defaultMessage:y[k]})}))},d=p=>{c(p),a(!0)},h=()=>{l&&(r(l),a(!1),c(null))},f=()=>{a(!1),c(null)};return m.jsxs(m.Fragment,{children:[m.jsx(ou,{renderLeftComponent:()=>o.formatMessage({id:"ChecklistTemplatePageInfo.back",defaultMessage:"Back"})}),m.jsx(Xr,{className:Dr.card,children:m.jsxs(m.Fragment,{children:[m.jsx("p",{className:Dr.label,children:o.formatMessage({id:"PregnantIntro.checklists-management",defaultMessage:"Checklist Template Management"})}),t().map(({id:p,title:y,avatar:b,repeat:w})=>m.jsxs("div",{className:Dr.checklistTemplateContainer,children:[m.jsxs("div",{className:Dr.checklistItem,children:[m.jsx(ae,{color:b.color||"#8A8A8A",width:32,height:32,icon:b.name}),m.jsx("div",{className:Dr.checklistBody,children:m.jsx(me.Text,{className:Dr.text,children:y})}),m.jsx(ae,{className:Dr.editIcon,width:24,height:24,icon:"material-symbols:edit-outline",onClick:()=>s(`/edit-checklist/${p}`)}),m.jsx(ae,{className:Dr.deleteIcon,width:24,height:24,icon:"material-symbols:delete-outline",onClick:()=>d(p)}),m.jsx(XS,{checked:e.includes(p),onChange:k=>{const x=k.target.checked;n(x?[...e,p]:e.filter(A=>A!==p))},className:Dr.checkbox})]}),m.jsx("div",{className:Dr.footer,children:u(w).map(({enabled:k,text:x})=>m.jsx(me.Text,{className:be(Dr.text,{[Dr.enabled]:k}),children:x},x))})]},p))]})}),m.jsx(Lj,{visible:i,title:o.formatMessage({id:"ChecklistTemplate.delete-confirm-title",defaultMessage:"Delete Checklist Template"}),primaryButtonText:o.formatMessage({id:"ChecklistTemplate.delete-confirm-ok",defaultMessage:"Delete"}),primaryButtonOnClick:h,secondaryButtonText:o.formatMessage({id:"ChecklistTemplate.delete-confirm-cancel",defaultMessage:"Cancel"}),secondaryButtonClick:f,content:m.jsx(me.Text,{children:o.formatMessage({id:"ChecklistTemplate.delete-confirm-message",defaultMessage:"Are you sure you want to delete this checklist template? This action cannot be undone."})})})]})},$ve=JSON.parse(`[{"identify_key":"the_golden_heart","name":"The Golden Heart","detail":"In a small village nestled between rolling hills and a dense forest, there lived a young girl named Lily. Unlike other children who spent their days playing games, Lily spent her time helping others. She would carry water for the elderly, gather firewood for widows, and share her lunch with those who had none.\\n\\nOne particularly harsh winter, when food was scarce and the cold was unbearable, Lily noticed that many villagers were suffering. Despite having little herself, she decided to venture into the forest to find food and supplies for everyone. The forest was known to be dangerous, especially in winter, but Lily's heart was set on helping others.\\n\\nAs she wandered deeper into the forest, she came across an injured fox caught in a hunter's trap. While others might have passed by, Lily stopped to help. She carefully freed the fox, bandaged its wound, and shared her last piece of bread with it. To her surprise, the fox spoke to her in a gentle voice.\\n\\n'I am the Guardian of the Forest,' the fox said. 'Your kindness has touched my heart. I will help you find what you seek.' The fox led Lily to a hidden grove where magical plants grew year-round. There, she found enough food and medicinal herbs to help the entire village.\\n\\nBut the fox had one more gift. It touched Lily's chest with its paw, and her heart began to glow with a golden light. 'This is the mark of true kindness,' the fox explained. 'As long as you continue to help others, this light will guide you and protect you.'\\n\\nLily returned to the village with the supplies, and her golden heart became a beacon of hope. The villagers, inspired by her selflessness, began to help each other more. The village flourished, and Lily's story spread far and wide, teaching everyone that true wealth lies not in gold or possessions, but in the kindness we show to others.\\n\\nYears passed, and Lily grew into a wise woman. Her golden heart continued to glow, becoming brighter with each act of kindness she performed. The village became known as the Village of the Golden Heart, a place where people lived in harmony and helped one another without hesitation.","lesson":"True wealth and happiness come from helping others. Kindness is a gift that grows stronger the more you share it, and it has the power to transform not just individuals, but entire communities. When we put others before ourselves, we create a world where everyone can thrive."},{"identify_key":"the_patient_gardener","name":"The Patient Gardener","detail":"In a bustling city, there lived an old gardener named Mr. Chen. His small garden was the most beautiful in the neighborhood, filled with flowers that bloomed in perfect harmony. People often asked him his secret, but he would just smile and say, 'Patience and care.'\\n\\nOne spring, a young boy named Tom moved next door. He was eager to grow his own garden and asked Mr. Chen for help. The old gardener gave him some seeds and basic instructions, but Tom wanted results immediately. He watered the seeds too much, dug them up to check their progress, and became frustrated when nothing grew.\\n\\nMr. Chen watched quietly, then invited Tom to help in his garden. Day by day, he taught the boy about the importance of patience. 'Plants, like people, need time to grow,' he explained. 'You cannot rush nature.'\\n\\nAs the weeks passed, Tom learned to observe the subtle changes in his plants. He discovered that growth happens slowly, often when we're not looking. His garden began to flourish, and he found joy in the process of nurturing life.\\n\\nYears later, Tom became a successful botanist, known for his innovative methods. But he always credited Mr. Chen for teaching him the most important lesson: that true growth comes from patience and consistent care.","lesson":"Patience is a virtue that leads to lasting success. Growth takes time, and rushing the process often leads to failure. By learning to wait and nurture things properly, we can achieve beautiful results that last."},{"identify_key":"the_honest_merchant","name":"The Honest Merchant","detail":"In a busy marketplace, there was a merchant named Sarah who ran a small shop selling handmade crafts. While other merchants would sometimes exaggerate the quality of their goods to make sales, Sarah always told the truth about her products.\\n\\nOne day, a wealthy customer came to her shop looking for a special gift. Sarah showed her a beautiful vase, but honestly pointed out a small flaw that others might have hidden. The customer was surprised by her honesty and bought the vase anyway.\\n\\nWord of Sarah's integrity spread, and soon her shop became the most trusted in the market. People knew they could rely on her to tell the truth, even if it meant losing a sale. Her business grew steadily, while other merchants who had been dishonest found their customers leaving.\\n\\nYears later, when the market faced tough times, Sarah's shop remained strong. Her loyal customers supported her because they knew they could trust her completely. She became known as the merchant who proved that honesty is not just the best policy, but the most profitable one too.","lesson":"Honesty builds trust and lasting relationships. While it might seem easier to tell small lies for immediate gain, the truth always leads to better long-term success. Integrity is the foundation of any lasting business or relationship."},{"identify_key":"the_brave_little_turtle","name":"The Brave Little Turtle","detail":"In a peaceful pond, there lived a small turtle named Timmy. Unlike other turtles who spent their days basking in the sun, Timmy dreamed of exploring the world beyond the pond. The other turtles warned him about the dangers outside, but Timmy's curiosity grew stronger each day.\\n\\nOne morning, Timmy decided to venture beyond the pond's edge. The journey was difficult - he had to climb steep banks, cross a busy road, and face many challenges. But Timmy's determination never wavered.\\n\\nAlong the way, he met a lost baby bird who had fallen from its nest. Despite being small and slow, Timmy helped the bird find its way home. This act of kindness earned him the respect of the forest animals, who helped him on his journey.\\n\\nWhen Timmy finally reached the ocean, he discovered a whole new world of possibilities. He learned that being brave doesn't mean being fearless, but rather facing your fears and moving forward despite them. Timmy's adventures taught him that the world is full of wonder for those who dare to explore it.","lesson":"Courage is not the absence of fear, but the willingness to face it. By stepping out of our comfort zones, we discover new possibilities and grow stronger. Every challenge we overcome makes us more capable of handling future obstacles."},{"identify_key":"the_sharing_tree","name":"The Sharing Tree","detail":"In a magical forest, there stood an ancient tree that bore the most delicious fruits. The tree had a special rule: it would only give fruit to those who shared with others. Many animals came to the tree, but only those who understood the value of sharing received its gifts.\\n\\nOne summer, a young squirrel named Sammy discovered the tree. He was hungry and wanted to keep all the fruit for himself. But the tree remained silent, its branches empty. Sammy tried everything to get the fruit, but nothing worked.\\n\\nOne day, Sammy noticed a hungry bird nearby. Remembering his own hunger, he shared his last acorn with the bird. To his surprise, the tree suddenly bore fruit, and Sammy received more than he could have imagined.\\n\\nAs time passed, Sammy became known as the most generous squirrel in the forest. He learned that the more he shared, the more the tree gave him. The forest became a happier place as animals learned from Sammy's example, understanding that sharing brings abundance to everyone.","lesson":"Sharing creates abundance for everyone. When we give freely to others, we often receive more in return. Generosity creates a cycle of giving and receiving that benefits the entire community."},{"identify_key":"the_persistent_ant","name":"The Persistent Ant","detail":"In a vast garden, there lived a tiny ant named Andy. While other ants worked together in large groups, Andy preferred to work alone. He was determined to build the biggest anthill in the garden, despite being told it was impossible for one ant.\\n\\nDay after day, Andy carried grains of sand and small pebbles, building his hill one piece at a time. Other ants laughed at his efforts, but Andy never gave up. When storms came and destroyed his work, he simply started again.\\n\\nOne particularly bad storm left many ants homeless. Andy, who had built his hill strong and tall, opened his home to those in need. The other ants were amazed by his achievement and his kindness.\\n\\nThrough his persistence, Andy proved that even the smallest creature can achieve great things. His story taught the other ants that determination and hard work can overcome any obstacle, and that helping others makes success even sweeter.","lesson":"Persistence and determination can overcome any obstacle. Even the smallest efforts, when continued consistently, can lead to great achievements. Never underestimate the power of steady, focused work."},{"identify_key":"the_wise_owl","name":"The Wise Owl","detail":"In a tall oak tree, there lived an old owl named Oliver. He was known throughout the forest for his wisdom and ability to solve problems. Animals would come to him with their troubles, and he would listen carefully before offering advice.\\n\\nOne day, a group of young animals came to Oliver with a problem: they couldn't agree on how to share the forest's resources. Each wanted what was best for their own kind, leading to constant arguments.\\n\\nInstead of telling them what to do, Oliver asked them to look at the forest from his high perch. From there, they could see how everything was connected - how the trees provided homes for birds, how the streams watered the plants, and how each creature played a vital role.\\n\\nThe young animals realized that working together would benefit everyone. They learned that true wisdom comes from understanding how all parts of a system work together, and that cooperation leads to better solutions than competition.","lesson":"Wisdom comes from seeing the bigger picture and understanding how everything is connected. By working together and considering different perspectives, we can find solutions that benefit everyone."},{"identify_key":"the_grateful_rabbit","name":"The Grateful Rabbit","detail":"In a beautiful meadow, there lived a rabbit named Rosie who always found something to be grateful for, even on the darkest days. When it rained, she was thankful for the water that helped the flowers grow. When it was cold, she appreciated her warm burrow.\\n\\nOne winter, a terrible storm destroyed many animals' homes. While others complained about their losses, Rosie focused on what she still had - her family, her health, and her ability to help others.\\n\\nRosie organized the animals to help each other rebuild. She showed them how to find joy in small things, like a warm ray of sunshine or a shared meal. Her positive attitude inspired others to look for the good in every situation.\\n\\nAs the meadow recovered, the animals realized that Rosie's gratitude had helped them all survive the hard times. They learned that being thankful for what we have makes us stronger and helps us face life's challenges with hope.","lesson":"Gratitude transforms our perspective and helps us find joy in every situation. By focusing on what we have rather than what we lack, we can maintain hope and strength even in difficult times."},{"identify_key":"the_creative_caterpillar","name":"The Creative Caterpillar","detail":"In a colorful garden, there lived a caterpillar named Clara who saw the world differently from others. While other caterpillars followed the same paths and ate the same leaves, Clara explored new places and tried different foods.\\n\\nSome caterpillars thought Clara was strange, but she didn't mind. She believed that being different was a gift. She used her unique perspective to solve problems in new ways, like finding alternative food sources when the usual leaves were scarce.\\n\\nWhen it was time to build her cocoon, Clara chose a special spot that others had never considered. Her transformation was different too - she emerged as a butterfly with the most beautiful and unique pattern in the garden.\\n\\nClara's story taught the other creatures that being different is not a weakness but a strength. Her creativity and willingness to try new things led to discoveries that benefited the entire garden.","lesson":"Creativity and being different are strengths, not weaknesses. By embracing our uniqueness and thinking outside the box, we can find new solutions and create beautiful things that others might never imagine."},{"identify_key":"the_friendly_dragon","name":"The Friendly Dragon","detail":"In a kingdom surrounded by mountains, there lived a dragon named Drake. Unlike other dragons who hoarded gold and scared villagers, Drake was kind and helpful. He used his fire breath to light the town's lamps and his wings to create gentle breezes for the crops.\\n\\nAt first, the villagers were afraid of Drake, but he patiently showed them that he meant no harm. He helped build bridges, cleared paths through the mountains, and even babysat the children when their parents were busy.\\n\\nOne day, a group of knights came to slay the dragon, believing all dragons were dangerous. The villagers stood up for Drake, explaining how he had helped them. The knights were amazed to see a dragon who used his powers for good.\\n\\nDrake's story spread throughout the kingdom, teaching everyone that we shouldn't judge others by their appearance or what we've heard about them. True character is shown through actions, not stereotypes.","lesson":"Don't judge others by their appearance or what you've heard about them. Everyone deserves a chance to show their true character through their actions. Kindness and understanding can break down even the strongest prejudices."},{"identify_key":"the_determined_seed","name":"The Determined Seed","detail":"In a dry, rocky field, there was a tiny seed that dreamed of growing into a great tree. The other seeds told it that the soil was too poor and the conditions too harsh, but this seed refused to give up.\\n\\nDay after day, the seed pushed its roots deeper into the ground, searching for water and nutrients. It faced many challenges - scorching sun, strong winds, and hungry animals. But each obstacle made it stronger.\\n\\nYears passed, and the seed grew into a magnificent tree. Its roots had broken through the rocks, creating paths for water to flow. Its shade provided shelter for animals, and its leaves enriched the soil. The once-barren field became a thriving ecosystem.\\n\\nThe tree's story inspired other seeds to try growing in difficult places. They learned that challenges can be opportunities for growth, and that determination can transform even the harshest conditions into something beautiful.","lesson":"Challenges can be opportunities for growth. With determination and perseverance, we can overcome even the most difficult circumstances and create something beautiful that benefits others."},{"identify_key":"the_musical_stream","name":"The Musical Stream","detail":"In a quiet valley, there flowed a stream that had lost its song. Once, it had been known for its beautiful melodies as it danced over rocks and through meadows. But over time, it had become silent and still.\\n\\nOne day, a young girl named Melody came to the stream. She noticed its silence and decided to help it find its music again. She started by clearing away the fallen leaves and branches that had blocked its path. Then, she carefully placed small stones in patterns that would create gentle ripples.\\n\\nAs the water began to flow freely again, it started to make soft sounds. Melody added more stones, each placed with care to create different notes. Soon, the stream was singing a beautiful melody that echoed through the valley.\\n\\nThe stream's music attracted birds and animals, who added their own voices to the symphony. The valley became alive with sound, and people came from far and wide to hear the stream's song. Melody had shown that sometimes, all it takes is a little care and attention to bring back the music in our lives.","lesson":"Beauty and joy can be found in the simplest things. By taking care of our surroundings and adding our own creative touch, we can bring harmony and music to the world around us."},{"identify_key":"the_colorful_chameleon","name":"The Colorful Chameleon","detail":"In a vibrant jungle, there lived a chameleon named Charlie who was different from other chameleons. While his friends changed colors to blend in with their surroundings, Charlie loved to stand out with bright, bold colors.\\n\\nAt first, the other chameleons thought Charlie was strange. They believed that blending in was the only way to be safe. But Charlie showed them that being different could be beautiful and useful too.\\n\\nOne day, a group of lost butterflies flew into the jungle. They were tired and couldn't find their way home. Charlie used his bright colors to create a path of light through the dark jungle, guiding the butterflies to safety.\\n\\nThe other chameleons learned that sometimes, standing out and being different can help others. They began to appreciate their ability to change colors not just for hiding, but for creating beauty and helping those in need.","lesson":"Being different is a gift that can be used to help others. Sometimes, standing out and being unique is more valuable than blending in with the crowd."},{"identify_key":"the_dreaming_star","name":"The Dreaming Star","detail":"High in the night sky, there was a small star named Stella who had big dreams. While other stars were content to simply shine, Stella wanted to learn about the world below. She watched the Earth with wonder, curious about everything she saw.\\n\\nOne night, Stella noticed a little girl named Luna looking up at the stars. Luna was feeling sad and alone. Stella decided to shine extra bright, creating a special pattern of light just for Luna.\\n\\nLuna saw the star's special message and smiled. She started to write stories about the stars, imagining their adventures and dreams. Her stories brought joy to many children, and soon, people all over the world were looking up at the stars with wonder.\\n\\nStella learned that even though she couldn't visit Earth, she could still touch people's lives through her light. Her dreams of connecting with the world below came true in a way she never expected.","lesson":"Dreams can come true in unexpected ways. Even when we can't achieve our goals exactly as we planned, we can still make a difference and touch others' lives in meaningful ways."},{"identify_key":"the_helping_hands","name":"The Helping Hands","detail":"In a busy city, there was a small community garden where people from different backgrounds came together. Each person had their own plot, but they all shared tools and knowledge. The garden was a place of peace and cooperation.\\n\\nOne summer, a terrible storm damaged many of the garden plots. Some people lost their entire crops, while others had minor damage. Instead of focusing on their own losses, everyone came together to help each other rebuild.\\n\\nThey shared seeds, tools, and time. Those with undamaged plots offered space to those who had lost everything. They worked together to make the garden stronger than before, adding better drainage and wind protection.\\n\\nThe garden became a symbol of community strength. People learned that by helping others, they created a stronger, more resilient community. The garden flourished, and so did the friendships that grew there.","lesson":"Community strength comes from helping each other. When we work together and support one another, we can overcome any challenge and create something beautiful that benefits everyone."},{"identify_key":"the_wise_mountain","name":"The Wise Mountain","detail":"In a distant land, there stood an ancient mountain that had watched over the valley for thousands of years. The mountain had seen many changes - seasons coming and going, rivers changing course, and civilizations rising and falling.\\n\\nPeople would come to the mountain seeking wisdom, but the mountain never spoke. Instead, it taught through its presence. It showed that true strength comes from standing firm in the face of change, that beauty can be found in every season, and that perspective changes everything.\\n\\nOne day, a young shepherd named Kira came to the mountain, troubled by the changes in her village. She sat quietly, watching the mountain's shadow move across the valley. As she observed, she began to understand that change is natural and necessary.\\n\\nThe mountain taught Kira that wisdom comes from observation and patience. She returned to her village with a new understanding of how to face change with grace and strength.","lesson":"True wisdom comes from observation and patience. By learning to see the bigger picture and understanding that change is natural, we can face life's challenges with grace and strength."},{"identify_key":"the_dancing_clouds","name":"The Dancing Clouds","detail":"In the vast sky, there lived a group of clouds who loved to dance. They would swirl and twirl, creating beautiful patterns that delighted everyone who looked up. But one cloud, named Cirrus, was different. She preferred to stay still and watch the others dance.\\n\\nThe other clouds tried to convince Cirrus to join them, but she was afraid of making mistakes. She thought her movements wouldn't be as graceful as the others. One day, a strong wind came and forced all the clouds to move.\\n\\nTo her surprise, Cirrus discovered that she could dance too. Her movements were unique and beautiful in their own way. The other clouds were amazed by her style and began to incorporate her moves into their dances.\\n\\nThe sky became more beautiful than ever, with each cloud adding its own special touch to the dance. Cirrus learned that everyone has their own unique way of moving and that the beauty of dance comes from the combination of different styles.","lesson":"Everyone has their own unique talents and ways of expression. By embracing our individuality and sharing it with others, we can create something more beautiful than we could ever achieve alone."},{"identify_key":"the_healing_garden","name":"The Healing Garden","detail":"In a hospital courtyard, there was a neglected garden that had once been beautiful. The plants were wilted, the paths were overgrown, and no one visited anymore. But a young patient named Maya saw its potential.\\n\\nDespite being in a wheelchair, Maya started to care for the garden. She planted flowers that could grow in shade, added herbs with healing properties, and created paths that were accessible to everyone. Other patients began to help, each adding their own touch to the garden.\\n\\nAs the garden grew, it became a place of healing and hope. Patients would come to sit among the flowers, finding peace and strength in nature's beauty. Doctors noticed that patients who spent time in the garden recovered faster.\\n\\nThe garden taught everyone that healing comes in many forms. Sometimes, the act of creating something beautiful can be the best medicine of all.","lesson":"Healing can come from unexpected places. By creating beauty and nurturing life, we can bring hope and strength to ourselves and others."},{"identify_key":"the_singing_stones","name":"The Singing Stones","detail":"On a remote beach, there were special stones that could sing when the waves touched them. Each stone had its own unique sound, creating a beautiful symphony when the tide came in. But the stones were scattered and disorganized, their music chaotic.\\n\\nA young musician named Rio discovered the stones and decided to organize them. He spent days listening to each stone's sound, then arranged them in a pattern that created harmonious melodies. The stones' music became more beautiful than ever.\\n\\nPeople came from far and wide to hear the stones' song. They would sit on the beach, letting the music wash over them like the waves. The stones taught them that even the most ordinary things can create extraordinary beauty when they work together in harmony.","lesson":"Harmony comes from working together. When we organize our talents and work in concert with others, we can create something more beautiful than we could ever achieve alone."},{"identify_key":"the_light_bearer","name":"The Light Bearer","detail":"In a village that had lost its way, there lived a young girl named Lucia who carried a special lantern. The lantern's light was different from ordinary light - it could show people their true paths when they were lost.\\n\\nAt first, the villagers were afraid of the light. They had grown comfortable in their darkness and didn't want to see the truth. But Lucia was patient. She would sit with people, sharing her light gently until they were ready to see.\\n\\nOne by one, the villagers began to accept the light. They discovered new paths and possibilities they had never imagined. The village transformed, becoming a place of hope and growth.\\n\\nLucia's lantern taught everyone that sometimes, we need someone to show us the way, but we must be ready to see the light for ourselves.","lesson":"True guidance comes from within, but sometimes we need help to find our way. By being patient and gentle, we can help others discover their own path to light and truth."},{"identify_key":"the_whispering_wind","name":"The Whispering Wind","detail":"In a quiet valley, there was a special wind that could carry messages between people. It would whisper secrets, share stories, and bring comfort to those who were lonely. But the wind was shy and would only speak to those who truly listened.\\n\\nA young boy named Echo learned to listen to the wind. He would sit still for hours, hearing its stories and messages. The wind taught him about the valley's history, about the people who lived there, and about the importance of listening.\\n\\nEcho began to share the wind's messages with others. He helped people connect with each other, carrying their words and feelings through the valley. The community grew stronger as people learned to listen and understand each other better.\\n\\nThe wind's whispers taught everyone that true communication requires both speaking and listening, and that sometimes the most important messages are the ones we hear in the silence.","lesson":"True communication requires both speaking and listening. By learning to listen carefully, we can understand others better and create stronger connections in our community."}]`),Fve="_container_fe1o7_1",Hve="_header_fe1o7_7",CR={container:Fve,header:Hve},zve=()=>{const[t,e]=Yr("story_key",{story:{},seen:[]}),n=i=>{t.seen.includes(i)||e({...t,seen:[...t.seen,i]})},[r,o]=$.useState(""),s=i=>{o(r===i?"":i),n(i)};return m.jsx("div",{children:$ve.map(({name:i,detail:a,identify_key:l,lesson:c})=>{var u;return m.jsxs(Xr,{onClick:()=>{s(l)},className:CR.container,children:[m.jsxs("div",{className:CR.header,children:[m.jsx(me.Title,{level:3,noMargin:!0,children:i}),m.jsx(me.Text,{children:((u=t.seen)==null?void 0:u.includes(l))&&"Seen"})]}),r===l&&m.jsxs("div",{children:[m.jsx(me.Title,{level:4,noMargin:!0,children:"Detail"}),m.jsx(me.Paragraph,{children:a}),m.jsx(me.Title,{level:4,noMargin:!0,children:"Lesson"}),m.jsx(me.Paragraph,{children:c})]})]},l)})})},Uve=()=>null,vE=v.createContext({});function wE(t){const e=v.useRef(null);return e.current===null&&(e.current=t()),e.current}const CE=typeof window<"u",Vj=CE?v.useLayoutEffect:v.useEffect,s0=v.createContext(null),xE=v.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function jj(t){return typeof t=="object"&&t!==null}function kE(t){return jj(t)&&"offsetHeight"in t}class Wve extends v.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=n.offsetParent,o=kE(r)&&r.offsetWidth||0,s=this.props.sizeRef.current;s.height=n.offsetHeight||0,s.width=n.offsetWidth||0,s.top=n.offsetTop,s.left=n.offsetLeft,s.right=o-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function qve({children:t,isPresent:e,anchorX:n}){const r=v.useId(),o=v.useRef(null),s=v.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:i}=v.useContext(xE);return v.useInsertionEffect(()=>{const{width:a,height:l,top:c,left:u,right:d}=s.current;if(e||!o.current||!a||!l)return;const h=n==="left"?`left: ${u}`:`right: ${d}`;o.current.dataset.motionPopId=r;const f=document.createElement("style");return i&&(f.nonce=i),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${l}px !important;
            ${h}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.contains(f)&&document.head.removeChild(f)}},[e]),m.jsx(Wve,{isPresent:e,childRef:o,sizeRef:s,children:v.cloneElement(t,{ref:o})})}const Gve=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:o,presenceAffectsLayout:s,mode:i,anchorX:a})=>{const l=wE(Kve),c=v.useId();let u=!0,d=v.useMemo(()=>(u=!1,{id:c,initial:e,isPresent:n,custom:o,onExitComplete:h=>{l.set(h,!0);for(const f of l.values())if(!f)return;r&&r()},register:h=>(l.set(h,!1),()=>l.delete(h))}),[n,l,r]);return s&&u&&(d={...d}),v.useMemo(()=>{l.forEach((h,f)=>l.set(f,!1))},[n]),v.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),i==="popLayout"&&(t=m.jsx(qve,{isPresent:n,anchorX:a,children:t})),m.jsx(s0.Provider,{value:d,children:t})};function Kve(){return new Map}function Bj(t=!0){const e=v.useContext(s0);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:o}=e,s=v.useId();v.useEffect(()=>{if(t)return o(s)},[t]);const i=v.useCallback(()=>t&&r&&r(s),[s,r,t]);return!n&&r?[!1,i]:[!0]}const em=t=>t.key||"";function xR(t){const e=[];return v.Children.forEach(t,n=>{v.isValidElement(n)&&e.push(n)}),e}const Yve=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:o=!0,mode:s="sync",propagate:i=!1,anchorX:a="left"})=>{const[l,c]=Bj(i),u=v.useMemo(()=>xR(t),[t]),d=i&&!l?[]:u.map(em),h=v.useRef(!0),f=v.useRef(u),p=wE(()=>new Map),[y,b]=v.useState(u),[w,k]=v.useState(u);Vj(()=>{h.current=!1,f.current=u;for(let I=0;I<w.length;I++){const M=em(w[I]);d.includes(M)?p.delete(M):p.get(M)!==!0&&p.set(M,!1)}},[w,d.length,d.join("-")]);const x=[];if(u!==y){let I=[...u];for(let M=0;M<w.length;M++){const T=w[M],S=em(T);d.includes(S)||(I.splice(M,0,T),x.push(T))}return s==="wait"&&x.length&&(I=x),k(xR(I)),b(u),null}const{forceRender:A}=v.useContext(vE);return m.jsx(m.Fragment,{children:w.map(I=>{const M=em(I),T=i&&!l?!1:u===w||d.includes(M),S=()=>{if(p.has(M))p.set(M,!0);else return;let _=!0;p.forEach(R=>{R||(_=!1)}),_&&(A==null||A(),k(f.current),i&&(c==null||c()),r&&r())};return m.jsx(Gve,{isPresent:T,initial:!h.current||n?void 0:!1,custom:e,presenceAffectsLayout:o,mode:s,onExitComplete:T?void 0:S,anchorX:a,children:I},M)})})},tm=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],kR={value:null};function Xve(t,e){let n=new Set,r=new Set,o=!1,s=!1;const i=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1},l=0;function c(d){i.has(d)&&(u.schedule(d),t()),l++,d(a)}const u={schedule:(d,h=!1,f=!1)=>{const y=f&&o?n:r;return h&&i.add(d),y.has(d)||y.add(d),d},cancel:d=>{r.delete(d),i.delete(d)},process:d=>{if(a=d,o){s=!0;return}o=!0,[n,r]=[r,n],n.forEach(c),e&&kR.value&&kR.value.frameloop[e].push(l),l=0,n.clear(),o=!1,s&&(s=!1,u.process(d))}};return u}const Us={},Jve=40;function $j(t,e){let n=!1,r=!0;const o={delta:0,timestamp:0,isProcessing:!1},s=()=>n=!0,i=tm.reduce((x,A)=>(x[A]=Xve(s,e?A:void 0),x),{}),{setup:a,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:h,render:f,postRender:p}=i,y=()=>{const x=Us.useManualTiming?o.timestamp:performance.now();n=!1,Us.useManualTiming||(o.delta=r?1e3/60:Math.max(Math.min(x-o.timestamp,Jve),1)),o.timestamp=x,o.isProcessing=!0,a.process(o),l.process(o),c.process(o),u.process(o),d.process(o),h.process(o),f.process(o),p.process(o),o.isProcessing=!1,n&&e&&(r=!1,t(y))},b=()=>{n=!0,r=!0,o.isProcessing||t(y)};return{schedule:tm.reduce((x,A)=>{const I=i[A];return x[A]=(M,T=!1,S=!1)=>(n||b(),I.schedule(M,T,S)),x},{}),cancel:x=>{for(let A=0;A<tm.length;A++)i[tm[A]].cancel(x)},state:o,steps:i}}const Kr=t=>t,{schedule:xt,cancel:ia,state:dn,steps:w1}=$j(typeof requestAnimationFrame<"u"?requestAnimationFrame:Kr,!0),Fj=v.createContext({strict:!1}),SR={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},qc={};for(const t in SR)qc[t]={isEnabled:e=>SR[t].some(n=>!!e[n])};function Qve(t){for(const e in t)qc[e]={...qc[e],...t[e]}}const Zve=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function gy(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Zve.has(t)}let Hj=t=>!gy(t);function e1e(t){t&&(Hj=e=>e.startsWith("on")?!gy(e):t(e))}try{e1e(require("@emotion/is-prop-valid").default)}catch{}function t1e(t,e,n){const r={};for(const o in t)o==="values"&&typeof t.values=="object"||(Hj(o)||n===!0&&gy(o)||!e&&!gy(o)||t.draggable&&o.startsWith("onDrag"))&&(r[o]=t[o]);return r}function n1e(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...r)=>t(...r);return new Proxy(n,{get:(r,o)=>o==="create"?t:(e.has(o)||e.set(o,t(o)),e.get(o))})}const i0=v.createContext({});function a0(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Yh(t){return typeof t=="string"||Array.isArray(t)}const SE=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],EE=["initial",...SE];function l0(t){return a0(t.animate)||EE.some(e=>Yh(t[e]))}function zj(t){return!!(l0(t)||t.variants)}function r1e(t,e){if(l0(t)){const{initial:n,animate:r}=t;return{initial:n===!1||Yh(n)?n:void 0,animate:Yh(r)?r:void 0}}return t.inherit!==!1?e:{}}function o1e(t){const{initial:e,animate:n}=r1e(t,v.useContext(i0));return v.useMemo(()=>({initial:e,animate:n}),[ER(e),ER(n)])}function ER(t){return Array.isArray(t)?t.join(" "):t}const s1e=Symbol.for("motionComponentSymbol");function fc(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function i1e(t,e,n){return v.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):fc(n)&&(n.current=r))},[e])}const TE=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),a1e="framerAppearId",Uj="data-"+TE(a1e),Wj=v.createContext({}),{schedule:_E}=$j(queueMicrotask,!1);function l1e(t,e,n,r,o){var y,b;const{visualElement:s}=v.useContext(i0),i=v.useContext(Fj),a=v.useContext(s0),l=v.useContext(xE).reducedMotion,c=v.useRef(null);r=r||i.renderer,!c.current&&r&&(c.current=r(t,{visualState:e,parent:s,props:n,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,d=v.useContext(Wj);u&&!u.projection&&o&&(u.type==="html"||u.type==="svg")&&c1e(c.current,n,o,d);const h=v.useRef(!1);v.useInsertionEffect(()=>{u&&h.current&&u.update(n,a)});const f=n[Uj],p=v.useRef(!!f&&!((y=window.MotionHandoffIsComplete)!=null&&y.call(window,f))&&((b=window.MotionHasOptimisedAnimation)==null?void 0:b.call(window,f)));return Vj(()=>{u&&(h.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),_E.render(u.render),p.current&&u.animationState&&u.animationState.animateChanges())}),v.useEffect(()=>{u&&(!p.current&&u.animationState&&u.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{var w;(w=window.MotionHandoffMarkAsComplete)==null||w.call(window,f)}),p.current=!1))}),u}function c1e(t,e,n,r){const{layoutId:o,layout:s,drag:i,dragConstraints:a,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:qj(t.parent)),t.projection.setOptions({layoutId:o,layout:s,alwaysMeasureLayout:!!i||a&&fc(a),visualElement:t,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function qj(t){if(t)return t.options.allowProjection!==!1?t.projection:qj(t.parent)}let AE=()=>{};function u1e({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:o}){t&&Qve(t);function s(a,l){let c;const u={...v.useContext(xE),...a,layoutId:d1e(a)},{isStatic:d}=u,h=o1e(a),f=r(a,d);if(!d&&CE){h1e();const p=f1e(u);c=p.MeasureLayout,h.visualElement=l1e(o,f,u,e,p.ProjectionNode)}return m.jsxs(i0.Provider,{value:h,children:[c&&h.visualElement?m.jsx(c,{visualElement:h.visualElement,...u}):null,n(o,a,i1e(f,h.visualElement,l),f,d,h.visualElement)]})}s.displayName=`motion.${typeof o=="string"?o:`create(${o.displayName??o.name??""})`}`;const i=v.forwardRef(s);return i[s1e]=o,i}function d1e({layoutId:t}){const e=v.useContext(vE).id;return e&&t!==void 0?e+"-"+t:t}function h1e(t,e){v.useContext(Fj).strict}function f1e(t){const{drag:e,layout:n}=qc;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const Gj=t=>e=>typeof e=="string"&&e.startsWith(t),IE=Gj("--"),p1e=Gj("var(--"),ME=t=>p1e(t)?m1e.test(t.split("/*")[0].trim()):!1,m1e=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Xh={};function g1e(t){for(const e in t)Xh[e]=t[e],IE(e)&&(Xh[e].isCSSVariable=!0)}const Tu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],_u=new Set(Tu);function Kj(t,{layout:e,layoutId:n}){return _u.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Xh[t]||t==="opacity")}const Yj=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Ws=(t,e,n)=>n>e?e:n<t?t:n,Au={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Jh={...Au,transform:t=>Ws(0,1,t)},nm={...Au,default:1},TR={...Au,transform:Math.round},Gf=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),ki=Gf("deg"),Uo=Gf("%"),we=Gf("px"),y1e=Gf("vh"),b1e=Gf("vw"),_R={...Uo,parse:t=>Uo.parse(t)/100,transform:t=>Uo.transform(t*100)},v1e={rotate:ki,rotateX:ki,rotateY:ki,rotateZ:ki,scale:nm,scaleX:nm,scaleY:nm,scaleZ:nm,skew:ki,skewX:ki,skewY:ki,distance:we,translateX:we,translateY:we,translateZ:we,x:we,y:we,z:we,perspective:we,transformPerspective:we,opacity:Jh,originX:_R,originY:_R,originZ:we},RE={borderWidth:we,borderTopWidth:we,borderRightWidth:we,borderBottomWidth:we,borderLeftWidth:we,borderRadius:we,radius:we,borderTopLeftRadius:we,borderTopRightRadius:we,borderBottomRightRadius:we,borderBottomLeftRadius:we,width:we,maxWidth:we,height:we,maxHeight:we,top:we,right:we,bottom:we,left:we,padding:we,paddingTop:we,paddingRight:we,paddingBottom:we,paddingLeft:we,margin:we,marginTop:we,marginRight:we,marginBottom:we,marginLeft:we,backgroundPositionX:we,backgroundPositionY:we,...v1e,zIndex:TR,fillOpacity:Jh,strokeOpacity:Jh,numOctaves:TR},w1e={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},C1e=Tu.length;function x1e(t,e,n){let r="",o=!0;for(let s=0;s<C1e;s++){const i=Tu[s],a=t[i];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(i.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const c=Yj(a,RE[i]);if(!l){o=!1;const u=w1e[i]||i;r+=`${u}(${c}) `}n&&(e[i]=c)}}return r=r.trim(),n?r=n(e,o?"":r):o&&(r="none"),r}function PE(t,e,n){const{style:r,vars:o,transformOrigin:s}=t;let i=!1,a=!1;for(const l in e){const c=e[l];if(_u.has(l)){i=!0;continue}else if(IE(l)){o[l]=c;continue}else{const u=Yj(c,RE[l]);l.startsWith("origin")?(a=!0,s[l]=u):r[l]=u}}if(e.transform||(i||n?r.transform=x1e(e,t.transform,n):r.transform&&(r.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=s;r.transformOrigin=`${l} ${c} ${u}`}}const DE=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Ln=t=>!!(t&&t.getVelocity);function Xj(t,e,n){for(const r in e)!Ln(e[r])&&!Kj(r,n)&&(t[r]=e[r])}function k1e({transformTemplate:t},e){return v.useMemo(()=>{const n=DE();return PE(n,e,t),Object.assign({},n.vars,n.style)},[e])}function S1e(t,e){const n=t.style||{},r={};return Xj(r,n,t),Object.assign(r,k1e(t,e)),r}function E1e(t,e){const n={},r=S1e(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}const T1e={offset:"stroke-dashoffset",array:"stroke-dasharray"},_1e={offset:"strokeDashoffset",array:"strokeDasharray"};function A1e(t,e,n=1,r=0,o=!0){t.pathLength=1;const s=o?T1e:_1e;t[s.offset]=we.transform(-r);const i=we.transform(e),a=we.transform(n);t[s.array]=`${i} ${a}`}function Jj(t,{attrX:e,attrY:n,attrScale:r,pathLength:o,pathSpacing:s=1,pathOffset:i=0,...a},l,c,u){if(PE(t,a,c),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:d,style:h}=t;d.transform&&(h.transform=d.transform,delete d.transform),(h.transform||d.transformOrigin)&&(h.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),h.transform&&(h.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox),e!==void 0&&(d.x=e),n!==void 0&&(d.y=n),r!==void 0&&(d.scale=r),o!==void 0&&A1e(d,o,s,i,!1)}const Qj=()=>({...DE(),attrs:{}}),Zj=t=>typeof t=="string"&&t.toLowerCase()==="svg";function I1e(t,e,n,r){const o=v.useMemo(()=>{const s=Qj();return Jj(s,e,Zj(r),t.transformTemplate,t.style),{...s.attrs,style:{...s.style}}},[e]);if(t.style){const s={};Xj(s,t.style,t),o.style={...s,...o.style}}return o}const M1e=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function NE(t){return typeof t!="string"||t.includes("-")?!1:!!(M1e.indexOf(t)>-1||/[A-Z]/u.test(t))}function R1e(t=!1){return(n,r,o,{latestValues:s},i)=>{const l=(NE(n)?I1e:E1e)(r,s,i,n),c=t1e(r,typeof n=="string",t),u=n!==v.Fragment?{...c,...l,ref:o}:{},{children:d}=r,h=v.useMemo(()=>Ln(d)?d.get():d,[d]);return v.createElement(n,{...u,children:h})}}function AR(t){const e=[{},{}];return t==null||t.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function OE(t,e,n,r){if(typeof e=="function"){const[o,s]=AR(r);e=e(n!==void 0?n:t.custom,o,s)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[o,s]=AR(r);e=e(n!==void 0?n:t.custom,o,s)}return e}function Nm(t){return Ln(t)?t.get():t}function P1e({scrapeMotionValuesFromProps:t,createRenderState:e},n,r,o){return{latestValues:D1e(n,r,o,t),renderState:e()}}const eB=t=>(e,n)=>{const r=v.useContext(i0),o=v.useContext(s0),s=()=>P1e(t,e,r,o);return n?s():wE(s)};function D1e(t,e,n,r){const o={},s=r(t,{});for(const h in s)o[h]=Nm(s[h]);let{initial:i,animate:a}=t;const l=l0(t),c=zj(t);e&&c&&!l&&t.inherit!==!1&&(i===void 0&&(i=e.initial),a===void 0&&(a=e.animate));let u=n?n.initial===!1:!1;u=u||i===!1;const d=u?a:i;if(d&&typeof d!="boolean"&&!a0(d)){const h=Array.isArray(d)?d:[d];for(let f=0;f<h.length;f++){const p=OE(t,h[f]);if(p){const{transitionEnd:y,transition:b,...w}=p;for(const k in w){let x=w[k];if(Array.isArray(x)){const A=u?x.length-1:0;x=x[A]}x!==null&&(o[k]=x)}for(const k in y)o[k]=y[k]}}}return o}function LE(t,e,n){var s;const{style:r}=t,o={};for(const i in r)(Ln(r[i])||e.style&&Ln(e.style[i])||Kj(i,t)||((s=n==null?void 0:n.getValue(i))==null?void 0:s.liveStyle)!==void 0)&&(o[i]=r[i]);return o}const N1e={useVisualState:eB({scrapeMotionValuesFromProps:LE,createRenderState:DE})};function tB(t,e,n){const r=LE(t,e,n);for(const o in t)if(Ln(t[o])||Ln(e[o])){const s=Tu.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;r[s]=t[o]}return r}const O1e={useVisualState:eB({scrapeMotionValuesFromProps:tB,createRenderState:Qj})};function L1e(t,e){return function(r,{forwardMotionProps:o}={forwardMotionProps:!1}){const i={...NE(r)?O1e:N1e,preloadedFeatures:t,useRender:R1e(o),createVisualElement:e,Component:r};return u1e(i)}}function Qh(t,e,n){const r=t.getProps();return OE(r,e,n!==void 0?n:r.custom,t)}const EC=t=>Array.isArray(t);let Om;function V1e(){Om=void 0}const dr={now:()=>(Om===void 0&&dr.set(dn.isProcessing||Us.useManualTiming?dn.timestamp:performance.now()),Om),set:t=>{Om=t,queueMicrotask(V1e)}};function VE(t,e){t.indexOf(e)===-1&&t.push(e)}function jE(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class BE{constructor(){this.subscriptions=[]}add(e){return VE(this.subscriptions,e),()=>jE(this.subscriptions,e)}notify(e,n,r){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](e,n,r);else for(let s=0;s<o;s++){const i=this.subscriptions[s];i&&i(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function nB(t,e){return e?t*(1e3/e):0}const IR=30,j1e=t=>!isNaN(parseFloat(t));class B1e{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,o=!0)=>{var i,a;const s=dr.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const l of this.dependents)l.dirty();o&&((a=this.events.renderRequest)==null||a.notify(this.current))},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=dr.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=j1e(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new BE);const r=this.events[e].add(n);return e==="change"?()=>{r(),xt.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=dr.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>IR)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,IR);return nB(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,n;(e=this.dependents)==null||e.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Gc(t,e){return new B1e(t,e)}function $1e(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Gc(n))}function F1e(t){return EC(t)?t[t.length-1]||0:t}function H1e(t,e){const n=Qh(t,e);let{transitionEnd:r={},transition:o={},...s}=n||{};s={...s,...r};for(const i in s){const a=F1e(s[i]);$1e(t,i,a)}}function z1e(t){return!!(Ln(t)&&t.add)}function TC(t,e){const n=t.getValue("willChange");if(z1e(n))return n.add(e);if(!n&&Us.WillChange){const r=new Us.WillChange("auto");t.addValue("willChange",r),r.add(e)}}function rB(t){return t.props[Uj]}const U1e=t=>t!==null;function W1e(t,{repeat:e,repeatType:n="loop"},r){const o=t.filter(U1e),s=e&&n!=="loop"&&e%2===1?0:o.length-1;return o[s]}const q1e={type:"spring",stiffness:500,damping:25,restSpeed:10},G1e=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),K1e={type:"keyframes",duration:.8},Y1e={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},X1e=(t,{keyframes:e})=>e.length>2?K1e:_u.has(t)?t.startsWith("scale")?G1e(e[1]):q1e:Y1e;function J1e({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:o,repeat:s,repeatType:i,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function $E(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const Wo=t=>t*1e3,qo=t=>t/1e3,Kd=t=>Math.round(t*1e5)/1e5,FE=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Q1e(t){return t==null}const Z1e=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,HE=(t,e)=>n=>!!(typeof n=="string"&&Z1e.test(n)&&n.startsWith(t)||e&&!Q1e(n)&&Object.prototype.hasOwnProperty.call(n,e)),oB=(t,e,n)=>r=>{if(typeof r!="string")return r;const[o,s,i,a]=r.match(FE);return{[t]:parseFloat(o),[e]:parseFloat(s),[n]:parseFloat(i),alpha:a!==void 0?parseFloat(a):1}},ewe=t=>Ws(0,255,t),C1={...Au,transform:t=>Math.round(ewe(t))},tl={test:HE("rgb","red"),parse:oB("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+C1.transform(t)+", "+C1.transform(e)+", "+C1.transform(n)+", "+Kd(Jh.transform(r))+")"};function twe(t){let e="",n="",r="",o="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),o=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),o=t.substring(4,5),e+=e,n+=n,r+=r,o+=o),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:o?parseInt(o,16)/255:1}}const _C={test:HE("#"),parse:twe,transform:tl.transform},pc={test:HE("hsl","hue"),parse:oB("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Uo.transform(Kd(e))+", "+Uo.transform(Kd(n))+", "+Kd(Jh.transform(r))+")"},Pn={test:t=>tl.test(t)||_C.test(t)||pc.test(t),parse:t=>tl.test(t)?tl.parse(t):pc.test(t)?pc.parse(t):_C.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?tl.transform(t):pc.transform(t)},nwe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function rwe(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(FE))==null?void 0:e.length)||0)+(((n=t.match(nwe))==null?void 0:n.length)||0)>0}const sB="number",iB="color",owe="var",swe="var(",MR="${}",iwe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Zh(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},o=[];let s=0;const a=e.replace(iwe,l=>(Pn.test(l)?(r.color.push(s),o.push(iB),n.push(Pn.parse(l))):l.startsWith(swe)?(r.var.push(s),o.push(owe),n.push(l)):(r.number.push(s),o.push(sB),n.push(parseFloat(l))),++s,MR)).split(MR);return{values:n,split:a,indexes:r,types:o}}function aB(t){return Zh(t).values}function lB(t){const{split:e,types:n}=Zh(t),r=e.length;return o=>{let s="";for(let i=0;i<r;i++)if(s+=e[i],o[i]!==void 0){const a=n[i];a===sB?s+=Kd(o[i]):a===iB?s+=Pn.transform(o[i]):s+=o[i]}return s}}const awe=t=>typeof t=="number"?0:t;function lwe(t){const e=aB(t);return lB(t)(e.map(awe))}const aa={test:rwe,parse:aB,createTransformer:lB,getAnimatableNone:lwe};function x1(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function cwe({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let o=0,s=0,i=0;if(!e)o=s=i=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;o=x1(l,a,t+1/3),s=x1(l,a,t),i=x1(l,a,t-1/3)}return{red:Math.round(o*255),green:Math.round(s*255),blue:Math.round(i*255),alpha:r}}function yy(t,e){return n=>n>0?e:t}const wt=(t,e,n)=>t+(e-t)*n,k1=(t,e,n)=>{const r=t*t,o=n*(e*e-r)+r;return o<0?0:Math.sqrt(o)},uwe=[_C,tl,pc],dwe=t=>uwe.find(e=>e.test(t));function RR(t){const e=dwe(t);if(!e)return!1;let n=e.parse(t);return e===pc&&(n=cwe(n)),n}const PR=(t,e)=>{const n=RR(t),r=RR(e);if(!n||!r)return yy(t,e);const o={...n};return s=>(o.red=k1(n.red,r.red,s),o.green=k1(n.green,r.green,s),o.blue=k1(n.blue,r.blue,s),o.alpha=wt(n.alpha,r.alpha,s),tl.transform(o))},AC=new Set(["none","hidden"]);function hwe(t,e){return AC.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}const fwe=(t,e)=>n=>e(t(n)),Kf=(...t)=>t.reduce(fwe);function pwe(t,e){return n=>wt(t,e,n)}function zE(t){return typeof t=="number"?pwe:typeof t=="string"?ME(t)?yy:Pn.test(t)?PR:ywe:Array.isArray(t)?cB:typeof t=="object"?Pn.test(t)?PR:mwe:yy}function cB(t,e){const n=[...t],r=n.length,o=t.map((s,i)=>zE(s)(s,e[i]));return s=>{for(let i=0;i<r;i++)n[i]=o[i](s);return n}}function mwe(t,e){const n={...t,...e},r={};for(const o in n)t[o]!==void 0&&e[o]!==void 0&&(r[o]=zE(t[o])(t[o],e[o]));return o=>{for(const s in r)n[s]=r[s](o);return n}}function gwe(t,e){const n=[],r={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const s=e.types[o],i=t.indexes[s][r[s]],a=t.values[i]??0;n[o]=a,r[s]++}return n}const ywe=(t,e)=>{const n=aa.createTransformer(e),r=Zh(t),o=Zh(e);return r.indexes.var.length===o.indexes.var.length&&r.indexes.color.length===o.indexes.color.length&&r.indexes.number.length>=o.indexes.number.length?AC.has(t)&&!o.values.length||AC.has(e)&&!r.values.length?hwe(t,e):Kf(cB(gwe(r,o),o.values),n):yy(t,e)};function uB(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?wt(t,e,n):zE(t)(t,e)}const bwe=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>xt.update(e,n),stop:()=>ia(e),now:()=>dn.isProcessing?dn.timestamp:dr.now()}},dB=(t,e,n=10)=>{let r="";const o=Math.max(Math.round(e/n),2);for(let s=0;s<o;s++)r+=t(s/(o-1))+", ";return`linear(${r.substring(0,r.length-2)})`},by=2e4;function UE(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<by;)e+=n,r=t.next(e);return e>=by?1/0:e}function vwe(t,e=100,n){const r=n({...t,keyframes:[0,e]}),o=Math.min(UE(r),by);return{type:"keyframes",ease:s=>r.next(o*s).value/e,duration:qo(o)}}const wwe=5;function hB(t,e,n){const r=Math.max(e-wwe,0);return nB(n-t(r),e-r)}const Tt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},DR=.001;function Cwe({duration:t=Tt.duration,bounce:e=Tt.bounce,velocity:n=Tt.velocity,mass:r=Tt.mass}){let o,s,i=1-e;i=Ws(Tt.minDamping,Tt.maxDamping,i),t=Ws(Tt.minDuration,Tt.maxDuration,qo(t)),i<1?(o=c=>{const u=c*i,d=u*t,h=u-n,f=IC(c,i),p=Math.exp(-d);return DR-h/f*p},s=c=>{const d=c*i*t,h=d*n+n,f=Math.pow(i,2)*Math.pow(c,2)*t,p=Math.exp(-d),y=IC(Math.pow(c,2),i);return(-o(c)+DR>0?-1:1)*((h-f)*p)/y}):(o=c=>{const u=Math.exp(-c*t),d=(c-n)*t+1;return-.001+u*d},s=c=>{const u=Math.exp(-c*t),d=(n-c)*(t*t);return u*d});const a=5/t,l=kwe(o,s,a);if(t=Wo(t),isNaN(l))return{stiffness:Tt.stiffness,damping:Tt.damping,duration:t};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:i*2*Math.sqrt(r*c),duration:t}}}const xwe=12;function kwe(t,e,n){let r=n;for(let o=1;o<xwe;o++)r=r-t(r)/e(r);return r}function IC(t,e){return t*Math.sqrt(1-e*e)}const Swe=["duration","bounce"],Ewe=["stiffness","damping","mass"];function NR(t,e){return e.some(n=>t[n]!==void 0)}function Twe(t){let e={velocity:Tt.velocity,stiffness:Tt.stiffness,damping:Tt.damping,mass:Tt.mass,isResolvedFromDuration:!1,...t};if(!NR(t,Ewe)&&NR(t,Swe))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),o=r*r,s=2*Ws(.05,1,1-(t.bounce||0))*Math.sqrt(o);e={...e,mass:Tt.mass,stiffness:o,damping:s}}else{const n=Cwe(t);e={...e,...n,mass:Tt.mass},e.isResolvedFromDuration=!0}return e}function vy(t=Tt.visualDuration,e=Tt.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:o}=n;const s=n.keyframes[0],i=n.keyframes[n.keyframes.length-1],a={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:f}=Twe({...n,velocity:-qo(n.velocity||0)}),p=h||0,y=c/(2*Math.sqrt(l*u)),b=i-s,w=qo(Math.sqrt(l/u)),k=Math.abs(b)<5;r||(r=k?Tt.restSpeed.granular:Tt.restSpeed.default),o||(o=k?Tt.restDelta.granular:Tt.restDelta.default);let x;if(y<1){const I=IC(w,y);x=M=>{const T=Math.exp(-y*w*M);return i-T*((p+y*w*b)/I*Math.sin(I*M)+b*Math.cos(I*M))}}else if(y===1)x=I=>i-Math.exp(-w*I)*(b+(p+w*b)*I);else{const I=w*Math.sqrt(y*y-1);x=M=>{const T=Math.exp(-y*w*M),S=Math.min(I*M,300);return i-T*((p+y*w*b)*Math.sinh(S)+I*b*Math.cosh(S))/I}}const A={calculatedDuration:f&&d||null,next:I=>{const M=x(I);if(f)a.done=I>=d;else{let T=I===0?p:0;y<1&&(T=I===0?Wo(p):hB(x,I,M));const S=Math.abs(T)<=r,_=Math.abs(i-M)<=o;a.done=S&&_}return a.value=a.done?i:M,a},toString:()=>{const I=Math.min(UE(A),by),M=dB(T=>A.next(I*T).value,I,30);return I+"ms "+M},toTransition:()=>{}};return A}vy.applyToOptions=t=>{const e=vwe(t,100,vy);return t.ease=e.ease,t.duration=Wo(e.duration),t.type="keyframes",t};function MC({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:o=10,bounceStiffness:s=500,modifyTarget:i,min:a,max:l,restDelta:c=.5,restSpeed:u}){const d=t[0],h={done:!1,value:d},f=S=>a!==void 0&&S<a||l!==void 0&&S>l,p=S=>a===void 0?l:l===void 0||Math.abs(a-S)<Math.abs(l-S)?a:l;let y=n*e;const b=d+y,w=i===void 0?b:i(b);w!==b&&(y=w-d);const k=S=>-y*Math.exp(-S/r),x=S=>w+k(S),A=S=>{const _=k(S),R=x(S);h.done=Math.abs(_)<=c,h.value=h.done?w:R};let I,M;const T=S=>{f(h.value)&&(I=S,M=vy({keyframes:[h.value,p(h.value)],velocity:hB(x,S,h.value),damping:o,stiffness:s,restDelta:c,restSpeed:u}))};return T(0),{calculatedDuration:null,next:S=>{let _=!1;return!M&&I===void 0&&(_=!0,A(S),T(S)),I!==void 0&&S>=I?M.next(S-I):(!_&&A(S),h)}}}const ef=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r};function _we(t,e,n){const r=[],o=n||Us.mix||uB,s=t.length-1;for(let i=0;i<s;i++){let a=o(t[i],t[i+1]);if(e){const l=Array.isArray(e)?e[i]||Kr:e;a=Kf(l,a)}r.push(a)}return r}function Awe(t,e,{clamp:n=!0,ease:r,mixer:o}={}){const s=t.length;if(AE(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const i=t[0]===t[1];t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=_we(e,r,o),l=a.length,c=u=>{if(i&&u<t[0])return e[0];let d=0;if(l>1)for(;d<t.length-2&&!(u<t[d+1]);d++);const h=ef(t[d],t[d+1],u);return a[d](h)};return n?u=>c(Ws(t[0],t[s-1],u)):c}function Iwe(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const o=ef(0,e,r);t.push(wt(n,1,o))}}function Mwe(t){const e=[0];return Iwe(e,t.length-1),e}function Rwe(t,e){return t.map(n=>n*e)}const fB=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,Pwe=1e-7,Dwe=12;function Nwe(t,e,n,r,o){let s,i,a=0;do i=e+(n-e)/2,s=fB(i,r,o)-t,s>0?n=i:e=i;while(Math.abs(s)>Pwe&&++a<Dwe);return i}function Yf(t,e,n,r){if(t===e&&n===r)return Kr;const o=s=>Nwe(s,0,1,t,n);return s=>s===0||s===1?s:fB(o(s),e,r)}const Owe=Yf(.42,0,1,1),Lwe=Yf(0,0,.58,1),pB=Yf(.42,0,.58,1),Vwe=t=>Array.isArray(t)&&typeof t[0]!="number",mB=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,gB=t=>e=>1-t(1-e),yB=Yf(.33,1.53,.69,.99),WE=gB(yB),bB=mB(WE),vB=t=>(t*=2)<1?.5*WE(t):.5*(2-Math.pow(2,-10*(t-1))),qE=t=>1-Math.sin(Math.acos(t)),wB=gB(qE),CB=mB(qE),xB=t=>Array.isArray(t)&&typeof t[0]=="number",jwe={linear:Kr,easeIn:Owe,easeInOut:pB,easeOut:Lwe,circIn:qE,circInOut:CB,circOut:wB,backIn:WE,backInOut:bB,backOut:yB,anticipate:vB},Bwe=t=>typeof t=="string",OR=t=>{if(xB(t)){AE(t.length===4);const[e,n,r,o]=t;return Yf(e,n,r,o)}else if(Bwe(t))return jwe[t];return t};function $we(t,e){return t.map(()=>e||pB).splice(0,t.length-1)}function Yd({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const o=Vwe(r)?r.map(OR):OR(r),s={done:!1,value:e[0]},i=Rwe(n&&n.length===e.length?n:Mwe(e),t),a=Awe(i,e,{ease:Array.isArray(o)?o:$we(e,o)});return{calculatedDuration:t,next:l=>(s.value=a(l),s.done=l>=t,s)}}const Fwe=t=>t!==null;function GE(t,{repeat:e,repeatType:n="loop"},r,o=1){const s=t.filter(Fwe),a=o<0||e&&n!=="loop"&&e%2===1?0:s.length-1;return!a||r===void 0?s[a]:r}const Hwe={decay:MC,inertia:MC,tween:Yd,keyframes:Yd,spring:vy};function kB(t){typeof t.type=="string"&&(t.type=Hwe[t.type])}class KE{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const zwe=t=>t/100;class YE extends KE{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=(n=!0)=>{var r,o;if(n){const{motionValue:s}=this.options;s&&s.updatedAt!==dr.now()&&this.tick(dr.now())}this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(o=(r=this.options).onStop)==null||o.call(r))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;kB(e);const{type:n=Yd,repeat:r=0,repeatDelay:o=0,repeatType:s,velocity:i=0}=e;let{keyframes:a}=e;const l=n||Yd;l!==Yd&&typeof a[0]!="number"&&(this.mixKeyframes=Kf(zwe,uB(a[0],a[1])),a=[0,100]);const c=l({...e,keyframes:a});s==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...a].reverse(),velocity:-i})),c.calculatedDuration===null&&(c.calculatedDuration=UE(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+o,this.totalDuration=this.resolvedDuration*(r+1)-o,this.generator=c}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:r,totalDuration:o,mixKeyframes:s,mirroredGenerator:i,resolvedDuration:a,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:u,repeat:d,repeatType:h,repeatDelay:f,type:p,onUpdate:y,finalKeyframe:b}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-o/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const w=this.currentTime-c*(this.playbackSpeed>=0?1:-1),k=this.playbackSpeed>=0?w<0:w>o;this.currentTime=Math.max(w,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=o);let x=this.currentTime,A=r;if(d){const S=Math.min(this.currentTime,o)/a;let _=Math.floor(S),R=S%1;!R&&S>=1&&(R=1),R===1&&_--,_=Math.min(_,d+1),!!(_%2)&&(h==="reverse"?(R=1-R,f&&(R-=f/a)):h==="mirror"&&(A=i)),x=Ws(0,1,R)*a}const I=k?{done:!1,value:u[0]}:A.next(x);s&&(I.value=s(I.value));let{done:M}=I;!k&&l!==null&&(M=this.playbackSpeed>=0?this.currentTime>=o:this.currentTime<=0);const T=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&M);return T&&p!==MC&&(I.value=GE(u,this.options,b,this.speed)),y&&y(I.value),T&&this.finish(),I}then(e,n){return this.finished.then(e,n)}get duration(){return qo(this.calculatedDuration)}get time(){return qo(this.currentTime)}set time(e){var n;e=Wo(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(dr.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=qo(this.currentTime))}play(){var o,s;if(this.isStopped)return;const{driver:e=bwe,startTime:n}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),(s=(o=this.options).onPlay)==null||s.call(o);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(dr.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(e=this.options).onComplete)==null||n.call(e)}cancel(){var e,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(e=this.options).onCancel)==null||n.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),e.observe(this)}}function Uwe(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const nl=t=>t*180/Math.PI,RC=t=>{const e=nl(Math.atan2(t[1],t[0]));return PC(e)},Wwe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:RC,rotateZ:RC,skewX:t=>nl(Math.atan(t[1])),skewY:t=>nl(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},PC=t=>(t=t%360,t<0&&(t+=360),t),LR=RC,VR=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),jR=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),qwe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:VR,scaleY:jR,scale:t=>(VR(t)+jR(t))/2,rotateX:t=>PC(nl(Math.atan2(t[6],t[5]))),rotateY:t=>PC(nl(Math.atan2(-t[2],t[0]))),rotateZ:LR,rotate:LR,skewX:t=>nl(Math.atan(t[4])),skewY:t=>nl(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function DC(t){return t.includes("scale")?1:0}function NC(t,e){if(!t||t==="none")return DC(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,o;if(n)r=qwe,o=n;else{const a=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=Wwe,o=a}if(!o)return DC(e);const s=r[e],i=o[1].split(",").map(Kwe);return typeof s=="function"?s(i):i[s]}const Gwe=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return NC(n,e)};function Kwe(t){return parseFloat(t.trim())}const BR=t=>t===Au||t===we,Ywe=new Set(["x","y","z"]),Xwe=Tu.filter(t=>!Ywe.has(t));function Jwe(t){const e=[];return Xwe.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const hl={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>NC(e,"x"),y:(t,{transform:e})=>NC(e,"y")};hl.translateX=hl.x;hl.translateY=hl.y;const fl=new Set;let OC=!1,LC=!1,VC=!1;function SB(){if(LC){const t=Array.from(fl).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const o=Jwe(r);o.length&&(n.set(r,o),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const o=n.get(r);o&&o.forEach(([s,i])=>{var a;(a=r.getValue(s))==null||a.set(i)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}LC=!1,OC=!1,fl.forEach(t=>t.complete(VC)),fl.clear()}function EB(){fl.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(LC=!0)})}function Qwe(){VC=!0,EB(),SB(),VC=!1}class XE{constructor(e,n,r,o,s,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=o,this.element=s,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(fl.add(this),OC||(OC=!0,xt.read(EB),xt.resolveKeyframes(SB))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:o}=this;if(e[0]===null){const s=o==null?void 0:o.get(),i=e[e.length-1];if(s!==void 0)e[0]=s;else if(r&&n){const a=r.readValue(n,i);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=i),o&&s===void 0&&o.set(e[0])}Uwe(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),fl.delete(this)}cancel(){this.state==="scheduled"&&(fl.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Zwe=t=>t.startsWith("--");function eCe(t,e,n){Zwe(e)?t.style.setProperty(e,n):t.style[e]=n}function JE(t){let e;return()=>(e===void 0&&(e=t()),e)}const tCe=JE(()=>window.ScrollTimeline!==void 0),nCe={};function rCe(t,e){const n=JE(t);return()=>nCe[e]??n()}const TB=rCe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Cd=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,$R={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Cd([0,.65,.55,1]),circOut:Cd([.55,0,1,.45]),backIn:Cd([.31,.01,.66,-.59]),backOut:Cd([.33,1.53,.69,.99])};function _B(t,e){if(t)return typeof t=="function"?TB()?dB(t,e):"ease-out":xB(t)?Cd(t):Array.isArray(t)?t.map(n=>_B(n,e)||$R.easeOut):$R[t]}function oCe(t,e,n,{delay:r=0,duration:o=300,repeat:s=0,repeatType:i="loop",ease:a="easeOut",times:l}={},c=void 0){const u={[e]:n};l&&(u.offset=l);const d=_B(a,o);Array.isArray(d)&&(u.easing=d);const h={delay:r,duration:o,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:i==="reverse"?"alternate":"normal"};return c&&(h.pseudoElement=c),t.animate(u,h)}function AB(t){return typeof t=="function"&&"applyToOptions"in t}function sCe({type:t,...e}){return AB(t)&&TB()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class iCe extends KE{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:r,keyframes:o,pseudoElement:s,allowFlatten:i=!1,finalKeyframe:a,onComplete:l}=e;this.isPseudoElement=!!s,this.allowFlatten=i,this.options=e,AE(typeof e.type!="string");const c=sCe(e);this.animation=oCe(n,r,o,c,s),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const u=GE(o,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(u):eCe(n,r,u),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,n;(n=(e=this.animation).finish)==null||n.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,n;this.isPseudoElement||(n=(e=this.animation).commitStyles)==null||n.call(e)}get duration(){var n,r;const e=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return qo(Number(e))}get time(){return qo(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Wo(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&tCe()?(this.animation.timeline=e,Kr):n(this)}}const IB={anticipate:vB,backInOut:bB,circInOut:CB};function aCe(t){return t in IB}function lCe(t){typeof t.ease=="string"&&aCe(t.ease)&&(t.ease=IB[t.ease])}const FR=10;class cCe extends iCe{constructor(e){lCe(e),kB(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:r,onComplete:o,element:s,...i}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const a=new YE({...i,autoplay:!1}),l=Wo(this.finishedTime??this.time);n.setWithVelocity(a.sample(l-FR).value,a.sample(l).value,FR),a.stop()}}const HR=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(aa.test(t)||t==="0")&&!t.startsWith("url("));function uCe(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function dCe(t,e,n,r){const o=t[0];if(o===null)return!1;if(e==="display"||e==="visibility")return!0;const s=t[t.length-1],i=HR(o,e),a=HR(s,e);return!i||!a?!1:uCe(t)||(n==="spring"||AB(n))&&r}const hCe=new Set(["opacity","clipPath","filter","transform"]),fCe=JE(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function pCe(t){var c;const{motionValue:e,name:n,repeatDelay:r,repeatType:o,damping:s,type:i}=t;if(!kE((c=e==null?void 0:e.owner)==null?void 0:c.current))return!1;const{onUpdate:a,transformTemplate:l}=e.owner.getProps();return fCe()&&n&&hCe.has(n)&&(n!=="transform"||!l)&&!a&&!r&&o!=="mirror"&&s!==0&&i!=="inertia"}const mCe=40;class gCe extends KE{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:o=0,repeatDelay:s=0,repeatType:i="loop",keyframes:a,name:l,motionValue:c,element:u,...d}){var p;super(),this.stop=()=>{var y,b;this._animation&&(this._animation.stop(),(y=this.stopTimeline)==null||y.call(this)),(b=this.keyframeResolver)==null||b.cancel()},this.createdAt=dr.now();const h={autoplay:e,delay:n,type:r,repeat:o,repeatDelay:s,repeatType:i,name:l,motionValue:c,element:u,...d},f=(u==null?void 0:u.KeyframeResolver)||XE;this.keyframeResolver=new f(a,(y,b,w)=>this.onKeyframesResolved(y,b,h,!w),l,c,u),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(e,n,r,o){this.keyframeResolver=void 0;const{name:s,type:i,velocity:a,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=dr.now(),dCe(e,s,i,a)||((Us.instantAnimations||!l)&&(u==null||u(GE(e,r,n))),e[0]=e[e.length-1],r.duration=0,r.repeat=0);const h={startTime:o?this.resolvedAt?this.resolvedAt-this.createdAt>mCe?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:e},f=!c&&pCe(h)?new cCe({...h,element:h.motionValue.owner.current}):new YE(h);f.finished.then(()=>this.notifyFinished()).catch(Kr),this.pendingTimeline&&(this.stopTimeline=f.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=f}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),Qwe()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const QE=(t,e,n,r={},o,s)=>i=>{const a=$E(r,t)||{},l=a.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Wo(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:h=>{e.set(h),a.onUpdate&&a.onUpdate(h)},onComplete:()=>{i(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:s?void 0:o};J1e(a)||Object.assign(u,X1e(t,u)),u.duration&&(u.duration=Wo(u.duration)),u.repeatDelay&&(u.repeatDelay=Wo(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(d=!0)),(Us.instantAnimations||Us.skipAnimations)&&(d=!0,u.duration=0,u.delay=0),u.allowFlatten=!a.type&&!a.ease,d&&!s&&e.get()!==void 0){const h=W1e(u.keyframes,a);if(h!==void 0){xt.update(()=>{u.onUpdate(h),u.onComplete()});return}}return a.isSync?new YE(u):new gCe(u)},MB=new Set(["width","height","top","left","right","bottom",...Tu]);function yCe({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function RB(t,e,{delay:n=0,transitionOverride:r,type:o}={}){let{transition:s=t.getDefaultTransition(),transitionEnd:i,...a}=e;r&&(s=r);const l=[],c=o&&t.animationState&&t.animationState.getState()[o];for(const u in a){const d=t.getValue(u,t.latestValues[u]??null),h=a[u];if(h===void 0||c&&yCe(c,u))continue;const f={delay:n,...$E(s||{},u)},p=d.get();if(p!==void 0&&!d.isAnimating&&!Array.isArray(h)&&h===p&&!f.velocity)continue;let y=!1;if(window.MotionHandoffAnimation){const w=rB(t);if(w){const k=window.MotionHandoffAnimation(w,u,xt);k!==null&&(f.startTime=k,y=!0)}}TC(t,u),d.start(QE(u,d,h,t.shouldReduceMotion&&MB.has(u)?{type:!1}:f,t,y));const b=d.animation;b&&l.push(b)}return i&&Promise.all(l).then(()=>{xt.update(()=>{i&&H1e(t,i)})}),l}function jC(t,e,n={}){var l;const r=Qh(t,e,n.type==="exit"?(l=t.presenceContext)==null?void 0:l.custom:void 0);let{transition:o=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(o=n.transitionOverride);const s=r?()=>Promise.all(RB(t,r,n)):()=>Promise.resolve(),i=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=o;return bCe(t,e,u+c,d,h,n)}:()=>Promise.resolve(),{when:a}=o;if(a){const[c,u]=a==="beforeChildren"?[s,i]:[i,s];return c().then(()=>u())}else return Promise.all([s(),i(n.delay)])}function bCe(t,e,n=0,r=0,o=1,s){const i=[],a=(t.variantChildren.size-1)*r,l=o===1?(c=0)=>c*r:(c=0)=>a-c*r;return Array.from(t.variantChildren).sort(vCe).forEach((c,u)=>{c.notify("AnimationStart",e),i.push(jC(c,e,{...s,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(i)}function vCe(t,e){return t.sortNodePosition(e)}function wCe(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const o=e.map(s=>jC(t,s,n));r=Promise.all(o)}else if(typeof e=="string")r=jC(t,e,n);else{const o=typeof e=="function"?Qh(t,e,n.custom):e;r=Promise.all(RB(t,o,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}function PB(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}const CCe=EE.length;function DB(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?DB(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<CCe;n++){const r=EE[n],o=t.props[r];(Yh(o)||o===!1)&&(e[r]=o)}return e}const xCe=[...SE].reverse(),kCe=SE.length;function SCe(t){return e=>Promise.all(e.map(({animation:n,options:r})=>wCe(t,n,r)))}function ECe(t){let e=SCe(t),n=zR(),r=!0;const o=l=>(c,u)=>{var h;const d=Qh(t,u,l==="exit"?(h=t.presenceContext)==null?void 0:h.custom:void 0);if(d){const{transition:f,transitionEnd:p,...y}=d;c={...c,...y,...p}}return c};function s(l){e=l(t)}function i(l){const{props:c}=t,u=DB(t.parent)||{},d=[],h=new Set;let f={},p=1/0;for(let b=0;b<kCe;b++){const w=xCe[b],k=n[w],x=c[w]!==void 0?c[w]:u[w],A=Yh(x),I=w===l?k.isActive:null;I===!1&&(p=b);let M=x===u[w]&&x!==c[w]&&A;if(M&&r&&t.manuallyAnimateOnMount&&(M=!1),k.protectedKeys={...f},!k.isActive&&I===null||!x&&!k.prevProp||a0(x)||typeof x=="boolean")continue;const T=TCe(k.prevProp,x);let S=T||w===l&&k.isActive&&!M&&A||b>p&&A,_=!1;const R=Array.isArray(x)?x:[x];let D=R.reduce(o(w),{});I===!1&&(D={});const{prevResolvedValues:O={}}=k,N={...O,...D},K=z=>{S=!0,h.has(z)&&(_=!0,h.delete(z)),k.needsAnimating[z]=!0;const W=t.getValue(z);W&&(W.liveStyle=!1)};for(const z in N){const W=D[z],X=O[z];if(f.hasOwnProperty(z))continue;let le=!1;EC(W)&&EC(X)?le=!PB(W,X):le=W!==X,le?W!=null?K(z):h.add(z):W!==void 0&&h.has(z)?K(z):k.protectedKeys[z]=!0}k.prevProp=x,k.prevResolvedValues=D,k.isActive&&(f={...f,...D}),r&&t.blockInitialAnimation&&(S=!1),S&&(!(M&&T)||_)&&d.push(...R.map(z=>({animation:z,options:{type:w}})))}if(h.size){const b={};if(typeof c.initial!="boolean"){const w=Qh(t,Array.isArray(c.initial)?c.initial[0]:c.initial);w&&w.transition&&(b.transition=w.transition)}h.forEach(w=>{const k=t.getBaseTarget(w),x=t.getValue(w);x&&(x.liveStyle=!0),b[w]=k??null}),d.push({animation:b})}let y=!!d.length;return r&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(y=!1),r=!1,y?e(d):Promise.resolve()}function a(l,c){var d;if(n[l].isActive===c)return Promise.resolve();(d=t.variantChildren)==null||d.forEach(h=>{var f;return(f=h.animationState)==null?void 0:f.setActive(l,c)}),n[l].isActive=c;const u=i(l);for(const h in n)n[h].protectedKeys={};return u}return{animateChanges:i,setActive:a,setAnimateFunction:s,getState:()=>n,reset:()=>{n=zR(),r=!0}}}function TCe(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!PB(e,t):!1}function ja(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function zR(){return{animate:ja(!0),whileInView:ja(),whileHover:ja(),whileTap:ja(),whileDrag:ja(),whileFocus:ja(),exit:ja()}}class ka{constructor(e){this.isMounted=!1,this.node=e}update(){}}class _Ce extends ka{constructor(e){super(e),e.animationState||(e.animationState=ECe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();a0(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let ACe=0;class ICe extends ka{constructor(){super(...arguments),this.id=ACe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const o=this.node.animationState.setActive("exit",!e);n&&!e&&o.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const MCe={animation:{Feature:_Ce},exit:{Feature:ICe}};function tf(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}const ZE=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function Xf(t){return{point:{x:t.pageX,y:t.pageY}}}const RCe=t=>e=>ZE(e)&&t(e,Xf(e));function Xd(t,e,n,r){return tf(t,e,RCe(n),r)}function NB({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function PCe({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function DCe(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}const OB=1e-4,NCe=1-OB,OCe=1+OB,LB=.01,LCe=0-LB,VCe=0+LB;function Yn(t){return t.max-t.min}function jCe(t,e,n){return Math.abs(t-e)<=n}function UR(t,e,n,r=.5){t.origin=r,t.originPoint=wt(e.min,e.max,t.origin),t.scale=Yn(n)/Yn(e),t.translate=wt(n.min,n.max,t.origin)-t.originPoint,(t.scale>=NCe&&t.scale<=OCe||isNaN(t.scale))&&(t.scale=1),(t.translate>=LCe&&t.translate<=VCe||isNaN(t.translate))&&(t.translate=0)}function Jd(t,e,n,r){UR(t.x,e.x,n.x,r?r.originX:void 0),UR(t.y,e.y,n.y,r?r.originY:void 0)}function WR(t,e,n){t.min=n.min+e.min,t.max=t.min+Yn(e)}function BCe(t,e,n){WR(t.x,e.x,n.x),WR(t.y,e.y,n.y)}function qR(t,e,n){t.min=e.min-n.min,t.max=t.min+Yn(e)}function Qd(t,e,n){qR(t.x,e.x,n.x),qR(t.y,e.y,n.y)}const GR=()=>({translate:0,scale:1,origin:0,originPoint:0}),mc=()=>({x:GR(),y:GR()}),KR=()=>({min:0,max:0}),Rt=()=>({x:KR(),y:KR()});function Vr(t){return[t("x"),t("y")]}function S1(t){return t===void 0||t===1}function BC({scale:t,scaleX:e,scaleY:n}){return!S1(t)||!S1(e)||!S1(n)}function Ha(t){return BC(t)||VB(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function VB(t){return YR(t.x)||YR(t.y)}function YR(t){return t&&t!=="0%"}function wy(t,e,n){const r=t-n,o=e*r;return n+o}function XR(t,e,n,r,o){return o!==void 0&&(t=wy(t,o,r)),wy(t,n,r)+e}function $C(t,e=0,n=1,r,o){t.min=XR(t.min,e,n,r,o),t.max=XR(t.max,e,n,r,o)}function jB(t,{x:e,y:n}){$C(t.x,e.translate,e.scale,e.originPoint),$C(t.y,n.translate,n.scale,n.originPoint)}const JR=.999999999999,QR=1.0000000000001;function $Ce(t,e,n,r=!1){const o=n.length;if(!o)return;e.x=e.y=1;let s,i;for(let a=0;a<o;a++){s=n[a],i=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&yc(t,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),i&&(e.x*=i.x.scale,e.y*=i.y.scale,jB(t,i)),r&&Ha(s.latestValues)&&yc(t,s.latestValues))}e.x<QR&&e.x>JR&&(e.x=1),e.y<QR&&e.y>JR&&(e.y=1)}function gc(t,e){t.min=t.min+e,t.max=t.max+e}function ZR(t,e,n,r,o=.5){const s=wt(t.min,t.max,o);$C(t,e,n,s,r)}function yc(t,e){ZR(t.x,e.x,e.scaleX,e.scale,e.originX),ZR(t.y,e.y,e.scaleY,e.scale,e.originY)}function BB(t,e){return NB(DCe(t.getBoundingClientRect(),e))}function FCe(t,e,n){const r=BB(t,n),{scroll:o}=e;return o&&(gc(r.x,o.offset.x),gc(r.y,o.offset.y)),r}const $B=({current:t})=>t?t.ownerDocument.defaultView:null,eP=(t,e)=>Math.abs(t-e);function HCe(t,e){const n=eP(t.x,e.x),r=eP(t.y,e.y);return Math.sqrt(n**2+r**2)}class FB{constructor(e,n,{transformPagePoint:r,contextWindow:o,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=T1(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,f=HCe(d.offset,{x:0,y:0})>=3;if(!h&&!f)return;const{point:p}=d,{timestamp:y}=dn;this.history.push({...p,timestamp:y});const{onStart:b,onMove:w}=this.handlers;h||(b&&b(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=E1(h,this.transformPagePoint),xt.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:f,onSessionEnd:p,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=T1(d.type==="pointercancel"?this.lastMoveEventInfo:E1(h,this.transformPagePoint),this.history);this.startEvent&&f&&f(d,b),p&&p(d,b)},!ZE(e))return;this.dragSnapToOrigin=s,this.handlers=n,this.transformPagePoint=r,this.contextWindow=o||window;const i=Xf(e),a=E1(i,this.transformPagePoint),{point:l}=a,{timestamp:c}=dn;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(e,T1(a,this.history)),this.removeListeners=Kf(Xd(this.contextWindow,"pointermove",this.handlePointerMove),Xd(this.contextWindow,"pointerup",this.handlePointerUp),Xd(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ia(this.updatePoint)}}function E1(t,e){return e?{point:e(t.point)}:t}function tP(t,e){return{x:t.x-e.x,y:t.y-e.y}}function T1({point:t},e){return{point:t,delta:tP(t,HB(e)),offset:tP(t,zCe(e)),velocity:UCe(e,.1)}}function zCe(t){return t[0]}function HB(t){return t[t.length-1]}function UCe(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const o=HB(t);for(;n>=0&&(r=t[n],!(o.timestamp-r.timestamp>Wo(e)));)n--;if(!r)return{x:0,y:0};const s=qo(o.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const i={x:(o.x-r.x)/s,y:(o.y-r.y)/s};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function WCe(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?wt(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?wt(n,t,r.max):Math.min(t,n)),t}function nP(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function qCe(t,{top:e,left:n,bottom:r,right:o}){return{x:nP(t.x,n,o),y:nP(t.y,e,r)}}function rP(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function GCe(t,e){return{x:rP(t.x,e.x),y:rP(t.y,e.y)}}function KCe(t,e){let n=.5;const r=Yn(t),o=Yn(e);return o>r?n=ef(e.min,e.max-r,t.min):r>o&&(n=ef(t.min,t.max-o,e.min)),Ws(0,1,n)}function YCe(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const FC=.35;function XCe(t=FC){return t===!1?t=0:t===!0&&(t=FC),{x:oP(t,"left","right"),y:oP(t,"top","bottom")}}function oP(t,e,n){return{min:sP(t,e),max:sP(t,n)}}function sP(t,e){return typeof t=="number"?t:t[e]||0}const co={x:!1,y:!1};function zB(){return co.x||co.y}function JCe(t){return t==="x"||t==="y"?co[t]?null:(co[t]=!0,()=>{co[t]=!1}):co.x||co.y?null:(co.x=co.y=!0,()=>{co.x=co.y=!1})}const QCe=new WeakMap;class ZCe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Rt(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const o=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Xf(u).point)},s=(u,d)=>{const{drag:h,dragPropagation:f,onDragStart:p}=this.getProps();if(h&&!f&&(this.openDragLock&&this.openDragLock(),this.openDragLock=JCe(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Vr(b=>{let w=this.getAxisMotionValue(b).get()||0;if(Uo.test(w)){const{projection:k}=this.visualElement;if(k&&k.layout){const x=k.layout.layoutBox[b];x&&(w=Yn(x)*(parseFloat(w)/100))}}this.originPoint[b]=w}),p&&xt.postRender(()=>p(u,d)),TC(this.visualElement,"transform");const{animationState:y}=this.visualElement;y&&y.setActive("whileDrag",!0)},i=(u,d)=>{const{dragPropagation:h,dragDirectionLock:f,onDirectionLock:p,onDrag:y}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:b}=d;if(f&&this.currentDirection===null){this.currentDirection=exe(b),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",d.point,b),this.updateAxis("y",d.point,b),this.visualElement.render(),y&&y(u,d)},a=(u,d)=>this.stop(u,d),l=()=>Vr(u=>{var d;return this.getAnimationState(u)==="paused"&&((d=this.getAxisMotionValue(u).animation)==null?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new FB(e,{onSessionStart:o,onStart:s,onMove:i,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:$B(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:o}=n;this.startAnimation(o);const{onDragEnd:s}=this.getProps();s&&xt.postRender(()=>s(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:o}=this.getProps();if(!r||!rm(e,o,this.currentDirection))return;const s=this.getAxisMotionValue(e);let i=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(i=WCe(i,this.constraints[e],this.elastic[e])),s.set(i)}resolveConstraints(){var s;const{dragConstraints:e,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)==null?void 0:s.layout,o=this.constraints;e&&fc(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=qCe(r.layoutBox,e):this.constraints=!1,this.elastic=XCe(n),o!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Vr(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=YCe(r.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!fc(e))return!1;const r=e.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const s=FCe(r,o.root,this.visualElement.getTransformPagePoint());let i=GCe(o.layout.layoutBox,s);if(n){const a=n(PCe(i));this.hasMutatedConstraints=!!a,a&&(i=NB(a))}return i}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:o,dragTransition:s,dragSnapToOrigin:i,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=Vr(u=>{if(!rm(u,n,this.currentDirection))return;let d=l&&l[u]||{};i&&(d={min:0,max:0});const h=o?200:1e6,f=o?40:1e7,p={type:"inertia",velocity:r?e[u]:0,bounceStiffness:h,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...s,...d};return this.startAxisValueAnimation(u,p)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return TC(this.visualElement,e),r.start(QE(e,r,0,n,this.visualElement,!1))}stopAnimation(){Vr(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Vr(e=>{var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),o=r[n];return o||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Vr(n=>{const{drag:r}=this.getProps();if(!rm(n,r,this.currentDirection))return;const{projection:o}=this.visualElement,s=this.getAxisMotionValue(n);if(o&&o.layout){const{min:i,max:a}=o.layout.layoutBox[n];s.set(e[n]-wt(i,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!fc(n)||!r||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};Vr(i=>{const a=this.getAxisMotionValue(i);if(a&&this.constraints!==!1){const l=a.get();o[i]=KCe({min:l,max:l},this.constraints[i])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Vr(i=>{if(!rm(i,e,null))return;const a=this.getAxisMotionValue(i),{min:l,max:c}=this.constraints[i];a.set(wt(l,c,o[i]))})}addListeners(){if(!this.visualElement.current)return;QCe.set(this.visualElement,this);const e=this.visualElement.current,n=Xd(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();fc(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,s=o.addEventListener("measure",r);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),xt.read(r);const i=tf(window,"resize",()=>this.scalePositionWithinConstraints()),a=o.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Vr(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{i(),n(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:o=!1,dragConstraints:s=!1,dragElastic:i=FC,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:o,dragConstraints:s,dragElastic:i,dragMomentum:a}}}function rm(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function exe(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class txe extends ka{constructor(e){super(e),this.removeGroupControls=Kr,this.removeListeners=Kr,this.controls=new ZCe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Kr}unmount(){this.removeGroupControls(),this.removeListeners()}}const iP=t=>(e,n)=>{t&&xt.postRender(()=>t(e,n))};class nxe extends ka{constructor(){super(...arguments),this.removePointerDownListener=Kr}onPointerDown(e){this.session=new FB(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:$B(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:o}=this.node.getProps();return{onSessionStart:iP(e),onStart:iP(n),onMove:r,onEnd:(s,i)=>{delete this.session,o&&xt.postRender(()=>o(s,i))}}}mount(){this.removePointerDownListener=Xd(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Lm={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function aP(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const cd={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(we.test(t))t=parseFloat(t);else return t;const n=aP(t,e.target.x),r=aP(t,e.target.y);return`${n}% ${r}%`}},rxe={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,o=aa.parse(t);if(o.length>5)return r;const s=aa.createTransformer(t),i=typeof o[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;o[0+i]/=a,o[1+i]/=l;const c=wt(a,l,.5);return typeof o[2+i]=="number"&&(o[2+i]/=c),typeof o[3+i]=="number"&&(o[3+i]/=c),s(o)}};class oxe extends v.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:o}=this.props,{projection:s}=e;g1e(sxe),s&&(n.group&&n.group.add(s),r&&r.register&&o&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),Lm.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:o,isPresent:s}=this.props,{projection:i}=r;return i&&(i.isPresent=s,o||e.layoutDependency!==n||n===void 0||e.isPresent!==s?i.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?i.promote():i.relegate()||xt.postRender(()=>{const a=i.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),_E.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:o}=e;o&&(o.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(o),r&&r.deregister&&r.deregister(o))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function UB(t){const[e,n]=Bj(),r=v.useContext(vE);return m.jsx(oxe,{...t,layoutGroup:r,switchLayoutGroup:v.useContext(Wj),isPresent:e,safeToRemove:n})}const sxe={borderRadius:{...cd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:cd,borderTopRightRadius:cd,borderBottomLeftRadius:cd,borderBottomRightRadius:cd,boxShadow:rxe};function ixe(t,e,n){const r=Ln(t)?t:Gc(t);return r.start(QE("",r,e,n)),r.animation}const axe=(t,e)=>t.depth-e.depth;class lxe{constructor(){this.children=[],this.isDirty=!1}add(e){VE(this.children,e),this.isDirty=!0}remove(e){jE(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(axe),this.isDirty=!1,this.children.forEach(e)}}function cxe(t,e){const n=dr.now(),r=({timestamp:o})=>{const s=o-n;s>=e&&(ia(r),t(s-e))};return xt.setup(r,!0),()=>ia(r)}const WB=["TopLeft","TopRight","BottomLeft","BottomRight"],uxe=WB.length,lP=t=>typeof t=="string"?parseFloat(t):t,cP=t=>typeof t=="number"||we.test(t);function dxe(t,e,n,r,o,s){o?(t.opacity=wt(0,n.opacity??1,hxe(r)),t.opacityExit=wt(e.opacity??1,0,fxe(r))):s&&(t.opacity=wt(e.opacity??1,n.opacity??1,r));for(let i=0;i<uxe;i++){const a=`border${WB[i]}Radius`;let l=uP(e,a),c=uP(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||cP(l)===cP(c)?(t[a]=Math.max(wt(lP(l),lP(c),r),0),(Uo.test(c)||Uo.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=wt(e.rotate||0,n.rotate||0,r))}function uP(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const hxe=qB(0,.5,wB),fxe=qB(.5,.95,Kr);function qB(t,e,n){return r=>r<t?0:r>e?1:n(ef(t,e,r))}function dP(t,e){t.min=e.min,t.max=e.max}function Nr(t,e){dP(t.x,e.x),dP(t.y,e.y)}function hP(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function fP(t,e,n,r,o){return t-=e,t=wy(t,1/n,r),o!==void 0&&(t=wy(t,1/o,r)),t}function pxe(t,e=0,n=1,r=.5,o,s=t,i=t){if(Uo.test(e)&&(e=parseFloat(e),e=wt(i.min,i.max,e/100)-i.min),typeof e!="number")return;let a=wt(s.min,s.max,r);t===s&&(a-=e),t.min=fP(t.min,e,n,a,o),t.max=fP(t.max,e,n,a,o)}function pP(t,e,[n,r,o],s,i){pxe(t,e[n],e[r],e[o],e.scale,s,i)}const mxe=["x","scaleX","originX"],gxe=["y","scaleY","originY"];function mP(t,e,n,r){pP(t.x,e,mxe,n?n.x:void 0,r?r.x:void 0),pP(t.y,e,gxe,n?n.y:void 0,r?r.y:void 0)}function gP(t){return t.translate===0&&t.scale===1}function GB(t){return gP(t.x)&&gP(t.y)}function yP(t,e){return t.min===e.min&&t.max===e.max}function yxe(t,e){return yP(t.x,e.x)&&yP(t.y,e.y)}function bP(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function KB(t,e){return bP(t.x,e.x)&&bP(t.y,e.y)}function vP(t){return Yn(t.x)/Yn(t.y)}function wP(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class bxe{constructor(){this.members=[]}add(e){VE(this.members,e),e.scheduleRender()}remove(e){if(jE(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(o=>e===o);if(n===0)return!1;let r;for(let o=n;o>=0;o--){const s=this.members[o];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:o}=e.options;o===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function vxe(t,e,n){let r="";const o=t.x.translate/e.x,s=t.y.translate/e.y,i=(n==null?void 0:n.z)||0;if((o||s||i)&&(r=`translate3d(${o}px, ${s}px, ${i}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:f,skewY:p}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `),f&&(r+=`skewX(${f}deg) `),p&&(r+=`skewY(${p}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(r+=`scale(${a}, ${l})`),r||"none"}function YB(t){return jj(t)&&"ownerSVGElement"in t}function wxe(t){return YB(t)&&t.tagName==="svg"}const _1=["","X","Y","Z"],Cxe={visibility:"hidden"},xxe=1e3;let kxe=0;function A1(t,e,n,r){const{latestValues:o}=e;o[t]&&(n[t]=o[t],e.setStaticValue(t,0),r&&(r[t]=0))}function XB(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=rB(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:o,layoutId:s}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",xt,!(o||s))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&XB(r)}function JB({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:o}){return class{constructor(i={},a=e==null?void 0:e()){this.id=kxe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Txe),this.nodes.forEach(Rxe),this.nodes.forEach(Pxe),this.nodes.forEach(_xe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new lxe)}addEventListener(i,a){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new BE),this.eventHandlers.get(i).add(a)}notifyListeners(i,...a){const l=this.eventHandlers.get(i);l&&l.notify(...a)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=YB(i)&&!wxe(i),this.instance=i;const{layoutId:a,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||a)&&(this.isLayoutDirty=!0),t){let u;const d=()=>this.root.updateBlockedByResize=!1;t(i,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=cxe(d,250),Lm.hasAnimatedSinceResize&&(Lm.hasAnimatedSinceResize=!1,this.nodes.forEach(xP))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&c&&(a||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:h,layout:f})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||c.getDefaultTransition()||Vxe,{onLayoutAnimationStart:y,onLayoutAnimationComplete:b}=c.getProps(),w=!this.targetLayout||!KB(this.targetLayout,f),k=!d&&h;if(this.options.layoutRoot||this.resumeFrom||k||d&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,k);const x={...$E(p,"layout"),onPlay:y,onComplete:b};(c.shouldReduceMotion||this.options.layoutRoot)&&(x.delay=0,x.type=!1),this.startAnimation(x)}else d||xP(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=f})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),ia(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Dxe),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&XB(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(CP);return}this.isUpdating||this.nodes.forEach(Ixe),this.isUpdating=!1,this.nodes.forEach(Mxe),this.nodes.forEach(Sxe),this.nodes.forEach(Exe),this.clearAllSnapshots();const a=dr.now();dn.delta=Ws(0,1e3/60,a-dn.timestamp),dn.timestamp=a,dn.isProcessing=!0,w1.update.process(dn),w1.preRender.process(dn),w1.render.process(dn),dn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,_E.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Axe),this.sharedNodes.forEach(Nxe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,xt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){xt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Yn(this.snapshot.measuredBox.x)&&!Yn(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Rt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(a=!1),a&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!o)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!GB(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;i&&this.instance&&(a||Ha(this.latestValues)||u)&&(o(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return i&&(l=this.removeTransform(l)),jxe(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:i}=this.options;if(!i)return Rt();const a=i.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(Bxe))){const{scroll:u}=this.root;u&&(gc(a.x,u.offset.x),gc(a.y,u.offset.y))}return a}removeElementScroll(i){var l;const a=Rt();if(Nr(a,i),(l=this.scroll)!=null&&l.wasRoot)return a;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&Nr(a,i),gc(a.x,d.offset.x),gc(a.y,d.offset.y))}return a}applyTransform(i,a=!1){const l=Rt();Nr(l,i);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&yc(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Ha(u.latestValues)&&yc(l,u.latestValues)}return Ha(this.latestValues)&&yc(l,this.latestValues),l}removeTransform(i){const a=Rt();Nr(a,i);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Ha(c.latestValues))continue;BC(c.latestValues)&&c.updateSnapshot();const u=Rt(),d=c.measurePageBox();Nr(u,d),mP(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Ha(this.latestValues)&&mP(a,this.latestValues),a}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==dn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var h;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==a;if(!(i||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=dn.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Rt(),this.relativeTargetOrigin=Rt(),Qd(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),Nr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Rt(),this.targetWithTransforms=Rt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),BCe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Nr(this.target,this.layout.layoutBox),jB(this.target,this.targetDelta)):Nr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Rt(),this.relativeTargetOrigin=Rt(),Qd(this.relativeTargetOrigin,this.target,f.target),Nr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||BC(this.parent.latestValues)||VB(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var p;const i=this.getLead(),a=!!this.resumingFrom||this!==i;let l=!0;if((this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty)&&(l=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===dn.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;Nr(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,h=this.treeScale.y;$Ce(this.layoutCorrected,this.treeScale,this.path,a),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Rt());const{target:f}=i;if(!f){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(hP(this.prevProjectionDelta.x,this.projectionDelta.x),hP(this.prevProjectionDelta.y,this.projectionDelta.y)),Jd(this.projectionDelta,this.layoutCorrected,f,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==h||!wP(this.projectionDelta.x,this.prevProjectionDelta.x)||!wP(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",f))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),i){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=mc(),this.projectionDelta=mc(),this.projectionDeltaWithTransform=mc()}setAnimationOrigin(i,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=mc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const h=Rt(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,y=f!==p,b=this.getStack(),w=!b||b.members.length<=1,k=!!(y&&!w&&this.options.crossfade===!0&&!this.path.some(Lxe));this.animationProgress=0;let x;this.mixTargetDelta=A=>{const I=A/1e3;kP(d.x,i.x,I),kP(d.y,i.y,I),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Qd(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Oxe(this.relativeTarget,this.relativeTargetOrigin,h,I),x&&yxe(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=Rt()),Nr(x,this.relativeTarget)),y&&(this.animationValues=u,dxe(u,c,this.latestValues,I,k,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=I},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){var a,l,c;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(!1),(c=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||c.stop(!1),this.pendingAnimation&&(ia(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=xt.update(()=>{Lm.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Gc(0)),this.currentAnimation=ixe(this.motionValue,[0,1e3],{...i,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),i.onUpdate&&i.onUpdate(u)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(xxe),this.currentAnimation.stop(!1)),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=i;if(!(!a||!l||!c)){if(this!==i&&this.layout&&c&&QB(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Rt();const d=Yn(this.layout.layoutBox.x);l.x.min=i.target.x.min,l.x.max=l.x.min+d;const h=Yn(this.layout.layoutBox.y);l.y.min=i.target.y.min,l.y.max=l.y.min+h}Nr(a,l),yc(a,u),Jd(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(i,a){this.sharedNodes.has(i)||this.sharedNodes.set(i,new bxe),this.sharedNodes.get(i).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var a;const{layoutId:i}=this.options;return i?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:i}=this.options;return i?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),i&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let a=!1;const{latestValues:l}=i;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&A1("z",i,c,this.animationValues);for(let u=0;u<_1.length;u++)A1(`rotate${_1[u]}`,i,c,this.animationValues),A1(`skew${_1[u]}`,i,c,this.animationValues);i.render();for(const u in c)i.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);i.scheduleRender()}getProjectionStyles(i){if(!this.instance||this.isSVG)return;if(!this.isVisible)return Cxe;const a={visibility:""},l=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,a.opacity="",a.pointerEvents=Nm(i==null?void 0:i.pointerEvents)||"",a.transform=l?l(this.latestValues,""):"none",a;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const f={};return this.options.layoutId&&(f.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,f.pointerEvents=Nm(i==null?void 0:i.pointerEvents)||""),this.hasProjected&&!Ha(this.latestValues)&&(f.transform=l?l({},""):"none",this.hasProjected=!1),f}const u=c.animationValues||c.latestValues;this.applyTransformsToTarget(),a.transform=vxe(this.projectionDeltaWithTransform,this.treeScale,u),l&&(a.transform=l(u,a.transform));const{x:d,y:h}=this.projectionDelta;a.transformOrigin=`${d.origin*100}% ${h.origin*100}% 0`,c.animationValues?a.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:a.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const f in Xh){if(u[f]===void 0)continue;const{correct:p,applyTo:y,isCSSVariable:b}=Xh[f],w=a.transform==="none"?u[f]:p(u[f],c);if(y){const k=y.length;for(let x=0;x<k;x++)a[y[x]]=w}else b?this.options.visualElement.renderState.vars[f]=w:a[f]=w}return this.options.layoutId&&(a.pointerEvents=c===this?Nm(i==null?void 0:i.pointerEvents)||"":"none"),a}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var a;return(a=i.currentAnimation)==null?void 0:a.stop(!1)}),this.root.nodes.forEach(CP),this.root.sharedNodes.clear()}}}function Sxe(t){t.updateLayout()}function Exe(t){var n;const e=((n=t.resumeFrom)==null?void 0:n.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:o}=t.layout,{animationType:s}=t.options,i=e.source!==t.layout.source;s==="size"?Vr(d=>{const h=i?e.measuredBox[d]:e.layoutBox[d],f=Yn(h);h.min=r[d].min,h.max=h.min+f}):QB(s,e.layoutBox,r)&&Vr(d=>{const h=i?e.measuredBox[d]:e.layoutBox[d],f=Yn(r[d]);h.max=h.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[d].max=t.relativeTarget[d].min+f)});const a=mc();Jd(a,r,e.layoutBox);const l=mc();i?Jd(l,t.applyTransform(o,!0),e.measuredBox):Jd(l,r,e.layoutBox);const c=!GB(a);let u=!1;if(!t.resumeFrom){const d=t.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:f}=d;if(h&&f){const p=Rt();Qd(p,e.layoutBox,h.layoutBox);const y=Rt();Qd(y,r,f.layoutBox),KB(p,y)||(u=!0),d.options.layoutRoot&&(t.relativeTarget=y,t.relativeTargetOrigin=p,t.relativeParent=d)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:e,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function Txe(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function _xe(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Axe(t){t.clearSnapshot()}function CP(t){t.clearMeasurements()}function Ixe(t){t.isLayoutDirty=!1}function Mxe(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function xP(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Rxe(t){t.resolveTargetDelta()}function Pxe(t){t.calcProjection()}function Dxe(t){t.resetSkewAndRotation()}function Nxe(t){t.removeLeadSnapshot()}function kP(t,e,n){t.translate=wt(e.translate,0,n),t.scale=wt(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function SP(t,e,n,r){t.min=wt(e.min,n.min,r),t.max=wt(e.max,n.max,r)}function Oxe(t,e,n,r){SP(t.x,e.x,n.x,r),SP(t.y,e.y,n.y,r)}function Lxe(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Vxe={duration:.45,ease:[.4,0,.1,1]},EP=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),TP=EP("applewebkit/")&&!EP("chrome/")?Math.round:Kr;function _P(t){t.min=TP(t.min),t.max=TP(t.max)}function jxe(t){_P(t.x),_P(t.y)}function QB(t,e,n){return t==="position"||t==="preserve-aspect"&&!jCe(vP(e),vP(n),.2)}function Bxe(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const $xe=JB({attachResizeListener:(t,e)=>tf(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),I1={current:void 0},ZB=JB({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!I1.current){const t=new $xe({});t.mount(window),t.setOptions({layoutScroll:!0}),I1.current=t}return I1.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Fxe={pan:{Feature:nxe},drag:{Feature:txe,ProjectionNode:ZB,MeasureLayout:UB}};function Hxe(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;const o=(n==null?void 0:n[t])??r.querySelectorAll(t);return o?Array.from(o):[]}return Array.from(t)}function e6(t,e){const n=Hxe(t),r=new AbortController,o={passive:!0,...e,signal:r.signal};return[n,o,()=>r.abort()]}function AP(t){return!(t.pointerType==="touch"||zB())}function zxe(t,e,n={}){const[r,o,s]=e6(t,n),i=a=>{if(!AP(a))return;const{target:l}=a,c=e(l,a);if(typeof c!="function"||!l)return;const u=d=>{AP(d)&&(c(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,o)};return r.forEach(a=>{a.addEventListener("pointerenter",i,o)}),s}function IP(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const o="onHover"+n,s=r[o];s&&xt.postRender(()=>s(e,Xf(e)))}class Uxe extends ka{mount(){const{current:e}=this.node;e&&(this.unmount=zxe(e,(n,r)=>(IP(this.node,r,"Start"),o=>IP(this.node,o,"End"))))}unmount(){}}class Wxe extends ka{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Kf(tf(this.node.current,"focus",()=>this.onFocus()),tf(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const t6=(t,e)=>e?t===e?!0:t6(t,e.parentElement):!1,qxe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Gxe(t){return qxe.has(t.tagName)||t.tabIndex!==-1}const Vm=new WeakSet;function MP(t){return e=>{e.key==="Enter"&&t(e)}}function M1(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Kxe=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=MP(()=>{if(Vm.has(n))return;M1(n,"down");const o=MP(()=>{M1(n,"up")}),s=()=>M1(n,"cancel");n.addEventListener("keyup",o,e),n.addEventListener("blur",s,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function RP(t){return ZE(t)&&!zB()}function Yxe(t,e,n={}){const[r,o,s]=e6(t,n),i=a=>{const l=a.currentTarget;if(!RP(a))return;Vm.add(l);const c=e(l,a),u=(f,p)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),Vm.has(l)&&Vm.delete(l),RP(f)&&typeof c=="function"&&c(f,{success:p})},d=f=>{u(f,l===window||l===document||n.useGlobalTarget||t6(l,f.target))},h=f=>{u(f,!1)};window.addEventListener("pointerup",d,o),window.addEventListener("pointercancel",h,o)};return r.forEach(a=>{(n.useGlobalTarget?window:a).addEventListener("pointerdown",i,o),kE(a)&&(a.addEventListener("focus",c=>Kxe(c,o)),!Gxe(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),s}function PP(t,e,n){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const o="onTap"+(n==="End"?"":n),s=r[o];s&&xt.postRender(()=>s(e,Xf(e)))}class Xxe extends ka{mount(){const{current:e}=this.node;e&&(this.unmount=Yxe(e,(n,r)=>(PP(this.node,r,"Start"),(o,{success:s})=>PP(this.node,o,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const HC=new WeakMap,R1=new WeakMap,Jxe=t=>{const e=HC.get(t.target);e&&e(t)},Qxe=t=>{t.forEach(Jxe)};function Zxe({root:t,...e}){const n=t||document;R1.has(n)||R1.set(n,{});const r=R1.get(n),o=JSON.stringify(e);return r[o]||(r[o]=new IntersectionObserver(Qxe,{root:t,...e})),r[o]}function eke(t,e,n){const r=Zxe(e);return HC.set(t,n),r.observe(t),()=>{HC.delete(t),r.unobserve(t)}}const tke={some:0,all:1};class nke extends ka{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:o="some",once:s}=e,i={root:n?n.current:void 0,rootMargin:r,threshold:typeof o=="number"?o:tke[o]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return eke(this.node.current,i,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(rke(e,n))&&this.startObserver()}unmount(){}}function rke({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const oke={inView:{Feature:nke},tap:{Feature:Xxe},focus:{Feature:Wxe},hover:{Feature:Uxe}},ske={layout:{ProjectionNode:ZB,MeasureLayout:UB}},zC={current:null},n6={current:!1};function ike(){if(n6.current=!0,!!CE)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>zC.current=t.matches;t.addListener(e),e()}else zC.current=!1}const ake=new WeakMap;function lke(t,e,n){for(const r in e){const o=e[r],s=n[r];if(Ln(o))t.addValue(r,o);else if(Ln(s))t.addValue(r,Gc(o,{owner:t}));else if(s!==o)if(t.hasValue(r)){const i=t.getValue(r);i.liveStyle===!0?i.jump(o):i.hasAnimated||i.set(o)}else{const i=t.getStaticValue(r);t.addValue(r,Gc(i!==void 0?i:o,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const r6=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),o6=t=>/^0[^.\s]+$/u.test(t),cke={test:t=>t==="auto",parse:t=>t},s6=t=>e=>e.test(t),i6=[Au,we,Uo,ki,b1e,y1e,cke],DP=t=>i6.find(s6(t)),uke=[...i6,Pn,aa],dke=t=>uke.find(s6(t)),hke=new Set(["brightness","contrast","saturate","opacity"]);function fke(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(FE)||[];if(!r)return t;const o=n.replace(r,"");let s=hke.has(e)?1:0;return r!==n&&(s*=100),e+"("+s+o+")"}const pke=/\b([a-z-]*)\(.*?\)/gu,UC={...aa,getAnimatableNone:t=>{const e=t.match(pke);return e?e.map(fke).join(" "):t}},mke={...RE,color:Pn,backgroundColor:Pn,outlineColor:Pn,fill:Pn,stroke:Pn,borderColor:Pn,borderTopColor:Pn,borderRightColor:Pn,borderBottomColor:Pn,borderLeftColor:Pn,filter:UC,WebkitFilter:UC},a6=t=>mke[t];function l6(t,e){let n=a6(t);return n!==UC&&(n=aa),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const NP=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class gke{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:o,blockInitialAnimation:s,visualState:i},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=XE,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=dr.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,xt.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=o,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=l0(n),this.isVariantNode=zj(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in d){const f=d[h];l[h]!==void 0&&Ln(f)&&f.set(l[h],!1)}}mount(e){this.current=e,ake.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),n6.current||ike(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:zC.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),ia(this.notifyUpdate),ia(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=_u.has(e);r&&this.onBindTransform&&this.onBindTransform();const o=n.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&xt.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=n.on("renderRequest",this.scheduleRender);let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{o(),s(),i&&i(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in qc){const n=qc[e];if(!n)continue;const{isEnabled:r,Feature:o}=n;if(!this.features[e]&&o&&r(this.props)&&(this.features[e]=new o(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Rt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<NP.length;r++){const o=NP[r];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const s="on"+o,i=e[s];i&&(this.propEventSubscriptions[o]=this.on(o,i))}this.prevMotionValues=lke(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Gc(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(r6(r)||o6(r))?r=parseFloat(r):!dke(r)&&aa.test(n)&&(r=l6(e,n)),this.setBaseTarget(e,Ln(r)?r.get():r)),Ln(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var s;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const i=OE(this.props,n,(s=this.presenceContext)==null?void 0:s.custom);i&&(r=i[e])}if(n&&r!==void 0)return r;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!Ln(o)?o:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new BE),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}const yke=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function bke(t){const e=yke.exec(t);if(!e)return[,];const[,n,r,o]=e;return[`--${n??r}`,o]}function c6(t,e,n=1){const[r,o]=bke(t);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const i=s.trim();return r6(i)?parseFloat(i):i}return ME(o)?c6(o,e,n+1):o}function vke(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||o6(t):!0}const wke=new Set(["auto","none","0"]);function Cke(t,e,n){let r=0,o;for(;r<t.length&&!o;){const s=t[r];typeof s=="string"&&!wke.has(s)&&Zh(s).values.length&&(o=t[r]),r++}if(o&&n)for(const s of e)t[s]=l6(n,o)}class xke extends XE{constructor(e,n,r,o,s){super(e,n,r,o,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),ME(c))){const u=c6(c,n.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!MB.has(r)||e.length!==2)return;const[o,s]=e,i=DP(o),a=DP(s);if(i!==a)if(BR(i)&&BR(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else hl[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let o=0;o<e.length;o++)(e[o]===null||vke(e[o]))&&r.push(o);r.length&&Cke(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=hl[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const o=n[n.length-1];o!==void 0&&e.getValue(r,o).jump(o,!1)}measureEndState(){var a;const{element:e,name:n,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const o=e.getValue(n);o&&o.jump(this.measuredOrigin,!1);const s=r.length-1,i=r[s];r[s]=hl[n](e.measureViewportBox(),window.getComputedStyle(e.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([l,c])=>{e.getValue(l).set(c)}),this.resolveNoneKeyframes()}}class u6 extends gke{constructor(){super(...arguments),this.KeyframeResolver=xke}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ln(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function d6(t,{style:e,vars:n},r,o){Object.assign(t.style,e,o&&o.getProjectionStyles(r));for(const s in n)t.style.setProperty(s,n[s])}function kke(t){return window.getComputedStyle(t)}class Ske extends u6{constructor(){super(...arguments),this.type="html",this.renderInstance=d6}readValueFromInstance(e,n){var r;if(_u.has(n))return(r=this.projection)!=null&&r.isProjecting?DC(n):Gwe(e,n);{const o=kke(e),s=(IE(n)?o.getPropertyValue(n):o[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return BB(e,n)}build(e,n,r){PE(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return LE(e,n,r)}}const h6=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Eke(t,e,n,r){d6(t,e,void 0,r);for(const o in e.attrs)t.setAttribute(h6.has(o)?o:TE(o),e.attrs[o])}class Tke extends u6{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Rt}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(_u.has(n)){const r=a6(n);return r&&r.default||0}return n=h6.has(n)?n:TE(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return tB(e,n,r)}build(e,n,r){Jj(e,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,n,r,o){Eke(e,n,r,o)}mount(e){this.isSVGTag=Zj(e.tagName),super.mount(e)}}const _ke=(t,e)=>NE(t)?new Tke(e):new Ske(e,{allowProjection:t!==v.Fragment}),Ake=L1e({...MCe,...oke,...Fxe,...ske},_ke),Ike=n1e(Ake),f6=()=>{const[t,e]=$.useState([]),[n,r]=$.useState([]),{getChecklistRecords:o}=Cu(),{getAllRecordFields:s}=Uy();return $.useEffect(()=>{const l=s().filter(d=>d.type==="note"),c=l.map(d=>d.id),u=o("",{fieldIds:c});e(Object.values(u).flat()),r(l)},[]),{allNotes:t,allNoteFields:n,getNotes:a=>{const l=o("",{fieldIds:a});e(Object.values(l).flat())}}},Mke="_container_4p8xy_2",Rke="_item_4p8xy_11",Pke="_itemActive_4p8xy_24",Dke="_icon_4p8xy_29",Nke="_iconActive_4p8xy_33",Oke="_menuButtonRotate_4p8xy_49",lo={container:Mke,item:Rke,itemActive:Pke,icon:Dke,iconActive:Nke,menuButtonRotate:Oke},Lke=({onChangeField:t})=>{const[e,n]=$.useState(!1),{allNoteFields:r}=f6(),[o,s]=vN(),i=o.get("fieldId"),a=Qb({width:e?"150px":"50px",config:{tension:400,friction:20}});return m.jsx("div",{children:m.jsx(Wh.div,{style:a,children:m.jsxs(Xr,{className:lo.container,children:[m.jsx("div",{onClick:()=>{n(!e)},className:lo.item,children:m.jsx(ae,{icon:"solar:hamburger-menu-outline",className:be(e&&lo.menuButtonRotate)})}),m.jsxs("div",{onClick:()=>{const l=Object.fromEntries(o);delete l.fieldId,s(l),t==null||t(r.map(c=>c.id))},className:be(lo.item,!i&&lo.itemActive),children:[m.jsx(ae,{icon:"solar:notes-line-duotone",className:be(lo.icon,!i&&lo.iconActive)}),e&&m.jsx(me.Text,{children:"All Notes"})]}),r.map(l=>m.jsxs("div",{onClick:()=>{s({...Object.fromEntries(o),fieldId:l.id}),t==null||t([l.id])},className:be(lo.item,i===l.id&&lo.itemActive),children:[m.jsx(ae,{icon:l.icon,className:be(lo.icon,i===l.id&&lo.iconActive)}),e&&m.jsx(me.Text,{children:l.title})]},l.id))]})})})},Vke="_container_1o6zy_2",jke="_addNoteButton_1o6zy_8",Bke="_addIcon_1o6zy_26",P1={container:Vke,addNoteButton:jke,addIcon:Bke},$ke="_container_q2wrn_2",Fke="_noteItem_q2wrn_9",Hke="_itemHeader_q2wrn_13",zke="_itemHeaderDate_q2wrn_19",om={container:$ke,noteItem:Fke,itemHeader:Hke,itemHeaderDate:zke},Uke=({allNotes:t,allNoteFields:e=[]})=>{const n=e.reduce((r,o)=>({...r,[o.id]:o}),{});return m.jsx("div",{className:om.container,children:t.map(r=>{var o;return m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:om.itemHeader,children:[m.jsx(me.Text,{className:om.itemHeaderDate,children:new Date(r.createdAt).toLocaleString()}),m.jsx(me.Text,{children:`${(o=n[r.fieldId])==null?void 0:o.title}`})]}),m.jsx(Xr,{className:om.noteItem,children:m.jsx(Lh,{value:r.value,withoutBorder:!0})})]})})})},Wke=()=>{const{allNotes:t,getNotes:e,allNoteFields:n}=f6();return m.jsxs(m.Fragment,{children:[m.jsx(ou,{renderLeftComponent:()=>m.jsx(m.Fragment,{children:"Notes"}),renderRightComponent:()=>m.jsxs(Gt,{className:P1.addNoteButton,children:[m.jsx(ae,{icon:"fe:plus",className:P1.addIcon,width:20})," Add Note"]})}),m.jsxs("div",{className:P1.container,children:[m.jsx(Lke,{onChangeField:r=>{e(r)}}),m.jsx(Uke,{allNotes:t,allNoteFields:n})]})]})},qke="_container_jw0vg_2",Gke="_title_jw0vg_8",Kke="_player_jw0vg_12",Yke="_currentContainer_jw0vg_17",Xke="_icon_jw0vg_30",tc={container:qke,title:Gke,player:Kke,currentContainer:Yke,icon:Xke},Jke=t=>new Date(t.getTime()-24*60*60*1e3),Qke=t=>new Date(t.getTime()+24*60*60*1e3),Zke=({date:t,onDateChange:e})=>{const n=kn(),o=new Date(t).toLocaleDateString()===new Date().toLocaleDateString()?n.formatMessage({id:"checklist-calendar.today",defaultMessage:"Today"}):new Date(t).toLocaleDateString();return m.jsxs("div",{className:tc.container,children:[m.jsx(me.Title,{level:4,noMargin:!0,className:tc.title,children:n.formatMessage({id:"checklist-calendar.title",defaultMessage:"Tasks"})}),m.jsxs("div",{className:tc.player,children:[m.jsx(ae,{onClick:()=>e(Jke(t)),width:30,icon:"basil:skip-prev-outline",className:tc.icon}),m.jsx(me.Text,{className:tc.currentContainer,onClick:()=>e(new Date),children:o}),m.jsx(ae,{onClick:()=>e(Qke(t)),width:30,icon:"basil:skip-next-outline",className:tc.icon})]})]})},eSe="_checklistItem_1ge4q_2",tSe="_lastChecklistItem_1ge4q_17",nSe="_checkbox_1ge4q_21",rSe="_title_1ge4q_26",ud={checklistItem:eSe,lastChecklistItem:tSe,checkbox:nSe,title:rSe},oSe=({date:t})=>{const{checklistByGivingDateIds:e,allChecklist:n,getChecklistByGivingDate:r,updateChecklist:o}=Fy(),{checklistTemplate:s}=Xi(),i=Ao();return $.useEffect(()=>{r({date:t})},[t]),m.jsx("div",{className:ud.container,children:e.map((a,l)=>{const c=n[a],u=s[c.checklistTemplateId];return m.jsxs("div",{className:be(ud.checklistItem,l===e.length-1&&ud.lastChecklistItem),children:[m.jsx(ae,{color:(u==null?void 0:u.avatar.color)||"#8A8A8A",width:32,height:32,icon:u==null?void 0:u.avatar.name}),m.jsx(me.Text,{onClick:()=>i(`/task/${c.checklistTemplateId}?currentDay=${t.toISOString()}${c.clientOnly?"":`&checklistId=${c.id}`}`),className:ud.title,children:u==null?void 0:u.title}),m.jsx(XS,{checked:!!(c!=null&&c.completedAt),className:ud.checkbox,onChange:d=>{d.stopPropagation(),o({...c,completedAt:d.target.checked?new Date().toISOString():void 0})}})]},a)})})},sSe="_addChecklist_4jpp5_2",iSe="_createBtn_4jpp5_6",OP={addChecklist:sSe,createBtn:iSe},aSe=()=>{const t=kn(),e=Ao();return m.jsx("div",{className:OP.addChecklist,children:m.jsx(Gt,{onClick:()=>{e("/create-checklist")},type:"dash",size:"md",className:OP.createBtn,block:!0,children:t.formatMessage({id:"checklist-create.label-create-checklist",defaultMessage:"Create Task"})})})};function lSe(t){return m.jsx("svg",{width:"32",height:"32",viewBox:"0 0 48 48",fill:"none",...t,children:m.jsx("g",{id:"pause_circle_outline_24px",children:m.jsx("path",{id:"icon/av/pause_circle_outline_24px","fill-rule":"evenodd","clip-rule":"evenodd",d:"M4 24C4 12.96 12.96 4 24 4C35.04 4 44 12.96 44 24C44 35.04 35.04 44 24 44C12.96 44 4 35.04 4 24ZM22 30C22 31.1 21.1 32 20 32C18.9 32 18 31.1 18 30V18C18 16.9 18.9 16 20 16C21.1 16 22 16.9 22 18V30ZM24 40C15.18 40 8 32.82 8 24C8 15.18 15.18 8 24 8C32.82 8 40 15.18 40 24C40 32.82 32.82 40 24 40ZM30 30C30 31.1 29.1 32 28 32C26.9 32 26 31.1 26 30V18C26 16.9 26.9 16 28 16C29.1 16 30 16.9 30 18V30Z",fill:"white"})})})}function cSe(t){return m.jsx("svg",{width:"32",height:"32",viewBox:"0 0 48 48",fill:"none",...t,children:m.jsx("g",{id:"play_circle_filled_24px",children:m.jsx("path",{id:"icon/av/play_circle_filled_24px","fill-rule":"evenodd","clip-rule":"evenodd",d:"M4 24C4 12.96 12.96 4 24 4C35.04 4 44 12.96 44 24C44 35.04 35.04 44 24 44C12.96 44 4 35.04 4 24ZM21.6 16.2C20.94 15.7 20 16.18 20 17V31C20 31.82 20.94 32.3 21.6 31.8L30.94 24.8C31.48 24.4 31.48 23.6 30.94 23.2L21.6 16.2Z",fill:"white"})})})}const uSe="_container_n2rya_2",dSe="_body_n2rya_6",hSe="_icon_n2rya_18",fSe="_progressContainer_n2rya_22",pSe="_progress_n2rya_22",mSe="_pomodoroPhase_n2rya_31",gSe="_pomodoroPhaseText_n2rya_39",ySe="_loadStatus_n2rya_52",ks={container:uSe,body:dSe,icon:hSe,progressContainer:fSe,progress:pSe,pomodoroPhase:mSe,pomodoroPhaseText:gSe,loadStatus:ySe},bSe={"date-a-live-season-1-ost.mp3":{name:"date a live",id:"date-a-live-season-1-ost.mp3"},"rockabye-baby-twinkle-twinkle.mp3":{name:"rockabye baby twinkle twinkle",id:"rockabye-baby-twinkle-twinkle.mp3"},"twinkle-twinkle-little-star-acoustic-guitar.mp3":{name:"twinkle twinkle little star acoustic guitar",id:"twinkle-twinkle-little-star-acoustic-guitar.mp3"},"einstein-baby-lullaby-academy-brahms.mp3":{name:"Baby Lullaby Music - Einstein Baby Lullaby Academy",id:"einstein-baby-lullaby-academy-brahms.mp3"},"einstein-baby-lullaby.mp3":{name:"Einstein Baby Lullaby",id:"einstein-baby-lullaby.mp3"},"a-whole-new-world.mp3":{id:"a-whole-new-world.mp3",name:"A Whole New World"},"reflection.mp3":{id:"reflection.mp3",name:"Reflection"},"arabesque-piano-relaxation.mp3":{id:"arabesque-piano-relaxation.mp3",name:"Arabesque Piano Relaxation"},"canon-in-d.mp3":{id:"canon-in-d.mp3",name:"Canon in D"},"music-therapy-serenity.mp3":{id:"music-therapy-serenity.mp3",name:"Music Therapy - Serenity"},"prelude-in-c-major.mp3":{id:"prelude-in-c-major.mp3",name:"Prelude in C Major"}},vSe=By(t=>({isPlaying:!1,setIsPlaying:e=>t({isPlaying:e}),currentSongIndex:0,setCurrentSongIndex:e=>t({currentSongIndex:e}),songList:[],setSongList:e=>t({songList:e}),currentTime:0,setCurrentTime:e=>t({currentTime:e}),duration:0,setDuration:e=>t({duration:e})})),Ba=[];let Ss=null;const p6=({autoPlayDefault:t=!1}={})=>{const{isPlaying:e,songList:n,setSongList:r,setIsPlaying:o,currentSongIndex:s,setCurrentSongIndex:i,currentTime:a,setCurrentTime:l,duration:c,setDuration:u}=vSe(),[d,h]=$.useState(t),f=x=>{console.log("currentSingIndex",s,n.length),Ss&&Ss.pause();let A=(s+1)%n.length;x&&!isNaN(x)&&(A=x),console.log("nextIndex",A),i(A),y(A)},p=()=>{Ss&&Ss.pause();const x=(s-1+n.length)%n.length;y(x),i(x)},y=x=>{if(x<0||x>=n.length)return;const A=n[x];let I;console.log("AUTO PLAY",d,Ba[x]),Ba[x]?(I=Ba[x],I.currentTime=0):I=new Audio(A),Ss=I,I.onended=()=>{console.log("AUDIO END!!!",d),d&&f(x+1)},I.ontimeupdate=()=>{l(I.currentTime),u(I.duration)},I.play().then(()=>{o(!0),l(0)}).catch(console.error)};return{loadSong:y,play:async()=>{if(!Ss)y(s),o(!0);else{const x=Ba[s];x&&!e&&x.play().then(()=>o(!0)).catch(console.error)}},pause:()=>{Ss&&e&&(Ss.pause(),o(!1))},isPlaying:e,autoPlay:d,setAutoPlay:x=>h(x),next:f,prev:p,audio:Ss,currentTime:a,duration:c,currentSongIndex:s,loadAllSongs:async({songs:x,callback:A})=>{const I=x.filter(T=>!n.includes(T)),M=[...n,...I];I.length&&r(M);for(let T=0;T<M.length;T++){const S=M[T];if(Ba[T]){A(S,T);continue}const _=new Audio(S);Ba.push(_),await new Promise((R,D)=>{_.addEventListener("loadedmetadata",()=>{A(S,T),R()}),_.addEventListener("error",O=>{console.error(`Error loading song: ${S}`,O),D(O)})})}return Ba},songList:n}},wSe=t=>{const e=[...t];for(let n=e.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[e[n],e[r]]=[e[r],e[n]]}return e},eT=wSe(Object.values(bSe)),CSe=eT.map(({id:t})=>hz(t)),xSe="_container_fu073_2",kSe="_header_fu073_10",SSe="_body_fu073_23",ESe="_card_fu073_28",TSe="_cardActive_fu073_40",_Se="_titleActive_fu073_44",ASe="_successIcon_fu073_49",$a={container:xSe,header:kSe,body:SSe,card:ESe,cardActive:TSe,titleActive:_Se,successIcon:ASe},ISe=({visible:t,onClose:e})=>{const{currentSongIndex:n,next:r}=p6(),o=kn();return m.jsxs(Dj,{className:$a.container,visible:t,onBlur:e,children:[m.jsxs("div",{className:$a.header,children:[m.jsx(me.Title,{noMargin:!0,level:4,children:o.formatMessage({id:"audio-song-list-drawer.title",defaultMessage:"Song List"})}),m.jsx(ae,{width:32,icon:"material-symbols:close-rounded",onClick:e})]}),m.jsx("div",{className:$a.body,children:eT.map(({name:s},i)=>m.jsxs("div",{onClick:()=>r(i),className:be($a.card,n===i&&$a.cardActive),children:[m.jsx(me.Paragraph,{noMargin:!0,className:be(n===i&&$a.titleActive),children:s}),n===i&&m.jsx(ae,{className:$a.successIcon,icon:"material-symbols:check-circle-rounded"})]},i))})]})},MSe=({className:t})=>{const[e,n]=$.useState(0),{play:r,pause:o,isPlaying:s,next:i,prev:a,currentTime:l,currentSongIndex:c,loadAllSongs:u,duration:d,songList:h}=p6({autoPlayDefault:!0}),[f,p]=v.useState(!1),y=async()=>{await u({songs:CSe,callback:()=>{n(w=>w+1)}})};$.useEffect(()=>{y()},[]);const b=()=>{s?o():r()};return m.jsxs("div",{className:be(ks.container,t),children:[m.jsx(ISe,{visible:f,onClose:()=>p(!1)}),e!==h.length&&m.jsxs(me.Text,{className:ks.loadStatus,children:["load song",e,"/",h.length]}),l>0&&m.jsx("div",{className:ks.progressContainer,children:m.jsx("div",{className:ks.progress,style:{width:`${l/d*100}%`}})}),m.jsxs("div",{className:ks.body,children:[m.jsx(ae,{icon:"material-symbols:skip-previous-rounded",height:24,color:"white",onClick:()=>a()}),s?m.jsx(lSe,{className:ks.icon,width:42,onClick:b}):m.jsx(cSe,{className:ks.icon,onClick:b}),m.jsx(ae,{icon:"material-symbols:skip-next-rounded",height:32,width:32,color:"white",onClick:()=>i()}),m.jsxs("span",{className:ks.pomodoroPhase,children:[m.jsx(me.Text,{onClick:()=>p(!0),className:ks.pomodoroPhaseText,children:`${c+1}. ${eT[c].name}`}),m.jsx(ae,{color:"white",onClick:()=>p(!0),icon:"material-symbols:library-music-rounded",width:24})]})]})]})},RSe="_container_ia9xq_2",PSe="_player_ia9xq_13",DSe="_hr_ia9xq_24",NSe="_card_ia9xq_29",OSe="_body_ia9xq_34",dd={container:RSe,player:PSe,hr:DSe,card:NSe,body:OSe},LSe=()=>{const[t,e]=$.useState(new Date);return m.jsxs("div",{className:dd.container,children:[m.jsx(_U,{}),m.jsx("div",{className:dd.body,children:m.jsxs(Xr,{className:dd.card,children:[m.jsx(Zke,{date:t,onDateChange:e}),m.jsx(_d,{classes:{hr:dd.hr}}),m.jsx(oSe,{date:t}),m.jsx(aSe,{})]})}),m.jsx(MSe,{className:dd.player})]})};function VSe({onStorageChange:t}={}){const[e,n]=v.useState({}),r=()=>{const s=Object.keys(localStorage).reduce((i,a)=>({...i,[a]:localStorage.getItem(a)}),{});return n(s),t==null||t(s),s},o=s=>{Object.entries(s).forEach(([i,a])=>{localStorage.setItem(i,a)}),n(s),t==null||t(s)};return v.useEffect(()=>{r()},[]),{storage:e,getAll:r,setAll:o}}const jSe=()=>{};var LP={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m6=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let o=t.charCodeAt(r);o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):(o&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128)}return e},BSe=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const o=t[n++];if(o<128)e[r++]=String.fromCharCode(o);else if(o>191&&o<224){const s=t[n++];e[r++]=String.fromCharCode((o&31)<<6|s&63)}else if(o>239&&o<365){const s=t[n++],i=t[n++],a=t[n++],l=((o&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],i=t[n++];e[r++]=String.fromCharCode((o&15)<<12|(s&63)<<6|i&63)}}return e.join("")},g6={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<t.length;o+=3){const s=t[o],i=o+1<t.length,a=i?t[o+1]:0,l=o+2<t.length,c=l?t[o+2]:0,u=s>>2,d=(s&3)<<4|a>>4;let h=(a&15)<<2|c>>6,f=c&63;l||(f=64,i||(h=64)),r.push(n[u],n[d],n[h],n[f])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(m6(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):BSe(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<t.length;){const s=n[t.charAt(o++)],a=o<t.length?n[t.charAt(o)]:0;++o;const c=o<t.length?n[t.charAt(o)]:64;++o;const d=o<t.length?n[t.charAt(o)]:64;if(++o,s==null||a==null||c==null||d==null)throw new $Se;const h=s<<2|a>>4;if(r.push(h),c!==64){const f=a<<4&240|c>>2;if(r.push(f),d!==64){const p=c<<6&192|d;r.push(p)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class $Se extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const FSe=function(t){const e=m6(t);return g6.encodeByteArray(e,!0)},Cy=function(t){return FSe(t).replace(/\./g,"")},HSe=function(t){try{return g6.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zSe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const USe=()=>zSe().__FIREBASE_DEFAULTS__,WSe=()=>{if(typeof process>"u"||typeof LP>"u")return;const t=LP.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},qSe=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&HSe(t[1]);return e&&JSON.parse(e)},tT=()=>{try{return jSe()||USe()||WSe()||qSe()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},GSe=t=>{var e,n;return(n=(e=tT())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},KSe=t=>{const e=GSe(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},y6=()=>{var t;return(t=tT())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YSe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nT(t){return t.endsWith(".cloudworkstations.dev")}async function XSe(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JSe(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",o=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Cy(JSON.stringify(n)),Cy(JSON.stringify(i)),""].join(".")}const Zd={};function QSe(){const t={prod:[],emulator:[]};for(const e of Object.keys(Zd))Zd[e]?t.emulator.push(e):t.prod.push(e);return t}function ZSe(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let VP=!1;function eEe(t,e){if(typeof window>"u"||typeof document>"u"||!nT(window.location.host)||Zd[t]===e||Zd[t]||VP)return;Zd[t]=e;function n(h){return`__firebase__banner__${h}`}const r="__firebase__banner",s=QSe().prod.length>0;function i(){const h=document.getElementById(r);h&&h.remove()}function a(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function l(h,f){h.setAttribute("width","24"),h.setAttribute("id",f),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function c(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{VP=!0,i()},h}function u(h,f){h.setAttribute("id",f),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function d(){const h=ZSe(r),f=n("text"),p=document.getElementById(f)||document.createElement("span"),y=n("learnmore"),b=document.getElementById(y)||document.createElement("a"),w=n("preprendIcon"),k=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const x=h.element;a(x),u(b,y);const A=c();l(k,w),x.append(k,p,b,A),document.body.appendChild(x)}s?(p.innerText="Preview backend disconnected.",k.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(k.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,p.innerText="Preview backend running in this workspace."),p.setAttribute("id",f)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tEe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nEe(){var t;const e=(t=tT())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function rEe(){return!nEe()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function oEe(){try{return typeof indexedDB=="object"}catch{return!1}}function sEe(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},o.onupgradeneeded=()=>{n=!1},o.onerror=()=>{var s;e(((s=o.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iEe="FirebaseError";class Iu extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=iEe,Object.setPrototypeOf(this,Iu.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,b6.prototype.create)}}class b6{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},o=`${this.service}/${e}`,s=this.errors[e],i=s?aEe(s,r):"Error",a=`${this.serviceName}: ${i} (${o}).`;return new Iu(o,a,r)}}function aEe(t,e){return t.replace(lEe,(n,r)=>{const o=e[r];return o!=null?String(o):`<${r}?>`})}const lEe=/\{\$([^}]+)}/g;function xy(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const o of n){if(!r.includes(o))return!1;const s=t[o],i=e[o];if(jP(s)&&jP(i)){if(!xy(s,i))return!1}else if(s!==i)return!1}for(const o of r)if(!n.includes(o))return!1;return!0}function jP(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qs(t){return t&&t._delegate?t._delegate:t}class nf{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const za="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cEe{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new YSe;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:n});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),o=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(o)return null;throw s}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(dEe(e))try{this.getOrInitializeService({instanceIdentifier:za})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:o});r.resolve(s)}catch{}}}}clearInstance(e=za){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=za){return this.instances.has(e)}getOptions(e=za){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&i.resolve(o)}return o}onInit(e,n){var r;const o=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(o))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(o,s);const i=this.instances.get(o);return i&&e(i,o),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const o of r)try{o(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:uEe(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=za){return this.component?this.component.multipleInstances?e:za:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function uEe(t){return t===za?void 0:t}function dEe(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hEe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new cEe(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Fe||(Fe={}));const fEe={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},pEe=Fe.INFO,mEe={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},gEe=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),o=mEe[e];if(o)console[o](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class v6{constructor(e){this.name=e,this._logLevel=pEe,this._logHandler=gEe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?fEe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,...e),this._logHandler(this,Fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,...e),this._logHandler(this,Fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,...e),this._logHandler(this,Fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,...e),this._logHandler(this,Fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,...e),this._logHandler(this,Fe.ERROR,...e)}}const yEe=(t,e)=>e.some(n=>t instanceof n);let BP,$P;function bEe(){return BP||(BP=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function vEe(){return $P||($P=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const w6=new WeakMap,WC=new WeakMap,C6=new WeakMap,D1=new WeakMap,rT=new WeakMap;function wEe(t){const e=new Promise((n,r)=>{const o=()=>{t.removeEventListener("success",s),t.removeEventListener("error",i)},s=()=>{n(Wi(t.result)),o()},i=()=>{r(t.error),o()};t.addEventListener("success",s),t.addEventListener("error",i)});return e.then(n=>{n instanceof IDBCursor&&w6.set(n,t)}).catch(()=>{}),rT.set(e,t),e}function CEe(t){if(WC.has(t))return;const e=new Promise((n,r)=>{const o=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",i),t.removeEventListener("abort",i)},s=()=>{n(),o()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",s),t.addEventListener("error",i),t.addEventListener("abort",i)});WC.set(t,e)}let qC={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return WC.get(t);if(e==="objectStoreNames")return t.objectStoreNames||C6.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Wi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function xEe(t){qC=t(qC)}function kEe(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(N1(this),e,...n);return C6.set(r,e.sort?e.sort():[e]),Wi(r)}:vEe().includes(t)?function(...e){return t.apply(N1(this),e),Wi(w6.get(this))}:function(...e){return Wi(t.apply(N1(this),e))}}function SEe(t){return typeof t=="function"?kEe(t):(t instanceof IDBTransaction&&CEe(t),yEe(t,bEe())?new Proxy(t,qC):t)}function Wi(t){if(t instanceof IDBRequest)return wEe(t);if(D1.has(t))return D1.get(t);const e=SEe(t);return e!==t&&(D1.set(t,e),rT.set(e,t)),e}const N1=t=>rT.get(t);function EEe(t,e,{blocked:n,upgrade:r,blocking:o,terminated:s}={}){const i=indexedDB.open(t,e),a=Wi(i);return r&&i.addEventListener("upgradeneeded",l=>{r(Wi(i.result),l.oldVersion,l.newVersion,Wi(i.transaction),l)}),n&&i.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),o&&l.addEventListener("versionchange",c=>o(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const TEe=["get","getKey","getAll","getAllKeys","count"],_Ee=["put","add","delete","clear"],O1=new Map;function FP(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(O1.get(e))return O1.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,o=_Ee.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(o||TEe.includes(n)))return;const s=async function(i,...a){const l=this.transaction(i,o?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),o&&l.done]))[0]};return O1.set(e,s),s}xEe(t=>({...t,get:(e,n,r)=>FP(e,n)||t.get(e,n,r),has:(e,n)=>!!FP(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AEe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(IEe(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function IEe(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const GC="@firebase/app",HP="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs=new v6("@firebase/app"),MEe="@firebase/app-compat",REe="@firebase/analytics-compat",PEe="@firebase/analytics",DEe="@firebase/app-check-compat",NEe="@firebase/app-check",OEe="@firebase/auth",LEe="@firebase/auth-compat",VEe="@firebase/database",jEe="@firebase/data-connect",BEe="@firebase/database-compat",$Ee="@firebase/functions",FEe="@firebase/functions-compat",HEe="@firebase/installations",zEe="@firebase/installations-compat",UEe="@firebase/messaging",WEe="@firebase/messaging-compat",qEe="@firebase/performance",GEe="@firebase/performance-compat",KEe="@firebase/remote-config",YEe="@firebase/remote-config-compat",XEe="@firebase/storage",JEe="@firebase/storage-compat",QEe="@firebase/firestore",ZEe="@firebase/ai",eTe="@firebase/firestore-compat",tTe="firebase",nTe="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC="[DEFAULT]",rTe={[GC]:"fire-core",[MEe]:"fire-core-compat",[PEe]:"fire-analytics",[REe]:"fire-analytics-compat",[NEe]:"fire-app-check",[DEe]:"fire-app-check-compat",[OEe]:"fire-auth",[LEe]:"fire-auth-compat",[VEe]:"fire-rtdb",[jEe]:"fire-data-connect",[BEe]:"fire-rtdb-compat",[$Ee]:"fire-fn",[FEe]:"fire-fn-compat",[HEe]:"fire-iid",[zEe]:"fire-iid-compat",[UEe]:"fire-fcm",[WEe]:"fire-fcm-compat",[qEe]:"fire-perf",[GEe]:"fire-perf-compat",[KEe]:"fire-rc",[YEe]:"fire-rc-compat",[XEe]:"fire-gcs",[JEe]:"fire-gcs-compat",[QEe]:"fire-fst",[eTe]:"fire-fst-compat",[ZEe]:"fire-vertex","fire-js":"fire-js",[tTe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ky=new Map,oTe=new Map,YC=new Map;function zP(t,e){try{t.container.addComponent(e)}catch(n){Gs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Sy(t){const e=t.name;if(YC.has(e))return Gs.debug(`There were multiple attempts to register component ${e}.`),!1;YC.set(e,t);for(const n of ky.values())zP(n,t);for(const n of oTe.values())zP(n,t);return!0}function sTe(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function iTe(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aTe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qi=new b6("app","Firebase",aTe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lTe{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new nf("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cTe=nTe;function x6(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:KC,automaticDataCollectionEnabled:!0},e),o=r.name;if(typeof o!="string"||!o)throw qi.create("bad-app-name",{appName:String(o)});if(n||(n=y6()),!n)throw qi.create("no-options");const s=ky.get(o);if(s){if(xy(n,s.options)&&xy(r,s.config))return s;throw qi.create("duplicate-app",{appName:o})}const i=new hEe(o);for(const l of YC.values())i.addComponent(l);const a=new lTe(n,r,i);return ky.set(o,a),a}function uTe(t=KC){const e=ky.get(t);if(!e&&t===KC&&y6())return x6();if(!e)throw qi.create("no-app",{appName:t});return e}function Ic(t,e,n){var r;let o=(r=rTe[t])!==null&&r!==void 0?r:t;n&&(o+=`-${n}`);const s=o.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${o}" with version "${e}":`];s&&a.push(`library name "${o}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gs.warn(a.join(" "));return}Sy(new nf(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dTe="firebase-heartbeat-database",hTe=1,rf="firebase-heartbeat-store";let L1=null;function k6(){return L1||(L1=EEe(dTe,hTe,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(rf)}catch(n){console.warn(n)}}}}).catch(t=>{throw qi.create("idb-open",{originalErrorMessage:t.message})})),L1}async function fTe(t){try{const n=(await k6()).transaction(rf),r=await n.objectStore(rf).get(S6(t));return await n.done,r}catch(e){if(e instanceof Iu)Gs.warn(e.message);else{const n=qi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Gs.warn(n.message)}}}async function UP(t,e){try{const r=(await k6()).transaction(rf,"readwrite");await r.objectStore(rf).put(e,S6(t)),await r.done}catch(n){if(n instanceof Iu)Gs.warn(n.message);else{const r=qi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Gs.warn(r.message)}}}function S6(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pTe=1024,mTe=30;class gTe{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new bTe(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=WP();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(i=>i.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:o}),this._heartbeatsCache.heartbeats.length>mTe){const i=vTe(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Gs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=WP(),{heartbeatsToSend:r,unsentEntries:o}=yTe(this._heartbeatsCache.heartbeats),s=Cy(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Gs.warn(n),""}}}function WP(){return new Date().toISOString().substring(0,10)}function yTe(t,e=pTe){const n=[];let r=t.slice();for(const o of t){const s=n.find(i=>i.agent===o.agent);if(s){if(s.dates.push(o.date),qP(n)>e){s.dates.pop();break}}else if(n.push({agent:o.agent,dates:[o.date]}),qP(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class bTe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return oEe()?sEe().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await fTe(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const o=await this.read();return UP(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const o=await this.read();return UP(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function qP(t){return Cy(JSON.stringify({version:2,heartbeats:t})).length}function vTe(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wTe(t){Sy(new nf("platform-logger",e=>new AEe(e),"PRIVATE")),Sy(new nf("heartbeat",e=>new gTe(e),"PRIVATE")),Ic(GC,HP,t),Ic(GC,HP,"esm2017"),Ic("fire-js","")}wTe("");var GP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Gi,E6;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,S){function _(){}_.prototype=S.prototype,T.D=S.prototype,T.prototype=new _,T.prototype.constructor=T,T.C=function(R,D,O){for(var N=Array(arguments.length-2),K=2;K<arguments.length;K++)N[K-2]=arguments[K];return S.prototype[D].apply(R,N)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(T,S,_){_||(_=0);var R=Array(16);if(typeof S=="string")for(var D=0;16>D;++D)R[D]=S.charCodeAt(_++)|S.charCodeAt(_++)<<8|S.charCodeAt(_++)<<16|S.charCodeAt(_++)<<24;else for(D=0;16>D;++D)R[D]=S[_++]|S[_++]<<8|S[_++]<<16|S[_++]<<24;S=T.g[0],_=T.g[1],D=T.g[2];var O=T.g[3],N=S+(O^_&(D^O))+R[0]+3614090360&4294967295;S=_+(N<<7&4294967295|N>>>25),N=O+(D^S&(_^D))+R[1]+3905402710&4294967295,O=S+(N<<12&4294967295|N>>>20),N=D+(_^O&(S^_))+R[2]+606105819&4294967295,D=O+(N<<17&4294967295|N>>>15),N=_+(S^D&(O^S))+R[3]+3250441966&4294967295,_=D+(N<<22&4294967295|N>>>10),N=S+(O^_&(D^O))+R[4]+4118548399&4294967295,S=_+(N<<7&4294967295|N>>>25),N=O+(D^S&(_^D))+R[5]+1200080426&4294967295,O=S+(N<<12&4294967295|N>>>20),N=D+(_^O&(S^_))+R[6]+2821735955&4294967295,D=O+(N<<17&4294967295|N>>>15),N=_+(S^D&(O^S))+R[7]+4249261313&4294967295,_=D+(N<<22&4294967295|N>>>10),N=S+(O^_&(D^O))+R[8]+1770035416&4294967295,S=_+(N<<7&4294967295|N>>>25),N=O+(D^S&(_^D))+R[9]+2336552879&4294967295,O=S+(N<<12&4294967295|N>>>20),N=D+(_^O&(S^_))+R[10]+4294925233&4294967295,D=O+(N<<17&4294967295|N>>>15),N=_+(S^D&(O^S))+R[11]+2304563134&4294967295,_=D+(N<<22&4294967295|N>>>10),N=S+(O^_&(D^O))+R[12]+1804603682&4294967295,S=_+(N<<7&4294967295|N>>>25),N=O+(D^S&(_^D))+R[13]+4254626195&4294967295,O=S+(N<<12&4294967295|N>>>20),N=D+(_^O&(S^_))+R[14]+2792965006&4294967295,D=O+(N<<17&4294967295|N>>>15),N=_+(S^D&(O^S))+R[15]+1236535329&4294967295,_=D+(N<<22&4294967295|N>>>10),N=S+(D^O&(_^D))+R[1]+4129170786&4294967295,S=_+(N<<5&4294967295|N>>>27),N=O+(_^D&(S^_))+R[6]+3225465664&4294967295,O=S+(N<<9&4294967295|N>>>23),N=D+(S^_&(O^S))+R[11]+643717713&4294967295,D=O+(N<<14&4294967295|N>>>18),N=_+(O^S&(D^O))+R[0]+3921069994&4294967295,_=D+(N<<20&4294967295|N>>>12),N=S+(D^O&(_^D))+R[5]+3593408605&4294967295,S=_+(N<<5&4294967295|N>>>27),N=O+(_^D&(S^_))+R[10]+38016083&4294967295,O=S+(N<<9&4294967295|N>>>23),N=D+(S^_&(O^S))+R[15]+3634488961&4294967295,D=O+(N<<14&4294967295|N>>>18),N=_+(O^S&(D^O))+R[4]+3889429448&4294967295,_=D+(N<<20&4294967295|N>>>12),N=S+(D^O&(_^D))+R[9]+568446438&4294967295,S=_+(N<<5&4294967295|N>>>27),N=O+(_^D&(S^_))+R[14]+3275163606&4294967295,O=S+(N<<9&4294967295|N>>>23),N=D+(S^_&(O^S))+R[3]+4107603335&4294967295,D=O+(N<<14&4294967295|N>>>18),N=_+(O^S&(D^O))+R[8]+1163531501&4294967295,_=D+(N<<20&4294967295|N>>>12),N=S+(D^O&(_^D))+R[13]+2850285829&4294967295,S=_+(N<<5&4294967295|N>>>27),N=O+(_^D&(S^_))+R[2]+4243563512&4294967295,O=S+(N<<9&4294967295|N>>>23),N=D+(S^_&(O^S))+R[7]+1735328473&4294967295,D=O+(N<<14&4294967295|N>>>18),N=_+(O^S&(D^O))+R[12]+2368359562&4294967295,_=D+(N<<20&4294967295|N>>>12),N=S+(_^D^O)+R[5]+4294588738&4294967295,S=_+(N<<4&4294967295|N>>>28),N=O+(S^_^D)+R[8]+2272392833&4294967295,O=S+(N<<11&4294967295|N>>>21),N=D+(O^S^_)+R[11]+1839030562&4294967295,D=O+(N<<16&4294967295|N>>>16),N=_+(D^O^S)+R[14]+4259657740&4294967295,_=D+(N<<23&4294967295|N>>>9),N=S+(_^D^O)+R[1]+2763975236&4294967295,S=_+(N<<4&4294967295|N>>>28),N=O+(S^_^D)+R[4]+1272893353&4294967295,O=S+(N<<11&4294967295|N>>>21),N=D+(O^S^_)+R[7]+4139469664&4294967295,D=O+(N<<16&4294967295|N>>>16),N=_+(D^O^S)+R[10]+3200236656&4294967295,_=D+(N<<23&4294967295|N>>>9),N=S+(_^D^O)+R[13]+681279174&4294967295,S=_+(N<<4&4294967295|N>>>28),N=O+(S^_^D)+R[0]+3936430074&4294967295,O=S+(N<<11&4294967295|N>>>21),N=D+(O^S^_)+R[3]+3572445317&4294967295,D=O+(N<<16&4294967295|N>>>16),N=_+(D^O^S)+R[6]+76029189&4294967295,_=D+(N<<23&4294967295|N>>>9),N=S+(_^D^O)+R[9]+3654602809&4294967295,S=_+(N<<4&4294967295|N>>>28),N=O+(S^_^D)+R[12]+3873151461&4294967295,O=S+(N<<11&4294967295|N>>>21),N=D+(O^S^_)+R[15]+530742520&4294967295,D=O+(N<<16&4294967295|N>>>16),N=_+(D^O^S)+R[2]+3299628645&4294967295,_=D+(N<<23&4294967295|N>>>9),N=S+(D^(_|~O))+R[0]+4096336452&4294967295,S=_+(N<<6&4294967295|N>>>26),N=O+(_^(S|~D))+R[7]+1126891415&4294967295,O=S+(N<<10&4294967295|N>>>22),N=D+(S^(O|~_))+R[14]+2878612391&4294967295,D=O+(N<<15&4294967295|N>>>17),N=_+(O^(D|~S))+R[5]+4237533241&4294967295,_=D+(N<<21&4294967295|N>>>11),N=S+(D^(_|~O))+R[12]+1700485571&4294967295,S=_+(N<<6&4294967295|N>>>26),N=O+(_^(S|~D))+R[3]+2399980690&4294967295,O=S+(N<<10&4294967295|N>>>22),N=D+(S^(O|~_))+R[10]+4293915773&4294967295,D=O+(N<<15&4294967295|N>>>17),N=_+(O^(D|~S))+R[1]+2240044497&4294967295,_=D+(N<<21&4294967295|N>>>11),N=S+(D^(_|~O))+R[8]+1873313359&4294967295,S=_+(N<<6&4294967295|N>>>26),N=O+(_^(S|~D))+R[15]+4264355552&4294967295,O=S+(N<<10&4294967295|N>>>22),N=D+(S^(O|~_))+R[6]+2734768916&4294967295,D=O+(N<<15&4294967295|N>>>17),N=_+(O^(D|~S))+R[13]+1309151649&4294967295,_=D+(N<<21&4294967295|N>>>11),N=S+(D^(_|~O))+R[4]+4149444226&4294967295,S=_+(N<<6&4294967295|N>>>26),N=O+(_^(S|~D))+R[11]+3174756917&4294967295,O=S+(N<<10&4294967295|N>>>22),N=D+(S^(O|~_))+R[2]+718787259&4294967295,D=O+(N<<15&4294967295|N>>>17),N=_+(O^(D|~S))+R[9]+3951481745&4294967295,T.g[0]=T.g[0]+S&4294967295,T.g[1]=T.g[1]+(D+(N<<21&4294967295|N>>>11))&4294967295,T.g[2]=T.g[2]+D&4294967295,T.g[3]=T.g[3]+O&4294967295}r.prototype.u=function(T,S){S===void 0&&(S=T.length);for(var _=S-this.blockSize,R=this.B,D=this.h,O=0;O<S;){if(D==0)for(;O<=_;)o(this,T,O),O+=this.blockSize;if(typeof T=="string"){for(;O<S;)if(R[D++]=T.charCodeAt(O++),D==this.blockSize){o(this,R),D=0;break}}else for(;O<S;)if(R[D++]=T[O++],D==this.blockSize){o(this,R),D=0;break}}this.h=D,this.o+=S},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var S=1;S<T.length-8;++S)T[S]=0;var _=8*this.o;for(S=T.length-8;S<T.length;++S)T[S]=_&255,_/=256;for(this.u(T),T=Array(16),S=_=0;4>S;++S)for(var R=0;32>R;R+=8)T[_++]=this.g[S]>>>R&255;return T};function s(T,S){var _=a;return Object.prototype.hasOwnProperty.call(_,T)?_[T]:_[T]=S(T)}function i(T,S){this.h=S;for(var _=[],R=!0,D=T.length-1;0<=D;D--){var O=T[D]|0;R&&O==S||(_[D]=O,R=!1)}this.g=_}var a={};function l(T){return-128<=T&&128>T?s(T,function(S){return new i([S|0],0>S?-1:0)}):new i([T|0],0>T?-1:0)}function c(T){if(isNaN(T)||!isFinite(T))return d;if(0>T)return b(c(-T));for(var S=[],_=1,R=0;T>=_;R++)S[R]=T/_|0,_*=4294967296;return new i(S,0)}function u(T,S){if(T.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(T.charAt(0)=="-")return b(u(T.substring(1),S));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=c(Math.pow(S,8)),R=d,D=0;D<T.length;D+=8){var O=Math.min(8,T.length-D),N=parseInt(T.substring(D,D+O),S);8>O?(O=c(Math.pow(S,O)),R=R.j(O).add(c(N))):(R=R.j(_),R=R.add(c(N)))}return R}var d=l(0),h=l(1),f=l(16777216);t=i.prototype,t.m=function(){if(y(this))return-b(this).m();for(var T=0,S=1,_=0;_<this.g.length;_++){var R=this.i(_);T+=(0<=R?R:4294967296+R)*S,S*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(p(this))return"0";if(y(this))return"-"+b(this).toString(T);for(var S=c(Math.pow(T,6)),_=this,R="";;){var D=A(_,S).g;_=w(_,D.j(S));var O=((0<_.g.length?_.g[0]:_.h)>>>0).toString(T);if(_=D,p(_))return O+R;for(;6>O.length;)O="0"+O;R=O+R}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function p(T){if(T.h!=0)return!1;for(var S=0;S<T.g.length;S++)if(T.g[S]!=0)return!1;return!0}function y(T){return T.h==-1}t.l=function(T){return T=w(this,T),y(T)?-1:p(T)?0:1};function b(T){for(var S=T.g.length,_=[],R=0;R<S;R++)_[R]=~T.g[R];return new i(_,~T.h).add(h)}t.abs=function(){return y(this)?b(this):this},t.add=function(T){for(var S=Math.max(this.g.length,T.g.length),_=[],R=0,D=0;D<=S;D++){var O=R+(this.i(D)&65535)+(T.i(D)&65535),N=(O>>>16)+(this.i(D)>>>16)+(T.i(D)>>>16);R=N>>>16,O&=65535,N&=65535,_[D]=N<<16|O}return new i(_,_[_.length-1]&-2147483648?-1:0)};function w(T,S){return T.add(b(S))}t.j=function(T){if(p(this)||p(T))return d;if(y(this))return y(T)?b(this).j(b(T)):b(b(this).j(T));if(y(T))return b(this.j(b(T)));if(0>this.l(f)&&0>T.l(f))return c(this.m()*T.m());for(var S=this.g.length+T.g.length,_=[],R=0;R<2*S;R++)_[R]=0;for(R=0;R<this.g.length;R++)for(var D=0;D<T.g.length;D++){var O=this.i(R)>>>16,N=this.i(R)&65535,K=T.i(D)>>>16,Q=T.i(D)&65535;_[2*R+2*D]+=N*Q,k(_,2*R+2*D),_[2*R+2*D+1]+=O*Q,k(_,2*R+2*D+1),_[2*R+2*D+1]+=N*K,k(_,2*R+2*D+1),_[2*R+2*D+2]+=O*K,k(_,2*R+2*D+2)}for(R=0;R<S;R++)_[R]=_[2*R+1]<<16|_[2*R];for(R=S;R<2*S;R++)_[R]=0;return new i(_,0)};function k(T,S){for(;(T[S]&65535)!=T[S];)T[S+1]+=T[S]>>>16,T[S]&=65535,S++}function x(T,S){this.g=T,this.h=S}function A(T,S){if(p(S))throw Error("division by zero");if(p(T))return new x(d,d);if(y(T))return S=A(b(T),S),new x(b(S.g),b(S.h));if(y(S))return S=A(T,b(S)),new x(b(S.g),S.h);if(30<T.g.length){if(y(T)||y(S))throw Error("slowDivide_ only works with positive integers.");for(var _=h,R=S;0>=R.l(T);)_=I(_),R=I(R);var D=M(_,1),O=M(R,1);for(R=M(R,2),_=M(_,2);!p(R);){var N=O.add(R);0>=N.l(T)&&(D=D.add(_),O=N),R=M(R,1),_=M(_,1)}return S=w(T,D.j(S)),new x(D,S)}for(D=d;0<=T.l(S);){for(_=Math.max(1,Math.floor(T.m()/S.m())),R=Math.ceil(Math.log(_)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),O=c(_),N=O.j(S);y(N)||0<N.l(T);)_-=R,O=c(_),N=O.j(S);p(O)&&(O=h),D=D.add(O),T=w(T,N)}return new x(D,T)}t.A=function(T){return A(this,T).h},t.and=function(T){for(var S=Math.max(this.g.length,T.g.length),_=[],R=0;R<S;R++)_[R]=this.i(R)&T.i(R);return new i(_,this.h&T.h)},t.or=function(T){for(var S=Math.max(this.g.length,T.g.length),_=[],R=0;R<S;R++)_[R]=this.i(R)|T.i(R);return new i(_,this.h|T.h)},t.xor=function(T){for(var S=Math.max(this.g.length,T.g.length),_=[],R=0;R<S;R++)_[R]=this.i(R)^T.i(R);return new i(_,this.h^T.h)};function I(T){for(var S=T.g.length+1,_=[],R=0;R<S;R++)_[R]=T.i(R)<<1|T.i(R-1)>>>31;return new i(_,T.h)}function M(T,S){var _=S>>5;S%=32;for(var R=T.g.length-_,D=[],O=0;O<R;O++)D[O]=0<S?T.i(O+_)>>>S|T.i(O+_+1)<<32-S:T.i(O+_);return new i(D,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,E6=r,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=u,Gi=i}).apply(typeof GP<"u"?GP:typeof self<"u"?self:typeof window<"u"?window:{});var sm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var T6,xd,_6,jm,XC,A6,I6,M6;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(g,C,E){return g==Array.prototype||g==Object.prototype||(g[C]=E.value),g};function n(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof sm=="object"&&sm];for(var C=0;C<g.length;++C){var E=g[C];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var r=n(this);function o(g,C){if(C)e:{var E=r;g=g.split(".");for(var P=0;P<g.length-1;P++){var V=g[P];if(!(V in E))break e;E=E[V]}g=g[g.length-1],P=E[g],C=C(P),C!=P&&C!=null&&e(E,g,{configurable:!0,writable:!0,value:C})}}function s(g,C){g instanceof String&&(g+="");var E=0,P=!1,V={next:function(){if(!P&&E<g.length){var j=E++;return{value:C(j,g[j]),done:!1}}return P=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}o("Array.prototype.values",function(g){return g||function(){return s(this,function(C,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},a=this||self;function l(g){var C=typeof g;return C=C!="object"?C:g?Array.isArray(g)?"array":C:"null",C=="array"||C=="object"&&typeof g.length=="number"}function c(g){var C=typeof g;return C=="object"&&g!=null||C=="function"}function u(g,C,E){return g.call.apply(g.bind,arguments)}function d(g,C,E){if(!g)throw Error();if(2<arguments.length){var P=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,P),g.apply(C,V)}}return function(){return g.apply(C,arguments)}}function h(g,C,E){return h=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,h.apply(null,arguments)}function f(g,C){var E=Array.prototype.slice.call(arguments,1);return function(){var P=E.slice();return P.push.apply(P,arguments),g.apply(this,P)}}function p(g,C){function E(){}E.prototype=C.prototype,g.aa=C.prototype,g.prototype=new E,g.prototype.constructor=g,g.Qb=function(P,V,j){for(var J=Array(arguments.length-2),rt=2;rt<arguments.length;rt++)J[rt-2]=arguments[rt];return C.prototype[V].apply(P,J)}}function y(g){const C=g.length;if(0<C){const E=Array(C);for(let P=0;P<C;P++)E[P]=g[P];return E}return[]}function b(g,C){for(let E=1;E<arguments.length;E++){const P=arguments[E];if(l(P)){const V=g.length||0,j=P.length||0;g.length=V+j;for(let J=0;J<j;J++)g[V+J]=P[J]}else g.push(P)}}class w{constructor(C,E){this.i=C,this.j=E,this.h=0,this.g=null}get(){let C;return 0<this.h?(this.h--,C=this.g,this.g=C.next,C.next=null):C=this.i(),C}}function k(g){return/^[\s\xa0]*$/.test(g)}function x(){var g=a.navigator;return g&&(g=g.userAgent)?g:""}function A(g){return A[" "](g),g}A[" "]=function(){};var I=x().indexOf("Gecko")!=-1&&!(x().toLowerCase().indexOf("webkit")!=-1&&x().indexOf("Edge")==-1)&&!(x().indexOf("Trident")!=-1||x().indexOf("MSIE")!=-1)&&x().indexOf("Edge")==-1;function M(g,C,E){for(const P in g)C.call(E,g[P],P,g)}function T(g,C){for(const E in g)C.call(void 0,g[E],E,g)}function S(g){const C={};for(const E in g)C[E]=g[E];return C}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(g,C){let E,P;for(let V=1;V<arguments.length;V++){P=arguments[V];for(E in P)g[E]=P[E];for(let j=0;j<_.length;j++)E=_[j],Object.prototype.hasOwnProperty.call(P,E)&&(g[E]=P[E])}}function D(g){var C=1;g=g.split(":");const E=[];for(;0<C&&g.length;)E.push(g.shift()),C--;return g.length&&E.push(g.join(":")),E}function O(g){a.setTimeout(()=>{throw g},0)}function N(){var g=X;let C=null;return g.g&&(C=g.g,g.g=g.g.next,g.g||(g.h=null),C.next=null),C}class K{constructor(){this.h=this.g=null}add(C,E){const P=Q.get();P.set(C,E),this.h?this.h.next=P:this.g=P,this.h=P}}var Q=new w(()=>new ce,g=>g.reset());class ce{constructor(){this.next=this.g=this.h=null}set(C,E){this.h=C,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let z,W=!1,X=new K,le=()=>{const g=a.Promise.resolve(void 0);z=()=>{g.then(te)}};var te=()=>{for(var g;g=N();){try{g.h.call(g.g)}catch(E){O(E)}var C=Q;C.j(g),100>C.h&&(C.h++,g.next=C.g,C.g=g)}W=!1};function oe(){this.s=this.s,this.C=this.C}oe.prototype.s=!1,oe.prototype.ma=function(){this.s||(this.s=!0,this.N())},oe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(g,C){this.type=g,this.g=this.target=C,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var lt=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var g=!1,C=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const E=()=>{};a.addEventListener("test",E,C),a.removeEventListener("test",E,C)}catch{}return g}();function Ze(g,C){if(ue.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g){var E=this.type=g.type,P=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;if(this.target=g.target||g.srcElement,this.g=C,C=g.relatedTarget){if(I){e:{try{A(C.nodeName);var V=!0;break e}catch{}V=!1}V||(C=null)}}else E=="mouseover"?C=g.fromElement:E=="mouseout"&&(C=g.toElement);this.relatedTarget=C,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=typeof g.pointerType=="string"?g.pointerType:De[g.pointerType]||"",this.state=g.state,this.i=g,g.defaultPrevented&&Ze.aa.h.call(this)}}p(Ze,ue);var De={2:"touch",3:"pen",4:"mouse"};Ze.prototype.h=function(){Ze.aa.h.call(this);var g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var Ge="closure_listenable_"+(1e6*Math.random()|0),gt=0;function nt(g,C,E,P,V){this.listener=g,this.proxy=null,this.src=C,this.type=E,this.capture=!!P,this.ha=V,this.key=++gt,this.da=this.fa=!1}function ge(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function Wt(g){this.src=g,this.g={},this.h=0}Wt.prototype.add=function(g,C,E,P,V){var j=g.toString();g=this.g[j],g||(g=this.g[j]=[],this.h++);var J=Xt(g,C,P,V);return-1<J?(C=g[J],E||(C.fa=!1)):(C=new nt(C,this.src,j,!!P,V),C.fa=E,g.push(C)),C};function Ot(g,C){var E=C.type;if(E in g.g){var P=g.g[E],V=Array.prototype.indexOf.call(P,C,void 0),j;(j=0<=V)&&Array.prototype.splice.call(P,V,1),j&&(ge(C),g.g[E].length==0&&(delete g.g[E],g.h--))}}function Xt(g,C,E,P){for(var V=0;V<g.length;++V){var j=g[V];if(!j.da&&j.listener==C&&j.capture==!!E&&j.ha==P)return V}return-1}var Lt="closure_lm_"+(1e6*Math.random()|0),Sn={};function gr(g,C,E,P,V){if(Array.isArray(C)){for(var j=0;j<C.length;j++)gr(g,C[j],E,P,V);return null}return E=Ta(E),g&&g[Ge]?g.K(C,E,c(P)?!!P.capture:!1,V):ri(g,C,E,!1,P,V)}function ri(g,C,E,P,V,j){if(!C)throw Error("Invalid event type");var J=c(V)?!!V.capture:!!V,rt=ii(g);if(rt||(g[Lt]=rt=new Wt(g)),E=rt.add(C,E,P,J,j),E.proxy)return E;if(P=oi(),E.proxy=P,P.src=g,P.listener=E,g.addEventListener)lt||(V=J),V===void 0&&(V=!1),g.addEventListener(C.toString(),P,V);else if(g.attachEvent)g.attachEvent(ps(C.toString()),P);else if(g.addListener&&g.removeListener)g.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return E}function oi(){function g(E){return C.call(g.src,g.listener,E)}const C=si;return g}function eo(g,C,E,P,V){if(Array.isArray(C))for(var j=0;j<C.length;j++)eo(g,C[j],E,P,V);else P=c(P)?!!P.capture:!!P,E=Ta(E),g&&g[Ge]?(g=g.i,C=String(C).toString(),C in g.g&&(j=g.g[C],E=Xt(j,E,P,V),-1<E&&(ge(j[E]),Array.prototype.splice.call(j,E,1),j.length==0&&(delete g.g[C],g.h--)))):g&&(g=ii(g))&&(C=g.g[C.toString()],g=-1,C&&(g=Xt(C,E,P,V)),(E=-1<g?C[g]:null)&&Xe(E))}function Xe(g){if(typeof g!="number"&&g&&!g.da){var C=g.src;if(C&&C[Ge])Ot(C.i,g);else{var E=g.type,P=g.proxy;C.removeEventListener?C.removeEventListener(E,P,g.capture):C.detachEvent?C.detachEvent(ps(E),P):C.addListener&&C.removeListener&&C.removeListener(P),(E=ii(C))?(Ot(E,g),E.h==0&&(E.src=null,C[Lt]=null)):ge(g)}}}function ps(g){return g in Sn?Sn[g]:Sn[g]="on"+g}function si(g,C){if(g.da)g=!0;else{C=new Ze(C,this);var E=g.listener,P=g.ha||g.src;g.fa&&Xe(g),g=E.call(P,C)}return g}function ii(g){return g=g[Lt],g instanceof Wt?g:null}var ai="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ta(g){return typeof g=="function"?g:(g[ai]||(g[ai]=function(C){return g.handleEvent(C)}),g[ai])}function It(){oe.call(this),this.i=new Wt(this),this.M=this,this.F=null}p(It,oe),It.prototype[Ge]=!0,It.prototype.removeEventListener=function(g,C,E,P){eo(this,g,C,E,P)};function ht(g,C){var E,P=g.F;if(P)for(E=[];P;P=P.F)E.push(P);if(g=g.M,P=C.type||C,typeof C=="string")C=new ue(C,g);else if(C instanceof ue)C.target=C.target||g;else{var V=C;C=new ue(P,g),R(C,V)}if(V=!0,E)for(var j=E.length-1;0<=j;j--){var J=C.g=E[j];V=nr(J,P,!0,C)&&V}if(J=C.g=g,V=nr(J,P,!0,C)&&V,V=nr(J,P,!1,C)&&V,E)for(j=0;j<E.length;j++)J=C.g=E[j],V=nr(J,P,!1,C)&&V}It.prototype.N=function(){if(It.aa.N.call(this),this.i){var g=this.i,C;for(C in g.g){for(var E=g.g[C],P=0;P<E.length;P++)ge(E[P]);delete g.g[C],g.h--}}this.F=null},It.prototype.K=function(g,C,E,P){return this.i.add(String(g),C,!1,E,P)},It.prototype.L=function(g,C,E,P){return this.i.add(String(g),C,!0,E,P)};function nr(g,C,E,P){if(C=g.i.g[String(C)],!C)return!0;C=C.concat();for(var V=!0,j=0;j<C.length;++j){var J=C[j];if(J&&!J.da&&J.capture==E){var rt=J.listener,an=J.ha||J.src;J.fa&&Ot(g.i,J),V=rt.call(an,P)!==!1&&V}}return V&&!P.defaultPrevented}function to(g,C,E){if(typeof g=="function")E&&(g=h(g,E));else if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return 2147483647<Number(C)?-1:a.setTimeout(g,C||0)}function li(g){g.g=to(()=>{g.g=null,g.i&&(g.i=!1,li(g))},g.l);const C=g.h;g.h=null,g.m.apply(null,C)}class yt extends oe{constructor(C,E){super(),this.m=C,this.l=E,this.h=null,this.i=!1,this.g=null}j(C){this.h=arguments,this.g?this.i=!0:li(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ci(g){oe.call(this),this.h=g,this.g={}}p(ci,oe);var rp=[];function op(g){M(g.g,function(C,E){this.g.hasOwnProperty(E)&&Xe(C)},g),g.g={}}ci.prototype.N=function(){ci.aa.N.call(this),op(this)},ci.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _a=a.JSON.stringify,sp=a.JSON.parse,T0=class{stringify(g){return a.JSON.stringify(g,void 0)}parse(g){return a.JSON.parse(g,void 0)}};function Fl(){}Fl.prototype.h=null;function ip(g){return g.h||(g.h=g.i())}function ap(){}var Aa={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Vt(){ue.call(this,"d")}p(Vt,ue);function on(){ue.call(this,"c")}p(on,ue);var Mt={},no=null;function sn(){return no=no||new It}Mt.La="serverreachability";function En(g){ue.call(this,Mt.La,g)}p(En,ue);function Tn(g){const C=sn();ht(C,new En(C))}Mt.STAT_EVENT="statevent";function ms(g,C){ue.call(this,Mt.STAT_EVENT,g),this.stat=C}p(ms,ue);function ze(g){const C=sn();ht(C,new ms(C,g))}Mt.Ma="timingevent";function ro(g,C){ue.call(this,Mt.Ma,g),this.size=C}p(ro,ue);function _n(g,C){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){g()},C)}function Hn(){this.g=!0}Hn.prototype.xa=function(){this.g=!1};function Ia(g,C,E,P,V,j){g.info(function(){if(g.g)if(j)for(var J="",rt=j.split("&"),an=0;an<rt.length;an++){var qe=rt[an].split("=");if(1<qe.length){var An=qe[0];qe=qe[1];var In=An.split("_");J=2<=In.length&&In[1]=="type"?J+(An+"="+qe+"&"):J+(An+"=redacted&")}}else J=null;else J=j;return"XMLHTTP REQ ("+P+") [attempt "+V+"]: "+C+`
`+E+`
`+J})}function Ma(g,C,E,P,V,j,J){g.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+V+"]: "+C+`
`+E+`
`+j+" "+J})}function zn(g,C,E,P){g.info(function(){return"XMLHTTP TEXT ("+C+"): "+Ou(g,E)+(P?" "+P:"")})}function Ra(g,C){g.info(function(){return"TIMEOUT: "+C})}Hn.prototype.info=function(){};function Ou(g,C){if(!g.g)return C;if(!C)return null;try{var E=JSON.parse(C);if(E){for(g=0;g<E.length;g++)if(Array.isArray(E[g])){var P=E[g];if(!(2>P.length)){var V=P[1];if(Array.isArray(V)&&!(1>V.length)){var j=V[0];if(j!="noop"&&j!="stop"&&j!="close")for(var J=1;J<V.length;J++)V[J]=""}}}}return _a(E)}catch{return C}}var lp={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},VT={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},_0;function cp(){}p(cp,Fl),cp.prototype.g=function(){return new XMLHttpRequest},cp.prototype.i=function(){return{}},_0=new cp;function ui(g,C,E,P){this.j=g,this.i=C,this.l=E,this.R=P||1,this.U=new ci(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new jT}function jT(){this.i=null,this.g="",this.h=!1}var BT={},A0={};function I0(g,C,E){g.L=1,g.v=fp(gs(C)),g.m=E,g.P=!0,$T(g,null)}function $T(g,C){g.F=Date.now(),up(g),g.A=gs(g.v);var E=g.A,P=g.R;Array.isArray(P)||(P=[String(P)]),e_(E.i,"t",P),g.C=0,E=g.j.J,g.h=new jT,g.g=b_(g.j,E?C:null,!g.m),0<g.O&&(g.M=new yt(h(g.Y,g,g.g),g.O)),C=g.U,E=g.g,P=g.ca;var V="readystatechange";Array.isArray(V)||(V&&(rp[0]=V.toString()),V=rp);for(var j=0;j<V.length;j++){var J=gr(E,V[j],P||C.handleEvent,!1,C.h||C);if(!J)break;C.g[J.key]=J}C=g.H?S(g.H):{},g.m?(g.u||(g.u="POST"),C["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.A,g.u,g.m,C)):(g.u="GET",g.g.ea(g.A,g.u,null,C)),Tn(),Ia(g.i,g.u,g.A,g.l,g.R,g.m)}ui.prototype.ca=function(g){g=g.target;const C=this.M;C&&ys(g)==3?C.j():this.Y(g)},ui.prototype.Y=function(g){try{if(g==this.g)e:{const In=ys(this.g);var C=this.g.Ba();const Ul=this.g.Z();if(!(3>In)&&(In!=3||this.g&&(this.h.h||this.g.oa()||a_(this.g)))){this.J||In!=4||C==7||(C==8||0>=Ul?Tn(3):Tn(2)),M0(this);var E=this.g.Z();this.X=E;t:if(FT(this)){var P=a_(this.g);g="";var V=P.length,j=ys(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Pa(this),Lu(this);var J="";break t}this.h.i=new a.TextDecoder}for(C=0;C<V;C++)this.h.h=!0,g+=this.h.i.decode(P[C],{stream:!(j&&C==V-1)});P.length=0,this.h.g+=g,this.C=0,J=this.h.g}else J=this.g.oa();if(this.o=E==200,Ma(this.i,this.u,this.A,this.l,this.R,In,E),this.o){if(this.T&&!this.K){t:{if(this.g){var rt,an=this.g;if((rt=an.g?an.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(rt)){var qe=rt;break t}}qe=null}if(E=qe)zn(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,R0(this,E);else{this.o=!1,this.s=3,ze(12),Pa(this),Lu(this);break e}}if(this.P){E=!0;let oo;for(;!this.J&&this.C<J.length;)if(oo=n$(this,J),oo==A0){In==4&&(this.s=4,ze(14),E=!1),zn(this.i,this.l,null,"[Incomplete Response]");break}else if(oo==BT){this.s=4,ze(15),zn(this.i,this.l,J,"[Invalid Chunk]"),E=!1;break}else zn(this.i,this.l,oo,null),R0(this,oo);if(FT(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),In!=4||J.length!=0||this.h.h||(this.s=1,ze(16),E=!1),this.o=this.o&&E,!E)zn(this.i,this.l,J,"[Invalid Chunked Response]"),Pa(this),Lu(this);else if(0<J.length&&!this.W){this.W=!0;var An=this.j;An.g==this&&An.ba&&!An.M&&(An.j.info("Great, no buffering proxy detected. Bytes received: "+J.length),V0(An),An.M=!0,ze(11))}}else zn(this.i,this.l,J,null),R0(this,J);In==4&&Pa(this),this.o&&!this.J&&(In==4?p_(this.j,this):(this.o=!1,up(this)))}else v$(this.g),E==400&&0<J.indexOf("Unknown SID")?(this.s=3,ze(12)):(this.s=0,ze(13)),Pa(this),Lu(this)}}}catch{}finally{}};function FT(g){return g.g?g.u=="GET"&&g.L!=2&&g.j.Ca:!1}function n$(g,C){var E=g.C,P=C.indexOf(`
`,E);return P==-1?A0:(E=Number(C.substring(E,P)),isNaN(E)?BT:(P+=1,P+E>C.length?A0:(C=C.slice(P,P+E),g.C=P+E,C)))}ui.prototype.cancel=function(){this.J=!0,Pa(this)};function up(g){g.S=Date.now()+g.I,HT(g,g.I)}function HT(g,C){if(g.B!=null)throw Error("WatchDog timer not null");g.B=_n(h(g.ba,g),C)}function M0(g){g.B&&(a.clearTimeout(g.B),g.B=null)}ui.prototype.ba=function(){this.B=null;const g=Date.now();0<=g-this.S?(Ra(this.i,this.A),this.L!=2&&(Tn(),ze(17)),Pa(this),this.s=2,Lu(this)):HT(this,this.S-g)};function Lu(g){g.j.G==0||g.J||p_(g.j,g)}function Pa(g){M0(g);var C=g.M;C&&typeof C.ma=="function"&&C.ma(),g.M=null,op(g.U),g.g&&(C=g.g,g.g=null,C.abort(),C.ma())}function R0(g,C){try{var E=g.j;if(E.G!=0&&(E.g==g||P0(E.h,g))){if(!g.K&&P0(E.h,g)&&E.G==3){try{var P=E.Da.g.parse(C)}catch{P=null}if(Array.isArray(P)&&P.length==3){var V=P;if(V[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<g.F)vp(E),yp(E);else break e;L0(E),ze(18)}}else E.za=V[1],0<E.za-E.T&&37500>V[2]&&E.F&&E.v==0&&!E.C&&(E.C=_n(h(E.Za,E),6e3));if(1>=WT(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else Na(E,11)}else if((g.K||E.g==g)&&vp(E),!k(C))for(V=E.Da.g.parse(C),C=0;C<V.length;C++){let qe=V[C];if(E.T=qe[0],qe=qe[1],E.G==2)if(qe[0]=="c"){E.K=qe[1],E.ia=qe[2];const An=qe[3];An!=null&&(E.la=An,E.j.info("VER="+E.la));const In=qe[4];In!=null&&(E.Aa=In,E.j.info("SVER="+E.Aa));const Ul=qe[5];Ul!=null&&typeof Ul=="number"&&0<Ul&&(P=1.5*Ul,E.L=P,E.j.info("backChannelRequestTimeoutMs_="+P)),P=E;const oo=g.g;if(oo){const Cp=oo.g?oo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Cp){var j=P.h;j.g||Cp.indexOf("spdy")==-1&&Cp.indexOf("quic")==-1&&Cp.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(D0(j,j.h),j.h=null))}if(P.D){const j0=oo.g?oo.g.getResponseHeader("X-HTTP-Session-Id"):null;j0&&(P.ya=j0,ft(P.I,P.D,j0))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-g.F,E.j.info("Handshake RTT: "+E.R+"ms")),P=E;var J=g;if(P.qa=y_(P,P.J?P.ia:null,P.W),J.K){qT(P.h,J);var rt=J,an=P.L;an&&(rt.I=an),rt.B&&(M0(rt),up(rt)),P.g=J}else h_(P);0<E.i.length&&bp(E)}else qe[0]!="stop"&&qe[0]!="close"||Na(E,7);else E.G==3&&(qe[0]=="stop"||qe[0]=="close"?qe[0]=="stop"?Na(E,7):O0(E):qe[0]!="noop"&&E.l&&E.l.ta(qe),E.v=0)}}Tn(4)}catch{}}var r$=class{constructor(g,C){this.g=g,this.map=C}};function zT(g){this.l=g||10,a.PerformanceNavigationTiming?(g=a.performance.getEntriesByType("navigation"),g=0<g.length&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function UT(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function WT(g){return g.h?1:g.g?g.g.size:0}function P0(g,C){return g.h?g.h==C:g.g?g.g.has(C):!1}function D0(g,C){g.g?g.g.add(C):g.h=C}function qT(g,C){g.h&&g.h==C?g.h=null:g.g&&g.g.has(C)&&g.g.delete(C)}zT.prototype.cancel=function(){if(this.i=GT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function GT(g){if(g.h!=null)return g.i.concat(g.h.D);if(g.g!=null&&g.g.size!==0){let C=g.i;for(const E of g.g.values())C=C.concat(E.D);return C}return y(g.i)}function o$(g){if(g.V&&typeof g.V=="function")return g.V();if(typeof Map<"u"&&g instanceof Map||typeof Set<"u"&&g instanceof Set)return Array.from(g.values());if(typeof g=="string")return g.split("");if(l(g)){for(var C=[],E=g.length,P=0;P<E;P++)C.push(g[P]);return C}C=[],E=0;for(P in g)C[E++]=g[P];return C}function s$(g){if(g.na&&typeof g.na=="function")return g.na();if(!g.V||typeof g.V!="function"){if(typeof Map<"u"&&g instanceof Map)return Array.from(g.keys());if(!(typeof Set<"u"&&g instanceof Set)){if(l(g)||typeof g=="string"){var C=[];g=g.length;for(var E=0;E<g;E++)C.push(E);return C}C=[],E=0;for(const P in g)C[E++]=P;return C}}}function KT(g,C){if(g.forEach&&typeof g.forEach=="function")g.forEach(C,void 0);else if(l(g)||typeof g=="string")Array.prototype.forEach.call(g,C,void 0);else for(var E=s$(g),P=o$(g),V=P.length,j=0;j<V;j++)C.call(void 0,P[j],E&&E[j],g)}var YT=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function i$(g,C){if(g){g=g.split("&");for(var E=0;E<g.length;E++){var P=g[E].indexOf("="),V=null;if(0<=P){var j=g[E].substring(0,P);V=g[E].substring(P+1)}else j=g[E];C(j,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function Da(g){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,g instanceof Da){this.h=g.h,dp(this,g.j),this.o=g.o,this.g=g.g,hp(this,g.s),this.l=g.l;var C=g.i,E=new Bu;E.i=C.i,C.g&&(E.g=new Map(C.g),E.h=C.h),XT(this,E),this.m=g.m}else g&&(C=String(g).match(YT))?(this.h=!1,dp(this,C[1]||"",!0),this.o=Vu(C[2]||""),this.g=Vu(C[3]||"",!0),hp(this,C[4]),this.l=Vu(C[5]||"",!0),XT(this,C[6]||"",!0),this.m=Vu(C[7]||"")):(this.h=!1,this.i=new Bu(null,this.h))}Da.prototype.toString=function(){var g=[],C=this.j;C&&g.push(ju(C,JT,!0),":");var E=this.g;return(E||C=="file")&&(g.push("//"),(C=this.o)&&g.push(ju(C,JT,!0),"@"),g.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&g.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&g.push("/"),g.push(ju(E,E.charAt(0)=="/"?c$:l$,!0))),(E=this.i.toString())&&g.push("?",E),(E=this.m)&&g.push("#",ju(E,d$)),g.join("")};function gs(g){return new Da(g)}function dp(g,C,E){g.j=E?Vu(C,!0):C,g.j&&(g.j=g.j.replace(/:$/,""))}function hp(g,C){if(C){if(C=Number(C),isNaN(C)||0>C)throw Error("Bad port number "+C);g.s=C}else g.s=null}function XT(g,C,E){C instanceof Bu?(g.i=C,h$(g.i,g.h)):(E||(C=ju(C,u$)),g.i=new Bu(C,g.h))}function ft(g,C,E){g.i.set(C,E)}function fp(g){return ft(g,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),g}function Vu(g,C){return g?C?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function ju(g,C,E){return typeof g=="string"?(g=encodeURI(g).replace(C,a$),E&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function a$(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var JT=/[#\/\?@]/g,l$=/[#\?:]/g,c$=/[#\?]/g,u$=/[#\?@]/g,d$=/#/g;function Bu(g,C){this.h=this.g=null,this.i=g||null,this.j=!!C}function di(g){g.g||(g.g=new Map,g.h=0,g.i&&i$(g.i,function(C,E){g.add(decodeURIComponent(C.replace(/\+/g," ")),E)}))}t=Bu.prototype,t.add=function(g,C){di(this),this.i=null,g=Hl(this,g);var E=this.g.get(g);return E||this.g.set(g,E=[]),E.push(C),this.h+=1,this};function QT(g,C){di(g),C=Hl(g,C),g.g.has(C)&&(g.i=null,g.h-=g.g.get(C).length,g.g.delete(C))}function ZT(g,C){return di(g),C=Hl(g,C),g.g.has(C)}t.forEach=function(g,C){di(this),this.g.forEach(function(E,P){E.forEach(function(V){g.call(C,V,P,this)},this)},this)},t.na=function(){di(this);const g=Array.from(this.g.values()),C=Array.from(this.g.keys()),E=[];for(let P=0;P<C.length;P++){const V=g[P];for(let j=0;j<V.length;j++)E.push(C[P])}return E},t.V=function(g){di(this);let C=[];if(typeof g=="string")ZT(this,g)&&(C=C.concat(this.g.get(Hl(this,g))));else{g=Array.from(this.g.values());for(let E=0;E<g.length;E++)C=C.concat(g[E])}return C},t.set=function(g,C){return di(this),this.i=null,g=Hl(this,g),ZT(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[C]),this.h+=1,this},t.get=function(g,C){return g?(g=this.V(g),0<g.length?String(g[0]):C):C};function e_(g,C,E){QT(g,C),0<E.length&&(g.i=null,g.g.set(Hl(g,C),y(E)),g.h+=E.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],C=Array.from(this.g.keys());for(var E=0;E<C.length;E++){var P=C[E];const j=encodeURIComponent(String(P)),J=this.V(P);for(P=0;P<J.length;P++){var V=j;J[P]!==""&&(V+="="+encodeURIComponent(String(J[P]))),g.push(V)}}return this.i=g.join("&")};function Hl(g,C){return C=String(C),g.j&&(C=C.toLowerCase()),C}function h$(g,C){C&&!g.j&&(di(g),g.i=null,g.g.forEach(function(E,P){var V=P.toLowerCase();P!=V&&(QT(this,P),e_(this,V,E))},g)),g.j=C}function f$(g,C){const E=new Hn;if(a.Image){const P=new Image;P.onload=f(hi,E,"TestLoadImage: loaded",!0,C,P),P.onerror=f(hi,E,"TestLoadImage: error",!1,C,P),P.onabort=f(hi,E,"TestLoadImage: abort",!1,C,P),P.ontimeout=f(hi,E,"TestLoadImage: timeout",!1,C,P),a.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=g}else C(!1)}function p$(g,C){const E=new Hn,P=new AbortController,V=setTimeout(()=>{P.abort(),hi(E,"TestPingServer: timeout",!1,C)},1e4);fetch(g,{signal:P.signal}).then(j=>{clearTimeout(V),j.ok?hi(E,"TestPingServer: ok",!0,C):hi(E,"TestPingServer: server error",!1,C)}).catch(()=>{clearTimeout(V),hi(E,"TestPingServer: error",!1,C)})}function hi(g,C,E,P,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),P(E)}catch{}}function m$(){this.g=new T0}function g$(g,C,E){const P=E||"";try{KT(g,function(V,j){let J=V;c(V)&&(J=_a(V)),C.push(P+j+"="+encodeURIComponent(J))})}catch(V){throw C.push(P+"type="+encodeURIComponent("_badmap")),V}}function pp(g){this.l=g.Ub||null,this.j=g.eb||!1}p(pp,Fl),pp.prototype.g=function(){return new mp(this.l,this.j)},pp.prototype.i=function(g){return function(){return g}}({});function mp(g,C){It.call(this),this.D=g,this.o=C,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}p(mp,It),t=mp.prototype,t.open=function(g,C){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=g,this.A=C,this.readyState=1,Fu(this)},t.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const C={headers:this.u,method:this.B,credentials:this.m,cache:void 0};g&&(C.body=g),(this.D||a).fetch(new Request(this.A,C)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,$u(this)),this.readyState=0},t.Sa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,Fu(this)),this.g&&(this.readyState=3,Fu(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;t_(this)}else g.text().then(this.Ra.bind(this),this.ga.bind(this))};function t_(g){g.j.read().then(g.Pa.bind(g)).catch(g.ga.bind(g))}t.Pa=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var C=g.value?g.value:new Uint8Array(0);(C=this.v.decode(C,{stream:!g.done}))&&(this.response=this.responseText+=C)}g.done?$u(this):Fu(this),this.readyState==3&&t_(this)}},t.Ra=function(g){this.g&&(this.response=this.responseText=g,$u(this))},t.Qa=function(g){this.g&&(this.response=g,$u(this))},t.ga=function(){this.g&&$u(this)};function $u(g){g.readyState=4,g.l=null,g.j=null,g.v=null,Fu(g)}t.setRequestHeader=function(g,C){this.u.append(g,C)},t.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],C=this.h.entries();for(var E=C.next();!E.done;)E=E.value,g.push(E[0]+": "+E[1]),E=C.next();return g.join(`\r
`)};function Fu(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(mp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function n_(g){let C="";return M(g,function(E,P){C+=P,C+=":",C+=E,C+=`\r
`}),C}function N0(g,C,E){e:{for(P in E){var P=!1;break e}P=!0}P||(E=n_(E),typeof g=="string"?E!=null&&encodeURIComponent(String(E)):ft(g,C,E))}function St(g){It.call(this),this.headers=new Map,this.o=g||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}p(St,It);var y$=/^https?$/i,b$=["POST","PUT"];t=St.prototype,t.Ha=function(g){this.J=g},t.ea=function(g,C,E,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);C=C?C.toUpperCase():"GET",this.D=g,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():_0.g(),this.v=this.o?ip(this.o):ip(_0),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(C,String(g),!0),this.B=!1}catch(j){r_(this,j);return}if(g=E||"",E=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var V in P)E.set(V,P[V]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const j of P.keys())E.set(j,P.get(j));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(E.keys()).find(j=>j.toLowerCase()=="content-type"),V=a.FormData&&g instanceof a.FormData,!(0<=Array.prototype.indexOf.call(b$,C,void 0))||P||V||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,J]of E)this.g.setRequestHeader(j,J);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{i_(this),this.u=!0,this.g.send(g),this.u=!1}catch(j){r_(this,j)}};function r_(g,C){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=C,g.m=5,o_(g),gp(g)}function o_(g){g.A||(g.A=!0,ht(g,"complete"),ht(g,"error"))}t.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=g||7,ht(this,"complete"),ht(this,"abort"),gp(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),gp(this,!0)),St.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?s_(this):this.bb())},t.bb=function(){s_(this)};function s_(g){if(g.h&&typeof i<"u"&&(!g.v[1]||ys(g)!=4||g.Z()!=2)){if(g.u&&ys(g)==4)to(g.Ea,0,g);else if(ht(g,"readystatechange"),ys(g)==4){g.h=!1;try{const J=g.Z();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var C=!0;break e;default:C=!1}var E;if(!(E=C)){var P;if(P=J===0){var V=String(g.D).match(YT)[1]||null;!V&&a.self&&a.self.location&&(V=a.self.location.protocol.slice(0,-1)),P=!y$.test(V?V.toLowerCase():"")}E=P}if(E)ht(g,"complete"),ht(g,"success");else{g.m=6;try{var j=2<ys(g)?g.g.statusText:""}catch{j=""}g.l=j+" ["+g.Z()+"]",o_(g)}}finally{gp(g)}}}}function gp(g,C){if(g.g){i_(g);const E=g.g,P=g.v[0]?()=>{}:null;g.g=null,g.v=null,C||ht(g,"ready");try{E.onreadystatechange=P}catch{}}}function i_(g){g.I&&(a.clearTimeout(g.I),g.I=null)}t.isActive=function(){return!!this.g};function ys(g){return g.g?g.g.readyState:0}t.Z=function(){try{return 2<ys(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(g){if(this.g){var C=this.g.responseText;return g&&C.indexOf(g)==0&&(C=C.substring(g.length)),sp(C)}};function a_(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.H){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function v$(g){const C={};g=(g.g&&2<=ys(g)&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<g.length;P++){if(k(g[P]))continue;var E=D(g[P]);const V=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const j=C[V]||[];C[V]=j,j.push(E)}T(C,function(P){return P.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Hu(g,C,E){return E&&E.internalChannelParams&&E.internalChannelParams[g]||C}function l_(g){this.Aa=0,this.i=[],this.j=new Hn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Hu("failFast",!1,g),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Hu("baseRetryDelayMs",5e3,g),this.cb=Hu("retryDelaySeedMs",1e4,g),this.Wa=Hu("forwardChannelMaxRetries",2,g),this.wa=Hu("forwardChannelRequestTimeoutMs",2e4,g),this.pa=g&&g.xmlHttpFactory||void 0,this.Xa=g&&g.Tb||void 0,this.Ca=g&&g.useFetchStreams||!1,this.L=void 0,this.J=g&&g.supportsCrossDomainXhr||!1,this.K="",this.h=new zT(g&&g.concurrentRequestLimit),this.Da=new m$,this.P=g&&g.fastHandshake||!1,this.O=g&&g.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=g&&g.Rb||!1,g&&g.xa&&this.j.xa(),g&&g.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&g&&g.detectBufferingProxy||!1,this.ja=void 0,g&&g.longPollingTimeout&&0<g.longPollingTimeout&&(this.ja=g.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=l_.prototype,t.la=8,t.G=1,t.connect=function(g,C,E,P){ze(0),this.W=g,this.H=C||{},E&&P!==void 0&&(this.H.OSID=E,this.H.OAID=P),this.F=this.X,this.I=y_(this,null,this.W),bp(this)};function O0(g){if(c_(g),g.G==3){var C=g.U++,E=gs(g.I);if(ft(E,"SID",g.K),ft(E,"RID",C),ft(E,"TYPE","terminate"),zu(g,E),C=new ui(g,g.j,C),C.L=2,C.v=fp(gs(E)),E=!1,a.navigator&&a.navigator.sendBeacon)try{E=a.navigator.sendBeacon(C.v.toString(),"")}catch{}!E&&a.Image&&(new Image().src=C.v,E=!0),E||(C.g=b_(C.j,null),C.g.ea(C.v)),C.F=Date.now(),up(C)}g_(g)}function yp(g){g.g&&(V0(g),g.g.cancel(),g.g=null)}function c_(g){yp(g),g.u&&(a.clearTimeout(g.u),g.u=null),vp(g),g.h.cancel(),g.s&&(typeof g.s=="number"&&a.clearTimeout(g.s),g.s=null)}function bp(g){if(!UT(g.h)&&!g.s){g.s=!0;var C=g.Ga;z||le(),W||(z(),W=!0),X.add(C,g),g.B=0}}function w$(g,C){return WT(g.h)>=g.h.j-(g.s?1:0)?!1:g.s?(g.i=C.D.concat(g.i),!0):g.G==1||g.G==2||g.B>=(g.Va?0:g.Wa)?!1:(g.s=_n(h(g.Ga,g,C),m_(g,g.B)),g.B++,!0)}t.Ga=function(g){if(this.s)if(this.s=null,this.G==1){if(!g){this.U=Math.floor(1e5*Math.random()),g=this.U++;const V=new ui(this,this.j,g);let j=this.o;if(this.S&&(j?(j=S(j),R(j,this.S)):j=this.S),this.m!==null||this.O||(V.H=j,j=null),this.P)e:{for(var C=0,E=0;E<this.i.length;E++){t:{var P=this.i[E];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(C+=P,4096<C){C=E;break e}if(C===4096||E===this.i.length-1){C=E+1;break e}}C=1e3}else C=1e3;C=d_(this,V,C),E=gs(this.I),ft(E,"RID",g),ft(E,"CVER",22),this.D&&ft(E,"X-HTTP-Session-Id",this.D),zu(this,E),j&&(this.O?C="headers="+encodeURIComponent(String(n_(j)))+"&"+C:this.m&&N0(E,this.m,j)),D0(this.h,V),this.Ua&&ft(E,"TYPE","init"),this.P?(ft(E,"$req",C),ft(E,"SID","null"),V.T=!0,I0(V,E,null)):I0(V,E,C),this.G=2}}else this.G==3&&(g?u_(this,g):this.i.length==0||UT(this.h)||u_(this))};function u_(g,C){var E;C?E=C.l:E=g.U++;const P=gs(g.I);ft(P,"SID",g.K),ft(P,"RID",E),ft(P,"AID",g.T),zu(g,P),g.m&&g.o&&N0(P,g.m,g.o),E=new ui(g,g.j,E,g.B+1),g.m===null&&(E.H=g.o),C&&(g.i=C.D.concat(g.i)),C=d_(g,E,1e3),E.I=Math.round(.5*g.wa)+Math.round(.5*g.wa*Math.random()),D0(g.h,E),I0(E,P,C)}function zu(g,C){g.H&&M(g.H,function(E,P){ft(C,P,E)}),g.l&&KT({},function(E,P){ft(C,P,E)})}function d_(g,C,E){E=Math.min(g.i.length,E);var P=g.l?h(g.l.Na,g.l,g):null;e:{var V=g.i;let j=-1;for(;;){const J=["count="+E];j==-1?0<E?(j=V[0].g,J.push("ofs="+j)):j=0:J.push("ofs="+j);let rt=!0;for(let an=0;an<E;an++){let qe=V[an].g;const An=V[an].map;if(qe-=j,0>qe)j=Math.max(0,V[an].g-100),rt=!1;else try{g$(An,J,"req"+qe+"_")}catch{P&&P(An)}}if(rt){P=J.join("&");break e}}}return g=g.i.splice(0,E),C.D=g,P}function h_(g){if(!g.g&&!g.u){g.Y=1;var C=g.Fa;z||le(),W||(z(),W=!0),X.add(C,g),g.v=0}}function L0(g){return g.g||g.u||3<=g.v?!1:(g.Y++,g.u=_n(h(g.Fa,g),m_(g,g.v)),g.v++,!0)}t.Fa=function(){if(this.u=null,f_(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var g=2*this.R;this.j.info("BP detection timer enabled: "+g),this.A=_n(h(this.ab,this),g)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ze(10),yp(this),f_(this))};function V0(g){g.A!=null&&(a.clearTimeout(g.A),g.A=null)}function f_(g){g.g=new ui(g,g.j,"rpc",g.Y),g.m===null&&(g.g.H=g.o),g.g.O=0;var C=gs(g.qa);ft(C,"RID","rpc"),ft(C,"SID",g.K),ft(C,"AID",g.T),ft(C,"CI",g.F?"0":"1"),!g.F&&g.ja&&ft(C,"TO",g.ja),ft(C,"TYPE","xmlhttp"),zu(g,C),g.m&&g.o&&N0(C,g.m,g.o),g.L&&(g.g.I=g.L);var E=g.g;g=g.ia,E.L=1,E.v=fp(gs(C)),E.m=null,E.P=!0,$T(E,g)}t.Za=function(){this.C!=null&&(this.C=null,yp(this),L0(this),ze(19))};function vp(g){g.C!=null&&(a.clearTimeout(g.C),g.C=null)}function p_(g,C){var E=null;if(g.g==C){vp(g),V0(g),g.g=null;var P=2}else if(P0(g.h,C))E=C.D,qT(g.h,C),P=1;else return;if(g.G!=0){if(C.o)if(P==1){E=C.m?C.m.length:0,C=Date.now()-C.F;var V=g.B;P=sn(),ht(P,new ro(P,E)),bp(g)}else h_(g);else if(V=C.s,V==3||V==0&&0<C.X||!(P==1&&w$(g,C)||P==2&&L0(g)))switch(E&&0<E.length&&(C=g.h,C.i=C.i.concat(E)),V){case 1:Na(g,5);break;case 4:Na(g,10);break;case 3:Na(g,6);break;default:Na(g,2)}}}function m_(g,C){let E=g.Ta+Math.floor(Math.random()*g.cb);return g.isActive()||(E*=2),E*C}function Na(g,C){if(g.j.info("Error code "+C),C==2){var E=h(g.fb,g),P=g.Xa;const V=!P;P=new Da(P||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||dp(P,"https"),fp(P),V?f$(P.toString(),E):p$(P.toString(),E)}else ze(2);g.G=0,g.l&&g.l.sa(C),g_(g),c_(g)}t.fb=function(g){g?(this.j.info("Successfully pinged google.com"),ze(2)):(this.j.info("Failed to ping google.com"),ze(1))};function g_(g){if(g.G=0,g.ka=[],g.l){const C=GT(g.h);(C.length!=0||g.i.length!=0)&&(b(g.ka,C),b(g.ka,g.i),g.h.i.length=0,y(g.i),g.i.length=0),g.l.ra()}}function y_(g,C,E){var P=E instanceof Da?gs(E):new Da(E);if(P.g!="")C&&(P.g=C+"."+P.g),hp(P,P.s);else{var V=a.location;P=V.protocol,C=C?C+"."+V.hostname:V.hostname,V=+V.port;var j=new Da(null);P&&dp(j,P),C&&(j.g=C),V&&hp(j,V),E&&(j.l=E),P=j}return E=g.D,C=g.ya,E&&C&&ft(P,E,C),ft(P,"VER",g.la),zu(g,P),P}function b_(g,C,E){if(C&&!g.J)throw Error("Can't create secondary domain capable XhrIo object.");return C=g.Ca&&!g.pa?new St(new pp({eb:E})):new St(g.pa),C.Ha(g.J),C}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function v_(){}t=v_.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function wp(){}wp.prototype.g=function(g,C){return new yr(g,C)};function yr(g,C){It.call(this),this.g=new l_(C),this.l=g,this.h=C&&C.messageUrlParams||null,g=C&&C.messageHeaders||null,C&&C.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=C&&C.initMessageHeaders||null,C&&C.messageContentType&&(g?g["X-WebChannel-Content-Type"]=C.messageContentType:g={"X-WebChannel-Content-Type":C.messageContentType}),C&&C.va&&(g?g["X-WebChannel-Client-Profile"]=C.va:g={"X-WebChannel-Client-Profile":C.va}),this.g.S=g,(g=C&&C.Sb)&&!k(g)&&(this.g.m=g),this.v=C&&C.supportsCrossDomainXhr||!1,this.u=C&&C.sendRawJson||!1,(C=C&&C.httpSessionIdParam)&&!k(C)&&(this.g.D=C,g=this.h,g!==null&&C in g&&(g=this.h,C in g&&delete g[C])),this.j=new zl(this)}p(yr,It),yr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yr.prototype.close=function(){O0(this.g)},yr.prototype.o=function(g){var C=this.g;if(typeof g=="string"){var E={};E.__data__=g,g=E}else this.u&&(E={},E.__data__=_a(g),g=E);C.i.push(new r$(C.Ya++,g)),C.G==3&&bp(C)},yr.prototype.N=function(){this.g.l=null,delete this.j,O0(this.g),delete this.g,yr.aa.N.call(this)};function w_(g){Vt.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var C=g.__sm__;if(C){e:{for(const E in C){g=E;break e}g=void 0}(this.i=g)&&(g=this.i,C=C!==null&&g in C?C[g]:void 0),this.data=C}else this.data=g}p(w_,Vt);function C_(){on.call(this),this.status=1}p(C_,on);function zl(g){this.g=g}p(zl,v_),zl.prototype.ua=function(){ht(this.g,"a")},zl.prototype.ta=function(g){ht(this.g,new w_(g))},zl.prototype.sa=function(g){ht(this.g,new C_)},zl.prototype.ra=function(){ht(this.g,"b")},wp.prototype.createWebChannel=wp.prototype.g,yr.prototype.send=yr.prototype.o,yr.prototype.open=yr.prototype.m,yr.prototype.close=yr.prototype.close,M6=function(){return new wp},I6=function(){return sn()},A6=Mt,XC={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},lp.NO_ERROR=0,lp.TIMEOUT=8,lp.HTTP_ERROR=6,jm=lp,VT.COMPLETE="complete",_6=VT,ap.EventType=Aa,Aa.OPEN="a",Aa.CLOSE="b",Aa.ERROR="c",Aa.MESSAGE="d",It.prototype.listen=It.prototype.K,xd=ap,St.prototype.listenOnce=St.prototype.L,St.prototype.getLastError=St.prototype.Ka,St.prototype.getLastErrorCode=St.prototype.Ba,St.prototype.getStatus=St.prototype.Z,St.prototype.getResponseJson=St.prototype.Oa,St.prototype.getResponseText=St.prototype.oa,St.prototype.send=St.prototype.ea,St.prototype.setWithCredentials=St.prototype.Ha,T6=St}).apply(typeof sm<"u"?sm:typeof self<"u"?self:typeof window<"u"?window:{});const KP="@firebase/firestore",YP="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Dn.UNAUTHENTICATED=new Dn(null),Dn.GOOGLE_CREDENTIALS=new Dn("google-credentials-uid"),Dn.FIRST_PARTY=new Dn("first-party-uid"),Dn.MOCK_USER=new Dn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mu="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ml=new v6("@firebase/firestore");function ic(){return Ml.logLevel}function Z(t,...e){if(Ml.logLevel<=Fe.DEBUG){const n=e.map(oT);Ml.debug(`Firestore (${Mu}): ${t}`,...n)}}function Ks(t,...e){if(Ml.logLevel<=Fe.ERROR){const n=e.map(oT);Ml.error(`Firestore (${Mu}): ${t}`,...n)}}function Kc(t,...e){if(Ml.logLevel<=Fe.WARN){const n=e.map(oT);Ml.warn(`Firestore (${Mu}): ${t}`,...n)}}function oT(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ye(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,R6(t,r,n)}function R6(t,e,n){let r=`FIRESTORE (${Mu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ks(r),new Error(r)}function Ye(t,e,n,r){let o="Unexpected state";typeof n=="string"?o=n:r=n,t||R6(e,o,r)}function Se(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends Iu{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class CTe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Dn.UNAUTHENTICATED))}shutdown(){}}class xTe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class kTe{constructor(e){this.t=e,this.currentUser=Dn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ye(this.o===void 0,42304);let r=this.i;const o=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Ki;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ki,e.enqueueRetryable(()=>o(this.currentUser))};const i=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await o(this.currentUser)})},a=l=>{Z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Z("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ki)}},0),i()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ye(typeof r.accessToken=="string",31837,{l:r}),new P6(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ye(e===null||typeof e=="string",2055,{h:e}),new Dn(e)}}class STe{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Dn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class ETe{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new STe(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Dn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class XP{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class TTe{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,iTe(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Ye(this.o===void 0,3512);const r=s=>{s.error!=null&&Z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const i=s.token!==this.m;return this.m=s.token,Z("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const o=s=>{Z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>o(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?o(s):Z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new XP(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ye(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new XP(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _Te(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D6(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const o=_Te(40);for(let s=0;s<o.length;++s)r.length<20&&o[s]<n&&(r+=e.charAt(o[s]%62))}return r}}function Me(t,e){return t<e?-1:t>e?1:0}function JC(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),o=e.codePointAt(n);if(r!==o){if(r<128&&o<128)return Me(r,o);{const s=D6(),i=ATe(s.encode(JP(t,n)),s.encode(JP(e,n)));return i!==0?i:Me(r,o)}}n+=r>65535?2:1}return Me(t.length,e.length)}function JP(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function ATe(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return Me(t[n],e[n]);return Me(t.length,e.length)}function Yc(t,e,n){return t.length===e.length&&t.every((r,o)=>n(r,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QP=-62135596800,ZP=1e6;class Kt{static now(){return Kt.fromMillis(Date.now())}static fromDate(e){return Kt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*ZP);return new Kt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new re(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new re(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<QP)throw new re(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ZP}_compareTo(e){return this.seconds===e.seconds?Me(this.nanoseconds,e.nanoseconds):Me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-QP;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{static fromTimestamp(e){return new ke(e)}static min(){return new ke(new Kt(0,0))}static max(){return new ke(new Kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eD="__name__";class Vo{constructor(e,n,r){n===void 0?n=0:n>e.length&&ye(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ye(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Vo.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Vo?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let o=0;o<r;o++){const s=Vo.compareSegments(e.get(o),n.get(o));if(s!==0)return s}return Me(e.length,n.length)}static compareSegments(e,n){const r=Vo.isNumericId(e),o=Vo.isNumericId(n);return r&&!o?-1:!r&&o?1:r&&o?Vo.extractNumericId(e).compare(Vo.extractNumericId(n)):JC(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Gi.fromString(e.substring(4,e.length-2))}}class mt extends Vo{construct(e,n,r){return new mt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new re(H.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(o=>o.length>0))}return new mt(n)}static emptyPath(){return new mt([])}}const ITe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mn extends Vo{construct(e,n,r){return new mn(e,n,r)}static isValidIdentifier(e){return ITe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===eD}static keyField(){return new mn([eD])}static fromServerFormat(e){const n=[];let r="",o=0;const s=()=>{if(r.length===0)throw new re(H.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let i=!1;for(;o<e.length;){const a=e[o];if(a==="\\"){if(o+1===e.length)throw new re(H.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[o+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new re(H.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,o+=2}else a==="`"?(i=!i,o++):a!=="."||i?(r+=a,o++):(s(),o++)}if(s(),i)throw new re(H.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mn(n)}static emptyPath(){return new mn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.path=e}static fromPath(e){return new he(mt.fromString(e))}static fromName(e){return new he(mt.fromString(e).popFirst(5))}static empty(){return new he(mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return mt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new he(new mt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const of=-1;function MTe(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,o=ke.fromTimestamp(r===1e9?new Kt(n+1,0):new Kt(n,r));return new la(o,he.empty(),e)}function RTe(t){return new la(t.readTime,t.key,of)}class la{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new la(ke.min(),he.empty(),of)}static max(){return new la(ke.max(),he.empty(),of)}}function PTe(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=he.comparator(t.documentKey,e.documentKey),n!==0?n:Me(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DTe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class NTe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ru(t){if(t.code!==H.FAILED_PRECONDITION||t.message!==DTe)throw t;Z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ye(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new F((r,o)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,o)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,o)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):F.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):F.reject(n)}static resolve(e){return new F((n,r)=>{n(e)})}static reject(e){return new F((n,r)=>{r(e)})}static waitFor(e){return new F((n,r)=>{let o=0,s=0,i=!1;e.forEach(a=>{++o,a.next(()=>{++s,i&&s===o&&n()},l=>r(l))}),i=!0,s===o&&n()})}static or(e){let n=F.resolve(!1);for(const r of e)n=n.next(o=>o?F.resolve(o):r());return n}static forEach(e,n){const r=[];return e.forEach((o,s)=>{r.push(n.call(this,o,s))}),this.waitFor(r)}static mapArray(e,n){return new F((r,o)=>{const s=e.length,i=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;n(e[c]).next(u=>{i[c]=u,++a,a===s&&r(i)},u=>o(u))}})}static doWhile(e,n){return new F((r,o)=>{const s=()=>{e()===!0?n().next(()=>{s()},o):r()};s()})}}function OTe(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Pu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>n.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}c0.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT=-1;function u0(t){return t==null}function Ey(t){return t===0&&1/t==-1/0}function LTe(t){return typeof t=="number"&&Number.isInteger(t)&&!Ey(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O6="";function VTe(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=tD(e)),e=jTe(t.get(n),e);return tD(e)}function jTe(t,e){let n=e;const r=t.length;for(let o=0;o<r;o++){const s=t.charAt(o);switch(s){case"\0":n+="";break;case O6:n+="";break;default:n+=s}}return n}function tD(t){return t+O6+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nD(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Sa(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function L6(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,n){this.comparator=e,this.root=n||fn.EMPTY}insert(e,n){return new kt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,fn.BLACK,null,null))}remove(e){return new kt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const o=this.comparator(e,r.key);if(o===0)return n+r.left.size;o<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new im(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new im(this.root,e,this.comparator,!1)}getReverseIterator(){return new im(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new im(this.root,e,this.comparator,!0)}}class im{constructor(e,n,r,o){this.isReverse=o,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&o&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class fn{constructor(e,n,r,o,s){this.key=e,this.value=n,this.color=r??fn.RED,this.left=o??fn.EMPTY,this.right=s??fn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,o,s){return new fn(e??this.key,n??this.value,r??this.color,o??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let o=this;const s=r(e,o.key);return o=s<0?o.copy(null,null,null,o.left.insert(e,n,r),null):s===0?o.copy(null,n,null,null,null):o.copy(null,null,null,null,o.right.insert(e,n,r)),o.fixUp()}removeMin(){if(this.left.isEmpty())return fn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,o=this;if(n(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,n),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),n(e,o.key)===0){if(o.right.isEmpty())return fn.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,n))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,fn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,fn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ye(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ye(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ye(27949);return e+(this.isRed()?0:1)}}fn.EMPTY=null,fn.RED=!0,fn.BLACK=!1;fn.EMPTY=new class{constructor(){this.size=0}get key(){throw ye(57766)}get value(){throw ye(16141)}get color(){throw ye(16727)}get left(){throw ye(29726)}get right(){throw ye(36894)}copy(e,n,r,o,s){return this}insert(e,n,r){return new fn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.comparator=e,this.data=new kt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const o=r.getNext();if(this.comparator(o.key,e[1])>=0)return;n(o.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new rD(this.data.getIterator())}getIteratorFrom(e){return new rD(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Yt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const o=n.getNext().key,s=r.getNext().key;if(this.comparator(o,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Yt(this.comparator);return n.data=e,n}}class rD{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.fields=e,e.sort(mn.comparator)}static empty(){return new Sr([])}unionWith(e){let n=new Yt(mn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Sr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Yc(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V6 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(o){try{return atob(o)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new V6("Invalid base64 string: "+s):s}}(e);return new Cn(n)}static fromUint8Array(e){const n=function(o){let s="";for(let i=0;i<o.length;++i)s+=String.fromCharCode(o[i]);return s}(e);return new Cn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let o=0;o<n.length;o++)r[o]=n.charCodeAt(o);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Cn.EMPTY_BYTE_STRING=new Cn("");const BTe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ca(t){if(Ye(!!t,39018),typeof t=="string"){let e=0;const n=BTe.exec(t);if(Ye(!!n,46558,{timestamp:t}),n[1]){let o=n[1];o=(o+"000000000").substr(0,9),e=Number(o)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Pt(t.seconds),nanos:Pt(t.nanos)}}function Pt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ua(t){return typeof t=="string"?Cn.fromBase64String(t):Cn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j6="server_timestamp",B6="__type__",$6="__previous_value__",F6="__local_write_time__";function iT(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[B6])===null||n===void 0?void 0:n.stringValue)===j6}function d0(t){const e=t.mapValue.fields[$6];return iT(e)?d0(e):e}function sf(t){const e=ca(t.mapValue.fields[F6].timestampValue);return new Kt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $Te{constructor(e,n,r,o,s,i,a,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=o,this.ssl=s,this.forceLongPolling=i,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const QC="(default)";class af{constructor(e,n){this.projectId=e,this.database=n||QC}static empty(){return new af("","")}get isDefaultDatabase(){return this.database===QC}isEqual(e){return e instanceof af&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H6="__type__",FTe="__max__",am={mapValue:{}},z6="__vector__",Ty="value";function da(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?iT(t)?4:zTe(t)?9007199254740991:HTe(t)?10:11:ye(28295,{value:t})}function ss(t,e){if(t===e)return!0;const n=da(t);if(n!==da(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return sf(t).isEqual(sf(e));case 3:return function(o,s){if(typeof o.timestampValue=="string"&&typeof s.timestampValue=="string"&&o.timestampValue.length===s.timestampValue.length)return o.timestampValue===s.timestampValue;const i=ca(o.timestampValue),a=ca(s.timestampValue);return i.seconds===a.seconds&&i.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(o,s){return ua(o.bytesValue).isEqual(ua(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(o,s){return Pt(o.geoPointValue.latitude)===Pt(s.geoPointValue.latitude)&&Pt(o.geoPointValue.longitude)===Pt(s.geoPointValue.longitude)}(t,e);case 2:return function(o,s){if("integerValue"in o&&"integerValue"in s)return Pt(o.integerValue)===Pt(s.integerValue);if("doubleValue"in o&&"doubleValue"in s){const i=Pt(o.doubleValue),a=Pt(s.doubleValue);return i===a?Ey(i)===Ey(a):isNaN(i)&&isNaN(a)}return!1}(t,e);case 9:return Yc(t.arrayValue.values||[],e.arrayValue.values||[],ss);case 10:case 11:return function(o,s){const i=o.mapValue.fields||{},a=s.mapValue.fields||{};if(nD(i)!==nD(a))return!1;for(const l in i)if(i.hasOwnProperty(l)&&(a[l]===void 0||!ss(i[l],a[l])))return!1;return!0}(t,e);default:return ye(52216,{left:t})}}function lf(t,e){return(t.values||[]).find(n=>ss(n,e))!==void 0}function Xc(t,e){if(t===e)return 0;const n=da(t),r=da(e);if(n!==r)return Me(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Me(t.booleanValue,e.booleanValue);case 2:return function(s,i){const a=Pt(s.integerValue||s.doubleValue),l=Pt(i.integerValue||i.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return oD(t.timestampValue,e.timestampValue);case 4:return oD(sf(t),sf(e));case 5:return JC(t.stringValue,e.stringValue);case 6:return function(s,i){const a=ua(s),l=ua(i);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,i){const a=s.split("/"),l=i.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=Me(a[c],l[c]);if(u!==0)return u}return Me(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,i){const a=Me(Pt(s.latitude),Pt(i.latitude));return a!==0?a:Me(Pt(s.longitude),Pt(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return sD(t.arrayValue,e.arrayValue);case 10:return function(s,i){var a,l,c,u;const d=s.fields||{},h=i.fields||{},f=(a=d[Ty])===null||a===void 0?void 0:a.arrayValue,p=(l=h[Ty])===null||l===void 0?void 0:l.arrayValue,y=Me(((c=f==null?void 0:f.values)===null||c===void 0?void 0:c.length)||0,((u=p==null?void 0:p.values)===null||u===void 0?void 0:u.length)||0);return y!==0?y:sD(f,p)}(t.mapValue,e.mapValue);case 11:return function(s,i){if(s===am.mapValue&&i===am.mapValue)return 0;if(s===am.mapValue)return 1;if(i===am.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=i.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let d=0;d<l.length&&d<u.length;++d){const h=JC(l[d],u[d]);if(h!==0)return h;const f=Xc(a[l[d]],c[u[d]]);if(f!==0)return f}return Me(l.length,u.length)}(t.mapValue,e.mapValue);default:throw ye(23264,{Pe:n})}}function oD(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Me(t,e);const n=ca(t),r=ca(e),o=Me(n.seconds,r.seconds);return o!==0?o:Me(n.nanos,r.nanos)}function sD(t,e){const n=t.values||[],r=e.values||[];for(let o=0;o<n.length&&o<r.length;++o){const s=Xc(n[o],r[o]);if(s)return s}return Me(n.length,r.length)}function Jc(t){return ZC(t)}function ZC(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ca(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ua(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return he.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",o=!0;for(const s of n.values||[])o?o=!1:r+=",",r+=ZC(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let o="{",s=!0;for(const i of r)s?s=!1:o+=",",o+=`${i}:${ZC(n.fields[i])}`;return o+"}"}(t.mapValue):ye(61005,{value:t})}function Bm(t){switch(da(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=d0(t);return e?16+Bm(e):16;case 5:return 2*t.stringValue.length;case 6:return ua(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((o,s)=>o+Bm(s),0)}(t.arrayValue);case 10:case 11:return function(r){let o=0;return Sa(r.fields,(s,i)=>{o+=s.length+Bm(i)}),o}(t.mapValue);default:throw ye(13486,{value:t})}}function iD(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ex(t){return!!t&&"integerValue"in t}function aT(t){return!!t&&"arrayValue"in t}function aD(t){return!!t&&"nullValue"in t}function lD(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $m(t){return!!t&&"mapValue"in t}function HTe(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[H6])===null||n===void 0?void 0:n.stringValue)===z6}function eh(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Sa(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=eh(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=eh(t.arrayValue.values[n]);return e}return Object.assign({},t)}function zTe(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===FTe}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e){this.value=e}static empty(){return new ur({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!$m(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=eh(n)}setAll(e){let n=mn.emptyPath(),r={},o=[];e.forEach((i,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,o),r={},o=[],n=a.popLast()}i?r[a.lastSegment()]=eh(i):o.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,o)}delete(e){const n=this.field(e.popLast());$m(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ss(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let o=n.mapValue.fields[e.get(r)];$m(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=o),n=o}return n.mapValue.fields}applyChanges(e,n,r){Sa(n,(o,s)=>e[o]=s);for(const o of r)delete e[o]}clone(){return new ur(eh(this.value))}}function U6(t){const e=[];return Sa(t.fields,(n,r)=>{const o=new mn([n]);if($m(r)){const s=U6(r.mapValue).fields;if(s.length===0)e.push(o);else for(const i of s)e.push(o.child(i))}else e.push(o)}),new Sr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,n,r,o,s,i,a){this.key=e,this.documentType=n,this.version=r,this.readTime=o,this.createTime=s,this.data=i,this.documentState=a}static newInvalidDocument(e){return new Nn(e,0,ke.min(),ke.min(),ke.min(),ur.empty(),0)}static newFoundDocument(e,n,r,o){return new Nn(e,1,n,ke.min(),r,o,0)}static newNoDocument(e,n){return new Nn(e,2,n,ke.min(),ke.min(),ur.empty(),0)}static newUnknownDocument(e,n){return new Nn(e,3,n,ke.min(),ke.min(),ur.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ke.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ur.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ur.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ke.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Nn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Nn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(e,n){this.position=e,this.inclusive=n}}function cD(t,e,n){let r=0;for(let o=0;o<t.position.length;o++){const s=e[o],i=t.position[o];if(s.field.isKeyField()?r=he.comparator(he.fromName(i.referenceValue),n.key):r=Xc(i,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function uD(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ss(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(e,n="asc"){this.field=e,this.dir=n}}function UTe(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W6{}class $t extends W6{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new qTe(e,n,r):n==="array-contains"?new YTe(e,r):n==="in"?new XTe(e,r):n==="not-in"?new JTe(e,r):n==="array-contains-any"?new QTe(e,r):new $t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new GTe(e,r):new KTe(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Xc(n,this.value)):n!==null&&da(this.value)===da(n)&&this.matchesComparison(Xc(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ye(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _o extends W6{constructor(e,n){super(),this.filters=e,this.op=n,this.Te=null}static create(e,n){return new _o(e,n)}matches(e){return q6(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function q6(t){return t.op==="and"}function G6(t){return WTe(t)&&q6(t)}function WTe(t){for(const e of t.filters)if(e instanceof _o)return!1;return!0}function tx(t){if(t instanceof $t)return t.field.canonicalString()+t.op.toString()+Jc(t.value);if(G6(t))return t.filters.map(e=>tx(e)).join(",");{const e=t.filters.map(n=>tx(n)).join(",");return`${t.op}(${e})`}}function K6(t,e){return t instanceof $t?function(r,o){return o instanceof $t&&r.op===o.op&&r.field.isEqual(o.field)&&ss(r.value,o.value)}(t,e):t instanceof _o?function(r,o){return o instanceof _o&&r.op===o.op&&r.filters.length===o.filters.length?r.filters.reduce((s,i,a)=>s&&K6(i,o.filters[a]),!0):!1}(t,e):void ye(19439)}function Y6(t){return t instanceof $t?function(n){return`${n.field.canonicalString()} ${n.op} ${Jc(n.value)}`}(t):t instanceof _o?function(n){return n.op.toString()+" {"+n.getFilters().map(Y6).join(" ,")+"}"}(t):"Filter"}class qTe extends $t{constructor(e,n,r){super(e,n,r),this.key=he.fromName(r.referenceValue)}matches(e){const n=he.comparator(e.key,this.key);return this.matchesComparison(n)}}class GTe extends $t{constructor(e,n){super(e,"in",n),this.keys=X6("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class KTe extends $t{constructor(e,n){super(e,"not-in",n),this.keys=X6("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function X6(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>he.fromName(r.referenceValue))}class YTe extends $t{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return aT(n)&&lf(n.arrayValue,this.value)}}class XTe extends $t{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&lf(this.value.arrayValue,n)}}class JTe extends $t{constructor(e,n){super(e,"not-in",n)}matches(e){if(lf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!lf(this.value.arrayValue,n)}}class QTe extends $t{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!aT(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>lf(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZTe{constructor(e,n=null,r=[],o=[],s=null,i=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=o,this.limit=s,this.startAt=i,this.endAt=a,this.Ie=null}}function dD(t,e=null,n=[],r=[],o=null,s=null,i=null){return new ZTe(t,e,n,r,o,s,i)}function lT(t){const e=Se(t);if(e.Ie===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>tx(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),u0(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Jc(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Jc(r)).join(",")),e.Ie=n}return e.Ie}function cT(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!UTe(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!K6(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!uD(t.startAt,e.startAt)&&uD(t.endAt,e.endAt)}function nx(t){return he.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(e,n=null,r=[],o=[],s=null,i="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=o,this.limit=s,this.limitType=i,this.startAt=a,this.endAt=l,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function e_e(t,e,n,r,o,s,i,a){return new Jf(t,e,n,r,o,s,i,a)}function J6(t){return new Jf(t)}function hD(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Q6(t){return t.collectionGroup!==null}function th(t){const e=Se(t);if(e.Ee===null){e.Ee=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ee.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(i){let a=new Yt(mn.comparator);return i.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ee.push(new Ay(s,r))}),n.has(mn.keyField().canonicalString())||e.Ee.push(new Ay(mn.keyField(),r))}return e.Ee}function Go(t){const e=Se(t);return e.de||(e.de=t_e(e,th(t))),e.de}function t_e(t,e){if(t.limitType==="F")return dD(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(o=>{const s=o.dir==="desc"?"asc":"desc";return new Ay(o.field,s)});const n=t.endAt?new _y(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new _y(t.startAt.position,t.startAt.inclusive):null;return dD(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function rx(t,e){const n=t.filters.concat([e]);return new Jf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function ox(t,e,n){return new Jf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function h0(t,e){return cT(Go(t),Go(e))&&t.limitType===e.limitType}function Z6(t){return`${lT(Go(t))}|lt:${t.limitType}`}function ac(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(o=>Y6(o)).join(", ")}]`),u0(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(o=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(o)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(o=>Jc(o)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(o=>Jc(o)).join(",")),`Target(${r})`}(Go(t))}; limitType=${t.limitType})`}function f0(t,e){return e.isFoundDocument()&&function(r,o){const s=o.key.path;return r.collectionGroup!==null?o.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):he.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,o){for(const s of th(r))if(!s.field.isKeyField()&&o.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,o){for(const s of r.filters)if(!s.matches(o))return!1;return!0}(t,e)&&function(r,o){return!(r.startAt&&!function(i,a,l){const c=cD(i,a,l);return i.inclusive?c<=0:c<0}(r.startAt,th(r),o)||r.endAt&&!function(i,a,l){const c=cD(i,a,l);return i.inclusive?c>=0:c>0}(r.endAt,th(r),o))}(t,e)}function n_e(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function e7(t){return(e,n)=>{let r=!1;for(const o of th(t)){const s=r_e(o,e,n);if(s!==0)return s;r=r||o.field.isKeyField()}return 0}}function r_e(t,e,n){const r=t.field.isKeyField()?he.comparator(e.key,n.key):function(s,i,a){const l=i.data.field(s),c=a.data.field(s);return l!==null&&c!==null?Xc(l,c):ye(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ye(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[o,s]of r)if(this.equalsFn(o,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),o=this.inner[r];if(o===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<o.length;s++)if(this.equalsFn(o[s][0],e))return void(o[s]=[e,n]);o.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return r.length===1?delete this.inner[n]:r.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Sa(this.inner,(n,r)=>{for(const[o,s]of r)e(o,s)})}isEmpty(){return L6(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o_e=new kt(he.comparator);function Ys(){return o_e}const t7=new kt(he.comparator);function kd(...t){let e=t7;for(const n of t)e=e.insert(n.key,n);return e}function n7(t){let e=t7;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function rl(){return nh()}function r7(){return nh()}function nh(){return new Bl(t=>t.toString(),(t,e)=>t.isEqual(e))}const s_e=new kt(he.comparator),i_e=new Yt(he.comparator);function Le(...t){let e=i_e;for(const n of t)e=e.add(n);return e}const a_e=new Yt(Me);function l_e(){return a_e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uT(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ey(e)?"-0":e}}function o7(t){return{integerValue:""+t}}function c_e(t,e){return LTe(e)?o7(e):uT(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(){this._=void 0}}function u_e(t,e,n){return t instanceof Iy?function(o,s){const i={fields:{[B6]:{stringValue:j6},[F6]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return s&&iT(s)&&(s=d0(s)),s&&(i.fields[$6]=s),{mapValue:i}}(n,e):t instanceof cf?i7(t,e):t instanceof uf?a7(t,e):function(o,s){const i=s7(o,s),a=fD(i)+fD(o.Re);return ex(i)&&ex(o.Re)?o7(a):uT(o.serializer,a)}(t,e)}function d_e(t,e,n){return t instanceof cf?i7(t,e):t instanceof uf?a7(t,e):n}function s7(t,e){return t instanceof My?function(r){return ex(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Iy extends p0{}class cf extends p0{constructor(e){super(),this.elements=e}}function i7(t,e){const n=l7(e);for(const r of t.elements)n.some(o=>ss(o,r))||n.push(r);return{arrayValue:{values:n}}}class uf extends p0{constructor(e){super(),this.elements=e}}function a7(t,e){let n=l7(e);for(const r of t.elements)n=n.filter(o=>!ss(o,r));return{arrayValue:{values:n}}}class My extends p0{constructor(e,n){super(),this.serializer=e,this.Re=n}}function fD(t){return Pt(t.integerValue||t.doubleValue)}function l7(t){return aT(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function h_e(t,e){return t.field.isEqual(e.field)&&function(r,o){return r instanceof cf&&o instanceof cf||r instanceof uf&&o instanceof uf?Yc(r.elements,o.elements,ss):r instanceof My&&o instanceof My?ss(r.Re,o.Re):r instanceof Iy&&o instanceof Iy}(t.transform,e.transform)}class f_e{constructor(e,n){this.version=e,this.transformResults=n}}class Ko{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ko}static exists(e){return new Ko(void 0,e)}static updateTime(e){return new Ko(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Fm(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class m0{}function c7(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new d7(t.key,Ko.none()):new Qf(t.key,t.data,Ko.none());{const n=t.data,r=ur.empty();let o=new Yt(mn.comparator);for(let s of e.fields)if(!o.has(s)){let i=n.field(s);i===null&&s.length>1&&(s=s.popLast(),i=n.field(s)),i===null?r.delete(s):r.set(s,i),o=o.add(s)}return new Ea(t.key,r,new Sr(o.toArray()),Ko.none())}}function p_e(t,e,n){t instanceof Qf?function(o,s,i){const a=o.value.clone(),l=mD(o.fieldTransforms,s,i.transformResults);a.setAll(l),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Ea?function(o,s,i){if(!Fm(o.precondition,s))return void s.convertToUnknownDocument(i.version);const a=mD(o.fieldTransforms,s,i.transformResults),l=s.data;l.setAll(u7(o)),l.setAll(a),s.convertToFoundDocument(i.version,l).setHasCommittedMutations()}(t,e,n):function(o,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function rh(t,e,n,r){return t instanceof Qf?function(s,i,a,l){if(!Fm(s.precondition,i))return a;const c=s.value.clone(),u=gD(s.fieldTransforms,l,i);return c.setAll(u),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ea?function(s,i,a,l){if(!Fm(s.precondition,i))return a;const c=gD(s.fieldTransforms,l,i),u=i.data;return u.setAll(u7(s)),u.setAll(c),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,i,a){return Fm(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a}(t,e,n)}function m_e(t,e){let n=null;for(const r of t.fieldTransforms){const o=e.data.field(r.field),s=s7(r.transform,o||null);s!=null&&(n===null&&(n=ur.empty()),n.set(r.field,s))}return n||null}function pD(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,o){return r===void 0&&o===void 0||!(!r||!o)&&Yc(r,o,(s,i)=>h_e(s,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Qf extends m0{constructor(e,n,r,o=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Ea extends m0{constructor(e,n,r,o,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=o,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function u7(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function mD(t,e,n){const r=new Map;Ye(t.length===n.length,32656,{Ve:n.length,me:t.length});for(let o=0;o<n.length;o++){const s=t[o],i=s.transform,a=e.data.field(s.field);r.set(s.field,d_e(i,a,n[o]))}return r}function gD(t,e,n){const r=new Map;for(const o of t){const s=o.transform,i=n.data.field(o.field);r.set(o.field,u_e(s,i,e))}return r}class d7 extends m0{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class g_e extends m0{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_e{constructor(e,n,r,o){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=o}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let o=0;o<this.mutations.length;o++){const s=this.mutations[o];s.key.isEqual(e.key)&&p_e(s,e,r[o])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=rh(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=rh(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=r7();return this.mutations.forEach(o=>{const s=e.get(o.key),i=s.overlayedDocument;let a=this.applyToLocalView(i,s.mutatedFields);a=n.has(o.key)?null:a;const l=c7(i,a);l!==null&&r.set(o.key,l),i.isValidDocument()||i.convertToNoDocument(ke.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Le())}isEqual(e){return this.batchId===e.batchId&&Yc(this.mutations,e.mutations,(n,r)=>pD(n,r))&&Yc(this.baseMutations,e.baseMutations,(n,r)=>pD(n,r))}}class dT{constructor(e,n,r,o){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=o}static from(e,n,r){Ye(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let o=function(){return s_e}();const s=e.mutations;for(let i=0;i<s.length;i++)o=o.insert(s[i].key,r[i].version);return new dT(e,n,r,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_e{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_e{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jt,$e;function w_e(t){switch(t){case H.OK:return ye(64938);case H.CANCELLED:case H.UNKNOWN:case H.DEADLINE_EXCEEDED:case H.RESOURCE_EXHAUSTED:case H.INTERNAL:case H.UNAVAILABLE:case H.UNAUTHENTICATED:return!1;case H.INVALID_ARGUMENT:case H.NOT_FOUND:case H.ALREADY_EXISTS:case H.PERMISSION_DENIED:case H.FAILED_PRECONDITION:case H.ABORTED:case H.OUT_OF_RANGE:case H.UNIMPLEMENTED:case H.DATA_LOSS:return!0;default:return ye(15467,{code:t})}}function h7(t){if(t===void 0)return Ks("GRPC error has no .code"),H.UNKNOWN;switch(t){case jt.OK:return H.OK;case jt.CANCELLED:return H.CANCELLED;case jt.UNKNOWN:return H.UNKNOWN;case jt.DEADLINE_EXCEEDED:return H.DEADLINE_EXCEEDED;case jt.RESOURCE_EXHAUSTED:return H.RESOURCE_EXHAUSTED;case jt.INTERNAL:return H.INTERNAL;case jt.UNAVAILABLE:return H.UNAVAILABLE;case jt.UNAUTHENTICATED:return H.UNAUTHENTICATED;case jt.INVALID_ARGUMENT:return H.INVALID_ARGUMENT;case jt.NOT_FOUND:return H.NOT_FOUND;case jt.ALREADY_EXISTS:return H.ALREADY_EXISTS;case jt.PERMISSION_DENIED:return H.PERMISSION_DENIED;case jt.FAILED_PRECONDITION:return H.FAILED_PRECONDITION;case jt.ABORTED:return H.ABORTED;case jt.OUT_OF_RANGE:return H.OUT_OF_RANGE;case jt.UNIMPLEMENTED:return H.UNIMPLEMENTED;case jt.DATA_LOSS:return H.DATA_LOSS;default:return ye(39323,{code:t})}}($e=jt||(jt={}))[$e.OK=0]="OK",$e[$e.CANCELLED=1]="CANCELLED",$e[$e.UNKNOWN=2]="UNKNOWN",$e[$e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$e[$e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$e[$e.NOT_FOUND=5]="NOT_FOUND",$e[$e.ALREADY_EXISTS=6]="ALREADY_EXISTS",$e[$e.PERMISSION_DENIED=7]="PERMISSION_DENIED",$e[$e.UNAUTHENTICATED=16]="UNAUTHENTICATED",$e[$e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$e[$e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$e[$e.ABORTED=10]="ABORTED",$e[$e.OUT_OF_RANGE=11]="OUT_OF_RANGE",$e[$e.UNIMPLEMENTED=12]="UNIMPLEMENTED",$e[$e.INTERNAL=13]="INTERNAL",$e[$e.UNAVAILABLE=14]="UNAVAILABLE",$e[$e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_e=new Gi([4294967295,4294967295],0);function yD(t){const e=D6().encode(t),n=new E6;return n.update(e),new Uint8Array(n.digest())}function bD(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),o=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Gi([n,r],0),new Gi([o,s],0)]}class hT{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Sd(`Invalid padding: ${n}`);if(r<0)throw new Sd(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Sd(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Sd(`Invalid padding when bitmap length is 0: ${n}`);this.pe=8*e.length-n,this.ye=Gi.fromNumber(this.pe)}we(e,n,r){let o=e.add(n.multiply(Gi.fromNumber(r)));return o.compare(C_e)===1&&(o=new Gi([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const n=yD(e),[r,o]=bD(n);for(let s=0;s<this.hashCount;s++){const i=this.we(r,o,s);if(!this.be(i))return!1}return!0}static create(e,n,r){const o=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),i=new hT(s,o,n);return r.forEach(a=>i.insert(a)),i}insert(e){if(this.pe===0)return;const n=yD(e),[r,o]=bD(n);for(let s=0;s<this.hashCount;s++){const i=this.we(r,o,s);this.Se(i)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Sd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{constructor(e,n,r,o,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=o,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const o=new Map;return o.set(e,Zf.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new g0(ke.min(),o,new kt(Me),Ys(),Le())}}class Zf{constructor(e,n,r,o,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=o,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Zf(r,n,Le(),Le(),Le())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(e,n,r,o){this.De=e,this.removedTargetIds=n,this.key=r,this.ve=o}}class f7{constructor(e,n){this.targetId=e,this.Ce=n}}class p7{constructor(e,n,r=Cn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=o}}class vD{constructor(){this.Fe=0,this.Me=wD(),this.xe=Cn.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Le(),n=Le(),r=Le();return this.Me.forEach((o,s)=>{switch(s){case 0:e=e.add(o);break;case 2:n=n.add(o);break;case 1:r=r.add(o);break;default:ye(38017,{changeType:s})}}),new Zf(this.xe,this.Oe,e,n,r)}Qe(){this.Ne=!1,this.Me=wD()}$e(e,n){this.Ne=!0,this.Me=this.Me.insert(e,n)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Ye(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class x_e{constructor(e){this.ze=e,this.je=new Map,this.He=Ys(),this.Je=lm(),this.Ye=lm(),this.Ze=new kt(Me)}Xe(e){for(const n of e.De)e.ve&&e.ve.isFoundDocument()?this.et(n,e.ve):this.tt(n,e.key,e.ve);for(const n of e.removedTargetIds)this.tt(n,e.key,e.ve)}nt(e){this.forEachTarget(e,n=>{const r=this.rt(n);switch(e.state){case 0:this.it(n)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(n);break;case 3:this.it(n)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(n)&&(this.st(n),r.ke(e.resumeToken));break;default:ye(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.je.forEach((r,o)=>{this.it(o)&&n(o)})}ot(e){const n=e.targetId,r=e.Ce.count,o=this._t(n);if(o){const s=o.target;if(nx(s))if(r===0){const i=new he(s.path);this.tt(n,i,Nn.newNoDocument(i,ke.min()))}else Ye(r===1,20013,{expectedCount:r});else{const i=this.ut(n);if(i!==r){const a=this.ct(e),l=a?this.lt(a,e,i):1;if(l!==0){this.st(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,c)}}}}}ct(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:o=0},hashCount:s=0}=n;let i,a;try{i=ua(r).toUint8Array()}catch(l){if(l instanceof V6)return Kc("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new hT(i,o,s)}catch(l){return Kc(l instanceof Sd?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.pe===0?null:a}lt(e,n,r){return n.Ce.count===r-this.Tt(e,n.targetId)?0:2}Tt(e,n){const r=this.ze.getRemoteKeysForTarget(n);let o=0;return r.forEach(s=>{const i=this.ze.Pt(),a=`projects/${i.projectId}/databases/${i.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.tt(n,s,null),o++)}),o}It(e){const n=new Map;this.je.forEach((s,i)=>{const a=this._t(i);if(a){if(s.current&&nx(a.target)){const l=new he(a.target.path);this.Et(l).has(i)||this.dt(i,l)||this.tt(i,l,Nn.newNoDocument(l,e))}s.Le&&(n.set(i,s.qe()),s.Qe())}});let r=Le();this.Ye.forEach((s,i)=>{let a=!0;i.forEachWhile(l=>{const c=this._t(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.He.forEach((s,i)=>i.setReadTime(e));const o=new g0(e,n,this.Ze,this.He,r);return this.He=Ys(),this.Je=lm(),this.Ye=lm(),this.Ze=new kt(Me),o}et(e,n){if(!this.it(e))return;const r=this.dt(e,n.key)?2:0;this.rt(e).$e(n.key,r),this.He=this.He.insert(n.key,n),this.Je=this.Je.insert(n.key,this.Et(n.key).add(e)),this.Ye=this.Ye.insert(n.key,this.At(n.key).add(e))}tt(e,n,r){if(!this.it(e))return;const o=this.rt(e);this.dt(e,n)?o.$e(n,1):o.Ue(n),this.Ye=this.Ye.insert(n,this.At(n).delete(e)),this.Ye=this.Ye.insert(n,this.At(n).add(e)),r&&(this.He=this.He.insert(n,r))}removeTarget(e){this.je.delete(e)}ut(e){const n=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let n=this.je.get(e);return n||(n=new vD,this.je.set(e,n)),n}At(e){let n=this.Ye.get(e);return n||(n=new Yt(Me),this.Ye=this.Ye.insert(e,n)),n}Et(e){let n=this.Je.get(e);return n||(n=new Yt(Me),this.Je=this.Je.insert(e,n)),n}it(e){const n=this._t(e)!==null;return n||Z("WatchChangeAggregator","Detected inactive target",e),n}_t(e){const n=this.je.get(e);return n&&n.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new vD),this.ze.getRemoteKeysForTarget(e).forEach(n=>{this.tt(e,n,null)})}dt(e,n){return this.ze.getRemoteKeysForTarget(e).has(n)}}function lm(){return new kt(he.comparator)}function wD(){return new kt(he.comparator)}const k_e={asc:"ASCENDING",desc:"DESCENDING"},S_e={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},E_e={and:"AND",or:"OR"};class T_e{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function sx(t,e){return t.useProto3Json||u0(e)?e:{value:e}}function Ry(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function m7(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function __e(t,e){return Ry(t,e.toTimestamp())}function Yo(t){return Ye(!!t,49232),ke.fromTimestamp(function(n){const r=ca(n);return new Kt(r.seconds,r.nanos)}(t))}function fT(t,e){return ix(t,e).canonicalString()}function ix(t,e){const n=function(o){return new mt(["projects",o.projectId,"databases",o.database])}(t).child("documents");return e===void 0?n:n.child(e)}function g7(t){const e=mt.fromString(t);return Ye(C7(e),10190,{key:e.toString()}),e}function ax(t,e){return fT(t.databaseId,e.path)}function V1(t,e){const n=g7(e);if(n.get(1)!==t.databaseId.projectId)throw new re(H.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new re(H.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new he(b7(n))}function y7(t,e){return fT(t.databaseId,e)}function A_e(t){const e=g7(t);return e.length===4?mt.emptyPath():b7(e)}function lx(t){return new mt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function b7(t){return Ye(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function CD(t,e,n){return{name:ax(t,e),fields:n.value.mapValue.fields}}function I_e(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ye(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],s=function(c,u){return c.useProto3Json?(Ye(u===void 0||typeof u=="string",58123),Cn.fromBase64String(u||"")):(Ye(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Cn.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),i=e.targetChange.cause,a=i&&function(c){const u=c.code===void 0?H.UNKNOWN:h7(c.code);return new re(u,c.message||"")}(i);n=new p7(r,o,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const o=V1(t,r.document.name),s=Yo(r.document.updateTime),i=r.document.createTime?Yo(r.document.createTime):ke.min(),a=new ur({mapValue:{fields:r.document.fields}}),l=Nn.newFoundDocument(o,s,i,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Hm(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const o=V1(t,r.document),s=r.readTime?Yo(r.readTime):ke.min(),i=Nn.newNoDocument(o,s),a=r.removedTargetIds||[];n=new Hm([],a,i.key,i)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const o=V1(t,r.document),s=r.removedTargetIds||[];n=new Hm([],s,o,null)}else{if(!("filter"in e))return ye(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:o=0,unchangedNames:s}=r,i=new v_e(o,s),a=r.targetId;n=new f7(a,i)}}return n}function M_e(t,e){let n;if(e instanceof Qf)n={update:CD(t,e.key,e.value)};else if(e instanceof d7)n={delete:ax(t,e.key)};else if(e instanceof Ea)n={update:CD(t,e.key,e.data),updateMask:B_e(e.fieldMask)};else{if(!(e instanceof g_e))return ye(16599,{ft:e.type});n={verify:ax(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const a=i.transform;if(a instanceof Iy)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof cf)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof uf)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof My)return{fieldPath:i.field.canonicalString(),increment:a.Re};throw ye(20930,{transform:i.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(o,s){return s.updateTime!==void 0?{updateTime:__e(o,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ye(27497)}(t,e.precondition)),n}function R_e(t,e){return t&&t.length>0?(Ye(e!==void 0,14353),t.map(n=>function(o,s){let i=o.updateTime?Yo(o.updateTime):Yo(s);return i.isEqual(ke.min())&&(i=Yo(s)),new f_e(i,o.transformResults||[])}(n,e))):[]}function P_e(t,e){return{documents:[y7(t,e.path)]}}function D_e(t,e){const n={structuredQuery:{}},r=e.path;let o;e.collectionGroup!==null?(o=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=y7(t,o);const s=function(c){if(c.length!==0)return w7(_o.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const i=function(c){if(c.length!==0)return c.map(u=>function(h){return{field:lc(h.field),direction:L_e(h.dir)}}(u))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const a=sx(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{gt:n,parent:o}}function N_e(t){let e=A_e(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let o=null;if(r>0){Ye(r===1,65062);const u=n.from[0];u.allDescendants?o=u.collectionId:e=e.child(u.collectionId)}let s=[];n.where&&(s=function(d){const h=v7(d);return h instanceof _o&&G6(h)?h.getFilters():[h]}(n.where));let i=[];n.orderBy&&(i=function(d){return d.map(h=>function(p){return new Ay(cc(p.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,u0(h)?null:h}(n.limit));let l=null;n.startAt&&(l=function(d){const h=!!d.before,f=d.values||[];return new _y(f,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){const h=!d.before,f=d.values||[];return new _y(f,h)}(n.endAt)),e_e(e,o,i,s,a,"F",l,c)}function O_e(t,e){const n=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ye(28987,{purpose:o})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function v7(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=cc(n.unaryFilter.field);return $t.create(r,"==",{doubleValue:NaN});case"IS_NULL":const o=cc(n.unaryFilter.field);return $t.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=cc(n.unaryFilter.field);return $t.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=cc(n.unaryFilter.field);return $t.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ye(61313);default:return ye(60726)}}(t):t.fieldFilter!==void 0?function(n){return $t.create(cc(n.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ye(58110);default:return ye(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return _o.create(n.compositeFilter.filters.map(r=>v7(r)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return ye(1026)}}(n.compositeFilter.op))}(t):ye(30097,{filter:t})}function L_e(t){return k_e[t]}function V_e(t){return S_e[t]}function j_e(t){return E_e[t]}function lc(t){return{fieldPath:t.canonicalString()}}function cc(t){return mn.fromServerFormat(t.fieldPath)}function w7(t){return t instanceof $t?function(n){if(n.op==="=="){if(lD(n.value))return{unaryFilter:{field:lc(n.field),op:"IS_NAN"}};if(aD(n.value))return{unaryFilter:{field:lc(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(lD(n.value))return{unaryFilter:{field:lc(n.field),op:"IS_NOT_NAN"}};if(aD(n.value))return{unaryFilter:{field:lc(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lc(n.field),op:V_e(n.op),value:n.value}}}(t):t instanceof _o?function(n){const r=n.getFilters().map(o=>w7(o));return r.length===1?r[0]:{compositeFilter:{op:j_e(n.op),filters:r}}}(t):ye(54877,{filter:t})}function B_e(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function C7(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e,n,r,o,s=ke.min(),i=ke.min(),a=Cn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=o,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new $i(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new $i(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new $i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new $i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_e{constructor(e){this.wt=e}}function F_e(t){const e=N_e({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ox(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_e{constructor(){this.Cn=new z_e}addToCollectionParentIndex(e,n){return this.Cn.add(n),F.resolve()}getCollectionParents(e,n){return F.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return F.resolve()}deleteFieldIndex(e,n){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,n){return F.resolve()}getDocumentsMatchingTarget(e,n){return F.resolve(null)}getIndexType(e,n){return F.resolve(0)}getFieldIndexes(e,n){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,n){return F.resolve(la.min())}getMinOffsetFromCollectionGroup(e,n){return F.resolve(la.min())}updateCollectionGroup(e,n,r){return F.resolve()}updateIndexEntries(e,n){return F.resolve()}}class z_e{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),o=this.index[n]||new Yt(mt.comparator),s=!o.has(r);return this.index[n]=o.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),o=this.index[n];return o&&o.has(r)}getEntries(e){return(this.index[e]||new Yt(mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xD={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},x7=41943040;class ir{static withCacheSize(e){return new ir(e,ir.DEFAULT_COLLECTION_PERCENTILE,ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ir.DEFAULT_COLLECTION_PERCENTILE=10,ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ir.DEFAULT=new ir(x7,ir.DEFAULT_COLLECTION_PERCENTILE,ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ir.DISABLED=new ir(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Qc(0)}static lr(){return new Qc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kD="LruGarbageCollector",U_e=1048576;function SD([t,e],[n,r]){const o=Me(t,n);return o===0?Me(e,r):o}class W_e{constructor(e){this.Er=e,this.buffer=new Yt(SD),this.dr=0}Ar(){return++this.dr}Rr(e){const n=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();SD(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class q_e{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Z(kD,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Pu(n)?Z(kD,"Ignoring IndexedDB error during garbage collection: ",n):await Ru(n)}await this.mr(3e5)})}}class G_e{constructor(e,n){this.gr=e,this.params=n}calculateTargetCount(e,n){return this.gr.pr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return F.resolve(c0.le);const r=new W_e(n);return this.gr.forEachTarget(e,o=>r.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>r.Rr(o))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.gr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.gr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Z("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(xD)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),xD):this.wr(e,n))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,n){let r,o,s,i,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(Z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),o=this.params.maximumSequenceNumbersToCollect):o=d,i=Date.now(),this.nthSequenceNumber(e,o))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),ic()<=Fe.DEBUG&&Z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${i-u}ms
	Determined least recently used ${o} in `+(a-i)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:s,documentsRemoved:d})))}}function K_e(t,e){return new G_e(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_e{constructor(){this.changes=new Bl(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Nn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?F.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_e{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_e{constructor(e,n,r,o){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=o}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(o=>(r=o,this.remoteDocumentCache.getEntry(e,n))).next(o=>(r!==null&&rh(r.mutation,o,Sr.empty(),Kt.now()),o))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Le()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Le()){const o=rl();return this.populateOverlays(e,o,n).next(()=>this.computeViews(e,n,o,r).next(s=>{let i=kd();return s.forEach((a,l)=>{i=i.insert(a,l.overlayedDocument)}),i}))}getOverlayedDocuments(e,n){const r=rl();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Le()))}populateOverlays(e,n,r){const o=[];return r.forEach(s=>{n.has(s)||o.push(s)}),this.documentOverlayCache.getOverlays(e,o).next(s=>{s.forEach((i,a)=>{n.set(i,a)})})}computeViews(e,n,r,o){let s=Ys();const i=nh(),a=function(){return nh()}();return n.forEach((l,c)=>{const u=r.get(c.key);o.has(c.key)&&(u===void 0||u.mutation instanceof Ea)?s=s.insert(c.key,c):u!==void 0?(i.set(c.key,u.mutation.getFieldMask()),rh(u.mutation,c,u.mutation.getFieldMask(),Kt.now())):i.set(c.key,Sr.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,u)=>i.set(c,u)),n.forEach((c,u)=>{var d;return a.set(c,new X_e(u,(d=i.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){const r=nh();let o=new kt((i,a)=>i-a),s=Le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(i=>{for(const a of i)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||Sr.empty();u=a.applyToLocalView(c,u),r.set(l,u);const d=(o.get(a.batchId)||Le()).add(l);o=o.insert(a.batchId,d)})}).next(()=>{const i=[],a=o.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,d=r7();u.forEach(h=>{if(!s.has(h)){const f=c7(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),i.push(this.documentOverlayCache.saveOverlays(e,c,d))}return F.waitFor(i)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,o){return function(i){return he.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Q6(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,o):this.getDocumentsMatchingCollectionQuery(e,n,r,o)}getNextDocuments(e,n,r,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,o).next(s=>{const i=o-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,o-s.size):F.resolve(rl());let a=of,l=s;return i.next(c=>F.forEach(c,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(u)?F.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{l=l.insert(u,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Le())).next(u=>({batchId:a,changes:n7(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new he(n)).next(r=>{let o=kd();return r.isFoundDocument()&&(o=o.insert(r.key,r)),o})}getDocumentsMatchingCollectionGroupQuery(e,n,r,o){const s=n.collectionGroup;let i=kd();return this.indexManager.getCollectionParents(e,s).next(a=>F.forEach(a,l=>{const c=function(d,h){return new Jf(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,o).next(u=>{u.forEach((d,h)=>{i=i.insert(d,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,r,o){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,o))).next(i=>{s.forEach((l,c)=>{const u=c.getKey();i.get(u)===null&&(i=i.insert(u,Nn.newInvalidDocument(u)))});let a=kd();return i.forEach((l,c)=>{const u=s.get(l);u!==void 0&&rh(u.mutation,c,Sr.empty(),Kt.now()),f0(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_e{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,n){return F.resolve(this.kr.get(n))}saveBundleMetadata(e,n){return this.kr.set(n.id,function(o){return{id:o.id,version:o.version,createTime:Yo(o.createTime)}}(n)),F.resolve()}getNamedQuery(e,n){return F.resolve(this.qr.get(n))}saveNamedQuery(e,n){return this.qr.set(n.name,function(o){return{name:o.name,query:F_e(o.bundledQuery),readTime:Yo(o.readTime)}}(n)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_e{constructor(){this.overlays=new kt(he.comparator),this.Qr=new Map}getOverlay(e,n){return F.resolve(this.overlays.get(n))}getOverlays(e,n){const r=rl();return F.forEach(n,o=>this.getOverlay(e,o).next(s=>{s!==null&&r.set(o,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((o,s)=>{this.St(e,n,s)}),F.resolve()}removeOverlaysForBatchId(e,n,r){const o=this.Qr.get(r);return o!==void 0&&(o.forEach(s=>this.overlays=this.overlays.remove(s)),this.Qr.delete(r)),F.resolve()}getOverlaysForCollection(e,n,r){const o=rl(),s=n.length+1,i=new he(n.child("")),a=this.overlays.getIteratorFrom(i);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&o.set(l.getKey(),l)}return F.resolve(o)}getOverlaysForCollectionGroup(e,n,r,o){let s=new kt((c,u)=>c-u);const i=this.overlays.getIterator();for(;i.hasNext();){const c=i.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=s.get(c.largestBatchId);u===null&&(u=rl(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=rl(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=o)););return F.resolve(a)}St(e,n,r){const o=this.overlays.get(r.key);if(o!==null){const i=this.Qr.get(o.largestBatchId).delete(r.key);this.Qr.set(o.largestBatchId,i)}this.overlays=this.overlays.insert(r.key,new b_e(n,r));let s=this.Qr.get(n);s===void 0&&(s=Le(),this.Qr.set(n,s)),this.Qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2e{constructor(){this.sessionToken=Cn.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pT{constructor(){this.$r=new Yt(Qt.Ur),this.Kr=new Yt(Qt.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,n){const r=new Qt(e,n);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.zr(new Qt(e,n))}jr(e,n){e.forEach(r=>this.removeReference(r,n))}Hr(e){const n=new he(new mt([])),r=new Qt(n,e),o=new Qt(n,e+1),s=[];return this.Kr.forEachInRange([r,o],i=>{this.zr(i),s.push(i.key)}),s}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const n=new he(new mt([])),r=new Qt(n,e),o=new Qt(n,e+1);let s=Le();return this.Kr.forEachInRange([r,o],i=>{s=s.add(i.key)}),s}containsKey(e){const n=new Qt(e,0),r=this.$r.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Qt{constructor(e,n){this.key=e,this.Zr=n}static Ur(e,n){return he.comparator(e.key,n.key)||Me(e.Zr,n.Zr)}static Wr(e,n){return Me(e.Zr,n.Zr)||he.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2e{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.nr=1,this.Xr=new Yt(Qt.Ur)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,o){const s=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new y_e(s,n,r,o);this.mutationQueue.push(i);for(const a of o)this.Xr=this.Xr.add(new Qt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return F.resolve(i)}lookupMutationBatch(e,n){return F.resolve(this.ei(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,o=this.ti(r),s=o<0?0:o;return F.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?sT:this.nr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Qt(n,0),o=new Qt(n,Number.POSITIVE_INFINITY),s=[];return this.Xr.forEachInRange([r,o],i=>{const a=this.ei(i.Zr);s.push(a)}),F.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Yt(Me);return n.forEach(o=>{const s=new Qt(o,0),i=new Qt(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([s,i],a=>{r=r.add(a.Zr)})}),F.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,o=r.length+1;let s=r;he.isDocumentKey(s)||(s=s.child(""));const i=new Qt(new he(s),0);let a=new Yt(Me);return this.Xr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===o&&(a=a.add(l.Zr)),!0)},i),F.resolve(this.ni(a))}ni(e){const n=[];return e.forEach(r=>{const o=this.ei(r);o!==null&&n.push(o)}),n}removeMutationBatch(e,n){Ye(this.ri(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return F.forEach(n.mutations,o=>{const s=new Qt(o.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,n){const r=new Qt(n,0),o=this.Xr.firstAfterOrEqual(r);return F.resolve(n.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}ri(e,n){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const n=this.ti(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2e{constructor(e){this.ii=e,this.docs=function(){return new kt(he.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,o=this.docs.get(r),s=o?o.size:0,i=this.ii(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:i}),this.size+=i-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return F.resolve(r?r.document.mutableCopy():Nn.newInvalidDocument(n))}getEntries(e,n){let r=Ys();return n.forEach(o=>{const s=this.docs.get(o);r=r.insert(o,s?s.document.mutableCopy():Nn.newInvalidDocument(o))}),F.resolve(r)}getDocumentsMatchingQuery(e,n,r,o){let s=Ys();const i=n.path,a=new he(i.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||PTe(RTe(u),r)<=0||(o.has(u.key)||f0(n,u))&&(s=s.insert(u.key,u.mutableCopy()))}return F.resolve(s)}getAllFromCollectionGroup(e,n,r,o){ye(9500)}si(e,n){return F.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new r2e(this)}getSize(e){return F.resolve(this.size)}}class r2e extends Y_e{constructor(e){super(),this.Br=e}applyChanges(e){const n=[];return this.changes.forEach((r,o)=>{o.isValidDocument()?n.push(this.Br.addEntry(e,o)):this.Br.removeEntry(r)}),F.waitFor(n)}getFromCache(e,n){return this.Br.getEntry(e,n)}getAllFromCache(e,n){return this.Br.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2e{constructor(e){this.persistence=e,this.oi=new Bl(n=>lT(n),cT),this.lastRemoteSnapshotVersion=ke.min(),this.highestTargetId=0,this._i=0,this.ai=new pT,this.targetCount=0,this.ui=Qc.cr()}forEachTarget(e,n){return this.oi.forEach((r,o)=>n(o)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this._i&&(this._i=n),F.resolve()}Tr(e){this.oi.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ui=new Qc(n),this.highestTargetId=n),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,n){return this.Tr(n),this.targetCount+=1,F.resolve()}updateTargetData(e,n){return this.Tr(n),F.resolve()}removeTargetData(e,n){return this.oi.delete(n.target),this.ai.Hr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,n,r){let o=0;const s=[];return this.oi.forEach((i,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.oi.delete(i),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),o++)}),F.waitFor(s).next(()=>o)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,n){const r=this.oi.get(n)||null;return F.resolve(r)}addMatchingKeys(e,n,r){return this.ai.Gr(n,r),F.resolve()}removeMatchingKeys(e,n,r){this.ai.jr(n,r);const o=this.persistence.referenceDelegate,s=[];return o&&n.forEach(i=>{s.push(o.markPotentiallyOrphaned(e,i))}),F.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.ai.Hr(n),F.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ai.Yr(n);return F.resolve(r)}containsKey(e,n){return F.resolve(this.ai.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k7{constructor(e,n){this.ci={},this.overlays={},this.li=new c0(0),this.hi=!1,this.hi=!0,this.Pi=new e2e,this.referenceDelegate=e(this),this.Ti=new o2e(this),this.indexManager=new H_e,this.remoteDocumentCache=function(o){return new n2e(o)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new $_e(n),this.Ei=new Q_e(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Z_e,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ci[e.toKey()];return r||(r=new t2e(n,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,n,r){Z("MemoryPersistence","Starting transaction:",e);const o=new s2e(this.li.next());return this.referenceDelegate.di(),r(o).next(s=>this.referenceDelegate.Ai(o).next(()=>s)).toPromise().then(s=>(o.raiseOnCommittedEvent(),s))}Ri(e,n){return F.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,n)))}}class s2e extends NTe{constructor(e){super(),this.currentSequenceNumber=e}}class mT{constructor(e){this.persistence=e,this.Vi=new pT,this.mi=null}static fi(e){return new mT(e)}get gi(){if(this.mi)return this.mi;throw ye(60996)}addReference(e,n,r){return this.Vi.addReference(r,n),this.gi.delete(r.toString()),F.resolve()}removeReference(e,n,r){return this.Vi.removeReference(r,n),this.gi.add(r.toString()),F.resolve()}markPotentiallyOrphaned(e,n){return this.gi.add(n.toString()),F.resolve()}removeTarget(e,n){this.Vi.Hr(n.targetId).forEach(o=>this.gi.add(o.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(o=>{o.forEach(s=>this.gi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}di(){this.mi=new Set}Ai(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.gi,r=>{const o=he.fromPath(r);return this.pi(e,o).next(s=>{s||n.removeEntry(o,ke.min())})}).next(()=>(this.mi=null,n.apply(e)))}updateLimboDocument(e,n){return this.pi(e,n).next(r=>{r?this.gi.delete(n.toString()):this.gi.add(n.toString())})}Ii(e){return 0}pi(e,n){return F.or([()=>F.resolve(this.Vi.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ri(e,n)])}}class Py{constructor(e,n){this.persistence=e,this.yi=new Bl(r=>VTe(r.path),(r,o)=>r.isEqual(o)),this.garbageCollector=K_e(this,n)}static fi(e,n){return new Py(e,n)}di(){}Ai(e){return F.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}pr(e){const n=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(o=>r+o))}br(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}yr(e,n){return F.forEach(this.yi,(r,o)=>this.Dr(e,r,o).next(s=>s?F.resolve():n(o)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const o=this.persistence.getRemoteDocumentCache(),s=o.newChangeBuffer();return o.si(e,i=>this.Dr(e,i,n).next(a=>{a||(r++,s.removeEntry(i,ke.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.yi.set(n,e.currentSequenceNumber),F.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),F.resolve()}removeReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),F.resolve()}updateLimboDocument(e,n){return this.yi.set(n,e.currentSequenceNumber),F.resolve()}Ii(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Bm(e.data.value)),n}Dr(e,n,r){return F.or([()=>this.persistence.Ri(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const o=this.yi.get(n);return F.resolve(o!==void 0&&o>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(e,n,r,o){this.targetId=e,this.fromCache=n,this.ds=r,this.As=o}static Rs(e,n){let r=Le(),o=Le();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:o=o.add(s.doc.key)}return new gT(e,n.fromCache,r,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2e{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a2e{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return rEe()?8:OTe(tEe())>0?6:4}()}initialize(e,n){this.ys=e,this.indexManager=n,this.Vs=!0}getDocumentsMatchingQuery(e,n,r,o){const s={result:null};return this.ws(e,n).next(i=>{s.result=i}).next(()=>{if(!s.result)return this.bs(e,n,o,r).next(i=>{s.result=i})}).next(()=>{if(s.result)return;const i=new i2e;return this.Ss(e,n,i).next(a=>{if(s.result=a,this.fs)return this.Ds(e,n,i,a.size)})}).next(()=>s.result)}Ds(e,n,r,o){return r.documentReadCount<this.gs?(ic()<=Fe.DEBUG&&Z("QueryEngine","SDK will not create cache indexes for query:",ac(n),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),F.resolve()):(ic()<=Fe.DEBUG&&Z("QueryEngine","Query:",ac(n),"scans",r.documentReadCount,"local documents and returns",o,"documents as results."),r.documentReadCount>this.ps*o?(ic()<=Fe.DEBUG&&Z("QueryEngine","The SDK decides to create cache indexes for query:",ac(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Go(n))):F.resolve())}ws(e,n){if(hD(n))return F.resolve(null);let r=Go(n);return this.indexManager.getIndexType(e,r).next(o=>o===0?null:(n.limit!==null&&o===1&&(n=ox(n,null,"F"),r=Go(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const i=Le(...s);return this.ys.getDocuments(e,i).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.vs(n,a);return this.Cs(n,c,i,l.readTime)?this.ws(e,ox(n,null,"F")):this.Fs(e,c,n,l)}))})))}bs(e,n,r,o){return hD(n)||o.isEqual(ke.min())?F.resolve(null):this.ys.getDocuments(e,r).next(s=>{const i=this.vs(n,s);return this.Cs(n,i,r,o)?F.resolve(null):(ic()<=Fe.DEBUG&&Z("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),ac(n)),this.Fs(e,i,n,MTe(o,of)).next(a=>a))})}vs(e,n){let r=new Yt(e7(e));return n.forEach((o,s)=>{f0(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,o){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(o)>0)}Ss(e,n,r){return ic()<=Fe.DEBUG&&Z("QueryEngine","Using full collection scan to execute query:",ac(n)),this.ys.getDocumentsMatchingQuery(e,n,la.min(),r)}Fs(e,n,r,o){return this.ys.getDocumentsMatchingQuery(e,r,o).next(s=>(n.forEach(i=>{s=s.insert(i.key,i)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yT="LocalStore",l2e=3e8;class c2e{constructor(e,n,r,o){this.persistence=e,this.Ms=n,this.serializer=o,this.xs=new kt(Me),this.Os=new Bl(s=>lT(s),cT),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new J_e(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.xs))}}function u2e(t,e,n,r){return new c2e(t,e,n,r)}async function S7(t,e){const n=Se(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let o;return n.mutationQueue.getAllMutationBatches(r).next(s=>(o=s,n.Ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const i=[],a=[];let l=Le();for(const c of o){i.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next(c=>({ks:c,removedBatchIds:i,addedBatchIds:a}))})})}function d2e(t,e){const n=Se(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const o=e.batch.keys(),s=n.Bs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const d=c.batch,h=d.keys();let f=F.resolve();return h.forEach(p=>{f=f.next(()=>u.getEntry(l,p)).next(y=>{const b=c.docVersions.get(p);Ye(b!==null,48541),y.version.compareTo(b)<0&&(d.applyToRemoteDocument(y,c),y.isValidDocument()&&(y.setReadTime(c.commitVersion),u.addEntry(y)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,o,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Le();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,o))})}function E7(t){const e=Se(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ti.getLastRemoteSnapshotVersion(n))}function h2e(t,e){const n=Se(t),r=e.snapshotVersion;let o=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const i=n.Bs.newChangeBuffer({trackRemovals:!0});o=n.xs;const a=[];e.targetChanges.forEach((u,d)=>{const h=o.get(d);if(!h)return;a.push(n.Ti.removeMatchingKeys(s,u.removedDocuments,d).next(()=>n.Ti.addMatchingKeys(s,u.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(Cn.EMPTY_BYTE_STRING,ke.min()).withLastLimboFreeSnapshotVersion(ke.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),o=o.insert(d,f),function(y,b,w){return y.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=l2e?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(h,f,u)&&a.push(n.Ti.updateTargetData(s,f))});let l=Ys(),c=Le();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(f2e(s,i,e.documentUpdates).next(u=>{l=u.qs,c=u.Qs})),!r.isEqual(ke.min())){const u=n.Ti.getLastRemoteSnapshotVersion(s).next(d=>n.Ti.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return F.waitFor(a).next(()=>i.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.xs=o,s))}function f2e(t,e,n){let r=Le(),o=Le();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let i=Ys();return n.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(o=o.add(a)),l.isNoDocument()&&l.version.isEqual(ke.min())?(e.removeEntry(a,l.readTime),i=i.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),i=i.insert(a,l)):Z(yT,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{qs:i,Qs:o}})}function p2e(t,e){const n=Se(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=sT),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function m2e(t,e){const n=Se(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let o;return n.Ti.getTargetData(r,e).next(s=>s?(o=s,F.resolve(o)):n.Ti.allocateTargetId(r).next(i=>(o=new $i(e,i,"TargetPurposeListen",r.currentSequenceNumber),n.Ti.addTargetData(r,o).next(()=>o))))}).then(r=>{const o=n.xs.get(r.targetId);return(o===null||r.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(n.xs=n.xs.insert(r.targetId,r),n.Os.set(e,r.targetId)),r})}async function cx(t,e,n){const r=Se(t),o=r.xs.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,i=>r.persistence.referenceDelegate.removeTarget(i,o))}catch(i){if(!Pu(i))throw i;Z(yT,`Failed to update sequence numbers for target ${e}: ${i}`)}r.xs=r.xs.remove(e),r.Os.delete(o.target)}function ED(t,e,n){const r=Se(t);let o=ke.min(),s=Le();return r.persistence.runTransaction("Execute query","readwrite",i=>function(l,c,u){const d=Se(l),h=d.Os.get(u);return h!==void 0?F.resolve(d.xs.get(h)):d.Ti.getTargetData(c,u)}(r,i,Go(e)).next(a=>{if(a)return o=a.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(i,a.targetId).next(l=>{s=l})}).next(()=>r.Ms.getDocumentsMatchingQuery(i,e,n?o:ke.min(),n?s:Le())).next(a=>(g2e(r,n_e(e),a),{documents:a,$s:s})))}function g2e(t,e,n){let r=t.Ns.get(e)||ke.min();n.forEach((o,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Ns.set(e,r)}class TD{constructor(){this.activeTargetIds=l_e()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class y2e{constructor(){this.xo=new TD,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,n,r){this.Oo[e]=n}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new TD,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2e{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _D="ConnectivityMonitor";class AD{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Z(_D,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Z(_D,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cm=null;function ux(){return cm===null?cm=function(){return 268435456+Math.round(2147483648*Math.random())}():cm++,"0x"+cm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1="RestConnection",v2e={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class w2e{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=n+"://"+e.host,this.Wo=`projects/${r}/databases/${o}`,this.Go=this.databaseId.database===QC?`project_id=${r}`:`project_id=${r}&database_id=${o}`}zo(e,n,r,o,s){const i=ux(),a=this.jo(e,n.toUriEncodedString());Z(j1,`Sending RPC '${e}' ${i}:`,a,r);const l={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(l,o,s);const{host:c}=new URL(a),u=nT(c);return this.Jo(e,a,l,r,u).then(d=>(Z(j1,`Received RPC '${e}' ${i}: `,d),d),d=>{throw Kc(j1,`RPC '${e}' ${i} failed with error: `,d,"url: ",a,"request:",r),d})}Yo(e,n,r,o,s,i){return this.zo(e,n,r,o,s)}Ho(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Mu}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((o,s)=>e[s]=o),r&&r.headers.forEach((o,s)=>e[s]=o)}jo(e,n){const r=v2e[e];return`${this.Ko}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2e{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mn="WebChannelConnection";class x2e extends w2e{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,o,s){const i=ux();return new Promise((a,l)=>{const c=new T6;c.setWithCredentials(!0),c.listenOnce(_6.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case jm.NO_ERROR:const d=c.getResponseJson();Z(Mn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),a(d);break;case jm.TIMEOUT:Z(Mn,`RPC '${e}' ${i} timed out`),l(new re(H.DEADLINE_EXCEEDED,"Request time out"));break;case jm.HTTP_ERROR:const h=c.getStatus();if(Z(Mn,`RPC '${e}' ${i} failed with status:`,h,"response text:",c.getResponseText()),h>0){let f=c.getResponseJson();Array.isArray(f)&&(f=f[0]);const p=f==null?void 0:f.error;if(p&&p.status&&p.message){const y=function(w){const k=w.toLowerCase().replace(/_/g,"-");return Object.values(H).indexOf(k)>=0?k:H.UNKNOWN}(p.status);l(new re(y,p.message))}else l(new re(H.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new re(H.UNAVAILABLE,"Connection failed."));break;default:ye(9055,{h_:e,streamId:i,P_:c.getLastErrorCode(),T_:c.getLastError()})}}finally{Z(Mn,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(o);Z(Mn,`RPC '${e}' ${i} sending request:`,o),c.send(n,"POST",u,r,15)})}I_(e,n,r){const o=ux(),s=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=M6(),a=I6(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Ho(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const u=s.join("");Z(Mn,`Creating RPC '${e}' stream ${o}: ${u}`,l);const d=i.createWebChannel(u,l);this.E_(d);let h=!1,f=!1;const p=new C2e({Zo:b=>{f?Z(Mn,`Not sending because RPC '${e}' stream ${o} is closed:`,b):(h||(Z(Mn,`Opening RPC '${e}' stream ${o} transport.`),d.open(),h=!0),Z(Mn,`RPC '${e}' stream ${o} sending:`,b),d.send(b))},Xo:()=>d.close()}),y=(b,w,k)=>{b.listen(w,x=>{try{k(x)}catch(A){setTimeout(()=>{throw A},0)}})};return y(d,xd.EventType.OPEN,()=>{f||(Z(Mn,`RPC '${e}' stream ${o} transport opened.`),p.__())}),y(d,xd.EventType.CLOSE,()=>{f||(f=!0,Z(Mn,`RPC '${e}' stream ${o} transport closed`),p.u_(),this.d_(d))}),y(d,xd.EventType.ERROR,b=>{f||(f=!0,Kc(Mn,`RPC '${e}' stream ${o} transport errored. Name:`,b.name,"Message:",b.message),p.u_(new re(H.UNAVAILABLE,"The operation could not be completed")))}),y(d,xd.EventType.MESSAGE,b=>{var w;if(!f){const k=b.data[0];Ye(!!k,16349);const x=k,A=(x==null?void 0:x.error)||((w=x[0])===null||w===void 0?void 0:w.error);if(A){Z(Mn,`RPC '${e}' stream ${o} received error:`,A);const I=A.status;let M=function(_){const R=jt[_];if(R!==void 0)return h7(R)}(I),T=A.message;M===void 0&&(M=H.INTERNAL,T="Unknown error status: "+I+" with message "+A.message),f=!0,p.u_(new re(M,T)),d.close()}else Z(Mn,`RPC '${e}' stream ${o} received:`,k),p.c_(k)}}),y(a,A6.STAT_EVENT,b=>{b.stat===XC.PROXY?Z(Mn,`RPC '${e}' stream ${o} detected buffering proxy`):b.stat===XC.NOPROXY&&Z(Mn,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{p.a_()},0),p}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(n=>n===e)}}function B1(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0(t){return new T_e(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T7{constructor(e,n,r=1e3,o=1.5,s=6e4){this.xi=e,this.timerId=n,this.A_=r,this.R_=o,this.V_=s,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const n=Math.floor(this.m_+this.w_()),r=Math.max(0,Date.now()-this.g_),o=Math.max(0,n-r);o>0&&Z("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ID="PersistentStream";class _7{constructor(e,n,r,o,s,i,a,l){this.xi=e,this.S_=r,this.D_=o,this.connection=s,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new T7(e,n)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,n){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():n&&n.code===H.RESOURCE_EXHAUSTED?(Ks(n.toString()),Ks("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):n&&n.code===H.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(n)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),n=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,o])=>{this.v_===n&&this.z_(r,o)},r=>{e(()=>{const o=new re(H.UNKNOWN,"Fetching auth token failed: "+r.message);return this.j_(o)})})}z_(e,n){const r=this.G_(this.v_);this.stream=this.H_(e,n),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{r(()=>this.j_(o))}),this.stream.onMessage(o=>{r(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return Z(ID,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return n=>{this.xi.enqueueAndForget(()=>this.v_===e?n():(Z(ID,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class k2e extends _7{constructor(e,n,r,o,s,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,o,i),this.serializer=s}H_(e,n){return this.connection.I_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const n=I_e(this.serializer,e),r=function(s){if(!("targetChange"in s))return ke.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?ke.min():i.readTime?Yo(i.readTime):ke.min()}(e);return this.listener.Y_(n,r)}Z_(e){const n={};n.database=lx(this.serializer),n.addTarget=function(s,i){let a;const l=i.target;if(a=nx(l)?{documents:P_e(s,l)}:{query:D_e(s,l).gt},a.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){a.resumeToken=m7(s,i.resumeToken);const c=sx(s,i.expectedCount);c!==null&&(a.expectedCount=c)}else if(i.snapshotVersion.compareTo(ke.min())>0){a.readTime=Ry(s,i.snapshotVersion.toTimestamp());const c=sx(s,i.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=O_e(this.serializer,e);r&&(n.labels=r),this.Q_(n)}X_(e){const n={};n.database=lx(this.serializer),n.removeTarget=e,this.Q_(n)}}class S2e extends _7{constructor(e,n,r,o,s,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,o,i),this.serializer=s}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,n){return this.connection.I_("Write",e,n)}J_(e){return Ye(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ye(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Ye(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const n=R_e(e.writeResults,e.commitTime),r=Yo(e.commitTime);return this.listener.ra(r,n)}ia(){const e={};e.database=lx(this.serializer),this.Q_(e)}ta(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>M_e(this.serializer,r))};this.Q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2e{}class T2e extends E2e{constructor(e,n,r,o){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new re(H.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,n,r,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.zo(e,ix(n,r),o,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re(H.UNKNOWN,s.toString())})}Yo(e,n,r,o,s){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Yo(e,ix(n,r),o,i,a,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new re(H.UNKNOWN,i.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class _2e{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Ks(n),this.ua=!1):Z("OnlineStateTracker",n)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rl="RemoteStore";class A2e{constructor(e,n,r,o,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=s,this.Ra.No(i=>{r.enqueueAndForget(async()=>{$l(this)&&(Z(Rl,"Restarting streams for network reachability change."),await async function(l){const c=Se(l);c.da.add(4),await ep(c),c.Va.set("Unknown"),c.da.delete(4),await b0(c)}(this))})}),this.Va=new _2e(r,o)}}async function b0(t){if($l(t))for(const e of t.Aa)await e(!0)}async function ep(t){for(const e of t.Aa)await e(!1)}function A7(t,e){const n=Se(t);n.Ea.has(e.targetId)||(n.Ea.set(e.targetId,e),CT(n)?wT(n):Du(n).N_()&&vT(n,e))}function bT(t,e){const n=Se(t),r=Du(n);n.Ea.delete(e),r.N_()&&I7(n,e),n.Ea.size===0&&(r.N_()?r.k_():$l(n)&&n.Va.set("Unknown"))}function vT(t,e){if(t.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ke.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Du(t).Z_(e)}function I7(t,e){t.ma.Ke(e),Du(t).X_(e)}function wT(t){t.ma=new x_e({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Ea.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),Du(t).start(),t.Va.ca()}function CT(t){return $l(t)&&!Du(t).O_()&&t.Ea.size>0}function $l(t){return Se(t).da.size===0}function M7(t){t.ma=void 0}async function I2e(t){t.Va.set("Online")}async function M2e(t){t.Ea.forEach((e,n)=>{vT(t,e)})}async function R2e(t,e){M7(t),CT(t)?(t.Va.Pa(e),wT(t)):t.Va.set("Unknown")}async function P2e(t,e,n){if(t.Va.set("Online"),e instanceof p7&&e.state===2&&e.cause)try{await async function(o,s){const i=s.cause;for(const a of s.targetIds)o.Ea.has(a)&&(await o.remoteSyncer.rejectListen(a,i),o.Ea.delete(a),o.ma.removeTarget(a))}(t,e)}catch(r){Z(Rl,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Dy(t,r)}else if(e instanceof Hm?t.ma.Xe(e):e instanceof f7?t.ma.ot(e):t.ma.nt(e),!n.isEqual(ke.min()))try{const r=await E7(t.localStore);n.compareTo(r)>=0&&await function(s,i){const a=s.ma.It(i);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=s.Ea.get(c);u&&s.Ea.set(c,u.withResumeToken(l.resumeToken,i))}}),a.targetMismatches.forEach((l,c)=>{const u=s.Ea.get(l);if(!u)return;s.Ea.set(l,u.withResumeToken(Cn.EMPTY_BYTE_STRING,u.snapshotVersion)),I7(s,l);const d=new $i(u.target,l,c,u.sequenceNumber);vT(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){Z(Rl,"Failed to raise snapshot:",r),await Dy(t,r)}}async function Dy(t,e,n){if(!Pu(e))throw e;t.da.add(1),await ep(t),t.Va.set("Offline"),n||(n=()=>E7(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Z(Rl,"Retrying IndexedDB access"),await n(),t.da.delete(1),await b0(t)})}function R7(t,e){return e().catch(n=>Dy(t,n,e))}async function v0(t){const e=Se(t),n=ha(e);let r=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:sT;for(;D2e(e);)try{const o=await p2e(e.localStore,r);if(o===null){e.Ia.length===0&&n.k_();break}r=o.batchId,N2e(e,o)}catch(o){await Dy(e,o)}P7(e)&&D7(e)}function D2e(t){return $l(t)&&t.Ia.length<10}function N2e(t,e){t.Ia.push(e);const n=ha(t);n.N_()&&n.ea&&n.ta(e.mutations)}function P7(t){return $l(t)&&!ha(t).O_()&&t.Ia.length>0}function D7(t){ha(t).start()}async function O2e(t){ha(t).ia()}async function L2e(t){const e=ha(t);for(const n of t.Ia)e.ta(n.mutations)}async function V2e(t,e,n){const r=t.Ia.shift(),o=dT.from(r,e,n);await R7(t,()=>t.remoteSyncer.applySuccessfulWrite(o)),await v0(t)}async function j2e(t,e){e&&ha(t).ea&&await async function(r,o){if(function(i){return w_e(i)&&i!==H.ABORTED}(o.code)){const s=r.Ia.shift();ha(r).L_(),await R7(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,o)),await v0(r)}}(t,e),P7(t)&&D7(t)}async function MD(t,e){const n=Se(t);n.asyncQueue.verifyOperationInProgress(),Z(Rl,"RemoteStore received new credentials");const r=$l(n);n.da.add(3),await ep(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.da.delete(3),await b0(n)}async function B2e(t,e){const n=Se(t);e?(n.da.delete(2),await b0(n)):e||(n.da.add(2),await ep(n),n.Va.set("Unknown"))}function Du(t){return t.fa||(t.fa=function(n,r,o){const s=Se(n);return s.oa(),new k2e(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,o)}(t.datastore,t.asyncQueue,{e_:I2e.bind(null,t),n_:M2e.bind(null,t),i_:R2e.bind(null,t),Y_:P2e.bind(null,t)}),t.Aa.push(async e=>{e?(t.fa.L_(),CT(t)?wT(t):t.Va.set("Unknown")):(await t.fa.stop(),M7(t))})),t.fa}function ha(t){return t.ga||(t.ga=function(n,r,o){const s=Se(n);return s.oa(),new S2e(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,o)}(t.datastore,t.asyncQueue,{e_:()=>Promise.resolve(),n_:O2e.bind(null,t),i_:j2e.bind(null,t),na:L2e.bind(null,t),ra:V2e.bind(null,t)}),t.Aa.push(async e=>{e?(t.ga.L_(),await v0(t)):(await t.ga.stop(),t.Ia.length>0&&(Z(Rl,`Stopping write stream with ${t.Ia.length} pending writes`),t.Ia=[]))})),t.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(e,n,r,o,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=o,this.removalCallback=s,this.deferred=new Ki,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,o,s){const i=Date.now()+r,a=new xT(e,n,i,o,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(H.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function kT(t,e){if(Ks("AsyncQueue",`${e}: ${t}`),Pu(t))return new re(H.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{static emptySet(e){return new Mc(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||he.comparator(n.key,r.key):(n,r)=>he.comparator(n.key,r.key),this.keyedMap=kd(),this.sortedSet=new kt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Mc)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const o=n.getNext().key,s=r.getNext().key;if(!o.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Mc;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(){this.pa=new kt(he.comparator)}track(e){const n=e.doc.key,r=this.pa.get(n);r?e.type!==0&&r.type===3?this.pa=this.pa.insert(n,e):e.type===3&&r.type!==1?this.pa=this.pa.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.pa=this.pa.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.pa=this.pa.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.pa=this.pa.remove(n):e.type===1&&r.type===2?this.pa=this.pa.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.pa=this.pa.insert(n,{type:2,doc:e.doc}):ye(63341,{Vt:e,ya:r}):this.pa=this.pa.insert(n,e)}wa(){const e=[];return this.pa.inorderTraversal((n,r)=>{e.push(r)}),e}}class Zc{constructor(e,n,r,o,s,i,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=o,this.mutatedKeys=s,this.fromCache=i,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,o,s){const i=[];return n.forEach(a=>{i.push({type:0,doc:a})}),new Zc(e,n,Mc.emptySet(n),i,r,o,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&h0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let o=0;o<n.length;o++)if(n[o].type!==r[o].type||!n[o].doc.isEqual(r[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2e{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class F2e{constructor(){this.queries=PD(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const o=Se(n),s=o.queries;o.queries=PD(),s.forEach((i,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new re(H.ABORTED,"Firestore shutting down"))}}function PD(){return new Bl(t=>Z6(t),h0)}async function H2e(t,e){const n=Se(t);let r=3;const o=e.query;let s=n.queries.get(o);s?!s.Da()&&e.va()&&(r=2):(s=new $2e,r=e.va()?0:1);try{switch(r){case 0:s.ba=await n.onListen(o,!0);break;case 1:s.ba=await n.onListen(o,!1);break;case 2:await n.onFirstRemoteStoreListen(o)}}catch(i){const a=kT(i,`Initialization of query '${ac(e.query)}' failed`);return void e.onError(a)}n.queries.set(o,s),s.Sa.push(e),e.Fa(n.onlineState),s.ba&&e.Ma(s.ba)&&ST(n)}async function z2e(t,e){const n=Se(t),r=e.query;let o=3;const s=n.queries.get(r);if(s){const i=s.Sa.indexOf(e);i>=0&&(s.Sa.splice(i,1),s.Sa.length===0?o=e.va()?0:1:!s.Da()&&e.va()&&(o=2))}switch(o){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function U2e(t,e){const n=Se(t);let r=!1;for(const o of e){const s=o.query,i=n.queries.get(s);if(i){for(const a of i.Sa)a.Ma(o)&&(r=!0);i.ba=o}}r&&ST(n)}function W2e(t,e,n){const r=Se(t),o=r.queries.get(e);if(o)for(const s of o.Sa)s.onError(n);r.queries.delete(e)}function ST(t){t.Ca.forEach(e=>{e.next()})}var dx,DD;(DD=dx||(dx={})).xa="default",DD.Cache="cache";class q2e{constructor(e,n,r){this.query=e,this.Oa=n,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=r||{}}Ma(e){if(!this.options.includeMetadataChanges){const r=[];for(const o of e.docChanges)o.type!==3&&r.push(o);e=new Zc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Na?this.La(e)&&(this.Oa.next(e),n=!0):this.ka(e,this.onlineState)&&(this.qa(e),n=!0),this.Ba=e,n}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let n=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),n=!0),n}ka(e,n){if(!e.fromCache||!this.va())return!0;const r=n!=="Offline";return(!this.options.Qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}La(e){if(e.docChanges.length>0)return!0;const n=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}qa(e){e=Zc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==dx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N7{constructor(e){this.key=e}}class O7{constructor(e){this.key=e}}class G2e{constructor(e,n){this.query=e,this.Ha=n,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Le(),this.mutatedKeys=Le(),this.Za=e7(e),this.Xa=new Mc(this.Za)}get eu(){return this.Ha}tu(e,n){const r=n?n.nu:new RD,o=n?n.Xa:this.Xa;let s=n?n.mutatedKeys:this.mutatedKeys,i=o,a=!1;const l=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,c=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((u,d)=>{const h=o.get(u),f=f0(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),y=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let b=!1;h&&f?h.data.isEqual(f.data)?p!==y&&(r.track({type:3,doc:f}),b=!0):this.ru(h,f)||(r.track({type:2,doc:f}),b=!0,(l&&this.Za(f,l)>0||c&&this.Za(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),b=!0):h&&!f&&(r.track({type:1,doc:h}),b=!0,(l||c)&&(a=!0)),b&&(f?(i=i.add(f),s=y?s.add(u):s.delete(u)):(i=i.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const u=this.query.limitType==="F"?i.last():i.first();i=i.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{Xa:i,nu:r,Cs:a,mutatedKeys:s}}ru(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,o){const s=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const i=e.nu.wa();i.sort((u,d)=>function(f,p){const y=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ye(20277,{Vt:b})}};return y(f)-y(p)}(u.type,d.type)||this.Za(u.doc,d.doc)),this.iu(r),o=o!=null&&o;const a=n&&!o?this.su():[],l=this.Ya.size===0&&this.current&&!o?1:0,c=l!==this.Ja;return this.Ja=l,i.length!==0||c?{snapshot:new Zc(this.query,e.Xa,s,i,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),ou:a}:{ou:a}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new RD,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Le(),this.Xa.forEach(r=>{this._u(r.key)&&(this.Ya=this.Ya.add(r.key))});const n=[];return e.forEach(r=>{this.Ya.has(r)||n.push(new O7(r))}),this.Ya.forEach(r=>{e.has(r)||n.push(new N7(r))}),n}au(e){this.Ha=e.$s,this.Ya=Le();const n=this.tu(e.documents);return this.applyChanges(n,!0)}uu(){return Zc.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const ET="SyncEngine";class K2e{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Y2e{constructor(e){this.key=e,this.cu=!1}}class X2e{constructor(e,n,r,o,s,i){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=o,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.lu={},this.hu=new Bl(a=>Z6(a),h0),this.Pu=new Map,this.Tu=new Set,this.Iu=new kt(he.comparator),this.Eu=new Map,this.du=new pT,this.Au={},this.Ru=new Map,this.Vu=Qc.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function J2e(t,e,n=!0){const r=F7(t);let o;const s=r.hu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),o=s.view.uu()):o=await L7(r,e,n,!0),o}async function Q2e(t,e){const n=F7(t);await L7(n,e,!0,!1)}async function L7(t,e,n,r){const o=await m2e(t.localStore,Go(e)),s=o.targetId,i=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await Z2e(t,e,s,i==="current",o.resumeToken)),t.isPrimaryClient&&n&&A7(t.remoteStore,o),a}async function Z2e(t,e,n,r,o){t.fu=(d,h,f)=>async function(y,b,w,k){let x=b.view.tu(w);x.Cs&&(x=await ED(y.localStore,b.query,!1).then(({documents:T})=>b.view.tu(T,x)));const A=k&&k.targetChanges.get(b.targetId),I=k&&k.targetMismatches.get(b.targetId)!=null,M=b.view.applyChanges(x,y.isPrimaryClient,A,I);return OD(y,b.targetId,M.ou),M.snapshot}(t,d,h,f);const s=await ED(t.localStore,e,!0),i=new G2e(e,s.$s),a=i.tu(s.documents),l=Zf.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",o),c=i.applyChanges(a,t.isPrimaryClient,l);OD(t,n,c.ou);const u=new K2e(e,n,i);return t.hu.set(e,u),t.Pu.has(n)?t.Pu.get(n).push(e):t.Pu.set(n,[e]),c.snapshot}async function eAe(t,e,n){const r=Se(t),o=r.hu.get(e),s=r.Pu.get(o.targetId);if(s.length>1)return r.Pu.set(o.targetId,s.filter(i=>!h0(i,e))),void r.hu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(o.targetId),r.sharedClientState.isActiveQueryTarget(o.targetId)||await cx(r.localStore,o.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(o.targetId),n&&bT(r.remoteStore,o.targetId),hx(r,o.targetId)}).catch(Ru)):(hx(r,o.targetId),await cx(r.localStore,o.targetId,!0))}async function tAe(t,e){const n=Se(t),r=n.hu.get(e),o=n.Pu.get(r.targetId);n.isPrimaryClient&&o.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),bT(n.remoteStore,r.targetId))}async function nAe(t,e,n){const r=cAe(t);try{const o=await function(i,a){const l=Se(i),c=Kt.now(),u=a.reduce((f,p)=>f.add(p.key),Le());let d,h;return l.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=Ys(),y=Le();return l.Bs.getEntries(f,u).next(b=>{p=b,p.forEach((w,k)=>{k.isValidDocument()||(y=y.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(f,p)).next(b=>{d=b;const w=[];for(const k of a){const x=m_e(k,d.get(k.key).overlayedDocument);x!=null&&w.push(new Ea(k.key,x,U6(x.value.mapValue),Ko.exists(!0)))}return l.mutationQueue.addMutationBatch(f,c,w,a)}).next(b=>{h=b;const w=b.applyToLocalDocumentSet(d,y);return l.documentOverlayCache.saveOverlays(f,b.batchId,w)})}).then(()=>({batchId:h.batchId,changes:n7(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(o.batchId),function(i,a,l){let c=i.Au[i.currentUser.toKey()];c||(c=new kt(Me)),c=c.insert(a,l),i.Au[i.currentUser.toKey()]=c}(r,o.batchId,n),await tp(r,o.changes),await v0(r.remoteStore)}catch(o){const s=kT(o,"Failed to persist write");n.reject(s)}}async function V7(t,e){const n=Se(t);try{const r=await h2e(n.localStore,e);e.targetChanges.forEach((o,s)=>{const i=n.Eu.get(s);i&&(Ye(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?i.cu=!0:o.modifiedDocuments.size>0?Ye(i.cu,14607):o.removedDocuments.size>0&&(Ye(i.cu,42227),i.cu=!1))}),await tp(n,r,e)}catch(r){await Ru(r)}}function ND(t,e,n){const r=Se(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const o=[];r.hu.forEach((s,i)=>{const a=i.view.Fa(e);a.snapshot&&o.push(a.snapshot)}),function(i,a){const l=Se(i);l.onlineState=a;let c=!1;l.queries.forEach((u,d)=>{for(const h of d.Sa)h.Fa(a)&&(c=!0)}),c&&ST(l)}(r.eventManager,e),o.length&&r.lu.Y_(o),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function rAe(t,e,n){const r=Se(t);r.sharedClientState.updateQueryState(e,"rejected",n);const o=r.Eu.get(e),s=o&&o.key;if(s){let i=new kt(he.comparator);i=i.insert(s,Nn.newNoDocument(s,ke.min()));const a=Le().add(s),l=new g0(ke.min(),new Map,new kt(Me),i,a);await V7(r,l),r.Iu=r.Iu.remove(s),r.Eu.delete(e),TT(r)}else await cx(r.localStore,e,!1).then(()=>hx(r,e,n)).catch(Ru)}async function oAe(t,e){const n=Se(t),r=e.batch.batchId;try{const o=await d2e(n.localStore,e);B7(n,r,null),j7(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await tp(n,o)}catch(o){await Ru(o)}}async function sAe(t,e,n){const r=Se(t);try{const o=await function(i,a){const l=Se(i);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(d=>(Ye(d!==null,37113),u=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(r.localStore,e);B7(r,e,n),j7(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await tp(r,o)}catch(o){await Ru(o)}}function j7(t,e){(t.Ru.get(e)||[]).forEach(n=>{n.resolve()}),t.Ru.delete(e)}function B7(t,e,n){const r=Se(t);let o=r.Au[r.currentUser.toKey()];if(o){const s=o.get(e);s&&(n?s.reject(n):s.resolve(),o=o.remove(e)),r.Au[r.currentUser.toKey()]=o}}function hx(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Pu.get(e))t.hu.delete(r),n&&t.lu.gu(r,n);t.Pu.delete(e),t.isPrimaryClient&&t.du.Hr(e).forEach(r=>{t.du.containsKey(r)||$7(t,r)})}function $7(t,e){t.Tu.delete(e.path.canonicalString());const n=t.Iu.get(e);n!==null&&(bT(t.remoteStore,n),t.Iu=t.Iu.remove(e),t.Eu.delete(n),TT(t))}function OD(t,e,n){for(const r of n)r instanceof N7?(t.du.addReference(r.key,e),iAe(t,r)):r instanceof O7?(Z(ET,"Document no longer in limbo: "+r.key),t.du.removeReference(r.key,e),t.du.containsKey(r.key)||$7(t,r.key)):ye(19791,{pu:r})}function iAe(t,e){const n=e.key,r=n.path.canonicalString();t.Iu.get(n)||t.Tu.has(r)||(Z(ET,"New document in limbo: "+n),t.Tu.add(r),TT(t))}function TT(t){for(;t.Tu.size>0&&t.Iu.size<t.maxConcurrentLimboResolutions;){const e=t.Tu.values().next().value;t.Tu.delete(e);const n=new he(mt.fromString(e)),r=t.Vu.next();t.Eu.set(r,new Y2e(n)),t.Iu=t.Iu.insert(n,r),A7(t.remoteStore,new $i(Go(J6(n.path)),r,"TargetPurposeLimboResolution",c0.le))}}async function tp(t,e,n){const r=Se(t),o=[],s=[],i=[];r.hu.isEmpty()||(r.hu.forEach((a,l)=>{i.push(r.fu(l,e,n).then(c=>{var u;if((c||n)&&r.isPrimaryClient){const d=c?!c.fromCache:(u=n==null?void 0:n.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){o.push(c);const d=gT.Rs(l.targetId,c);s.push(d)}}))}),await Promise.all(i),r.lu.Y_(o),await async function(l,c){const u=Se(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>F.forEach(c,h=>F.forEach(h.ds,f=>u.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>F.forEach(h.As,f=>u.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!Pu(d))throw d;Z(yT,"Failed to update sequence numbers: "+d)}for(const d of c){const h=d.targetId;if(!d.fromCache){const f=u.xs.get(h),p=f.snapshotVersion,y=f.withLastLimboFreeSnapshotVersion(p);u.xs=u.xs.insert(h,y)}}}(r.localStore,s))}async function aAe(t,e){const n=Se(t);if(!n.currentUser.isEqual(e)){Z(ET,"User change. New user:",e.toKey());const r=await S7(n.localStore,e);n.currentUser=e,function(s,i){s.Ru.forEach(a=>{a.forEach(l=>{l.reject(new re(H.CANCELLED,i))})}),s.Ru.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await tp(n,r.ks)}}function lAe(t,e){const n=Se(t),r=n.Eu.get(e);if(r&&r.cu)return Le().add(r.key);{let o=Le();const s=n.Pu.get(e);if(!s)return o;for(const i of s){const a=n.hu.get(i);o=o.unionWith(a.view.eu)}return o}}function F7(t){const e=Se(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=V7.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lAe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=rAe.bind(null,e),e.lu.Y_=U2e.bind(null,e.eventManager),e.lu.gu=W2e.bind(null,e.eventManager),e}function cAe(t){const e=Se(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=oAe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sAe.bind(null,e),e}class Ny{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=y0(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,n){return null}Cu(e,n){return null}Du(e){return u2e(this.persistence,new a2e,e.initialUser,this.serializer)}Su(e){return new k7(mT.fi,this.serializer)}bu(e){return new y2e}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ny.provider={build:()=>new Ny};class uAe extends Ny{constructor(e){super(),this.cacheSizeBytes=e}vu(e,n){Ye(this.persistence.referenceDelegate instanceof Py,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new q_e(r,e.asyncQueue,n)}Su(e){const n=this.cacheSizeBytes!==void 0?ir.withCacheSize(this.cacheSizeBytes):ir.DEFAULT;return new k7(r=>Py.fi(r,n),this.serializer)}}class fx{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ND(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=aAe.bind(null,this.syncEngine),await B2e(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new F2e}()}createDatastore(e){const n=y0(e.databaseInfo.databaseId),r=function(s){return new x2e(s)}(e.databaseInfo);return function(s,i,a,l){return new T2e(s,i,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,o,s,i,a){return new A2e(r,o,s,i,a)}(this.localStore,this.datastore,e.asyncQueue,n=>ND(this.syncEngine,n,0),function(){return AD.C()?new AD:new b2e}())}createSyncEngine(e,n){return function(o,s,i,a,l,c,u){const d=new X2e(o,s,i,a,l,c);return u&&(d.mu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(o){const s=Se(o);Z(Rl,"RemoteStore shutting down."),s.da.add(5),await ep(s),s.Ra.shutdown(),s.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}fx.provider={build:()=>new fx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dAe{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Ks("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa="FirestoreClient";class hAe{constructor(e,n,r,o,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=o,this.user=Dn.UNAUTHENTICATED,this.clientId=N6.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async i=>{Z(fa,"Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(Z(fa,"Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ki;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=kT(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function $1(t,e){t.asyncQueue.verifyOperationInProgress(),Z(fa,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async o=>{r.isEqual(o)||(await S7(e.localStore,o),r=o)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function LD(t,e){t.asyncQueue.verifyOperationInProgress();const n=await fAe(t);Z(fa,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>MD(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,o)=>MD(e.remoteStore,o)),t._onlineComponents=e}async function fAe(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Z(fa,"Using user provided OfflineComponentProvider");try{await $1(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(o){return o.name==="FirebaseError"?o.code===H.FAILED_PRECONDITION||o.code===H.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(n))throw n;Kc("Error using user provided cache. Falling back to memory cache: "+n),await $1(t,new Ny)}}else Z(fa,"Using default OfflineComponentProvider"),await $1(t,new uAe(void 0));return t._offlineComponents}async function H7(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Z(fa,"Using user provided OnlineComponentProvider"),await LD(t,t._uninitializedComponentsProvider._online)):(Z(fa,"Using default OnlineComponentProvider"),await LD(t,new fx))),t._onlineComponents}function pAe(t){return H7(t).then(e=>e.syncEngine)}async function mAe(t){const e=await H7(t),n=e.eventManager;return n.onListen=J2e.bind(null,e.syncEngine),n.onUnlisten=eAe.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Q2e.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=tAe.bind(null,e.syncEngine),n}function gAe(t,e,n={}){const r=new Ki;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,a,l,c){const u=new dAe({next:h=>{u.xu(),i.enqueueAndForget(()=>z2e(s,d)),h.fromCache&&l.source==="server"?c.reject(new re(H.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new q2e(a,u,{includeMetadataChanges:!0,Qa:!0});return H2e(s,d)}(await mAe(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z7(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U7(t,e,n){if(!n)throw new re(H.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function yAe(t,e,n,r){if(e===!0&&r===!0)throw new re(H.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function jD(t){if(!he.isDocumentKey(t))throw new re(H.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function BD(t){if(he.isDocumentKey(t))throw new re(H.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function w0(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ye(12329,{type:typeof t})}function eu(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(H.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=w0(t);throw new re(H.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W7="firestore.googleapis.com",$D=!0;class FD{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new re(H.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=W7,this.ssl=$D}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:$D;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=x7;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<U_e)throw new re(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}yAe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=z7((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new re(H.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new re(H.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new re(H.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,o){return r.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class C0{constructor(e,n,r,o){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FD({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(H.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(H.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FD(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new CTe;switch(r.type){case"firstParty":return new ETe(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new re(H.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=VD.get(n);r&&(Z("ComponentProvider","Removing Datastore"),VD.delete(n),r.terminate())}(this),Promise.resolve()}}function bAe(t,e,n,r={}){var o;t=eu(t,C0);const s=nT(e),i=t._getSettings(),a=Object.assign(Object.assign({},i),{emulatorOptions:t._getEmulatorOptions()}),l=`${e}:${n}`;s&&(XSe(`https://${l}`),eEe("Firestore",!0)),i.host!==W7&&i.host!==l&&Kc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},i),{host:l,ssl:s,emulatorOptions:r});if(!xy(c,a)&&(t._setSettings(c),r.mockUserToken)){let u,d;if(typeof r.mockUserToken=="string")u=r.mockUserToken,d=Dn.MOCK_USER;else{u=JSe(r.mockUserToken,(o=t._app)===null||o===void 0?void 0:o.options.projectId);const h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new re(H.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Dn(h)}t._authCredentials=new xTe(new P6(u,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Nu(this.firestore,e,this._query)}}class Tr{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tr(this.firestore,e,this._key)}}class Yi extends Nu{constructor(e,n,r){super(e,n,J6(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tr(this.firestore,null,new he(e))}withConverter(e){return new Yi(this.firestore,e,this._path)}}function HD(t,e,...n){if(t=qs(t),U7("collection","path",e),t instanceof C0){const r=mt.fromString(e,...n);return BD(r),new Yi(t,null,r)}{if(!(t instanceof Tr||t instanceof Yi))throw new re(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(mt.fromString(e,...n));return BD(r),new Yi(t.firestore,null,r)}}function vAe(t,e,...n){if(t=qs(t),arguments.length===1&&(e=N6.newId()),U7("doc","path",e),t instanceof C0){const r=mt.fromString(e,...n);return jD(r),new Tr(t,null,new he(r))}{if(!(t instanceof Tr||t instanceof Yi))throw new re(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(mt.fromString(e,...n));return jD(r),new Tr(t.firestore,t instanceof Yi?t.converter:null,new he(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zD="AsyncQueue";class UD{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new T7(this,"async_queue_retry"),this.rc=()=>{const r=B1();r&&Z(zD,"Visibility state changed to "+r.visibilityState),this.x_.b_()},this.sc=e;const n=B1();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const n=B1();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const n=new Ki;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!Pu(e))throw e;Z(zD,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const n=this.sc.then(()=>(this.ec=!0,e().catch(r=>{throw this.Xu=r,this.ec=!1,Ks("INTERNAL UNHANDLED ERROR: ",WD(r)),r}).then(r=>(this.ec=!1,r))));return this.sc=n,n}enqueueAfterDelay(e,n,r){this.oc(),this.nc.indexOf(e)>-1&&(n=0);const o=xT.createAndSchedule(this,e,n,r,s=>this.uc(s));return this.Zu.push(o),o}oc(){this.Xu&&ye(47125,{cc:WD(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const n of this.Zu)if(n.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Zu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const n=this.Zu.indexOf(e);this.Zu.splice(n,1)}}function WD(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class x0 extends C0{constructor(e,n,r,o){super(e,n,r,o),this.type="firestore",this._queue=new UD,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new UD(e),this._firestoreClient=void 0,await e}}}function wAe(t,e){const n=typeof t=="object"?t:uTe(),r=typeof t=="string"?t:e,o=sTe(n,"firestore").getImmediate({identifier:r});if(!o._initialized){const s=KSe("firestore");s&&bAe(o,...s)}return o}function q7(t){if(t._terminated)throw new re(H.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||CAe(t),t._firestoreClient}function CAe(t){var e,n,r;const o=t._freezeSettings(),s=function(a,l,c,u){return new $Te(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,z7(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,o);t._componentsProvider||!((n=o.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=o.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),t._firestoreClient=new hAe(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new tu(Cn.fromBase64String(e))}catch(n){throw new re(H.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new tu(Cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new re(H.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new re(H.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new re(H.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Me(this._lat,e._lat)||Me(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,o){if(r.length!==o.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==o[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xAe=/^__.*__$/;class kAe{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ea(e,this.data,this.fieldMask,n,this.fieldTransforms):new Qf(e,this.data,n,this.fieldTransforms)}}class G7{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ea(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function K7(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ye(40011,{Ic:t})}}class MT{constructor(e,n,r,o,s,i){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=o,s===void 0&&this.Ec(),this.fieldTransforms=s||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new MT(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),o=this.dc({path:r,Rc:!1});return o.Vc(e),o}mc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),o=this.dc({path:r,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Oy(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(K7(this.Ic)&&xAe.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class SAe{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||y0(e)}bc(e,n,r,o=!1){return new MT({Ic:e,methodName:n,wc:r,path:mn.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function RT(t){const e=t._freezeSettings(),n=y0(t._databaseId);return new SAe(t._databaseId,!!e.ignoreUndefinedProperties,n)}function EAe(t,e,n,r,o,s={}){const i=t.bc(s.merge||s.mergeFields?2:0,e,n,o);PT("Data must be an object, but it was:",i,r);const a=Y7(r,i);let l,c;if(s.merge)l=new Sr(i.fieldMask),c=i.fieldTransforms;else if(s.mergeFields){const u=[];for(const d of s.mergeFields){const h=px(e,d,n);if(!i.contains(h))throw new re(H.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);J7(u,h)||u.push(h)}l=new Sr(u),c=i.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=i.fieldTransforms;return new kAe(new ur(a),l,c)}class S0 extends _T{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof S0}}function TAe(t,e,n,r){const o=t.bc(1,e,n);PT("Data must be an object, but it was:",o,r);const s=[],i=ur.empty();Sa(r,(l,c)=>{const u=DT(e,l,n);c=qs(c);const d=o.mc(u);if(c instanceof S0)s.push(u);else{const h=np(c,d);h!=null&&(s.push(u),i.set(u,h))}});const a=new Sr(s);return new G7(i,a,o.fieldTransforms)}function _Ae(t,e,n,r,o,s){const i=t.bc(1,e,n),a=[px(e,r,n)],l=[o];if(s.length%2!=0)throw new re(H.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(px(e,s[h])),l.push(s[h+1]);const c=[],u=ur.empty();for(let h=a.length-1;h>=0;--h)if(!J7(c,a[h])){const f=a[h];let p=l[h];p=qs(p);const y=i.mc(f);if(p instanceof S0)c.push(f);else{const b=np(p,y);b!=null&&(c.push(f),u.set(f,b))}}const d=new Sr(c);return new G7(u,d,i.fieldTransforms)}function AAe(t,e,n,r=!1){return np(n,t.bc(r?4:3,e))}function np(t,e){if(X7(t=qs(t)))return PT("Unsupported field value:",e,t),Y7(t,e);if(t instanceof _T)return function(r,o){if(!K7(o.Ic))throw o.gc(`${r._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(o);s&&o.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(r,o){const s=[];let i=0;for(const a of r){let l=np(a,o.fc(i));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),i++}return{arrayValue:{values:s}}}(t,e)}return function(r,o){if((r=qs(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return c_e(o.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Kt.fromDate(r);return{timestampValue:Ry(o.serializer,s)}}if(r instanceof Kt){const s=new Kt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ry(o.serializer,s)}}if(r instanceof AT)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof tu)return{bytesValue:m7(o.serializer,r._byteString)};if(r instanceof Tr){const s=o.databaseId,i=r.firestore._databaseId;if(!i.isEqual(s))throw o.gc(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:fT(r.firestore._databaseId||o.databaseId,r._key.path)}}if(r instanceof IT)return function(i,a){return{mapValue:{fields:{[H6]:{stringValue:z6},[Ty]:{arrayValue:{values:i.toArray().map(c=>{if(typeof c!="number")throw a.gc("VectorValues must only contain numeric values.");return uT(a.serializer,c)})}}}}}}(r,o);throw o.gc(`Unsupported field value: ${w0(r)}`)}(t,e)}function Y7(t,e){const n={};return L6(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Sa(t,(r,o)=>{const s=np(o,e.Ac(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function X7(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Kt||t instanceof AT||t instanceof tu||t instanceof Tr||t instanceof _T||t instanceof IT)}function PT(t,e,n){if(!X7(n)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(n)){const r=w0(n);throw r==="an object"?e.gc(t+" a custom object"):e.gc(t+" "+r)}}function px(t,e,n){if((e=qs(e))instanceof k0)return e._internalPath;if(typeof e=="string")return DT(t,e);throw Oy("Field path arguments must be of type string or ",t,!1,void 0,n)}const IAe=new RegExp("[~\\*/\\[\\]]");function DT(t,e,n){if(e.search(IAe)>=0)throw Oy(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new k0(...e.split("."))._internalPath}catch{throw Oy(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Oy(t,e,n,r,o){const s=r&&!r.isEmpty(),i=o!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||i)&&(l+=" (found",s&&(l+=` in field ${r}`),i&&(l+=` in document ${o}`),l+=")"),new re(H.INVALID_ARGUMENT,a+t+l)}function J7(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q7{constructor(e,n,r,o,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=o,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Tr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new MAe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(NT("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class MAe extends Q7{data(){return super.data()}}function NT(t,e){return typeof e=="string"?DT(t,e):e instanceof k0?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RAe(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new re(H.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class OT{}class PAe extends OT{}function qD(t,e,...n){let r=[];e instanceof OT&&r.push(e),r=r.concat(n),function(s){const i=s.filter(l=>l instanceof LT).length,a=s.filter(l=>l instanceof E0).length;if(i>1||i>0&&a>0)throw new re(H.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const o of r)t=o._apply(t);return t}class E0 extends PAe{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new E0(e,n,r)}_apply(e){const n=this._parse(e);return Z7(e._query,n),new Nu(e.firestore,e.converter,rx(e._query,n))}_parse(e){const n=RT(e.firestore);return function(s,i,a,l,c,u,d){let h;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new re(H.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){YD(d,u);const p=[];for(const y of d)p.push(KD(l,s,y));h={arrayValue:{values:p}}}else h=KD(l,s,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||YD(d,u),h=AAe(a,i,d,u==="in"||u==="not-in");return $t.create(c,u,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function GD(t,e,n){const r=e,o=NT("where",t);return E0._create(o,r,n)}class LT extends OT{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new LT(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:_o.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(o,s){let i=o;const a=s.getFlattenedFilters();for(const l of a)Z7(i,l),i=rx(i,l)}(e._query,n),new Nu(e.firestore,e.converter,rx(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function KD(t,e,n){if(typeof(n=qs(n))=="string"){if(n==="")throw new re(H.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Q6(e)&&n.indexOf("/")!==-1)throw new re(H.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(mt.fromString(n));if(!he.isDocumentKey(r))throw new re(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return iD(t,new he(r))}if(n instanceof Tr)return iD(t,n._key);throw new re(H.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${w0(n)}.`)}function YD(t,e){if(!Array.isArray(t)||t.length===0)throw new re(H.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Z7(t,e){const n=function(o,s){for(const i of o)for(const a of i.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new re(H.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new re(H.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class DAe{convertValue(e,n="none"){switch(da(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ua(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ye(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Sa(e,(o,s)=>{r[o]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,o;const s=(o=(r=(n=e.fields)===null||n===void 0?void 0:n[Ty].arrayValue)===null||r===void 0?void 0:r.values)===null||o===void 0?void 0:o.map(i=>Pt(i.doubleValue));return new IT(s)}convertGeoPoint(e){return new AT(Pt(e.latitude),Pt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=d0(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(sf(e));default:return null}}convertTimestamp(e){const n=ca(e);return new Kt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=mt.fromString(e);Ye(C7(r),9688,{name:e});const o=new af(r.get(1),r.get(3)),s=new he(r.popFirst(5));return o.isEqual(n)||Ks(`Document ${s} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NAe(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class OAe extends Q7{constructor(e,n,r,o,s,i){super(e,n,r,o,i),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new zm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(NT("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class zm extends OAe{data(e={}){return super.data(e)}}class LAe{constructor(e,n,r,o){this._firestore=e,this._userDataWriter=n,this._snapshot=o,this.metadata=new um(o.hasPendingWrites,o.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new zm(this._firestore,this._userDataWriter,r.key,r,new um(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new re(H.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(o,s){if(o._snapshot.oldDocs.isEmpty()){let i=0;return o._snapshot.docChanges.map(a=>{const l=new zm(o._firestore,o._userDataWriter,a.doc.key,a.doc,new um(o._snapshot.mutatedKeys.has(a.doc.key),o._snapshot.fromCache),o.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:i++}})}{let i=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new zm(o._firestore,o._userDataWriter,a.doc.key,a.doc,new um(o._snapshot.mutatedKeys.has(a.doc.key),o._snapshot.fromCache),o.query.converter);let c=-1,u=-1;return a.type!==0&&(c=i.indexOf(a.doc.key),i=i.delete(a.doc.key)),a.type!==1&&(i=i.add(a.doc),u=i.indexOf(a.doc.key)),{type:VAe(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function VAe(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ye(61501,{type:t})}}class jAe extends DAe{constructor(e){super(),this.firestore=e}convertBytes(e){return new tu(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Tr(this.firestore,null,n)}}function XD(t){t=eu(t,Nu);const e=eu(t.firestore,x0),n=q7(e),r=new jAe(e);return RAe(t._query),gAe(n,t._query).then(o=>new LAe(e,r,t,o))}function BAe(t,e,n,...r){t=eu(t,Tr);const o=eu(t.firestore,x0),s=RT(o);let i;return i=typeof(e=qs(e))=="string"||e instanceof k0?_Ae(s,"updateDoc",t._key,e,n,r):TAe(s,"updateDoc",t._key,e),e$(o,[i.toMutation(t._key,Ko.exists(!0))])}function $Ae(t,e){const n=eu(t.firestore,x0),r=vAe(t),o=NAe(t.converter,e);return e$(n,[EAe(RT(t.firestore),"addDoc",r._key,o,t.converter!==null,{}).toMutation(r._key,Ko.exists(!1))]).then(()=>r)}function e$(t,e){return function(r,o){const s=new Ki;return r.asyncQueue.enqueueAndForget(async()=>nAe(await pAe(r),o,s)),s.promise}(q7(t),e)}(function(e,n=!0){(function(o){Mu=o})(cTe),Sy(new nf("firestore",(r,{instanceIdentifier:o,options:s})=>{const i=r.getProvider("app").getImmediate(),a=new x0(new kTe(r.getProvider("auth-internal")),new TTe(i,r.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new re(H.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new af(c.options.projectId,u)}(i,o),i);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Ic(KP,YP,e),Ic(KP,YP,"esm2017")})();var FAe="firebase",HAe="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ic(FAe,HAe,"app");const t$=()=>{const[t]=Yr("user",{id:qn()},{storeOnMount:!0});return{user:t}},zAe={apiKey:"AIzaSyA5y2kRmE3UvUJfD5sNo8Ww5hdjSwF6VRY",authDomain:"dreamer-f595f.firebaseapp.com",projectId:"dreamer-f595f",storageBucket:"dreamer-f595f.firebasestorage.app",messagingSenderId:"363304767907",appId:"1:363304767907:web:734ebd9ea0bc436410ca16",measurementId:"G-B9GDH81EEC"},UAe=x6(zAe),JD=wAe(UAe,"(default)"),WAe=()=>{const{user:t}=t$();return{syncToCloud:async()=>{const r=Object.keys(localStorage).reduce((a,l)=>({...a,[l]:localStorage.getItem(l)}),{}),o=HD(JD,"localStorage"),s=qD(o,GD("userId","==",t.id)),i=await XD(s);if(i.empty){const a=await $Ae(o,{content:JSON.stringify(r),userId:t.id,created:new Date().toISOString()});return alert("DONE"),a.id}else{const a=i.docs[0].ref;return await BAe(a,{content:JSON.stringify(r),lastUpdated:new Date().toISOString()}),a.id}},syncFromCloud:async()=>{const r=HD(JD,"localStorage"),o=qD(r,GD("userId","==",t.id)),i=(await XD(o)).docs.map(a=>a.data());console.log(">LOCALSTORAGE",i)}}};function qAe(){const{syncToCloud:t,syncFromCloud:e}=WAe(),[n,r]=$.useState("{}"),{setAll:o}=VSe({onStorageChange:a=>r(JSON.stringify(a))}),s=a=>{r(a.target.value)},{user:i}=t$();return m.jsxs("div",{style:{padding:"20px",maxWidth:"600px",margin:"0 auto"},children:[m.jsx(me.Text,{children:i.id}),m.jsx("textarea",{value:n,onChange:s,placeholder:"Start typing here...",style:{width:"100%",height:"300px",padding:"10px",fontSize:"16px",border:"1px solid #ccc",borderRadius:"4px",resize:"vertical"}}),m.jsx("button",{onClick:()=>o(JSON.parse(n)),children:"UPDATE LOCAL STORAGE LOCAL"}),m.jsx("button",{onClick:t,children:"Sync(Upload to server)"}),m.jsx("button",{onClick:e,children:"FETCH(Download)"})]})}const Or=({children:t})=>m.jsx(Ike.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:t}),GAe=()=>{const t=Xs();return m.jsx(Yve,{mode:"wait",children:m.jsxs(S8,{location:t,children:[m.jsx(br,{path:"/",element:m.jsx(Or,{children:m.jsx(LSe,{})})}),m.jsx(br,{path:"/task/:id",element:m.jsx(Or,{children:m.jsx(Kpe,{})})}),m.jsx(br,{path:"/create-checklist",element:m.jsx(Or,{children:m.jsx(H0e,{})})}),m.jsx(br,{path:"/edit-checklist/:id",element:m.jsx(Or,{children:m.jsx(ove,{})})}),m.jsx(br,{path:"/weight-record",element:m.jsx(Or,{children:m.jsx(_ve,{})})}),m.jsx(br,{path:"/intro",element:m.jsx(Or,{children:m.jsx(cme,{})})}),m.jsx(br,{path:"/checklist-template",element:m.jsx(Or,{children:m.jsx(Bve,{})})}),m.jsx(br,{path:"/setting",element:m.jsx(Or,{children:m.jsx(IU,{})})}),m.jsx(br,{path:"/story",element:m.jsx(Or,{children:m.jsx(zve,{})})}),m.jsx(br,{path:"/audio",element:m.jsx(Or,{children:m.jsx(Uve,{})})}),m.jsx(br,{path:"/setting/local-storage-editor",element:m.jsx(Or,{children:m.jsx(qAe,{})})}),m.jsx(br,{path:"/notes",element:m.jsx(Or,{children:m.jsx(Wke,{})})})]},t.pathname)})},KAe=()=>m.jsx(Y8,{children:m.jsx(GAe,{})}),YAe="_container_1qdlo_1",XAe="_toast_1qdlo_8",JAe="_toastMessage_1qdlo_22",QAe="_toastButton_1qdlo_26",hd={container:YAe,toast:XAe,toastMessage:JAe,toastButton:QAe};function ZAe(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:o,onRegisteredSW:s,onRegisterError:i}=t;let a,l;const c=async(d=!0)=>{await l};async function u(){if("serviceWorker"in navigator){if(a=await hn(async()=>{const{Workbox:d}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:d}},[]).then(({Workbox:d})=>new d("/sw.js",{scope:"/",type:"classic"})).catch(d=>{i==null||i(d)}),!a)return;a.addEventListener("activated",d=>{(d.isUpdate||d.isExternal)&&window.location.reload()}),a.addEventListener("installed",d=>{d.isUpdate||r==null||r()}),a.register({immediate:e}).then(d=>{s?s("/sw.js",d):o==null||o(d)}).catch(d=>{i==null||i(d)})}}return l=u(),c}function eIe(t={}){const{immediate:e=!0,onNeedRefresh:n,onOfflineReady:r,onRegistered:o,onRegisteredSW:s,onRegisterError:i}=t,[a,l]=v.useState(!1),[c,u]=v.useState(!1),[d]=v.useState(()=>ZAe({immediate:e,onOfflineReady(){u(!0),r==null||r()},onNeedRefresh(){l(!0),n==null||n()},onRegistered:o,onRegisteredSW:s,onRegisterError:i}));return{needRefresh:[a,l],offlineReady:[c,u],updateServiceWorker:d}}function tIe(){const{offlineReady:[t,e],needRefresh:[n,r],updateServiceWorker:o}=eIe({onRegistered(i){console.log("SW Registered: "+i)},onRegisterError(i){console.log("SW registration error",i)}}),s=()=>{e(!1),r(!1)};return $.useEffect(()=>{n&&o(!0)},[n]),m.jsx("div",{className:hd.container,children:(t||n)&&m.jsxs("div",{className:hd.toast,children:[m.jsx("div",{className:hd.toastMessage,children:t?m.jsx("span",{children:"App ready to work offline"}):m.jsx("span",{children:"New content available, click on reload button to update."})}),n&&m.jsx("button",{className:hd.toastButton,onClick:()=>o(!0),children:"Reload"}),m.jsx("button",{className:hd.toastButton,onClick:()=>s(),children:"Close"})]})})}const nIe="_container_t8rr9_164",rIe="_body_t8rr9_172",QD={container:nIe,body:rIe};function oIe(){const{theme:t}=Hy();return m.jsxs("div",{className:QD.container,"data-theme":t,children:[m.jsxs("div",{className:QD.body,children:[m.jsx(KAe,{}),m.jsx(tIe,{})]}),m.jsx("div",{id:"drawer-global-root"})]})}const sIe=pz(dz(oIe));gn.render(m.jsx(sIe,{}),document.getElementById("app"));
